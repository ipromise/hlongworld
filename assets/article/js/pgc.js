!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function config($routeProvider){$routeProvider.when("/",{template:__webpack_require__(64),controller:"articleDraftCtrl as draft",reloadOnSearch:!1}).when("/published/",{template:__webpack_require__(65),controller:"articlePublisedCtrl as published",reloadOnSearch:!1}).when("/create/",{template:__webpack_require__(66),controller:"articleCreateCtrl as article",reloadOnSearch:!1}).when("/create/success/",{template:__webpack_require__(67),controller:"articleSuccessCtrl as vm",reloadOnSearch:!1}).otherwise({redirectTo:"/"}),PGC&&PGC.Video&&$routeProvider.when("/videolib/",{template:__webpack_require__(68),controller:"videoLibraryCtrl as videolib",reloadOnSearch:!1}).when("/videolib/create/",{template:__webpack_require__(69),controller:"videoCreateCtrl as videoCrt",reloadOnSearch:!1}).when("/videolib/update/",{template:__webpack_require__(70),controller:"videoUpdateCtrl as videoU"})}var _angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_angularSanitize=__webpack_require__(4),_angularSanitize2=_interopRequireDefault(_angularSanitize),_angularRoute=__webpack_require__(6),_angularRoute2=_interopRequireDefault(_angularRoute),_ngDialog=__webpack_require__(8),_ngDialog2=_interopRequireDefault(_ngDialog),_pgc=__webpack_require__(9),_pgc2=_interopRequireDefault(_pgc),_pgc3=__webpack_require__(25),_pgc4=_interopRequireDefault(_pgc3),_pgc5=__webpack_require__(31),_pgc6=_interopRequireDefault(_pgc5),_pgc7=__webpack_require__(36),_pgc8=_interopRequireDefault(_pgc7);__webpack_require__(62),__webpack_require__(63),config.$inject=["$routeProvider"],_angular2["default"].module("app",["ui.tinymce","monospaced.qrcode",_angularSanitize2["default"],_angularRoute2["default"],_ngDialog2["default"],_pgc4["default"],_pgc8["default"].name,_pgc6["default"].name,_pgc2["default"].name]).config(config)},function(module,exports,__webpack_require__){__webpack_require__(2),module.exports=angular},function(module,exports,__webpack_require__){(function(__webpack_provided_window_dot_jQuery){!function(window){"use strict";function minErr(module,ErrorConstructor){return ErrorConstructor=ErrorConstructor||Error,function(){var paramPrefix,i,SKIP_INDEXES=2,templateArgs=arguments,code=templateArgs[0],message="["+(module?module+":":"")+code+"] ",template=templateArgs[1];for(message+=template.replace(/\{\d+\}/g,function(match){var index=+match.slice(1,-1),shiftedIndex=index+SKIP_INDEXES;return shiftedIndex<templateArgs.length?toDebugString(templateArgs[shiftedIndex]):match}),message+="\nhttp://errors.angularjs.org/1.5.8/"+(module?module+"/":"")+code,i=SKIP_INDEXES,paramPrefix="?";i<templateArgs.length;i++,paramPrefix="&")message+=paramPrefix+"p"+(i-SKIP_INDEXES)+"="+encodeURIComponent(toDebugString(templateArgs[i]));return new ErrorConstructor(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;if(isArray(obj)||isString(obj)||jqLite&&obj instanceof jqLite)return!0;var length="length"in Object(obj)&&obj.length;return isNumber(length)&&(length>=0&&(length-1 in obj||obj instanceof Array)||"function"==typeof obj.item)}function forEach(obj,iterator,context){var key,length;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key,obj);else if(isArray(obj)||isArrayLike(obj)){var isPrimitive="object"!=typeof obj;for(key=0,length=obj.length;length>key;key++)(isPrimitive||key in obj)&&iterator.call(context,obj[key],key,obj)}else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context,obj);else if(isBlankObject(obj))for(key in obj)iterator.call(context,obj[key],key,obj);else if("function"==typeof obj.hasOwnProperty)for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);else for(key in obj)hasOwnProperty.call(obj,key)&&iterator.call(context,obj[key],key,obj);return obj}function forEachSorted(obj,iterator,context){for(var keys=Object.keys(obj).sort(),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){return++uid}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function baseExtend(dst,objs,deep){for(var h=dst.$$hashKey,i=0,ii=objs.length;ii>i;++i){var obj=objs[i];if(isObject(obj)||isFunction(obj))for(var keys=Object.keys(obj),j=0,jj=keys.length;jj>j;j++){var key=keys[j],src=obj[key];deep&&isObject(src)?isDate(src)?dst[key]=new Date(src.valueOf()):isRegExp(src)?dst[key]=new RegExp(src):src.nodeName?dst[key]=src.cloneNode(!0):isElement(src)?dst[key]=src.clone():(isObject(dst[key])||(dst[key]=isArray(src)?[]:{}),baseExtend(dst[key],[src],!0)):dst[key]=src}}return setHashKey(dst,h),dst}function extend(dst){return baseExtend(dst,slice.call(arguments,1),!1)}function merge(dst){return baseExtend(dst,slice.call(arguments,1),!0)}function toInt(str){return parseInt(str,10)}function inherit(parent,extra){return extend(Object.create(parent),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function hasCustomToString(obj){return isFunction(obj.toString)&&obj.toString!==toString}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!==value&&"object"==typeof value}function isBlankObject(value){return null!==value&&"object"==typeof value&&!getPrototypeOf(value)}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.window===obj}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isFormData(obj){return"[object FormData]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isBoolean(value){return"boolean"==typeof value}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function isTypedArray(value){return value&&isNumber(value.length)&&TYPED_ARRAY_REGEXP.test(toString.call(value))}function isArrayBuffer(obj){return"[object ArrayBuffer]"===toString.call(obj)}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function nodeName_(element){return lowercase(element.nodeName||element[0]&&element[0].nodeName)}function arrayRemove(array,value){var index=array.indexOf(value);return index>=0&&array.splice(index,1),index}function copy(source,destination){function copyRecurse(source,destination){var key,h=destination.$$hashKey;if(isArray(source))for(var i=0,ii=source.length;ii>i;i++)destination.push(copyElement(source[i]));else if(isBlankObject(source))for(key in source)destination[key]=copyElement(source[key]);else if(source&&"function"==typeof source.hasOwnProperty)for(key in source)source.hasOwnProperty(key)&&(destination[key]=copyElement(source[key]));else for(key in source)hasOwnProperty.call(source,key)&&(destination[key]=copyElement(source[key]));return setHashKey(destination,h),destination}function copyElement(source){if(!isObject(source))return source;var index=stackSource.indexOf(source);if(-1!==index)return stackDest[index];if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");var needsRecurse=!1,destination=copyType(source);return void 0===destination&&(destination=isArray(source)?[]:Object.create(getPrototypeOf(source)),needsRecurse=!0),stackSource.push(source),stackDest.push(destination),needsRecurse?copyRecurse(source,destination):destination}function copyType(source){switch(toString.call(source)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new source.constructor(copyElement(source.buffer),source.byteOffset,source.length);case"[object ArrayBuffer]":if(!source.slice){var copied=new ArrayBuffer(source.byteLength);return new Uint8Array(copied).set(new Uint8Array(source)),copied}return source.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new source.constructor(source.valueOf());case"[object RegExp]":var re=new RegExp(source.source,source.toString().match(/[^\/]*$/)[0]);return re.lastIndex=source.lastIndex,re;case"[object Blob]":return new source.constructor([source],{type:source.type})}return isFunction(source.cloneNode)?source.cloneNode(!0):void 0}var stackSource=[],stackDest=[];if(destination){if(isTypedArray(destination)||isArrayBuffer(destination))throw ngMinErr("cpta","Can't copy! TypedArray destination cannot be mutated.");if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");return isArray(destination)?destination.length=0:forEach(destination,function(value,key){"$$hashKey"!==key&&delete destination[key]}),stackSource.push(source),stackDest.push(destination),copyRecurse(source,destination)}return copyElement(source)}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)?equals(o1.getTime(),o2.getTime()):!1;if(isRegExp(o1))return isRegExp(o2)?o1.toString()==o2.toString():!1;if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2)||isDate(o2)||isRegExp(o2))return!1;keySet=createMap();for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!(key in keySet)&&"$"!==key.charAt(0)&&isDefined(o2[key])&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,concat(curryArgs,arguments,0)):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)&&"$"===key.charAt(1)?val=void 0:isWindow(value)?val="$WINDOW":value&&window.document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return isUndefined(obj)?void 0:(isNumber(pretty)||(pretty=pretty?2:null),JSON.stringify(obj,toJsonReplacer,pretty))}function fromJson(json){return isString(json)?JSON.parse(json):json}function timezoneToOffset(timezone,fallback){timezone=timezone.replace(ALL_COLONS,"");var requestedTimezoneOffset=Date.parse("Jan 01, 1970 00:00:00 "+timezone)/6e4;return isNaN(requestedTimezoneOffset)?fallback:requestedTimezoneOffset}function addDateMinutes(date,minutes){return date=new Date(date.getTime()),date.setMinutes(date.getMinutes()+minutes),date}function convertTimezoneToLocal(date,timezone,reverse){reverse=reverse?-1:1;var dateTimezoneOffset=date.getTimezoneOffset(),timezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset);return addDateMinutes(date,reverse*(timezoneOffset-dateTimezoneOffset))}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===NODE_TYPE_TEXT?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var obj={};return forEach((keyValue||"").split("&"),function(keyValue){var splitPoint,key,val;keyValue&&(key=keyValue=keyValue.replace(/\+/g,"%20"),splitPoint=keyValue.indexOf("="),-1!==splitPoint&&(key=keyValue.substring(0,splitPoint),val=keyValue.substring(splitPoint+1)),key=tryDecodeURIComponent(key),isDefined(key)&&(val=isDefined(val)?tryDecodeURIComponent(val):!0,hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val))}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function getNgAttribute(element,ngAttr){var attr,i,ii=ngAttrPrefixes.length;for(i=0;ii>i;++i)if(attr=ngAttrPrefixes[i]+ngAttr,isString(attr=element.getAttribute(attr)))return attr;return null}function angularInit(element,bootstrap){var appElement,module,config={};forEach(ngAttrPrefixes,function(prefix){var name=prefix+"app";!appElement&&element.hasAttribute&&element.hasAttribute(name)&&(appElement=element,module=element.getAttribute(name))}),forEach(ngAttrPrefixes,function(prefix){var candidate,name=prefix+"app";!appElement&&(candidate=element.querySelector("["+name.replace(":","\\:")+"]"))&&(appElement=candidate,module=candidate.getAttribute(name))}),appElement&&(config.strictDi=null!==getNgAttribute(appElement,"strict-di"),bootstrap(appElement,module?[module]:[],config))}function bootstrap(element,modules,config){isObject(config)||(config={});var defaultConfig={strictDi:!1};config=extend(defaultConfig,config);var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===window.document?"document":startingTag(element);throw ngMinErr("btstrpd","App already bootstrapped with this element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),config.debugInfoEnabled&&modules.push(["$compileProvider",function($compileProvider){$compileProvider.debugInfoEnabled(!0)}]),modules.unshift("ng");var injector=createInjector(modules,config.strictDi);return injector.invoke(["$rootScope","$rootElement","$compile","$injector",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_ENABLE_DEBUG_INFO=/^NG_ENABLE_DEBUG_INFO!/,NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&NG_ENABLE_DEBUG_INFO.test(window.name)&&(config.debugInfoEnabled=!0,window.name=window.name.replace(NG_ENABLE_DEBUG_INFO,"")),window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),angular.resumeBootstrap=function(extraModules){return forEach(extraModules,function(module){modules.push(module)}),doBootstrap()},void(isFunction(angular.resumeDeferredBootstrap)&&angular.resumeDeferredBootstrap()))}function reloadWithDebugInfo(){window.name="NG_ENABLE_DEBUG_INFO!"+window.name,window.location.reload()}function getTestability(rootElement){var injector=angular.element(rootElement).injector();if(!injector)throw ngMinErr("test","no injector found for element argument to getTestability");return injector.get("$$testability")}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){var originalCleanData;if(!bindJQueryFired){var jqName=jq();jQuery=isUndefined(jqName)?__webpack_provided_window_dot_jQuery:jqName?window[jqName]:void 0,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),originalCleanData=jQuery.cleanData,jQuery.cleanData=function(elems){for(var events,elem,i=0;null!=(elem=elems[i]);i++)events=jQuery._data(elem,"events"),events&&events.$destroy&&jQuery(elem).triggerHandler("$destroy");originalCleanData(elems)}):jqLite=JQLite,angular.element=jqLite,bindJQueryFired=!0}}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockNodes(nodes){for(var blockNodes,node=nodes[0],endNode=nodes[nodes.length-1],i=1;node!==endNode&&(node=node.nextSibling);i++)(blockNodes||nodes[i]!==node)&&(blockNodes||(blockNodes=jqLite(slice.call(nodes,0,i))),blockNodes.push(node));return blockNodes||nodes}function createMap(){return Object.create(null)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod,queue){return queue||(queue=invokeQueue),function(){return queue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}function invokeLaterAndSetModuleName(provider,method){return function(recipeName,factoryFunction){return factoryFunction&&isFunction(factoryFunction)&&(factoryFunction.$$moduleName=name),invokeQueue.push([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],configBlocks=[],runBlocks=[],config=invokeLater("$injector","invoke","push",configBlocks),moduleInstance={_invokeQueue:invokeQueue,_configBlocks:configBlocks,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLaterAndSetModuleName("$provide","provider"),factory:invokeLaterAndSetModuleName("$provide","factory"),service:invokeLaterAndSetModuleName("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),decorator:invokeLaterAndSetModuleName("$provide","decorator"),animation:invokeLaterAndSetModuleName("$animateProvider","register"),filter:invokeLaterAndSetModuleName("$filterProvider","register"),controller:invokeLaterAndSetModuleName("$controllerProvider","register"),directive:invokeLaterAndSetModuleName("$compileProvider","directive"),component:invokeLaterAndSetModuleName("$compileProvider","component"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;ii>i;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key])}return dst||src}function serializeObject(obj){var seen=[];return JSON.stringify(obj,function(key,val){if(val=toJsonReplacer(key,val),isObject(val)){if(seen.indexOf(val)>=0)return"...";seen.push(val)}return val})}function toDebugString(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):isUndefined(obj)?"undefined":"string"!=typeof obj?serializeObject(obj):obj}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,merge:merge,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{$$counter:0},getTestability:getTestability,$$minErr:minErr,$$csp:csp,reloadWithDebugInfo:reloadWithDebugInfo}),(angularModule=setupModuleLoader(window))("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,pattern:patternDirective,ngPattern:patternDirective,required:requiredDirective,ngRequired:requiredDirective,minlength:minlengthDirective,ngMinlength:minlengthDirective,maxlength:maxlengthDirective,ngMaxlength:maxlengthDirective,ngValue:ngValueDirective,ngModelOptions:ngModelOptionsDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$animateCss:$CoreAnimateCssProvider,$$animateJs:$$CoreAnimateJsProvider,$$animateQueue:$$CoreAnimateQueueProvider,$$AnimateRunner:$$AnimateRunnerFactoryProvider,$$animateAsyncRun:$$AnimateAsyncRunFactoryProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$$forceReflow:$$ForceReflowProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpParamSerializer:$HttpParamSerializerProvider,$httpParamSerializerJQLike:$HttpParamSerializerJQLikeProvider,$httpBackend:$HttpBackendProvider,$xhrFactory:$xhrFactoryProvider,$jsonpCallbacks:$jsonpCallbacksProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$$q:$$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$templateRequest:$TemplateRequestProvider,$$testability:$$TestabilityProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$jqLite:$$jqLiteProvider,$$HashMap:$$HashMapProvider,$$cookieReader:$$CookieReaderProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteAcceptsData(node){var nodeType=node.nodeType;return nodeType===NODE_TYPE_ELEMENT||!nodeType||nodeType===NODE_TYPE_DOCUMENT}function jqLiteHasData(node){for(var key in jqCache[node.ng339])return!0;return!1}function jqLiteCleanData(nodes){for(var i=0,ii=nodes.length;ii>i;i++)jqLiteRemoveData(nodes[i])}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,i,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],i=wrap[0];i--;)tmp=tmp.lastChild;nodes=concat(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",forEach(nodes,function(node){fragment.appendChild(node)}),fragment}function jqLiteParseHTML(html,context){context=context||window.document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:(parsed=jqLiteBuildFragment(html,context))?parsed.childNodes:[]}function jqLiteWrapNode(node,wrapper){var parent=node.parentNode;parent&&parent.replaceChild(wrapper,node),wrapper.appendChild(node)}function JQLite(element){if(element instanceof JQLite)return element;var argIsString;if(isString(element)&&(element=trim(element),argIsString=!0),!(this instanceof JQLite)){if(argIsString&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}argIsString?jqLiteAddNodes(this,jqLiteParseHTML(element)):jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element,onlyDescendants){if(onlyDescendants||jqLiteRemoveData(element),element.querySelectorAll)for(var descendants=element.querySelectorAll("*"),i=0,l=descendants.length;l>i;i++)jqLiteRemoveData(descendants[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,handle=expandoStore&&expandoStore.handle;if(handle)if(type){var removeHandler=function(type){var listenerFns=events[type];isDefined(fn)&&arrayRemove(listenerFns||[],fn),isDefined(fn)&&listenerFns&&listenerFns.length>0||(removeEventListenerFn(element,type,handle),delete events[type])};forEach(type.split(" "),function(type){removeHandler(type),MOUSE_EVENT_MAP[type]&&removeHandler(MOUSE_EVENT_MAP[type])})}else for(type in events)"$destroy"!==type&&removeEventListenerFn(element,type,handle),delete events[type]}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];if(expandoStore){if(name)return void delete expandoStore.data[name];expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element.ng339=void 0}}function jqLiteExpandoStore(element,createIfNecessary){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];return createIfNecessary&&!expandoStore&&(element.ng339=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={events:{},data:{},handle:void 0}),expandoStore}function jqLiteData(element,key,value){if(jqLiteAcceptsData(element)){var isSimpleSetter=isDefined(value),isSimpleGetter=!isSimpleSetter&&key&&!isObject(key),massGetter=!key,expandoStore=jqLiteExpandoStore(element,!isSimpleGetter),data=expandoStore&&expandoStore.data;if(isSimpleSetter)data[key]=value;else{if(massGetter)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}}function jqLiteHasClass(element,selector){return element.getAttribute?(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1:!1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),-1===existingClasses.indexOf(" "+cssClass+" ")&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements)if(elements.nodeType)root[root.length++]=elements;else{var length=elements.length;if("number"==typeof length&&elements.window!==elements){if(length)for(var i=0;length>i;i++)root[root.length++]=elements[i]}else root[root.length++]=elements}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){element.nodeType==NODE_TYPE_DOCUMENT&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;ii>i;i++)if(isDefined(value=jqLite.data(element,names[i])))return value;element=element.parentNode||element.nodeType===NODE_TYPE_DOCUMENT_FRAGMENT&&element.host}}function jqLiteEmpty(element){for(jqLiteDealoc(element,!0);element.firstChild;)element.removeChild(element.firstChild)}function jqLiteRemove(element,keepData){keepData||jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)}function jqLiteDocumentLoaded(action,win){win=win||window,"complete"===win.document.readyState?win.setTimeout(action):jqLite(win).on("load",action)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[nodeName_(element)]&&booleanAttr}function getAliasedAttrName(name){return ALIASED_ATTR[name]}function createEventHandler(element,events){var eventHandler=function(event,type){event.isDefaultPrevented=function(){return event.defaultPrevented};var eventFns=events[type||event.type],eventFnsLength=eventFns?eventFns.length:0;if(eventFnsLength){if(isUndefined(event.immediatePropagationStopped)){var originalStopImmediatePropagation=event.stopImmediatePropagation;event.stopImmediatePropagation=function(){event.immediatePropagationStopped=!0,event.stopPropagation&&event.stopPropagation(),originalStopImmediatePropagation&&originalStopImmediatePropagation.call(event)}}event.isImmediatePropagationStopped=function(){
return event.immediatePropagationStopped===!0};var handlerWrapper=eventFns.specialHandlerWrapper||defaultHandlerWrapper;eventFnsLength>1&&(eventFns=shallowCopy(eventFns));for(var i=0;eventFnsLength>i;i++)event.isImmediatePropagationStopped()||handlerWrapper(element,event,eventFns[i])}};return eventHandler.elem=element,eventHandler}function defaultHandlerWrapper(element,event,handler){handler.call(element,event)}function specialMouseHandlerWrapper(target,event,handler){var related=event.relatedTarget;related&&(related===target||jqLiteContains.call(target,related))||handler.call(target,event)}function $$jqLiteProvider(){this.$get=function(){return extend(JQLite,{hasClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteHasClass(node,classes)},addClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteAddClass(node,classes)},removeClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteRemoveClass(node,classes)}})}}function hashKey(obj,nextUidFn){var key=obj&&obj.$$hashKey;if(key)return"function"==typeof key&&(key=obj.$$hashKey()),key;var objType=typeof obj;return key="function"==objType||"object"==objType&&null!==obj?obj.$$hashKey=objType+":"+(nextUidFn||nextUid)():objType+":"+obj}function HashMap(array,isolatedUid){if(isolatedUid){var uid=0;this.nextUid=function(){return++uid}}forEach(array,this.put,this)}function stringifyFn(fn){return Function.prototype.toString.call(fn)+" "}function extractArgs(fn){var fnText=stringifyFn(fn).replace(STRIP_COMMENTS,""),args=fnText.match(ARROW_ARG)||fnText.match(FN_ARGS);return args}function anonFn(fn){var args=extractArgs(fn);return args?"function("+(args[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function annotate(fn,strictDi,name){var $inject,argDecl,last;if("function"==typeof fn){if(!($inject=fn.$inject)){if($inject=[],fn.length){if(strictDi)throw isString(name)&&name||(name=fn.name||anonFn(fn)),$injectorMinErr("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",name);argDecl=extractArgs(fn),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})}fn.$inject=$inject}}else isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0);return $inject}function createInjector(modulesToLoad,strictDi){function supportObject(delegate){return function(key,value){return isObject(key)?void forEach(key,reverseParams(delegate)):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function enforceReturnValue(name,factory){return function(){var result=instanceInjector.invoke(factory,this);if(isUndefined(result))throw $injectorMinErr("undef","Provider '{0}' must return a value from $get factory method.",name);return result}}function factory(name,factoryFn,enforce){return provider(name,{$get:enforce!==!1?enforceReturnValue(name,factoryFn):factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val),!1)}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){assertArg(isUndefined(modulesToLoad)||isArray(modulesToLoad),"modulesToLoad","not an array");var moduleFn,runBlocks=[];return forEach(modulesToLoad,function(module){function runInvokeQueue(queue){var i,ii;for(i=0,ii=queue.length;ii>i;i++){var invokeArgs=queue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}}if(!loadedModules.get(module)){loadedModules.put(module,!0);try{isString(module)?(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),runInvokeQueue(moduleFn._invokeQueue),runInvokeQueue(moduleFn._configBlocks)):isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName,caller){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName,caller)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function injectionArgs(fn,locals,serviceName){for(var args=[],$inject=createInjector.$$annotate(fn,strictDi,serviceName),i=0,length=$inject.length;length>i;i++){var key=$inject[i];if("string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key,serviceName))}return args}function isClass(func){return 11>=msie?!1:"function"==typeof func&&/^(?:class\b|constructor\()/.test(stringifyFn(func))}function invoke(fn,self,locals,serviceName){"string"==typeof locals&&(serviceName=locals,locals=null);var args=injectionArgs(fn,locals,serviceName);return isArray(fn)&&(fn=fn[fn.length-1]),isClass(fn)?(args.unshift(null),new(Function.prototype.bind.apply(fn,args))):fn.apply(self,args)}function instantiate(Type,locals,serviceName){var ctor=isArray(Type)?Type[Type.length-1]:Type,args=injectionArgs(Type,locals,serviceName);return args.unshift(null),new(Function.prototype.bind.apply(ctor,args))}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:createInjector.$$annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}strictDi=strictDi===!0;var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap([],!0),providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(serviceName,caller){throw angular.isString(caller)&&path.push(caller),$injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},protoInstanceInjector=createInternalInjector(instanceCache,function(serviceName,caller){var provider=providerInjector.get(serviceName+providerSuffix,caller);return instanceInjector.invoke(provider.$get,provider,void 0,serviceName)}),instanceInjector=protoInstanceInjector;providerCache["$injector"+providerSuffix]={$get:valueFn(protoInstanceInjector)};var runBlocks=loadModules(modulesToLoad);return instanceInjector=protoInstanceInjector.get("$injector"),instanceInjector.strictDi=strictDi,forEach(runBlocks,function(fn){fn&&instanceInjector.invoke(fn)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return Array.prototype.some.call(list,function(element){return"a"===nodeName_(element)?(result=element,!0):void 0}),result}function getYOffset(){var offset=scroll.yOffset;if(isFunction(offset))offset=offset();else if(isElement(offset)){var elem=offset[0],style=$window.getComputedStyle(elem);offset="fixed"!==style.position?0:elem.getBoundingClientRect().bottom}else isNumber(offset)||(offset=0);return offset}function scrollTo(elem){if(elem){elem.scrollIntoView();var offset=getYOffset();if(offset){var elemTop=elem.getBoundingClientRect().top;$window.scrollBy(0,elemTop-offset)}}else $window.scrollTo(0,0)}function scroll(hash){hash=isString(hash)?hash:$location.hash();var elm;hash?(elm=document.getElementById(hash))?scrollTo(elm):(elm=getFirstAnchor(document.getElementsByName(hash)))?scrollTo(elm):"top"===hash&&scrollTo(null):scrollTo(null)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(newVal,oldVal){newVal===oldVal&&""===newVal||jqLiteDocumentLoaded(function(){$rootScope.$evalAsync(scroll)})}),scroll}]}function mergeClasses(a,b){return a||b?a?b?(isArray(a)&&(a=a.join(" ")),isArray(b)&&(b=b.join(" ")),a+" "+b):a:b:""}function extractElementNode(element){for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType===ELEMENT_NODE)return elm}}function splitClasses(classes){isString(classes)&&(classes=classes.split(" "));var obj=createMap();return forEach(classes,function(klass){klass.length&&(obj[klass]=!0)}),obj}function prepareAnimateOptions(options){return isObject(options)?options:{}}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function getHash(url){var index=url.indexOf("#");return-1===index?"":url.substr(index)}function cacheStateAndFireUrlChange(){pendingLocation=null,cacheState(),fireUrlChange()}function cacheState(){cachedState=getCurrentState(),cachedState=isUndefined(cachedState)?null:cachedState,equals(cachedState,lastCachedState)&&(cachedState=lastCachedState),lastCachedState=cachedState}function fireUrlChange(){lastBrowserUrl===self.url()&&lastHistoryState===cachedState||(lastBrowserUrl=self.url(),lastHistoryState=cachedState,forEach(urlChangeListeners,function(listener){listener(self.url(),cachedState)}))}var self=this,location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var cachedState,lastHistoryState,lastBrowserUrl=location.href,baseElement=document.find("base"),pendingLocation=null,getCurrentState=$sniffer.history?function(){try{return history.state}catch(e){}}:noop;cacheState(),lastHistoryState=cachedState,self.url=function(url,replace,state){if(isUndefined(state)&&(state=null),location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){var sameState=lastHistoryState===state;if(lastBrowserUrl===url&&(!$sniffer.history||sameState))return self;var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,lastHistoryState=state,!$sniffer.history||sameBase&&sameState?(sameBase||(pendingLocation=url),replace?location.replace(url):sameBase?location.hash=getHash(url):location.href=url,location.href!==url&&(pendingLocation=url)):(history[replace?"replaceState":"pushState"](state,"",url),cacheState(),lastHistoryState=cachedState),pendingLocation&&(pendingLocation=url),self}return pendingLocation||location.href.replace(/%27/g,"'")},self.state=function(){return cachedState};var urlChangeListeners=[],urlChangeInit=!1,lastCachedState=null;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",cacheStateAndFireUrlChange),jqLite(window).on("hashchange",cacheStateAndFireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$applicationDestroyed=function(){jqLite(window).off("hashchange popstate",cacheStateAndFireUrlChange)},self.$$checkUrlChange=fireUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data=createMap(),capacity=options&&options.capacity||Number.MAX_VALUE,lruHash=createMap(),freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(!isUndefined(value)){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value}},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}key in data&&(delete data[key],size--)},removeAll:function(){data=createMap(),size=0,lruHash=createMap(),freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function UNINITIALIZED_VALUE(){}function $CompileProvider($provide,$$sanitizeUriProvider){function parseIsolateBindings(scope,directiveName,isController){var LOCAL_REGEXP=/^\s*([@&<]|=(\*?))(\??)\s*(\w*)\s*$/,bindings=createMap();return forEach(scope,function(definition,scopeName){if(definition in bindingCache)return void(bindings[scopeName]=bindingCache[definition]);var match=definition.match(LOCAL_REGEXP);if(!match)throw $compileMinErr("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",directiveName,scopeName,definition,isController?"controller bindings definition":"isolate scope definition");bindings[scopeName]={mode:match[1][0],collection:"*"===match[2],optional:"?"===match[3],attrName:match[4]||scopeName},match[4]&&(bindingCache[definition]=bindings[scopeName])}),bindings}function parseDirectiveBindings(directive,directiveName){var bindings={isolateScope:null,bindToController:null};if(isObject(directive.scope)&&(directive.bindToController===!0?(bindings.bindToController=parseIsolateBindings(directive.scope,directiveName,!0),bindings.isolateScope={}):bindings.isolateScope=parseIsolateBindings(directive.scope,directiveName,!1)),isObject(directive.bindToController)&&(bindings.bindToController=parseIsolateBindings(directive.bindToController,directiveName,!0)),isObject(bindings.bindToController)){var controller=directive.controller,controllerAs=directive.controllerAs;if(!controller)throw $compileMinErr("noctrl","Cannot bind to controller without directive '{0}'s controller.",directiveName);if(!identifierForController(controller,controllerAs))throw $compileMinErr("noident","Cannot bind to controller without identifier for directive '{0}'.",directiveName)}return bindings}function assertValidDirectiveName(name){var letter=name.charAt(0);if(!letter||letter!==lowercase(letter))throw $compileMinErr("baddir","Directive/Component name '{0}' is invalid. The first character must be a lowercase letter",name);if(name!==name.trim())throw $compileMinErr("baddir","Directive/Component name '{0}' is invalid. The name should not contain leading or trailing whitespaces",name)}function getDirectiveRequire(directive){var require=directive.require||directive.controller&&directive.name;return!isArray(require)&&isObject(require)&&forEach(require,function(value,key){var match=value.match(REQUIRE_PREFIX_REGEXP),name=value.substring(match[0].length);name||(require[key]=match[0]+key)}),require}var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\w\-]+)(?:\:([^;]+))?;?)/,ALL_OR_NOTHING_ATTRS=makeMap("ngSrc,ngSrcset,src,srcset"),REQUIRE_PREFIX_REGEXP=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/,bindingCache=createMap();this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertValidDirectiveName(name),assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=getDirectiveRequire(directive),directive.restrict=directive.restrict||"EA",directive.$$moduleName=directiveFactory.$$moduleName,directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.component=function(name,options){function factory($injector){function makeInjectable(fn){return isFunction(fn)||isArray(fn)?function(tElement,tAttrs){return $injector.invoke(fn,this,{$element:tElement,$attrs:tAttrs})}:fn}var template=options.template||options.templateUrl?options.template:"",ddo={controller:controller,controllerAs:identifierForController(options.controller)||options.controllerAs||"$ctrl",template:makeInjectable(template),templateUrl:makeInjectable(options.templateUrl),transclude:options.transclude,scope:{},bindToController:options.bindings||{},restrict:"E",require:options.require};return forEach(options,function(val,key){"$"===key.charAt(0)&&(ddo[key]=val)}),ddo}var controller=options.controller||function(){};return forEach(options,function(val,key){"$"===key.charAt(0)&&(factory[key]=val,isFunction(controller)&&(controller[key]=val))}),factory.$inject=["$injector"],this.directive(name,factory)},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()};var debugInfoEnabled=!0;this.debugInfoEnabled=function(enabled){return isDefined(enabled)?(debugInfoEnabled=enabled,this):debugInfoEnabled};var TTL=10;this.onChangesTtl=function(value){return arguments.length?(TTL=value,this):TTL},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$templateRequest,$parse,$controller,$rootScope,$sce,$animate,$$sanitizeUri){function flushOnChangesQueue(){try{if(!--onChangesTtl)throw onChangesQueue=void 0,$compileMinErr("infchng","{0} $onChanges() iterations reached. Aborting!\n",TTL);$rootScope.$apply(function(){for(var errors=[],i=0,ii=onChangesQueue.length;ii>i;++i)try{onChangesQueue[i]()}catch(e){errors.push(e)}if(onChangesQueue=void 0,errors.length)throw errors})}finally{onChangesTtl++}}function Attributes(element,attributesToCopy){if(attributesToCopy){var i,l,key,keys=Object.keys(attributesToCopy);for(i=0,l=keys.length;l>i;i++)key=keys[i],this[key]=attributesToCopy[key]}else this.$attr={};this.$$element=element}function setSpecialAttr(element,attrName,value){specialAttrHolder.innerHTML="<span "+attrName+">";var attributes=specialAttrHolder.firstChild.attributes,attribute=attributes[0];attributes.removeNamedItem(attribute.name),attribute.value=value,element.attributes.setNamedItem(attribute)}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes));for(var NOT_EMPTY=/\S+/,i=0,len=$compileNodes.length;len>i;i++){var domNode=$compileNodes[i];domNode.nodeType===NODE_TYPE_TEXT&&domNode.nodeValue.match(NOT_EMPTY)&&jqLiteWrapNode(domNode,$compileNodes[i]=window.document.createElement("span"))}var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);compile.$$addScopeClass($compileNodes);var namespace=null;return function(scope,cloneConnectFn,options){assertArg(scope,"scope"),previousCompileContext&&previousCompileContext.needsNewScope&&(scope=scope.$parent.$new()),options=options||{};var parentBoundTranscludeFn=options.parentBoundTranscludeFn,transcludeControllers=options.transcludeControllers,futureParentElement=options.futureParentElement;parentBoundTranscludeFn&&parentBoundTranscludeFn.$$boundTransclude&&(parentBoundTranscludeFn=parentBoundTranscludeFn.$$boundTransclude),namespace||(namespace=detectNamespaceForChildElements(futureParentElement));var $linkNode;if($linkNode="html"!==namespace?jqLite(wrapTemplate(namespace,jqLite("<div>").append($compileNodes).html())):cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes,transcludeControllers)for(var controllerName in transcludeControllers)$linkNode.data("$"+controllerName+"Controller",transcludeControllers[controllerName].instance);return compile.$$addScopeInfo($linkNode,scope),cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function detectNamespaceForChildElements(parentElement){var node=parentElement&&parentElement[0];return node&&"foreignobject"!==nodeName_(node)&&toString.call(node).match(/SVG/)?"svg":"html"}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,idx,childBoundTranscludeFn,stableNodeList;if(nodeLinkFnFound){var nodeListLength=nodeList.length;for(stableNodeList=new Array(nodeListLength),i=0;i<linkFns.length;i+=3)idx=linkFns[i],stableNodeList[idx]=nodeList[idx]}else stableNodeList=nodeList;for(i=0,ii=linkFns.length;ii>i;)node=stableNodeList[linkFns[i++]],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),compile.$$addScopeInfo(jqLite(node),childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,void 0,parentBoundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,nodeLinkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:void 0,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&compile.$$addScopeClass(attrs.$$element),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),(nodeLinkFn||childLinkFn)&&(linkFns.push(i,nodeLinkFn,childLinkFn),linkFnFound=!0,nodeLinkFnFound=nodeLinkFnFound||nodeLinkFn),previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){function boundTranscludeFn(transcludedScope,cloneFn,controllers,futureParentElement,containingScope){return transcludedScope||(transcludedScope=scope.$new(!1,containingScope),transcludedScope.$$transcluded=!0),transcludeFn(transcludedScope,cloneFn,{parentBoundTranscludeFn:previousBoundTranscludeFn,transcludeControllers:controllers,futureParentElement:futureParentElement})}var boundSlots=boundTranscludeFn.$$slots=createMap();for(var slotName in transcludeFn.$$slots)transcludeFn.$$slots[slotName]?boundSlots[slotName]=createBoundTranscludeFn(scope,transcludeFn.$$slots[slotName],previousBoundTranscludeFn):boundSlots[slotName]=null;return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case NODE_TYPE_ELEMENT:addDirective(directives,directiveNormalize(nodeName_(node)),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,isNgAttr,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++){var attrStartName=!1,attrEndName=!1;attr=nAttrs[j],name=attr.name,value=trim(attr.value),ngAttrName=directiveNormalize(name),(isNgAttr=NG_ATTR_BINDING.test(ngAttrName))&&(name=name.replace(PREFIX_REGEXP,"").substr(8).replace(/_(.)/g,function(match,letter){return letter.toUpperCase()}));var multiElementMatch=ngAttrName.match(MULTI_ELEMENT_DIR_RE);multiElementMatch&&directiveIsMultiElement(multiElementMatch[1])&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,!isNgAttr&&attrs.hasOwnProperty(nName)||(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName,isNgAttr),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}if(className=node.className,isObject(className)&&(className=className.animVal),isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case NODE_TYPE_TEXT:if(11===msie)for(;node.parentNode&&node.nextSibling&&node.nextSibling.nodeType===NODE_TYPE_TEXT;)node.nodeValue=node.nodeValue+node.nextSibling.nodeValue,node.parentNode.removeChild(node.nextSibling);addTextInterpolateDirective(directives,node.nodeValue);break;case NODE_TYPE_COMMENT:collectCommentDirectives(node,directives,attrs,maxPriority,ignoreDirective)}return directives.sort(byPriority),directives}function collectCommentDirectives(node,directives,attrs,maxPriority,ignoreDirective){try{var match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue);if(match){var nName=directiveNormalize(match[1]);addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2]))}}catch(e){}}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);node.nodeType==NODE_TYPE_ELEMENT&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function compilationGenerator(eager,$compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){var compiled;return eager?compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext):function(){return compiled||(compiled=compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext),$compileNodes=transcludeFn=previousCompileContext=null),compiled.apply(this,arguments)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn,futureParentElement,slotName){var transcludeControllers;if(isScope(scope)||(slotName=futureParentElement,futureParentElement=cloneAttachFn,cloneAttachFn=scope,scope=void 0),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),futureParentElement||(futureParentElement=hasElementTranscludeDirective?$element.parent():$element),!slotName)return boundTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild);var slotTranscludeFn=boundTranscludeFn.$$slots[slotName];if(slotTranscludeFn)return slotTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild);if(isUndefined(slotTranscludeFn))throw $compileMinErr("noslot",'No parent directive that requires a transclusion with slot name "{0}". Element: {1}',slotName,startingTag($element))}var i,ii,linkFn,isolateScope,controllerScope,elementControllers,transcludeFn,$element,attrs,scopeBindingInfo;compileNode===linkNode?(attrs=templateAttrs,$element=templateAttrs.$$element):($element=jqLite(linkNode),attrs=new Attributes($element,templateAttrs)),controllerScope=scope,newIsolateScopeDirective?isolateScope=scope.$new(!0):newScopeDirective&&(controllerScope=scope.$parent),
boundTranscludeFn&&(transcludeFn=controllersBoundTransclude,transcludeFn.$$boundTransclude=boundTranscludeFn,transcludeFn.isSlotFilled=function(slotName){return!!boundTranscludeFn.$$slots[slotName]}),controllerDirectives&&(elementControllers=setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope,newIsolateScopeDirective)),newIsolateScopeDirective&&(compile.$$addScopeInfo($element,isolateScope,!0,!(templateDirective&&(templateDirective===newIsolateScopeDirective||templateDirective===newIsolateScopeDirective.$$originalDirective))),compile.$$addScopeClass($element,!0),isolateScope.$$isolateBindings=newIsolateScopeDirective.$$isolateBindings,scopeBindingInfo=initializeDirectiveBindings(scope,attrs,isolateScope,isolateScope.$$isolateBindings,newIsolateScopeDirective),scopeBindingInfo.removeWatches&&isolateScope.$on("$destroy",scopeBindingInfo.removeWatches));for(var name in elementControllers){var controllerDirective=controllerDirectives[name],controller=elementControllers[name],bindings=controllerDirective.$$bindings.bindToController;controller.identifier&&bindings?controller.bindingInfo=initializeDirectiveBindings(controllerScope,attrs,controller.instance,bindings,controllerDirective):controller.bindingInfo={};var controllerResult=controller();controllerResult!==controller.instance&&(controller.instance=controllerResult,$element.data("$"+controllerDirective.name+"Controller",controllerResult),controller.bindingInfo.removeWatches&&controller.bindingInfo.removeWatches(),controller.bindingInfo=initializeDirectiveBindings(controllerScope,attrs,controller.instance,bindings,controllerDirective))}for(forEach(controllerDirectives,function(controllerDirective,name){var require=controllerDirective.require;controllerDirective.bindToController&&!isArray(require)&&isObject(require)&&extend(elementControllers[name].instance,getControllers(name,require,$element,elementControllers))}),forEach(elementControllers,function(controller){var controllerInstance=controller.instance;if(isFunction(controllerInstance.$onChanges))try{controllerInstance.$onChanges(controller.bindingInfo.initialChanges)}catch(e){$exceptionHandler(e)}if(isFunction(controllerInstance.$onInit))try{controllerInstance.$onInit()}catch(e){$exceptionHandler(e)}isFunction(controllerInstance.$doCheck)&&(controllerScope.$watch(function(){controllerInstance.$doCheck()}),controllerInstance.$doCheck()),isFunction(controllerInstance.$onDestroy)&&controllerScope.$on("$destroy",function(){controllerInstance.$onDestroy()})}),i=0,ii=preLinkFns.length;ii>i;i++)linkFn=preLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,void 0,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)linkFn=postLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);forEach(elementControllers,function(controller){var controllerInstance=controller.instance;isFunction(controllerInstance.$postLink)&&controllerInstance.$postLink()})}previousCompileContext=previousCompileContext||{};for(var directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,newScopeDirective=previousCompileContext.newScopeDirective,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,didScanForMultipleTransclusion=!1,mightHaveMultipleTransclusionError=!1,i=0,ii=directives.length;ii>i;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=void 0,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(directive.templateUrl||(isObject(directiveValue)?(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective||newScopeDirective,directive,$compileNode),newIsolateScopeDirective=directive):assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode)),newScopeDirective=newScopeDirective||directive),directiveName=directive.name,!didScanForMultipleTransclusion&&(directive.replace&&(directive.templateUrl||directive.template)||directive.transclude&&!directive.$$tlb)){for(var candidateDirective,scanningIndex=i+1;candidateDirective=directives[scanningIndex++];)if(candidateDirective.transclude&&!candidateDirective.$$tlb||candidateDirective.replace&&(candidateDirective.templateUrl||candidateDirective.template)){mightHaveMultipleTransclusionError=!0;break}didScanForMultipleTransclusion=!0}if(!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||createMap(),assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),directiveValue=directive.transclude)if(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue)hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(compile.$$createComment(directiveName,templateAttrs[directiveName])),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),$template[0].$$parentNode=$template[0].parentNode,childTranscludeFn=compilationGenerator(mightHaveMultipleTransclusionError,$template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective});else{var slots=createMap();if($template=jqLite(jqLiteClone(compileNode)).contents(),isObject(directiveValue)){$template=[];var slotMap=createMap(),filledSlots=createMap();forEach(directiveValue,function(elementSelector,slotName){var optional="?"===elementSelector.charAt(0);elementSelector=optional?elementSelector.substring(1):elementSelector,slotMap[elementSelector]=slotName,slots[slotName]=null,filledSlots[slotName]=optional}),forEach($compileNode.contents(),function(node){var slotName=slotMap[directiveNormalize(nodeName_(node))];slotName?(filledSlots[slotName]=!0,slots[slotName]=slots[slotName]||[],slots[slotName].push(node)):$template.push(node)}),forEach(filledSlots,function(filled,slotName){if(!filled)throw $compileMinErr("reqslot","Required transclusion slot `{0}` was not filled.",slotName)});for(var slotName in slots)slots[slotName]&&(slots[slotName]=compilationGenerator(mightHaveMultipleTransclusionError,slots[slotName],transcludeFn))}$compileNode.empty(),childTranscludeFn=compilationGenerator(mightHaveMultipleTransclusionError,$template,transcludeFn,void 0,void 0,{needsNewScope:directive.$$isolateScope||directive.$$newScope}),childTranscludeFn.$$slots=slots}if(directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:removeComments(wrapTemplate(directive.templateNamespace,trim(directiveValue))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));(newIsolateScopeDirective||newScopeDirective)&&markDirectiveScope(templateDirectives,newIsolateScopeDirective,newScopeDirective),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newScopeDirective:newScopeDirective!==directive&&newScopeDirective,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn);var context=directive.$$originalDirective||directive;isFunction(linkFn)?addLinkFns(null,bind(context,linkFn),attrStart,attrEnd):linkFn&&addLinkFns(bind(context,linkFn.pre),bind(context,linkFn.post),attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function getControllers(directiveName,require,$element,elementControllers){var value;if(isString(require)){var match=require.match(REQUIRE_PREFIX_REGEXP),name=require.substring(match[0].length),inheritType=match[1]||match[3],optional="?"===match[2];if("^^"===inheritType?$element=$element.parent():(value=elementControllers&&elementControllers[name],value=value&&value.instance),!value){var dataName="$"+name+"Controller";value=inheritType?$element.inheritedData(dataName):$element.data(dataName)}if(!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",name,directiveName)}else if(isArray(require)){value=[];for(var i=0,ii=require.length;ii>i;i++)value[i]=getControllers(directiveName,require[i],$element,elementControllers)}else isObject(require)&&(value={},forEach(require,function(controller,property){value[property]=getControllers(directiveName,controller,$element,elementControllers)}));return value||null}function setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope,newIsolateScopeDirective){var elementControllers=createMap();for(var controllerKey in controllerDirectives){var directive=controllerDirectives[controllerKey],locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn},controller=directive.controller;"@"==controller&&(controller=attrs[directive.name]);var controllerInstance=$controller(controller,locals,!0,directive.controllerAs);elementControllers[directive.name]=controllerInstance,$element.data("$"+directive.name+"Controller",controllerInstance.instance)}return elementControllers}function markDirectiveScope(directives,isolateScope,newScope){for(var j=0,jj=directives.length;jj>j;j++)directives[j]=inherit(directives[j],{$$isolateScope:isolateScope,$$newScope:newScope})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{if(directive=directives[i],(isUndefined(maxPriority)||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)){if(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),!directive.$$bindings){var bindings=directive.$$bindings=parseDirectiveBindings(directive,directive.name);isObject(bindings.isolateScope)&&(directive.$$isolateBindings=bindings.isolateScope)}tDirectives.push(directive),match=directive}}catch(e){$exceptionHandler(e)}return match}function directiveIsMultiElement(name){if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)if(directive=directives[i],directive.multiElement)return!0;return!1}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr;dst.$$element,forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){dst.hasOwnProperty(key)||"$"===key.charAt(0)||(dst[key]=value,"class"!==key&&"style"!==key&&(dstAttr[key]=srcAttr[key]))})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=inherit(origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl,templateNamespace=origAsyncDirective.templateNamespace;return $compileNode.empty(),$templateRequest(templateUrl).then(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:removeComments(wrapTemplate(templateNamespace,trim(content))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectiveScope(templateDirectives,!0),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(!scope.$$destroyed){if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}}linkQueue=null}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;scope.$$destroyed||(linkQueue?linkQueue.push(scope,node,rootElement,childBoundTranscludeFn):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn)))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){function wrapModuleNameIfDefined(moduleName){return moduleName?" (module: "+moduleName+")":""}if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",previousDirective.name,wrapModuleNameIfDefined(previousDirective.$$moduleName),directive.name,wrapModuleNameIfDefined(directive.$$moduleName),what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var templateNodeParent=templateNode.parent(),hasCompileParent=!!templateNodeParent.length;return hasCompileParent&&compile.$$addBindingClass(templateNodeParent),function(scope,node){var parent=node.parent();hasCompileParent||compile.$$addBindingClass(parent),compile.$$addBindingInfo(parent,interpolateFn.expressions),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}function wrapTemplate(type,template){switch(type=lowercase(type||"html")){case"svg":case"math":var wrapper=window.document.createElement("div");return wrapper.innerHTML="<"+type+">"+template+"</"+type+">",wrapper.childNodes[0].childNodes;default:return template}}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"form"==tag&&"action"==attrNormalizedName||"img"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name,allOrNothing){var trustedContext=getTrustedContext(node,name);allOrNothing=ALL_OR_NOTHING_ATTRS[name]||allOrNothing;var interpolateFn=$interpolate(value,!0,trustedContext,allOrNothing);if(interpolateFn){if("multiple"===name&&"select"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers=createMap());if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var newValue=attr[name];newValue!==value&&(interpolateFn=newValue&&$interpolate(newValue,!0,trustedContext,allOrNothing),value=newValue),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;jj>j;j++,j2++)jj>j2?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1,$rootElement.context===firstElementToRemove&&($rootElement.context=newNode);break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=window.document.createDocumentFragment();for(i=0;removeCount>i;i++)fragment.appendChild(elementsToRemove[i]);for(jqLite.hasData(firstElementToRemove)&&(jqLite.data(newNode,jqLite.data(firstElementToRemove)),jqLite(firstElementToRemove).off("$destroy")),jqLite.cleanData(fragment.querySelectorAll("*")),i=1;removeCount>i;i++)delete elementsToRemove[i];elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}function invokeLinkFn(linkFn,scope,$element,attrs,controllers,transcludeFn){try{linkFn(scope,$element,attrs,controllers,transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}function initializeDirectiveBindings(scope,attrs,destination,bindings,directive){function recordChanges(key,currentValue,previousValue){isFunction(destination.$onChanges)&&currentValue!==previousValue&&(onChangesQueue||(scope.$$postDigest(flushOnChangesQueue),onChangesQueue=[]),changes||(changes={},onChangesQueue.push(triggerOnChangesHook)),changes[key]&&(previousValue=changes[key].previousValue),changes[key]=new SimpleChange(previousValue,currentValue))}function triggerOnChangesHook(){destination.$onChanges(changes),changes=void 0}var changes,removeWatchCollection=[],initialChanges={};return forEach(bindings,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,removeWatch,attrName=definition.attrName,optional=definition.optional,mode=definition.mode;switch(mode){case"@":optional||hasOwnProperty.call(attrs,attrName)||(destination[scopeName]=attrs[attrName]=void 0),attrs.$observe(attrName,function(value){if(isString(value)||isBoolean(value)){var oldValue=destination[scopeName];recordChanges(scopeName,value,oldValue),destination[scopeName]=value}}),attrs.$$observers[attrName].$$scope=scope,lastValue=attrs[attrName],isString(lastValue)?destination[scopeName]=$interpolate(lastValue)(scope):isBoolean(lastValue)&&(destination[scopeName]=lastValue),initialChanges[scopeName]=new SimpleChange(_UNINITIALIZED_VALUE,destination[scopeName]);break;case"=":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b||a!==a&&b!==b},parentSet=parentGet.assign||function(){throw lastValue=destination[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' in attribute '{1}' used with directive '{2}' is non-assignable!",attrs[attrName],attrName,directive.name)},lastValue=destination[scopeName]=parentGet(scope);var parentValueWatch=function(parentValue){return compare(parentValue,destination[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=destination[scopeName]):destination[scopeName]=parentValue),lastValue=parentValue};parentValueWatch.$stateful=!0,removeWatch=definition.collection?scope.$watchCollection(attrs[attrName],parentValueWatch):scope.$watch($parse(attrs[attrName],parentValueWatch),null,parentGet.literal),removeWatchCollection.push(removeWatch);break;case"<":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;parentGet=$parse(attrs[attrName]);var initialValue=destination[scopeName]=parentGet(scope);initialChanges[scopeName]=new SimpleChange(_UNINITIALIZED_VALUE,destination[scopeName]),removeWatch=scope.$watch(parentGet,function(newValue,oldValue){if(oldValue===newValue){if(oldValue===initialValue)return;oldValue=initialValue}recordChanges(scopeName,newValue,oldValue),destination[scopeName]=newValue},parentGet.literal),removeWatchCollection.push(removeWatch);break;case"&":if(parentGet=attrs.hasOwnProperty(attrName)?$parse(attrs[attrName]):noop,parentGet===noop&&optional)break;destination[scopeName]=function(locals){return parentGet(scope,locals)}}}),{initialChanges:initialChanges,removeWatches:removeWatchCollection.length&&function(){for(var i=0,ii=removeWatchCollection.length;ii>i;++i)removeWatchCollection[i]()}}}var onChangesQueue,SIMPLE_ATTR_NAME=/^\w/,specialAttrHolder=window.document.createElement("div"),onChangesTtl=TTL;Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses);toAdd&&toAdd.length&&$animate.addClass(this.$$element,toAdd);var toRemove=tokenDifference(oldClasses,newClasses);toRemove&&toRemove.length&&$animate.removeClass(this.$$element,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,node=this.$$element[0],booleanKey=getBooleanAttrName(node,key),aliasedKey=getAliasedAttrName(key),observer=key;if(booleanKey?(this.$$element.prop(key,value),attrName=booleanKey):aliasedKey&&(this[aliasedKey]=value,observer=aliasedKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),"a"===nodeName&&("href"===key||"xlinkHref"===key)||"img"===nodeName&&"src"===key)this[key]=value=$$sanitizeUri(value,"src"===key);else if("img"===nodeName&&"srcset"===key&&isDefined(value)){for(var result="",trimmedSrcset=trim(value),srcPattern=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,pattern=/\s/.test(trimmedSrcset)?srcPattern:/(,)/,rawUris=trimmedSrcset.split(pattern),nbrUrisWith2parts=Math.floor(rawUris.length/2),i=0;nbrUrisWith2parts>i;i++){var innerIdx=2*i;result+=$$sanitizeUri(trim(rawUris[innerIdx]),!0),result+=" "+trim(rawUris[innerIdx+1])}var lastTuple=trim(rawUris[2*i]).split(/\s/);result+=$$sanitizeUri(trim(lastTuple[0]),!0),2===lastTuple.length&&(result+=" "+trim(lastTuple[1])),this[key]=value=result}writeAttr!==!1&&(null===value||isUndefined(value)?this.$$element.removeAttr(attrName):SIMPLE_ATTR_NAME.test(attrName)?this.$$element.attr(attrName,value):setSpecialAttr(this.$$element[0],attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[observer],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers=createMap()),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||!attrs.hasOwnProperty(key)||isUndefined(attrs[key])||fn(attrs[key])}),function(){arrayRemove(listeners,fn)}}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol&&"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/,MULTI_ELEMENT_DIR_RE=/^(.+)Start$/;return compile.$$addBindingInfo=debugInfoEnabled?function($element,binding){var bindings=$element.data("$binding")||[];isArray(binding)?bindings=bindings.concat(binding):bindings.push(binding),$element.data("$binding",bindings)}:noop,compile.$$addBindingClass=debugInfoEnabled?function($element){safeAddClass($element,"ng-binding")}:noop,compile.$$addScopeInfo=debugInfoEnabled?function($element,scope,isolated,noTemplate){var dataName=isolated?noTemplate?"$isolateScopeNoTemplate":"$isolateScope":"$scope";$element.data(dataName,scope)}:noop,compile.$$addScopeClass=debugInfoEnabled?function($element,isolated){safeAddClass($element,isolated?"ng-isolate-scope":"ng-scope")}:noop,compile.$$createComment=function(directiveName,comment){var content="";return debugInfoEnabled&&(content=" "+(directiveName||"")+": ",comment&&(content+=comment+" ")),window.document.createComment(content)},compile}]}function SimpleChange(previous,current){this.previousValue=previous,this.currentValue=current}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function removeComments(jqNodes){jqNodes=jqLite(jqNodes);var i=jqNodes.length;if(1>=i)return jqNodes;for(;i--;){var node=jqNodes[i];node.nodeType===NODE_TYPE_COMMENT&&splice.call(jqNodes,i,1)}return jqNodes}function identifierForController(controller,ident){if(ident&&isString(ident))return ident;if(isString(controller)){var match=CNTRL_REG.exec(controller);if(match)return match[3]}}function $ControllerProvider(){var controllers={},globals=!1;this.has=function(name){return controllers.hasOwnProperty(name)},this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.allowGlobals=function(){globals=!0},this.$get=["$injector","$window",function($injector,$window){function addIdentifier(locals,identifier,instance,name){if(!locals||!isObject(locals.$scope))throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",name,identifier);locals.$scope[identifier]=instance}return function(expression,locals,later,ident){var instance,match,constructor,identifier;if(later=later===!0,ident&&isString(ident)&&(identifier=ident),isString(expression)){if(match=expression.match(CNTRL_REG),!match)throw $controllerMinErr("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",expression);constructor=match[1],identifier=identifier||match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||(globals?getter($window,constructor,!0):void 0),assertArgFn(expression,constructor,!0)}if(later){var controllerPrototype=(isArray(expression)?expression[expression.length-1]:expression).prototype;instance=Object.create(controllerPrototype||null),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name);var instantiate;return instantiate=extend(function(){var result=$injector.invoke(expression,instance,locals,constructor);return result!==instance&&(isObject(result)||isFunction(result))&&(instance=result,identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name)),instance},{instance:instance,identifier:identifier})}return instance=$injector.instantiate(expression,locals,constructor),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(exception,cause){$log.error.apply($log,arguments)}}]}function serializeValue(v){return isObject(v)?isDate(v)?v.toISOString():toJson(v):v}function $HttpParamSerializerProvider(){this.$get=function(){return function(params){if(!params)return"";var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)?forEach(value,function(v){parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(v)))}):parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(value))))}),parts.join("&")}}}function $HttpParamSerializerJQLikeProvider(){this.$get=function(){return function(params){function serialize(toSerialize,prefix,topLevel){null===toSerialize||isUndefined(toSerialize)||(isArray(toSerialize)?forEach(toSerialize,function(value,index){serialize(value,prefix+"["+(isObject(value)?index:"")+"]");
}):isObject(toSerialize)&&!isDate(toSerialize)?forEachSorted(toSerialize,function(value,key){serialize(value,prefix+(topLevel?"":"[")+key+(topLevel?"":"]"))}):parts.push(encodeUriQuery(prefix)+"="+encodeUriQuery(serializeValue(toSerialize))))}if(!params)return"";var parts=[];return serialize(params,"",!0),parts.join("&")}}}function defaultHttpResponseTransform(data,headers){if(isString(data)){var tempData=data.replace(JSON_PROTECTION_PREFIX,"").trim();if(tempData){var contentType=headers("Content-Type");(contentType&&0===contentType.indexOf(APPLICATION_JSON)||isJsonLike(tempData))&&(data=fromJson(tempData))}}return data}function isJsonLike(str){var jsonStart=str.match(JSON_START);return jsonStart&&JSON_ENDS[jsonStart[0]].test(str)}function parseHeaders(headers){function fillInParsed(key,val){key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}var i,parsed=createMap();return isString(headers)?forEach(headers.split("\n"),function(line){i=line.indexOf(":"),fillInParsed(lowercase(trim(line.substr(0,i))),trim(line.substr(i+1)))}):isObject(headers)&&forEach(headers,function(headerVal,headerKey){fillInParsed(lowercase(headerKey),trim(headerVal))}),parsed}function headersGetter(headers){var headersObj;return function(name){if(headersObj||(headersObj=parseHeaders(headers)),name){var value=headersObj[lowercase(name)];return void 0===value&&(value=null),value}return headersObj}}function transformData(data,headers,status,fns){return isFunction(fns)?fns(data,headers,status):(forEach(fns,function(fn){data=fn(data,headers,status)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var defaults=this.defaults={transformResponse:[defaultHttpResponseTransform],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)||isFormData(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},useApplyAsync=!1;this.useApplyAsync=function(value){return isDefined(value)?(useApplyAsync=!!value,this):useApplyAsync};var useLegacyPromise=!0;this.useLegacyPromiseExtensions=function(value){return isDefined(value)?(useLegacyPromise=!!value,this):useLegacyPromise};var interceptorFactories=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$$cookieReader,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function chainInterceptors(promise,interceptors){for(var i=0,ii=interceptors.length;ii>i;){var thenFn=interceptors[i++],rejectFn=interceptors[i++];promise=promise.then(thenFn,rejectFn)}return interceptors.length=0,promise}function executeHeaderFns(headers,config){var headerContent,processedHeaders={};return forEach(headers,function(headerFn,header){isFunction(headerFn)?(headerContent=headerFn(config),null!=headerContent&&(processedHeaders[header]=headerContent)):processedHeaders[header]=headerFn}),processedHeaders}function mergeHeaders(config){var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return executeHeaderFns(reqHeaders,shallowCopy(config))}function serverRequest(config){var headers=config.headers,reqData=transformData(config.data,headersGetter(headers),void 0,config.transformRequest);return isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData).then(transformResponse,transformResponse)}function transformResponse(response){var resp=extend({},response);return resp.data=transformData(response.data,response.headers,response.status,config.transformResponse),isSuccess(response.status)?resp:$q.reject(resp)}if(!isObject(requestConfig))throw minErr("$http")("badreq","Http request configuration must be an object.  Received: {0}",requestConfig);if(!isString(requestConfig.url))throw minErr("$http")("badreq","Http request configuration url must be a string.  Received: {0}",requestConfig.url);var config=extend({method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse,paramSerializer:defaults.paramSerializer},requestConfig);config.headers=mergeHeaders(requestConfig),config.method=uppercase(config.method),config.paramSerializer=isString(config.paramSerializer)?$injector.get(config.paramSerializer):config.paramSerializer;var requestInterceptors=[],responseInterceptors=[],promise=$q.when(config);return forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&requestInterceptors.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&responseInterceptors.push(interceptor.response,interceptor.responseError)}),promise=chainInterceptors(promise,requestInterceptors),promise=promise.then(serverRequest),promise=chainInterceptors(promise,responseInterceptors),useLegacyPromise?(promise.success=function(fn){return assertArgFn(fn,"fn"),promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return assertArgFn(fn,"fn"),promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise}):(promise.success=$httpMinErrLegacyFn("success"),promise.error=$httpMinErrLegacyFn("error")),promise}function createShortMethods(names){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend({},config||{},{method:name,url:url}))}})}function createShortMethodsWithData(name){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend({},config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData){function createApplyHandlers(eventHandlers){if(eventHandlers){var applyHandlers={};return forEach(eventHandlers,function(eventHandler,key){applyHandlers[key]=function(event){function callEventHandler(){eventHandler(event)}useApplyAsync?$rootScope.$applyAsync(callEventHandler):$rootScope.$$phase?callEventHandler():$rootScope.$apply(callEventHandler)}}),applyHandlers}}function done(status,response,headersString,statusText){function resolveHttpPromise(){resolvePromise(response,status,headersString,statusText)}cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),useApplyAsync?$rootScope.$applyAsync(resolveHttpPromise):(resolveHttpPromise(),$rootScope.$$phase||$rootScope.$apply())}function resolvePromise(response,status,headers,statusText){status=status>=-1?status:0,(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function resolvePromiseWithResult(result){resolvePromise(result.data,result.status,shallowCopy(result.headers()),result.statusText)}function removePendingReq(){var idx=$http.pendingRequests.indexOf(config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,reqHeaders=config.headers,url=buildUrl(config.url,config.paramSerializer(config.params));if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||config.cache===!1||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache&&(cachedResp=cache.get(url),isDefined(cachedResp)?isPromiseLike(cachedResp)?cachedResp.then(resolvePromiseWithResult,resolvePromiseWithResult):isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK"):cache.put(url,promise)),isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$$cookieReader()[config.xsrfCookieName||defaults.xsrfCookieName]:void 0;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType,createApplyHandlers(config.eventHandlers),createApplyHandlers(config.uploadEventHandlers))}return promise}function buildUrl(url,serializedParams){return serializedParams.length>0&&(url+=(-1==url.indexOf("?")?"?":"&")+serializedParams),url}var defaultCache=$cacheFactory("$http");defaults.paramSerializer=isString(defaults.paramSerializer)?$injector.get(defaults.paramSerializer):defaults.paramSerializer;var reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put","patch"),$http.defaults=defaults,$http}]}function $xhrFactoryProvider(){this.$get=function(){return function(){return new window.XMLHttpRequest}}}function $HttpBackendProvider(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function($browser,$jsonpCallbacks,$document,$xhrFactory){return createHttpBackend($browser,$xhrFactory,$browser.defer,$jsonpCallbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackPath,done){url=url.replace("JSON_CALLBACK",callbackPath);var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks.wasCalled(callbackPath)||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),rawDocument.body.appendChild(script),callback}return function(method,url,post,callback,headers,timeout,withCredentials,responseType,eventHandlers,uploadEventHandlers){function timeoutRequest(){jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){isDefined(timeoutId)&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"===lowercase(method))var callbackPath=callbacks.createCallback(url),jsonpDone=jsonpReq(url,callbackPath,function(status,text){var response=200===status&&callbacks.getResponse(callbackPath);completeRequest(callback,status,response,"",text),callbacks.removeCallback(callbackPath)});else{var xhr=createXhr(method,url);xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onload=function(){var statusText=xhr.statusText||"",response="response"in xhr?xhr.response:xhr.responseText,status=1223===xhr.status?204:xhr.status;0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),completeRequest(callback,status,response,xhr.getAllResponseHeaders(),statusText)};var requestError=function(){completeRequest(callback,-1,null,null,"")};if(xhr.onerror=requestError,xhr.onabort=requestError,forEach(eventHandlers,function(value,key){xhr.addEventListener(key,value)}),forEach(uploadEventHandlers,function(value,key){xhr.upload.addEventListener(key,value)}),withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(isUndefined(post)?null:post)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function escape(ch){return"\\\\\\"+ch}function unescapeText(text){return text.replace(escapedStartRegexp,startSymbol).replace(escapedEndRegexp,endSymbol)}function stringify(value){if(null==value)return"";switch(typeof value){case"string":break;case"number":value=""+value;break;default:value=toJson(value)}return value}function constantWatchDelegate(scope,listener,objectEquality,constantInterp){var unwatch;return unwatch=scope.$watch(function(scope){return unwatch(),constantInterp(scope)},listener,objectEquality)}function $interpolate(text,mustHaveExpression,trustedContext,allOrNothing){function parseStringifyInterceptor(value){try{return value=getValue(value),allOrNothing&&!isDefined(value)?value:stringify(value)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}}if(!text.length||-1===text.indexOf(startSymbol)){var constantInterp;if(!mustHaveExpression){var unescapedText=unescapeText(text);constantInterp=valueFn(unescapedText),constantInterp.exp=text,constantInterp.expressions=[],constantInterp.$$watchDelegate=constantWatchDelegate}return constantInterp}allOrNothing=!!allOrNothing;for(var startIndex,endIndex,exp,index=0,expressions=[],parseFns=[],textLength=text.length,concat=[],expressionPositions=[];textLength>index;){if(-1==(startIndex=text.indexOf(startSymbol,index))||-1==(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))){index!==textLength&&concat.push(unescapeText(text.substring(index)));break}index!==startIndex&&concat.push(unescapeText(text.substring(index,startIndex))),exp=text.substring(startIndex+startSymbolLength,endIndex),expressions.push(exp),parseFns.push($parse(exp,parseStringifyInterceptor)),index=endIndex+endSymbolLength,expressionPositions.push(concat.length),concat.push("")}if(trustedContext&&concat.length>1&&$interpolateMinErr.throwNoconcat(text),!mustHaveExpression||expressions.length){var compute=function(values){for(var i=0,ii=expressions.length;ii>i;i++){if(allOrNothing&&isUndefined(values[i]))return;concat[expressionPositions[i]]=values[i]}return concat.join("")},getValue=function(value){return trustedContext?$sce.getTrusted(trustedContext,value):$sce.valueOf(value)};return extend(function(context){var i=0,ii=expressions.length,values=new Array(ii);try{for(;ii>i;i++)values[i]=parseFns[i](context);return compute(values)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}},{exp:text,expressions:expressions,$$watchDelegate:function(scope,listener){var lastValue;return scope.$watchGroup(parseFns,function(values,oldValues){var currValue=compute(values);isFunction(listener)&&listener.call(this,currValue,values!==oldValues?lastValue:currValue,scope),lastValue=currValue})}})}}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length,escapedStartRegexp=new RegExp(startSymbol.replace(/./g,escape),"g"),escapedEndRegexp=new RegExp(endSymbol.replace(/./g,escape),"g");return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q","$$q","$browser",function($rootScope,$window,$q,$$q,$browser){function interval(fn,delay,count,invokeApply){function callback(){hasParams?fn.apply(null,args):fn(iteration)}var hasParams=arguments.length>4,args=hasParams?sliceArgs(arguments,4):[],setInterval=$window.setInterval,clearInterval=$window.clearInterval,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return count=isDefined(count)?count:0,promise.$$intervalId=setInterval(function(){skipApply?$browser.defer(callback):$rootScope.$evalAsync(callback),deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return promise&&promise.$$intervalId in intervals?(intervals[promise.$$intervalId].reject("canceled"),$window.clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0):!1},interval}]}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj){var parsedUrl=urlResolve(absoluteUrl);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=toInt(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function startsWith(haystack,needle){return 0===haystack.lastIndexOf(needle,0)}function stripBaseUrl(base,url){return startsWith(url,base)?url.substr(base.length):void 0}function stripHash(url){var index=url.indexOf("#");return-1==index?url:url.substr(0,index)}function trimEmptyHash(url){return url.replace(/(#.+)|#$/,"$1")}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,appBaseNoFile,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"",parseAbsoluteUrl(appBase,this),this.$$parse=function(url){var pathUrl=stripBaseUrl(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var appUrl,prevAppUrl,rewrittenUrl;return isDefined(appUrl=stripBaseUrl(appBase,url))?(prevAppUrl=appUrl,rewrittenUrl=isDefined(appUrl=stripBaseUrl(basePrefix,appUrl))?appBaseNoFile+(stripBaseUrl("/",appUrl)||appUrl):appBase+prevAppUrl):isDefined(appUrl=stripBaseUrl(appBaseNoFile,url))?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile==url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl}}function LocationHashbangUrl(appBase,appBaseNoFile,hashPrefix){parseAbsoluteUrl(appBase,this),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;return startsWith(url,base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutHashUrl,withoutBaseUrl=stripBaseUrl(appBase,url)||stripBaseUrl(appBaseNoFile,url);isUndefined(withoutBaseUrl)||"#"!==withoutBaseUrl.charAt(0)?this.$$html5?withoutHashUrl=withoutBaseUrl:(withoutHashUrl="",isUndefined(withoutBaseUrl)&&(appBase=url,this.replace())):(withoutHashUrl=stripBaseUrl(hashPrefix,withoutBaseUrl),isUndefined(withoutHashUrl)&&(withoutHashUrl=withoutBaseUrl)),parseAppUrl(withoutHashUrl,this),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$parseLinkUrl=function(url,relHref){return stripHash(appBase)==stripHash(url)?(this.$$parse(url),!0):!1}}function LocationHashbangInHtml5Url(appBase,appBaseNoFile,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments),this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var rewrittenUrl,appUrl;return appBase==stripHash(url)?rewrittenUrl=url:(appUrl=stripBaseUrl(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isBoolean(mode)?(html5Mode.enabled=mode,this):isObject(mode)?(isBoolean(mode.enabled)&&(html5Mode.enabled=mode.enabled),isBoolean(mode.requireBase)&&(html5Mode.requireBase=mode.requireBase),isBoolean(mode.rewriteLinks)&&(html5Mode.rewriteLinks=mode.rewriteLinks),this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function($rootScope,$browser,$sniffer,$rootElement,$window){function setBrowserUrlWithFallback(url,replace,state){var oldUrl=$location.url(),oldState=$location.$$state;try{$browser.url(url,replace,state),$location.$$state=$browser.state()}catch(e){throw $location.url(oldUrl),$location.$$state=oldState,e}}function afterLocationChange(oldUrl,oldState){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl,$location.$$state,oldState)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();if(html5Mode.enabled){if(!baseHref&&html5Mode.requireBase)throw $locationMinErr("nobase","$location in HTML5 mode requires a <base> tag to be present!");appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url}else appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl;var appBaseNoFile=stripFile(appBase);$location=new LocationMode(appBase,appBaseNoFile,"#"+hashPrefix),$location.$$parseLinkUrl(initialUrl,initialUrl),$location.$$state=$browser.state();var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;$rootElement.on("click",function(event){if(html5Mode.rewriteLinks&&!event.ctrlKey&&!event.metaKey&&!event.shiftKey&&2!=event.which&&2!=event.button){for(var elm=jqLite(event.target);"a"!==nodeName_(elm[0]);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!=$browser.url()&&($rootScope.$apply(),$window.angular["ff-684208-preventDefault"]=!0))}}),trimEmptyHash($location.absUrl())!=trimEmptyHash(initialUrl)&&$browser.url($location.absUrl(),!0);var initializing=!0;return $browser.onUrlChange(function(newUrl,newState){return isUndefined(stripBaseUrl(appBaseNoFile,newUrl))?void($window.location.href=newUrl):($rootScope.$evalAsync(function(){var defaultPrevented,oldUrl=$location.absUrl(),oldState=$location.$$state;newUrl=trimEmptyHash(newUrl),$location.$$parse(newUrl),$location.$$state=newState,defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,newState,oldState).defaultPrevented,$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState,setBrowserUrlWithFallback(oldUrl,!1,oldState)):(initializing=!1,afterLocationChange(oldUrl,oldState)))}),void($rootScope.$$phase||$rootScope.$digest()))}),$rootScope.$watch(function(){var oldUrl=trimEmptyHash($browser.url()),newUrl=trimEmptyHash($location.absUrl()),oldState=$browser.state(),currentReplace=$location.$$replace,urlOrStateChanged=oldUrl!==newUrl||$location.$$html5&&$sniffer.history&&oldState!==$location.$$state;(initializing||urlOrStateChanged)&&(initializing=!1,$rootScope.$evalAsync(function(){var newUrl=$location.absUrl(),defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,$location.$$state,oldState).defaultPrevented;$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState):(urlOrStateChanged&&setBrowserUrlWithFallback(newUrl,currentReplace,oldState===$location.$$state?null:$location.$$state),afterLocationChange(oldUrl,oldState)))})),$location.$$replace=!1}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function getStringValue(name){return name+""}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.window===obj)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function ensureSafeAssignContext(obj,fullExpression){if(obj&&(obj===0..constructor||obj===(!1).constructor||obj==="".constructor||obj==={}.constructor||obj===[].constructor||obj===Function.constructor))throw $parseMinErr("isecaf","Assigning to a constructor is disallowed! Expression: {0}",fullExpression)}function ifDefined(v,d){return"undefined"!=typeof v?v:d}function plusFn(l,r){return"undefined"==typeof l?r:"undefined"==typeof r?l:l+r}function isStateless($filter,filterName){var fn=$filter(filterName);return!fn.$stateful}function findConstantAndWatchExpressions(ast,$filter){var allConstants,argsToWatch;switch(ast.type){case AST.Program:allConstants=!0,forEach(ast.body,function(expr){findConstantAndWatchExpressions(expr.expression,$filter),allConstants=allConstants&&expr.expression.constant}),ast.constant=allConstants;break;case AST.Literal:ast.constant=!0,ast.toWatch=[];break;case AST.UnaryExpression:findConstantAndWatchExpressions(ast.argument,$filter),ast.constant=ast.argument.constant,ast.toWatch=ast.argument.toWatch;break;case AST.BinaryExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.left.toWatch.concat(ast.right.toWatch);break;case AST.LogicalExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.ConditionalExpression:findConstantAndWatchExpressions(ast.test,$filter),findConstantAndWatchExpressions(ast.alternate,$filter),findConstantAndWatchExpressions(ast.consequent,$filter),ast.constant=ast.test.constant&&ast.alternate.constant&&ast.consequent.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.Identifier:ast.constant=!1,ast.toWatch=[ast];break;case AST.MemberExpression:findConstantAndWatchExpressions(ast.object,$filter),ast.computed&&findConstantAndWatchExpressions(ast.property,$filter),ast.constant=ast.object.constant&&(!ast.computed||ast.property.constant),ast.toWatch=[ast];break;case AST.CallExpression:allConstants=ast.filter?isStateless($filter,ast.callee.name):!1,argsToWatch=[],forEach(ast.arguments,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=ast.filter&&isStateless($filter,ast.callee.name)?argsToWatch:[ast];break;case AST.AssignmentExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=[ast];break;case AST.ArrayExpression:allConstants=!0,argsToWatch=[],forEach(ast.elements,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ObjectExpression:allConstants=!0,argsToWatch=[],forEach(ast.properties,function(property){findConstantAndWatchExpressions(property.value,$filter),allConstants=allConstants&&property.value.constant&&!property.computed,property.value.constant||argsToWatch.push.apply(argsToWatch,property.value.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ThisExpression:ast.constant=!1,ast.toWatch=[];break;case AST.LocalsExpression:ast.constant=!1,ast.toWatch=[]}}function getInputs(body){if(1==body.length){var lastExpression=body[0].expression,candidate=lastExpression.toWatch;return 1!==candidate.length?candidate:candidate[0]!==lastExpression?candidate:void 0}}function isAssignable(ast){return ast.type===AST.Identifier||ast.type===AST.MemberExpression;
}function assignableAST(ast){return 1===ast.body.length&&isAssignable(ast.body[0].expression)?{type:AST.AssignmentExpression,left:ast.body[0].expression,right:{type:AST.NGValueParameter},operator:"="}:void 0}function isLiteral(ast){return 0===ast.body.length||1===ast.body.length&&(ast.body[0].expression.type===AST.Literal||ast.body[0].expression.type===AST.ArrayExpression||ast.body[0].expression.type===AST.ObjectExpression)}function isConstant(ast){return ast.constant}function ASTCompiler(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function ASTInterpreter(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function isPossiblyDangerousMemberName(name){return"constructor"==name}function getValueOf(value){return isFunction(value.valueOf)?value.valueOf():objectValueOf.call(value)}function $ParseProvider(){var identStart,identContinue,cacheDefault=createMap(),cacheExpensive=createMap(),literals={"true":!0,"false":!1,"null":null,undefined:void 0};this.addLiteral=function(literalName,literalValue){literals[literalName]=literalValue},this.setIdentifierFns=function(identifierStart,identifierContinue){return identStart=identifierStart,identContinue=identifierContinue,this},this.$get=["$filter",function($filter){function $parse(exp,interceptorFn,expensiveChecks){var parsedExpression,oneTime,cacheKey;switch(expensiveChecks=expensiveChecks||runningChecksEnabled,typeof exp){case"string":exp=exp.trim(),cacheKey=exp;var cache=expensiveChecks?cacheExpensive:cacheDefault;if(parsedExpression=cache[cacheKey],!parsedExpression){":"===exp.charAt(0)&&":"===exp.charAt(1)&&(oneTime=!0,exp=exp.substring(2));var parseOptions=expensiveChecks?$parseOptionsExpensive:$parseOptions,lexer=new Lexer(parseOptions),parser=new Parser(lexer,$filter,parseOptions);parsedExpression=parser.parse(exp),parsedExpression.constant?parsedExpression.$$watchDelegate=constantWatchDelegate:oneTime?parsedExpression.$$watchDelegate=parsedExpression.literal?oneTimeLiteralWatchDelegate:oneTimeWatchDelegate:parsedExpression.inputs&&(parsedExpression.$$watchDelegate=inputsWatchDelegate),expensiveChecks&&(parsedExpression=expensiveChecksInterceptor(parsedExpression)),cache[cacheKey]=parsedExpression}return addInterceptor(parsedExpression,interceptorFn);case"function":return addInterceptor(exp,interceptorFn);default:return addInterceptor(noop,interceptorFn)}}function expensiveChecksInterceptor(fn){function expensiveCheckFn(scope,locals,assign,inputs){var expensiveCheckOldValue=runningChecksEnabled;runningChecksEnabled=!0;try{return fn(scope,locals,assign,inputs)}finally{runningChecksEnabled=expensiveCheckOldValue}}if(!fn)return fn;expensiveCheckFn.$$watchDelegate=fn.$$watchDelegate,expensiveCheckFn.assign=expensiveChecksInterceptor(fn.assign),expensiveCheckFn.constant=fn.constant,expensiveCheckFn.literal=fn.literal;for(var i=0;fn.inputs&&i<fn.inputs.length;++i)fn.inputs[i]=expensiveChecksInterceptor(fn.inputs[i]);return expensiveCheckFn.inputs=fn.inputs,expensiveCheckFn}function expressionInputDirtyCheck(newValue,oldValueOfValue){return null==newValue||null==oldValueOfValue?newValue===oldValueOfValue:"object"==typeof newValue&&(newValue=getValueOf(newValue),"object"==typeof newValue)?!1:newValue===oldValueOfValue||newValue!==newValue&&oldValueOfValue!==oldValueOfValue}function inputsWatchDelegate(scope,listener,objectEquality,parsedExpression,prettyPrintExpression){var lastResult,inputExpressions=parsedExpression.inputs;if(1===inputExpressions.length){var oldInputValueOf=expressionInputDirtyCheck;return inputExpressions=inputExpressions[0],scope.$watch(function(scope){var newInputValue=inputExpressions(scope);return expressionInputDirtyCheck(newInputValue,oldInputValueOf)||(lastResult=parsedExpression(scope,void 0,void 0,[newInputValue]),oldInputValueOf=newInputValue&&getValueOf(newInputValue)),lastResult},listener,objectEquality,prettyPrintExpression)}for(var oldInputValueOfValues=[],oldInputValues=[],i=0,ii=inputExpressions.length;ii>i;i++)oldInputValueOfValues[i]=expressionInputDirtyCheck,oldInputValues[i]=null;return scope.$watch(function(scope){for(var changed=!1,i=0,ii=inputExpressions.length;ii>i;i++){var newInputValue=inputExpressions[i](scope);(changed||(changed=!expressionInputDirtyCheck(newInputValue,oldInputValueOfValues[i])))&&(oldInputValues[i]=newInputValue,oldInputValueOfValues[i]=newInputValue&&getValueOf(newInputValue))}return changed&&(lastResult=parsedExpression(scope,void 0,void 0,oldInputValues)),lastResult},listener,objectEquality,prettyPrintExpression)}function oneTimeWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.apply(this,arguments),isDefined(value)&&scope.$$postDigest(function(){isDefined(lastValue)&&unwatch()})},objectEquality)}function oneTimeLiteralWatchDelegate(scope,listener,objectEquality,parsedExpression){function isAllDefined(value){var allDefined=!0;return forEach(value,function(val){isDefined(val)||(allDefined=!1)}),allDefined}var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.call(this,value,old,scope),isAllDefined(value)&&scope.$$postDigest(function(){isAllDefined(lastValue)&&unwatch()})},objectEquality)}function constantWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch;return unwatch=scope.$watch(function(scope){return unwatch(),parsedExpression(scope)},listener,objectEquality)}function addInterceptor(parsedExpression,interceptorFn){if(!interceptorFn)return parsedExpression;var watchDelegate=parsedExpression.$$watchDelegate,useInputs=!1,regularWatch=watchDelegate!==oneTimeLiteralWatchDelegate&&watchDelegate!==oneTimeWatchDelegate,fn=regularWatch?function(scope,locals,assign,inputs){var value=useInputs&&inputs?inputs[0]:parsedExpression(scope,locals,assign,inputs);return interceptorFn(value,scope,locals)}:function(scope,locals,assign,inputs){var value=parsedExpression(scope,locals,assign,inputs),result=interceptorFn(value,scope,locals);return isDefined(value)?result:value};return parsedExpression.$$watchDelegate&&parsedExpression.$$watchDelegate!==inputsWatchDelegate?fn.$$watchDelegate=parsedExpression.$$watchDelegate:interceptorFn.$stateful||(fn.$$watchDelegate=inputsWatchDelegate,useInputs=!parsedExpression.inputs,fn.inputs=parsedExpression.inputs?parsedExpression.inputs:[parsedExpression]),fn}var noUnsafeEval=csp().noUnsafeEval,$parseOptions={csp:noUnsafeEval,expensiveChecks:!1,literals:copy(literals),isIdentifierStart:isFunction(identStart)&&identStart,isIdentifierContinue:isFunction(identContinue)&&identContinue},$parseOptionsExpensive={csp:noUnsafeEval,expensiveChecks:!0,literals:copy(literals),isIdentifierStart:isFunction(identStart)&&identStart,isIdentifierContinue:isFunction(identContinue)&&identContinue},runningChecksEnabled=!1;return $parse.$$runningExpensiveChecks=function(){return runningChecksEnabled},$parse}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function $$QProvider(){this.$get=["$browser","$exceptionHandler",function($browser,$exceptionHandler){return qFactory(function(callback){$browser.defer(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function Promise(){this.$$state={status:0}}function simpleBind(context,fn){return function(value){fn.call(context,value)}}function processQueue(state){var fn,deferred,pending;pending=state.pending,state.processScheduled=!1,state.pending=void 0;for(var i=0,ii=pending.length;ii>i;++i){deferred=pending[i][0],fn=pending[i][state.status];try{isFunction(fn)?deferred.resolve(fn(state.value)):1===state.status?deferred.resolve(state.value):deferred.reject(state.value)}catch(e){deferred.reject(e),exceptionHandler(e)}}}function scheduleProcessQueue(state){!state.processScheduled&&state.pending&&(state.processScheduled=!0,nextTick(function(){processQueue(state)}))}function Deferred(){this.promise=new Promise}function all(promises){var deferred=new Deferred,counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,when(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}function race(promises){var deferred=defer();return forEach(promises,function(promise){when(promise).then(deferred.resolve,deferred.reject)}),deferred.promise}var $qMinErr=minErr("$q",TypeError),defer=function(){var d=new Deferred;return d.resolve=simpleBind(d,d.resolve),d.reject=simpleBind(d,d.reject),d.notify=simpleBind(d,d.notify),d};extend(Promise.prototype,{then:function(onFulfilled,onRejected,progressBack){if(isUndefined(onFulfilled)&&isUndefined(onRejected)&&isUndefined(progressBack))return this;var result=new Deferred;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([result,onFulfilled,onRejected,progressBack]),this.$$state.status>0&&scheduleProcessQueue(this.$$state),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback,progressBack){return this.then(function(value){return handleCallback(value,!0,callback)},function(error){return handleCallback(error,!1,callback)},progressBack)}}),extend(Deferred.prototype,{resolve:function(val){this.promise.$$state.status||(val===this.promise?this.$$reject($qMinErr("qcycle","Expected promise to be resolved with value other than itself '{0}'",val)):this.$$resolve(val))},$$resolve:function(val){function resolvePromise(val){done||(done=!0,that.$$resolve(val))}function rejectPromise(val){done||(done=!0,that.$$reject(val))}var then,that=this,done=!1;try{(isObject(val)||isFunction(val))&&(then=val&&val.then),isFunction(then)?(this.promise.$$state.status=-1,then.call(val,resolvePromise,rejectPromise,simpleBind(this,this.notify))):(this.promise.$$state.value=val,this.promise.$$state.status=1,scheduleProcessQueue(this.promise.$$state))}catch(e){rejectPromise(e),exceptionHandler(e)}},reject:function(reason){this.promise.$$state.status||this.$$reject(reason)},$$reject:function(reason){this.promise.$$state.value=reason,this.promise.$$state.status=2,scheduleProcessQueue(this.promise.$$state)},notify:function(progress){var callbacks=this.promise.$$state.pending;this.promise.$$state.status<=0&&callbacks&&callbacks.length&&nextTick(function(){for(var callback,result,i=0,ii=callbacks.length;ii>i;i++){result=callbacks[i][0],callback=callbacks[i][3];try{result.notify(isFunction(callback)?callback(progress):progress)}catch(e){exceptionHandler(e)}}})}});var reject=function(reason){var result=new Deferred;return result.reject(reason),result.promise},makePromise=function(value,resolved){var result=new Deferred;return resolved?result.resolve(value):result.reject(value),result.promise},handleCallback=function(value,isResolved,callback){var callbackOutput=null;try{isFunction(callback)&&(callbackOutput=callback())}catch(e){return makePromise(e,!1)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)},when=function(value,callback,errback,progressBack){var result=new Deferred;return result.resolve(value),result.promise.then(callback,errback,progressBack)},resolve=when,$Q=function(resolver){function resolveFn(value){deferred.resolve(value)}function rejectFn(reason){deferred.reject(reason)}if(!isFunction(resolver))throw $qMinErr("norslvr","Expected resolverFn, got '{0}'",resolver);var deferred=new Deferred;return resolver(resolveFn,rejectFn),deferred.promise};return $Q.prototype=Promise.prototype,$Q.defer=defer,$Q.reject=reject,$Q.when=when,$Q.resolve=resolve,$Q.all=all,$Q.race=race,$Q}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){function createChildScopeClass(parent){function ChildScope(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=nextUid(),this.$$ChildScope=null}return ChildScope.prototype=parent,ChildScope}var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null,applyAsyncId=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$exceptionHandler","$parse","$browser",function($exceptionHandler,$parse,$browser){function destroyChildScope($event){$event.currentScope.$$destroyed=!0}function cleanUpScope($scope){9===msie&&($scope.$$childHead&&cleanUpScope($scope.$$childHead),$scope.$$nextSibling&&cleanUpScope($scope.$$nextSibling)),$scope.$parent=$scope.$$nextSibling=$scope.$$prevSibling=$scope.$$childHead=$scope.$$childTail=$scope.$root=$scope.$$watchers=null}function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function incrementWatchersCount(current,count){do current.$$watchersCount+=count;while(current=current.$parent)}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}function flushApplyAsync(){for(;applyAsyncQueue.length;)try{applyAsyncQueue.shift()()}catch(e){$exceptionHandler(e)}applyAsyncId=null}function scheduleApplyAsync(){null===applyAsyncId&&(applyAsyncId=$browser.defer(function(){$rootScope.$apply(flushApplyAsync)}))}Scope.prototype={constructor:Scope,$new:function(isolate,parent){var child;return parent=parent||this,isolate?(child=new Scope,child.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=createChildScopeClass(this)),child=new this.$$ChildScope),child.$parent=parent,child.$$prevSibling=parent.$$childTail,parent.$$childHead?(parent.$$childTail.$$nextSibling=child,parent.$$childTail=child):parent.$$childHead=parent.$$childTail=child,(isolate||parent!=this)&&child.$on("$destroy",destroyChildScope),child},$watch:function(watchExp,listener,objectEquality,prettyPrintExpression){var get=$parse(watchExp);if(get.$$watchDelegate)return get.$$watchDelegate(this,listener,objectEquality,get,watchExp);var scope=this,array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:prettyPrintExpression||watchExp,eq:!!objectEquality};return lastDirtyWatch=null,isFunction(listener)||(watcher.fn=noop),array||(array=scope.$$watchers=[]),array.unshift(watcher),incrementWatchersCount(this,1),function(){arrayRemove(array,watcher)>=0&&incrementWatchersCount(scope,-1),lastDirtyWatch=null}},$watchGroup:function(watchExpressions,listener){function watchGroupAction(){changeReactionScheduled=!1,firstRun?(firstRun=!1,listener(newValues,newValues,self)):listener(newValues,oldValues,self)}var oldValues=new Array(watchExpressions.length),newValues=new Array(watchExpressions.length),deregisterFns=[],self=this,changeReactionScheduled=!1,firstRun=!0;if(!watchExpressions.length){var shouldCall=!0;return self.$evalAsync(function(){shouldCall&&listener(newValues,newValues,self)}),function(){shouldCall=!1}}return 1===watchExpressions.length?this.$watch(watchExpressions[0],function(value,oldValue,scope){newValues[0]=value,oldValues[0]=oldValue,listener(newValues,value===oldValue?newValues:oldValues,scope)}):(forEach(watchExpressions,function(expr,i){var unwatchFn=self.$watch(expr,function(value,oldValue){newValues[i]=value,oldValues[i]=oldValue,changeReactionScheduled||(changeReactionScheduled=!0,self.$evalAsync(watchGroupAction))});deregisterFns.push(unwatchFn)}),function(){for(;deregisterFns.length;)deregisterFns.shift()()})},$watchCollection:function(obj,listener){function $watchCollectionInterceptor(_value){newValue=_value;var newLength,key,bothNaN,newItem,oldItem;if(!isUndefined(newValue)){if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;newLength>i;i++)oldItem=oldValue[i],newItem=newValue[i],bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[i]=newItem)}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)hasOwnProperty.call(newValue,key)&&(newLength++,newItem=newValue[key],oldItem=oldValue[key],key in oldValue?(bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[key]=newItem)):(oldLength++,oldValue[key]=newItem,changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)hasOwnProperty.call(newValue,key)||(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}$watchCollectionInterceptor.$stateful=!0;var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,changeDetector=$parse(obj,$watchCollectionInterceptor),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch(changeDetector,$watchCollectionAction)},$digest:function(){var watch,value,last,fn,get,watchers,length,dirty,next,current,logIdx,asyncTask,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),this===$rootScope&&null!==applyAsyncId&&($browser.defer.cancel(applyAsyncId),flushApplyAsync()),lastDirtyWatch=null;do{dirty=!1,current=target;for(var asyncQueuePosition=0;asyncQueuePosition<asyncQueue.length;asyncQueuePosition++){try{asyncTask=asyncQueue[asyncQueuePosition],asyncTask.scope.$eval(asyncTask.expression,asyncTask.locals)}catch(e){$exceptionHandler(e)}lastDirtyWatch=null}asyncQueue.length=0;traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if(get=watch.get,(value=get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,fn=watch.fn,fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),watchLog[logIdx].push({msg:isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,newVal:value,oldVal:last}))}catch(e){$exceptionHandler(e)}if(!(next=current.$$watchersCount&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,watchLog)}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueuePosition<postDigestQueue.length;)try{postDigestQueue[postDigestQueuePosition++]()}catch(e){$exceptionHandler(e)}postDigestQueue.length=postDigestQueuePosition=0},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this===$rootScope&&$browser.$$applicationDestroyed(),incrementWatchersCount(this,-this.$$watchersCount);for(var eventName in this.$$listenerCount)decrementListenerCount(this,this.$$listenerCount[eventName],eventName);parent&&parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent&&parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=noop,this.$on=this.$watch=this.$watchGroup=function(){return noop},this.$$listeners={},this.$$nextSibling=null,cleanUpScope(this)}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr,locals){$rootScope.$$phase||asyncQueue.length||$browser.defer(function(){asyncQueue.length&&$rootScope.$digest()}),asyncQueue.push({scope:this,expression:$parse(expr),locals:locals})},$$postDigest:function(fn){postDigestQueue.push(fn)},$apply:function(expr){try{beginPhase("$apply");try{return this.$eval(expr)}finally{clearPhase()}}catch(e){$exceptionHandler(e)}finally{try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$applyAsync:function(expr){function $applyAsyncExpression(){scope.$eval(expr)}var scope=this;expr&&applyAsyncQueue.push($applyAsyncExpression),expr=$parse(expr),scheduleApplyAsync()},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){var indexOfListener=namedListeners.indexOf(listener);-1!==indexOfListener&&(namedListeners[indexOfListener]=null,decrementListenerCount(self,1,name))}},$emit:function(name,args){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event.currentScope=null,event;scope=scope.$parent}while(scope);return event.currentScope=null,event},$broadcast:function(name,args){var target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1};if(!target.$$listenerCount[name])return event;for(var listeners,i,length,listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event.currentScope=null,event}};var $rootScope=new Scope,asyncQueue=$rootScope.$$asyncQueue=[],postDigestQueue=$rootScope.$$postDigestQueue=[],applyAsyncQueue=$rootScope.$$applyAsyncQueue=[],postDigestQueuePosition=0;return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex)?uri:"unsafe:"+normalizedVal}}}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;n>i;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;n>i;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||isUndefined(trustedValue)||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||isUndefined(maybeTrusted)||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(html){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sceDelegate",function($parse,$sceDelegate){if(enabled&&8>msie)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:$parse(expr,function(value){return sce.getTrusted(type,value)})};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},isChromePackagedApp=$window.chrome&&$window.chrome.app&&$window.chrome.app.runtime,hasHistoryPushState=!isChromePackagedApp&&$window.history&&$window.history.pushState,android=toInt((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},vendorRegex=/^(Moz|webkit|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix[0].toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(bodyStyle.webkitTransition),animations=isString(bodyStyle.webkitAnimation))}return{history:!(!hasHistoryPushState||4>android||boxee),hasEvent:function(event){if("input"===event&&11>=msie)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android}}]}function $TemplateRequestProvider(){var httpOptions;this.httpOptions=function(val){return val?(httpOptions=val,this):httpOptions},this.$get=["$templateCache","$http","$q","$sce",function($templateCache,$http,$q,$sce){
function handleRequestFn(tpl,ignoreRequestError){function handleError(resp){if(!ignoreRequestError)throw $templateRequestMinErr("tpload","Failed to load template: {0} (HTTP status: {1} {2})",tpl,resp.status,resp.statusText);return $q.reject(resp)}handleRequestFn.totalPendingRequests++,isString(tpl)&&!isUndefined($templateCache.get(tpl))||(tpl=$sce.getTrustedResourceUrl(tpl));var transformResponse=$http.defaults&&$http.defaults.transformResponse;return isArray(transformResponse)?transformResponse=transformResponse.filter(function(transformer){return transformer!==defaultHttpResponseTransform}):transformResponse===defaultHttpResponseTransform&&(transformResponse=null),$http.get(tpl,extend({cache:$templateCache,transformResponse:transformResponse},httpOptions))["finally"](function(){handleRequestFn.totalPendingRequests--}).then(function(response){return $templateCache.put(tpl,response.data),response.data},handleError)}return handleRequestFn.totalPendingRequests=0,handleRequestFn}]}function $$TestabilityProvider(){this.$get=["$rootScope","$browser","$location",function($rootScope,$browser,$location){var testability={};return testability.findBindings=function(element,expression,opt_exactMatch){var bindings=element.getElementsByClassName("ng-binding"),matches=[];return forEach(bindings,function(binding){var dataBinding=angular.element(binding).data("$binding");dataBinding&&forEach(dataBinding,function(bindingName){if(opt_exactMatch){var matcher=new RegExp("(^|\\s)"+escapeForRegexp(expression)+"(\\s|\\||$)");matcher.test(bindingName)&&matches.push(binding)}else-1!=bindingName.indexOf(expression)&&matches.push(binding)})}),matches},testability.findModels=function(element,expression,opt_exactMatch){for(var prefixes=["ng-","data-ng-","ng\\:"],p=0;p<prefixes.length;++p){var attributeEquals=opt_exactMatch?"=":"*=",selector="["+prefixes[p]+"model"+attributeEquals+'"'+expression+'"]',elements=element.querySelectorAll(selector);if(elements.length)return elements}},testability.getLocation=function(){return $location.url()},testability.setLocation=function(url){url!==$location.url()&&($location.url(url),$rootScope.$digest())},testability.whenStable=function(callback){$browser.notifyWhenNoOutstandingRequests(callback)},testability}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function($rootScope,$browser,$q,$$q,$exceptionHandler){function timeout(fn,delay,invokeApply){isFunction(fn)||(invokeApply=delay,delay=fn,fn=noop);var timeoutId,args=sliceArgs(arguments,3),skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn.apply(null,args))}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function urlResolve(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $$CookieReader($document){function safeDecodeURIComponent(str){try{return decodeURIComponent(str)}catch(e){return str}}var rawDocument=$document[0]||{},lastCookies={},lastCookieString="";return function(){var cookieArray,cookie,i,index,name,currentCookieString=rawDocument.cookie||"";if(currentCookieString!==lastCookieString)for(lastCookieString=currentCookieString,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=safeDecodeURIComponent(cookie.substring(0,index)),isUndefined(lastCookies[name])&&(lastCookies[name]=safeDecodeURIComponent(cookie.substring(index+1))));return lastCookies}}function $$CookieReaderProvider(){this.$get=$$CookieReader}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator,anyPropertyKey){if(!isArrayLike(array)){if(null==array)return array;throw minErr("filter")("notarray","Expected array but received: {0}",array)}anyPropertyKey=anyPropertyKey||"$";var predicateFn,matchAgainstAnyProp,expressionType=getTypeForFilter(expression);switch(expressionType){case"function":predicateFn=expression;break;case"boolean":case"null":case"number":case"string":matchAgainstAnyProp=!0;case"object":predicateFn=createPredicateFn(expression,comparator,anyPropertyKey,matchAgainstAnyProp);break;default:return array}return Array.prototype.filter.call(array,predicateFn)}}function createPredicateFn(expression,comparator,anyPropertyKey,matchAgainstAnyProp){var predicateFn,shouldMatchPrimitives=isObject(expression)&&anyPropertyKey in expression;return comparator===!0?comparator=equals:isFunction(comparator)||(comparator=function(actual,expected){return isUndefined(actual)?!1:null===actual||null===expected?actual===expected:isObject(expected)||isObject(actual)&&!hasCustomToString(actual)?!1:(actual=lowercase(""+actual),expected=lowercase(""+expected),-1!==actual.indexOf(expected))}),predicateFn=function(item){return shouldMatchPrimitives&&!isObject(item)?deepCompare(item,expression[anyPropertyKey],comparator,anyPropertyKey,!1):deepCompare(item,expression,comparator,anyPropertyKey,matchAgainstAnyProp)}}function deepCompare(actual,expected,comparator,anyPropertyKey,matchAgainstAnyProp,dontMatchWholeObject){var actualType=getTypeForFilter(actual),expectedType=getTypeForFilter(expected);if("string"===expectedType&&"!"===expected.charAt(0))return!deepCompare(actual,expected.substring(1),comparator,anyPropertyKey,matchAgainstAnyProp);if(isArray(actual))return actual.some(function(item){return deepCompare(item,expected,comparator,anyPropertyKey,matchAgainstAnyProp)});switch(actualType){case"object":var key;if(matchAgainstAnyProp){for(key in actual)if("$"!==key.charAt(0)&&deepCompare(actual[key],expected,comparator,anyPropertyKey,!0))return!0;return dontMatchWholeObject?!1:deepCompare(actual,expected,comparator,anyPropertyKey,!1)}if("object"===expectedType){for(key in expected){var expectedVal=expected[key];if(!isFunction(expectedVal)&&!isUndefined(expectedVal)){var matchAnyProperty=key===anyPropertyKey,actualVal=matchAnyProperty?actual:actual[key];if(!deepCompare(actualVal,expectedVal,comparator,anyPropertyKey,matchAnyProperty,matchAnyProperty))return!1}}return!0}return comparator(actual,expected);case"function":return!1;default:return comparator(actual,expected)}}function getTypeForFilter(val){return null===val?"null":typeof val}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol,fractionSize){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),isUndefined(fractionSize)&&(fractionSize=formats.PATTERNS[1].maxFrac),null==amount?amount:formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return null==number?number:formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function parse(numStr){var digits,numberOfIntegerDigits,i,j,zeros,exponent=0;for((numberOfIntegerDigits=numStr.indexOf(DECIMAL_SEP))>-1&&(numStr=numStr.replace(DECIMAL_SEP,"")),(i=numStr.search(/e/i))>0?(0>numberOfIntegerDigits&&(numberOfIntegerDigits=i),numberOfIntegerDigits+=+numStr.slice(i+1),numStr=numStr.substring(0,i)):0>numberOfIntegerDigits&&(numberOfIntegerDigits=numStr.length),i=0;numStr.charAt(i)==ZERO_CHAR;i++);if(i==(zeros=numStr.length))digits=[0],numberOfIntegerDigits=1;else{for(zeros--;numStr.charAt(zeros)==ZERO_CHAR;)zeros--;for(numberOfIntegerDigits-=i,digits=[],j=0;zeros>=i;i++,j++)digits[j]=+numStr.charAt(i)}return numberOfIntegerDigits>MAX_DIGITS&&(digits=digits.splice(0,MAX_DIGITS-1),exponent=numberOfIntegerDigits-1,numberOfIntegerDigits=1),{d:digits,e:exponent,i:numberOfIntegerDigits}}function roundNumber(parsedNumber,fractionSize,minFrac,maxFrac){var digits=parsedNumber.d,fractionLen=digits.length-parsedNumber.i;fractionSize=isUndefined(fractionSize)?Math.min(Math.max(minFrac,fractionLen),maxFrac):+fractionSize;var roundAt=fractionSize+parsedNumber.i,digit=digits[roundAt];if(roundAt>0){digits.splice(Math.max(parsedNumber.i,roundAt));for(var j=roundAt;j<digits.length;j++)digits[j]=0}else{fractionLen=Math.max(0,fractionLen),parsedNumber.i=1,digits.length=Math.max(1,roundAt=fractionSize+1),digits[0]=0;for(var i=1;roundAt>i;i++)digits[i]=0}if(digit>=5)if(0>roundAt-1){for(var k=0;k>roundAt;k--)digits.unshift(0),parsedNumber.i++;digits.unshift(1),parsedNumber.i++}else digits[roundAt-1]++;for(;fractionLen<Math.max(0,fractionSize);fractionLen++)digits.push(0);var carry=digits.reduceRight(function(carry,d,i,digits){return d+=carry,digits[i]=d%10,Math.floor(d/10)},0);carry&&(digits.unshift(carry),parsedNumber.i++)}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(!isString(number)&&!isNumber(number)||isNaN(number))return"";var parsedNumber,isInfinity=!isFinite(number),isZero=!1,numStr=Math.abs(number)+"",formattedText="";if(isInfinity)formattedText="∞";else{parsedNumber=parse(numStr),roundNumber(parsedNumber,fractionSize,pattern.minFrac,pattern.maxFrac);var digits=parsedNumber.d,integerLen=parsedNumber.i,exponent=parsedNumber.e,decimals=[];for(isZero=digits.reduce(function(isZero,d){return isZero&&!d},!0);0>integerLen;)digits.unshift(0),integerLen++;integerLen>0?decimals=digits.splice(integerLen,digits.length):(decimals=digits,digits=[0]);var groups=[];for(digits.length>=pattern.lgSize&&groups.unshift(digits.splice(-pattern.lgSize,digits.length).join(""));digits.length>pattern.gSize;)groups.unshift(digits.splice(-pattern.gSize,digits.length).join(""));digits.length&&groups.unshift(digits.join("")),formattedText=groups.join(groupSep),decimals.length&&(formattedText+=decimalSep+decimals.join("")),exponent&&(formattedText+="e+"+exponent)}return 0>number&&!isZero?pattern.negPre+formattedText+pattern.negSuf:pattern.posPre+formattedText+pattern.posSuf}function padNumber(num,digits,trim,negWrap){var neg="";for((0>num||negWrap&&0>=num)&&(negWrap?num=-num+1:(num=-num,neg="-")),num=""+num;num.length<digits;)num=ZERO_CHAR+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim,negWrap){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim,negWrap)}}function dateStrGetter(name,shortForm,standAlone){return function(date,formats){var value=date["get"+name](),propPrefix=(standAlone?"STANDALONE":"")+(shortForm?"SHORT":""),get=uppercase(propPrefix+name);return formats[get][value]}}function timeZoneGetter(date,formats,offset){var zone=-1*offset,paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function getFirstThursdayOfYear(year){var dayOfWeekOnFirst=new Date(year,0,1).getDay();return new Date(year,0,(4>=dayOfWeekOnFirst?5:12)-dayOfWeekOnFirst)}function getThursdayThisWeek(datetime){return new Date(datetime.getFullYear(),datetime.getMonth(),datetime.getDate()+(4-datetime.getDay()))}function weekGetter(size){return function(date){var firstThurs=getFirstThursdayOfYear(date.getFullYear()),thisThurs=getThursdayThisWeek(date),diff=+thisThurs-+firstThurs,result=1+Math.round(diff/6048e5);return padNumber(result,size)}}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function eraGetter(date,formats){return date.getFullYear()<=0?formats.ERAS[0]:formats.ERAS[1]}function longEraGetter(date,formats){return date.getFullYear()<=0?formats.ERANAMES[0]:formats.ERANAMES[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=toInt(match[9]+match[10]),tzMin=toInt(match[9]+match[11])),dateSetter.call(date,toInt(match[1]),toInt(match[2])-1,toInt(match[3]));var h=toInt(match[4]||0)-tzHour,m=toInt(match[5]||0)-tzMin,s=toInt(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format,timezone){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?toInt(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date)||!isFinite(date.getTime()))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);var dateTimezoneOffset=date.getTimezoneOffset();return timezone&&(dateTimezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset),date=convertTimezoneToLocal(date,timezone,!0)),forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS,dateTimezoneOffset):"''"===value?"'":value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object,spacing){return isUndefined(spacing)&&(spacing=2),toJson(object,spacing)}}function limitToFilter(){return function(input,limit,begin){return limit=Math.abs(Number(limit))===1/0?Number(limit):toInt(limit),isNaN(limit)?input:(isNumber(input)&&(input=input.toString()),isArrayLike(input)?(begin=!begin||isNaN(begin)?0:toInt(begin),begin=0>begin?Math.max(0,input.length+begin):begin,limit>=0?sliceFn(input,begin,begin+limit):0===begin?sliceFn(input,limit,input.length):sliceFn(input,Math.max(0,begin+limit),begin)):input)}}function sliceFn(input,begin,end){return isString(input)?input.slice(begin,end):slice.call(input,begin,end)}function orderByFilter($parse){function processPredicates(sortPredicates){return sortPredicates.map(function(predicate){var descending=1,get=identity;if(isFunction(predicate))get=predicate;else if(isString(predicate)&&("+"!=predicate.charAt(0)&&"-"!=predicate.charAt(0)||(descending="-"==predicate.charAt(0)?-1:1,predicate=predicate.substring(1)),""!==predicate&&(get=$parse(predicate),get.constant))){var key=get();get=function(value){return value[key]}}return{get:get,descending:descending}})}function isPrimitive(value){switch(typeof value){case"number":case"boolean":case"string":return!0;default:return!1}}function objectValue(value){return isFunction(value.valueOf)&&(value=value.valueOf(),isPrimitive(value))?value:hasCustomToString(value)&&(value=value.toString(),isPrimitive(value))?value:value}function getPredicateValue(value,index){var type=typeof value;return null===value?(type="string",value="null"):"object"===type&&(value=objectValue(value)),{value:value,type:type,index:index}}function defaultCompare(v1,v2){var result=0,type1=v1.type,type2=v2.type;if(type1===type2){var value1=v1.value,value2=v2.value;"string"===type1?(value1=value1.toLowerCase(),value2=value2.toLowerCase()):"object"===type1&&(isObject(value1)&&(value1=v1.index),isObject(value2)&&(value2=v2.index)),value1!==value2&&(result=value2>value1?-1:1)}else result=type2>type1?-1:1;return result}return function(array,sortPredicate,reverseOrder,compareFn){function getComparisonObject(value,index){return{value:value,tieBreaker:{value:index,type:"number",index:index},predicateValues:predicates.map(function(predicate){return getPredicateValue(predicate.get(value),index)})}}function doComparison(v1,v2){for(var i=0,ii=predicates.length;ii>i;i++){var result=compare(v1.predicateValues[i],v2.predicateValues[i]);if(result)return result*predicates[i].descending*descending}return compare(v1.tieBreaker,v2.tieBreaker)*descending}if(null==array)return array;if(!isArrayLike(array))throw minErr("orderBy")("notarray","Expected array but received: {0}",array);isArray(sortPredicate)||(sortPredicate=[sortPredicate]),0===sortPredicate.length&&(sortPredicate=["+"]);var predicates=processPredicates(sortPredicate),descending=reverseOrder?-1:1,compare=isFunction(compareFn)?compareFn:defaultCompare,compareValues=Array.prototype.map.call(array,getComparisonObject);return compareValues.sort(doComparison),array=compareValues.map(function(item){return item.value})}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function nullFormRenameControl(control,name){control.$name=name}function FormController(element,attrs,$scope,$animate,$interpolate){var form=this,controls=[];form.$error={},form.$$success={},form.$pending=void 0,form.$name=$interpolate(attrs.name||attrs.ngForm||"")($scope),form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,form.$submitted=!1,form.$$parentForm=nullFormCtrl,form.$rollbackViewValue=function(){forEach(controls,function(control){control.$rollbackViewValue()})},form.$commitViewValue=function(){forEach(controls,function(control){control.$commitViewValue()})},form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control),control.$$parentForm=form},form.$$renameControl=function(control,newName){var oldName=control.$name;form[oldName]===control&&delete form[oldName],form[newName]=control,control.$name=newName},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(form.$pending,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$error,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$$success,function(value,name){form.$setValidity(name,null,control)}),arrayRemove(controls,control),control.$$parentForm=nullFormCtrl},addSetValidityMethod({ctrl:this,$element:element,set:function(object,property,controller){var list=object[property];if(list){var index=list.indexOf(controller);-1===index&&list.push(controller)}else object[property]=[controller]},unset:function(object,property,controller){var list=object[property];list&&(arrayRemove(list,controller),0===list.length&&delete object[property])},$animate:$animate}),form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,form.$$parentForm.$setDirty()},form.$setPristine=function(){$animate.setClass(element,PRISTINE_CLASS,DIRTY_CLASS+" "+SUBMITTED_CLASS),form.$dirty=!1,form.$pristine=!0,form.$submitted=!1,forEach(controls,function(control){control.$setPristine()})},form.$setUntouched=function(){forEach(controls,function(control){control.$setUntouched()})},form.$setSubmitted=function(){$animate.addClass(element,SUBMITTED_CLASS),form.$submitted=!0,form.$$parentForm.$setSubmitted()}}function stringBasedInputType(ctrl){ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?value:value.toString()})}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl)}function baseInputType(scope,element,attr,ctrl,$sniffer,$browser){var type=lowercase(element[0].type);if(!$sniffer.android){var composing=!1;element.on("compositionstart",function(){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var timeout,listener=function(ev){if(timeout&&($browser.defer.cancel(timeout),timeout=null),!composing){var value=element.val(),event=ev&&ev.type;"password"===type||attr.ngTrim&&"false"===attr.ngTrim||(value=trim(value)),(ctrl.$viewValue!==value||""===value&&ctrl.$$hasNativeValidators)&&ctrl.$setViewValue(value,event)}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var deferListener=function(ev,input,origValue){timeout||(timeout=$browser.defer(function(){timeout=null,input&&input.value===origValue||listener(ev)}))};element.on("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener(event,this,this.value)}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),PARTIAL_VALIDATION_TYPES[type]&&ctrl.$$hasNativeValidators&&type===attr.type&&element.on(PARTIAL_VALIDATION_EVENTS,function(ev){if(!timeout){var validity=this[VALIDITY_STATE_PROPERTY],origBadInput=validity.badInput,origTypeMismatch=validity.typeMismatch;timeout=$browser.defer(function(){timeout=null,validity.badInput===origBadInput&&validity.typeMismatch===origTypeMismatch||listener(ev)})}}),ctrl.$render=function(){var value=ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue;element.val()!==value&&element.val(value)}}function weekParser(isoWeek,existingDate){if(isDate(isoWeek))return isoWeek;if(isString(isoWeek)){WEEK_REGEXP.lastIndex=0;var parts=WEEK_REGEXP.exec(isoWeek);if(parts){var year=+parts[1],week=+parts[2],hours=0,minutes=0,seconds=0,milliseconds=0,firstThurs=getFirstThursdayOfYear(year),addDays=7*(week-1);return existingDate&&(hours=existingDate.getHours(),minutes=existingDate.getMinutes(),seconds=existingDate.getSeconds(),milliseconds=existingDate.getMilliseconds()),new Date(year,0,firstThurs.getDate()+addDays,hours,minutes,seconds,milliseconds)}}return NaN}function createDateParser(regexp,mapping){return function(iso,date){var parts,map;if(isDate(iso))return iso;if(isString(iso)){if('"'==iso.charAt(0)&&'"'==iso.charAt(iso.length-1)&&(iso=iso.substring(1,iso.length-1)),ISO_DATE_REGEXP.test(iso))return new Date(iso);if(regexp.lastIndex=0,parts=regexp.exec(iso))return parts.shift(),map=date?{yyyy:date.getFullYear(),MM:date.getMonth()+1,dd:date.getDate(),HH:date.getHours(),mm:date.getMinutes(),ss:date.getSeconds(),sss:date.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},forEach(parts,function(part,index){index<mapping.length&&(map[mapping[index]]=+part)}),new Date(map.yyyy,map.MM-1,map.dd,map.HH,map.mm,map.ss||0,1e3*map.sss||0)}return NaN}}function createDateInputType(type,regexp,parseDate,format){return function(scope,element,attr,ctrl,$sniffer,$browser,$filter){function isValidDate(value){return value&&!(value.getTime&&value.getTime()!==value.getTime())}function parseObservedDateValue(val){return isDefined(val)&&!isDate(val)?parseDate(val)||void 0:val}badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser);var previousDate,timezone=ctrl&&ctrl.$options&&ctrl.$options.timezone;if(ctrl.$$parserName=type,ctrl.$parsers.push(function(value){if(ctrl.$isEmpty(value))return null;if(regexp.test(value)){var parsedDate=parseDate(value,previousDate);return timezone&&(parsedDate=convertTimezoneToLocal(parsedDate,timezone)),parsedDate}}),ctrl.$formatters.push(function(value){if(value&&!isDate(value))throw ngModelMinErr("datefmt","Expected `{0}` to be a date",value);return isValidDate(value)?(previousDate=value,previousDate&&timezone&&(previousDate=convertTimezoneToLocal(previousDate,timezone,!0)),$filter("date")(value,format,timezone)):(previousDate=null,"")}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return!isValidDate(value)||isUndefined(minVal)||parseDate(value)>=minVal},attr.$observe("min",function(val){minVal=parseObservedDateValue(val),ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return!isValidDate(value)||isUndefined(maxVal)||parseDate(value)<=maxVal},attr.$observe("max",function(val){maxVal=parseObservedDateValue(val),ctrl.$validate()})}}}function badInputChecker(scope,element,attr,ctrl){var node=element[0],nativeValidation=ctrl.$$hasNativeValidators=isObject(node.validity);nativeValidation&&ctrl.$parsers.push(function(value){var validity=element.prop(VALIDITY_STATE_PROPERTY)||{};return validity.badInput||validity.typeMismatch?void 0:value})}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$$parserName="number",ctrl.$parsers.push(function(value){return ctrl.$isEmpty(value)?null:NUMBER_REGEXP.test(value)?parseFloat(value):void 0}),ctrl.$formatters.push(function(value){if(!ctrl.$isEmpty(value)){if(!isNumber(value))throw ngModelMinErr("numfmt","Expected `{0}` to be a number",value);value=value.toString()}return value}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return ctrl.$isEmpty(value)||isUndefined(minVal)||value>=minVal},attr.$observe("min",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val)),minVal=isNumber(val)&&!isNaN(val)?val:void 0,ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return ctrl.$isEmpty(value)||isUndefined(maxVal)||maxVal>=value},attr.$observe("max",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val)),maxVal=isNumber(val)&&!isNaN(val)?val:void 0,ctrl.$validate()})}}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="url",ctrl.$validators.url=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||URL_REGEXP.test(value)}}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="email",ctrl.$validators.email=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value)}}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid());var listener=function(ev){element[0].checked&&ctrl.$setViewValue(attr.value,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function parseConstantExpr($parse,context,name,expression,fallback){var parseFn;if(isDefined(expression)){if(parseFn=$parse(expression),!parseFn.constant)throw ngModelMinErr("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",name,expression);return parseFn(context)}return fallback}function checkboxInputType(scope,element,attr,ctrl,$sniffer,$browser,$filter,$parse){var trueValue=parseConstantExpr($parse,scope,"ngTrueValue",attr.ngTrueValue,!0),falseValue=parseConstantExpr($parse,scope,"ngFalseValue",attr.ngFalseValue,!1),listener=function(ev){ctrl.$setViewValue(element[0].checked,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value===!1},ctrl.$formatters.push(function(value){return equals(value,trueValue)}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){var classes=[];return isArray(classVal)?(forEach(classVal,function(v){classes=classes.concat(arrayClasses(v))}),classes):isString(classVal)?classVal.split(" "):isObject(classVal)?(forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes):classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||createMap(),classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toAdd=digestClassCounts(toAdd,1),toRemove=digestClassCounts(toRemove,-1),toAdd&&toAdd.length&&$animate.addClass(element,toAdd),toRemove&&toRemove.length&&$animate.removeClass(element,toRemove)}function ngClassWatchAction(newVal){if(selector===!0||(1&scope.$index)===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=isArray(newVal)?newVal.map(function(v){return shallowCopy(v)}):shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(value){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}function addSetValidityMethod(context){function setValidity(validationErrorKey,state,controller){isUndefined(state)?createAndSet("$pending",validationErrorKey,controller):unsetAndCleanup("$pending",validationErrorKey,controller),isBoolean(state)?state?(unset(ctrl.$error,validationErrorKey,controller),set(ctrl.$$success,validationErrorKey,controller)):(set(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)):(unset(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)),ctrl.$pending?(cachedToggleClass(PENDING_CLASS,!0),ctrl.$valid=ctrl.$invalid=void 0,toggleValidationCss("",null)):(cachedToggleClass(PENDING_CLASS,!1),ctrl.$valid=isObjectEmpty(ctrl.$error),ctrl.$invalid=!ctrl.$valid,toggleValidationCss("",ctrl.$valid));var combinedState;combinedState=ctrl.$pending&&ctrl.$pending[validationErrorKey]?void 0:ctrl.$error[validationErrorKey]?!1:ctrl.$$success[validationErrorKey]?!0:null,toggleValidationCss(validationErrorKey,combinedState),ctrl.$$parentForm.$setValidity(validationErrorKey,combinedState,ctrl)}function createAndSet(name,value,controller){ctrl[name]||(ctrl[name]={}),set(ctrl[name],value,controller);
}function unsetAndCleanup(name,value,controller){ctrl[name]&&unset(ctrl[name],value,controller),isObjectEmpty(ctrl[name])&&(ctrl[name]=void 0)}function cachedToggleClass(className,switchValue){switchValue&&!classCache[className]?($animate.addClass($element,className),classCache[className]=!0):!switchValue&&classCache[className]&&($animate.removeClass($element,className),classCache[className]=!1)}function toggleValidationCss(validationErrorKey,isValid){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",cachedToggleClass(VALID_CLASS+validationErrorKey,isValid===!0),cachedToggleClass(INVALID_CLASS+validationErrorKey,isValid===!1)}var ctrl=context.ctrl,$element=context.$element,classCache={},set=context.set,unset=context.unset,$animate=context.$animate;classCache[INVALID_CLASS]=!(classCache[VALID_CLASS]=$element.hasClass(VALID_CLASS)),ctrl.$setValidity=setValidity}function isObjectEmpty(obj){if(obj)for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return!0}function chromeHack(optionElement){optionElement[0].hasAttribute("selected")&&(optionElement[0].selected=!0)}var REGEX_STRING_REGEXP=/^\/(.+)\/([a-z]*)$/,VALIDITY_STATE_PROPERTY="validity",hasOwnProperty=Object.prototype.hasOwnProperty,lowercase=function(string){return isString(string)?string.toLowerCase():string},uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,slice=[].slice,splice=[].splice,push=[].push,toString=Object.prototype.toString,getPrototypeOf=Object.getPrototypeOf,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=0;msie=window.document.documentMode,noop.$inject=[],identity.$inject=[];var isArray=Array.isArray,TYPED_ARRAY_REGEXP=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/,trim=function(value){return isString(value)?value.trim():value},escapeForRegexp=function(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},csp=function(){function noUnsafeEval(){try{return new Function(""),!1}catch(e){return!0}}if(!isDefined(csp.rules)){var ngCspElement=window.document.querySelector("[ng-csp]")||window.document.querySelector("[data-ng-csp]");if(ngCspElement){var ngCspAttribute=ngCspElement.getAttribute("ng-csp")||ngCspElement.getAttribute("data-ng-csp");csp.rules={noUnsafeEval:!ngCspAttribute||-1!==ngCspAttribute.indexOf("no-unsafe-eval"),noInlineStyle:!ngCspAttribute||-1!==ngCspAttribute.indexOf("no-inline-style")}}else csp.rules={noUnsafeEval:noUnsafeEval(),noInlineStyle:!1}}return csp.rules},jq=function(){if(isDefined(jq.name_))return jq.name_;var el,i,prefix,name,ii=ngAttrPrefixes.length;for(i=0;ii>i;++i)if(prefix=ngAttrPrefixes[i],el=window.document.querySelector("["+prefix.replace(":","\\:")+"jq]")){name=el.getAttribute(prefix+"jq");break}return jq.name_=name},ALL_COLONS=/:/g,ngAttrPrefixes=["ng-","data-ng-","ng:","x-ng-"],SNAKE_CASE_REGEXP=/[A-Z]/g,bindJQueryFired=!1,NODE_TYPE_ELEMENT=1,NODE_TYPE_ATTRIBUTE=2,NODE_TYPE_TEXT=3,NODE_TYPE_COMMENT=8,NODE_TYPE_DOCUMENT=9,NODE_TYPE_DOCUMENT_FRAGMENT=11,version={full:"1.5.8",major:1,minor:5,dot:8,codeName:"arbitrary-fallbacks"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1,addEventListenerFn=function(element,type,fn){element.addEventListener(type,fn,!1)},removeEventListenerFn=function(element,type,fn){element.removeEventListener(type,fn,!1)};JQLite._data=function(node){return this.cache[node[this.expando]]||{}};var SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,MOUSE_EVENT_MAP={mouseleave:"mouseout",mouseenter:"mouseover"},jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:-]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var jqLiteContains=window.Node.prototype.contains||function(arg){return!!(16&this.compareDocumentPosition(arg))},JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===window.document.readyState?window.setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[value]=!0});var ALIASED_ATTR={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};forEach({data:jqLiteData,removeData:jqLiteRemoveData,hasData:jqLiteHasData,cleanData:jqLiteCleanData},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){return name=camelCase(name),isDefined(value)?void(element.style[name]=value):element.style[name]},attr:function(element,name,value){var nodeType=element.nodeType;if(nodeType!==NODE_TYPE_TEXT&&nodeType!==NODE_TYPE_ATTRIBUTE&&nodeType!==NODE_TYPE_COMMENT){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:void 0;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?void 0:ret}}},prop:function(element,name,value){return isDefined(value)?void(element[name]=value):element[name]},text:function(){function getText(element,value){if(isUndefined(value)){var nodeType=element.nodeType;return nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_TEXT?element.textContent:""}element.textContent=value}return getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if(element.multiple&&"select"===nodeName_(element)){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){return isUndefined(value)?element.innerHTML:(jqLiteDealoc(element,!0),void(element.innerHTML=value))},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&isUndefined(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)){if(isObject(arg1)){for(i=0;nodeCount>i;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=isUndefined(value)?Math.min(nodeCount,1):nodeCount,j=0;jj>j;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;nodeCount>i;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,on:function(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(jqLiteAcceptsData(element)){var expandoStore=jqLiteExpandoStore(element,!0),events=expandoStore.events,handle=expandoStore.handle;handle||(handle=expandoStore.handle=createEventHandler(element,events));for(var types=type.indexOf(" ")>=0?type.split(" "):[type],i=types.length,addHandler=function(type,specialHandlerWrapper,noEventListener){var eventFns=events[type];eventFns||(eventFns=events[type]=[],eventFns.specialHandlerWrapper=specialHandlerWrapper,"$destroy"===type||noEventListener||addEventListenerFn(element,type,handle)),eventFns.push(fn)};i--;)type=types[i],MOUSE_EVENT_MAP[type]?(addHandler(MOUSE_EVENT_MAP[type],specialMouseHandlerWrapper),addHandler(type,void 0,!0)):addHandler(type)}},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){element.nodeType===NODE_TYPE_ELEMENT&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){var nodeType=element.nodeType;if(nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_DOCUMENT_FRAGMENT){node=new JQLite(node);for(var i=0,ii=node.length;ii>i;i++){var child=node[i];element.appendChild(child)}}},prepend:function(element,node){if(element.nodeType===NODE_TYPE_ELEMENT){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){jqLiteWrapNode(element,jqLite(wrapNode).eq(0).clone()[0])},remove:jqLiteRemove,detach:function(element){jqLiteRemove(element,!0)},after:function(element,newElement){var index=element,parent=element.parentNode;newElement=new JQLite(newElement);for(var i=0,ii=newElement.length;ii>i;i++){var node=newElement[i];parent.insertBefore(node,index.nextSibling),index=node}},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&parent.nodeType!==NODE_TYPE_DOCUMENT_FRAGMENT?parent:null},next:function(element){return element.nextElementSibling},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,eventFns=events&&events[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return this.immediatePropagationStopped===!0},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){dummyEvent.isImmediatePropagationStopped()||fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0,ii=this.length;ii>i;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key,this.nextUid)]=value},get:function(key){return this[hashKey(key,this.nextUid)]},remove:function(key){var value=this[key=hashKey(key,this.nextUid)];return delete this[key],value}};var $$HashMapProvider=[function(){this.$get=[function(){return HashMap}]}],ARROW_ARG=/^([^\(]+?)=>/,FN_ARGS=/^[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector");createInjector.$$annotate=annotate;var $animateMinErr=minErr("$animate"),ELEMENT_NODE=1,NG_ANIMATE_CLASSNAME="ng-animate",$$CoreAnimateJsProvider=function(){this.$get=noop},$$CoreAnimateQueueProvider=function(){var postDigestQueue=new HashMap,postDigestElements=[];this.$get=["$$AnimateRunner","$rootScope",function($$AnimateRunner,$rootScope){function updateData(data,classes,value){var changed=!1;return classes&&(classes=isString(classes)?classes.split(" "):isArray(classes)?classes:[],forEach(classes,function(className){className&&(changed=!0,data[className]=value)})),changed}function handleCSSClassChanges(){forEach(postDigestElements,function(element){var data=postDigestQueue.get(element);if(data){var existing=splitClasses(element.attr("class")),toAdd="",toRemove="";forEach(data,function(status,className){var hasClass=!!existing[className];status!==hasClass&&(status?toAdd+=(toAdd.length?" ":"")+className:toRemove+=(toRemove.length?" ":"")+className)}),forEach(element,function(elm){toAdd&&jqLiteAddClass(elm,toAdd),toRemove&&jqLiteRemoveClass(elm,toRemove)}),postDigestQueue.remove(element)}}),postDigestElements.length=0}function addRemoveClassesPostDigest(element,add,remove){var data=postDigestQueue.get(element)||{},classesAdded=updateData(data,add,!0),classesRemoved=updateData(data,remove,!1);(classesAdded||classesRemoved)&&(postDigestQueue.put(element,data),postDigestElements.push(element),1===postDigestElements.length&&$rootScope.$$postDigest(handleCSSClassChanges))}return{enabled:noop,on:noop,off:noop,pin:noop,push:function(element,event,options,domOperation){domOperation&&domOperation(),options=options||{},options.from&&element.css(options.from),options.to&&element.css(options.to),(options.addClass||options.removeClass)&&addRemoveClassesPostDigest(element,options.addClass,options.removeClass);var runner=new $$AnimateRunner;return runner.complete(),runner}}}]},$AnimateProvider=["$provide",function($provide){var provider=this;this.$$registeredAnimations=Object.create(null),this.register=function(name,factory){if(name&&"."!==name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);var key=name+"-animation";provider.$$registeredAnimations[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){if(1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null,this.$$classNameFilter)){var reservedRegex=new RegExp("(\\s+|\\/)"+NG_ANIMATE_CLASSNAME+"(\\s+|\\/)");if(reservedRegex.test(this.$$classNameFilter.toString()))throw $animateMinErr("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',NG_ANIMATE_CLASSNAME)}return this.$$classNameFilter},this.$get=["$$animateQueue",function($$animateQueue){function domInsert(element,parentElement,afterElement){if(afterElement){var afterNode=extractElementNode(afterElement);!afterNode||afterNode.parentNode||afterNode.previousElementSibling||(afterElement=null)}afterElement?afterElement.after(element):parentElement.prepend(element)}return{on:$$animateQueue.on,off:$$animateQueue.off,pin:$$animateQueue.pin,enabled:$$animateQueue.enabled,cancel:function(runner){runner.end&&runner.end()},enter:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"enter",prepareAnimateOptions(options))},move:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"move",prepareAnimateOptions(options))},leave:function(element,options){return $$animateQueue.push(element,"leave",prepareAnimateOptions(options),function(){element.remove()})},addClass:function(element,className,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addclass,className),$$animateQueue.push(element,"addClass",options)},removeClass:function(element,className,options){return options=prepareAnimateOptions(options),options.removeClass=mergeClasses(options.removeClass,className),$$animateQueue.push(element,"removeClass",options)},setClass:function(element,add,remove,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addClass,add),options.removeClass=mergeClasses(options.removeClass,remove),$$animateQueue.push(element,"setClass",options)},animate:function(element,from,to,className,options){return options=prepareAnimateOptions(options),options.from=options.from?extend(options.from,from):from,options.to=options.to?extend(options.to,to):to,className=className||"ng-inline-animate",options.tempClasses=mergeClasses(options.tempClasses,className),$$animateQueue.push(element,"animate",options)}}}]}],$$AnimateAsyncRunFactoryProvider=function(){this.$get=["$$rAF",function($$rAF){function waitForTick(fn){waitQueue.push(fn),waitQueue.length>1||$$rAF(function(){for(var i=0;i<waitQueue.length;i++)waitQueue[i]();waitQueue=[]})}var waitQueue=[];return function(){var passed=!1;return waitForTick(function(){passed=!0}),function(callback){passed?callback():waitForTick(callback)}}}]},$$AnimateRunnerFactoryProvider=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$document","$timeout",function($q,$sniffer,$$animateAsyncRun,$document,$timeout){function AnimateRunner(host){this.setHost(host);var rafTick=$$animateAsyncRun(),timeoutTick=function(fn){$timeout(fn,0,!1)};this._doneCallbacks=[],this._tick=function(fn){var doc=$document[0];doc&&doc.hidden?timeoutTick(fn):rafTick(fn)},this._state=0}var INITIAL_STATE=0,DONE_PENDING_STATE=1,DONE_COMPLETE_STATE=2;return AnimateRunner.chain=function(chain,callback){function next(){return index===chain.length?void callback(!0):void chain[index](function(response){return response===!1?void callback(!1):(index++,void next())})}var index=0;next()},AnimateRunner.all=function(runners,callback){function onProgress(response){status=status&&response,++count===runners.length&&callback(status)}var count=0,status=!0;forEach(runners,function(runner){runner.done(onProgress)})},AnimateRunner.prototype={setHost:function(host){this.host=host||{}},done:function(fn){this._state===DONE_COMPLETE_STATE?fn():this._doneCallbacks.push(fn)},progress:noop,getPromise:function(){if(!this.promise){var self=this;this.promise=$q(function(resolve,reject){self.done(function(status){status===!1?reject():resolve()})})}return this.promise},then:function(resolveHandler,rejectHandler){return this.getPromise().then(resolveHandler,rejectHandler)},"catch":function(handler){return this.getPromise()["catch"](handler)},"finally":function(handler){return this.getPromise()["finally"](handler)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(response){var self=this;self._state===INITIAL_STATE&&(self._state=DONE_PENDING_STATE,self._tick(function(){self._resolve(response)}))},_resolve:function(response){this._state!==DONE_COMPLETE_STATE&&(forEach(this._doneCallbacks,function(fn){fn(response)}),this._doneCallbacks.length=0,this._state=DONE_COMPLETE_STATE)}},AnimateRunner}]},$CoreAnimateCssProvider=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function($$rAF,$q,$$AnimateRunner){return function(element,initialOptions){function run(){return $$rAF(function(){applyAnimationContents(),closed||runner.complete(),closed=!0}),runner}function applyAnimationContents(){options.addClass&&(element.addClass(options.addClass),options.addClass=null),options.removeClass&&(element.removeClass(options.removeClass),options.removeClass=null),options.to&&(element.css(options.to),options.to=null)}var options=initialOptions||{};options.$$prepared||(options=copy(options)),options.cleanupStyles&&(options.from=options.to=null),options.from&&(element.css(options.from),options.from=null);var closed,runner=new $$AnimateRunner;return{start:run,end:run}}}]},$compileMinErr=minErr("$compile"),_UNINITIALIZED_VALUE=new UNINITIALIZED_VALUE;$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"],SimpleChange.prototype.isFirstChange=function(){return this.previousValue===_UNINITIALIZED_VALUE};var PREFIX_REGEXP=/^((?:x|data)[\:\-_])/i,$controllerMinErr=minErr("$controller"),CNTRL_REG=/^(\S+)(\s+as\s+([\w$]+))?$/,$$ForceReflowProvider=function(){this.$get=["$document",function($document){return function(domNode){return domNode?!domNode.nodeType&&domNode instanceof jqLite&&(domNode=domNode[0]):domNode=$document[0].body,domNode.offsetWidth+1}}]},APPLICATION_JSON="application/json",CONTENT_TYPE_APPLICATION_JSON={"Content-Type":APPLICATION_JSON+";charset=utf-8"},JSON_START=/^\[|^\{(?!\{)/,JSON_ENDS={"[":/]$/,"{":/}$/},JSON_PROTECTION_PREFIX=/^\)\]\}',?\n/,$httpMinErr=minErr("$http"),$httpMinErrLegacyFn=function(method){return function(){throw $httpMinErr("legacy","The method `{0}` on the promise returned from `$http` has been disabled.",method)}},$interpolateMinErr=angular.$interpolateMinErr=minErr("$interpolate");$interpolateMinErr.throwNoconcat=function(text){throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text)},$interpolateMinErr.interr=function(text,err){return $interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString())};var $jsonpCallbacksProvider=function(){this.$get=["$window",function($window){function createCallback(callbackId){var callback=function(data){callback.data=data,callback.called=!0};return callback.id=callbackId,callback}var callbacks=$window.angular.callbacks,callbackMap={};return{createCallback:function(url){var callbackId="_"+(callbacks.$$counter++).toString(36),callbackPath="angular.callbacks."+callbackId,callback=createCallback(callbackId);return callbackMap[callbackPath]=callbacks[callbackId]=callback,callbackPath},wasCalled:function(callbackPath){return callbackMap[callbackPath].called},getResponse:function(callbackPath){return callbackMap[callbackPath].data},removeCallback:function(callbackPath){var callback=callbackMap[callbackPath];delete callbacks[callback.id],delete callbackMap[callbackPath]}}}]},PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location"),locationPrototype={$$absUrl:"",$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return(match[1]||""===url)&&this.path(decodeURIComponent(match[1])),(match[2]||match[1]||""===url)&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return path=null!==path?path.toString():"","/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");search=copy(search,{}),forEach(search,function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};forEach([LocationHashbangInHtml5Url,LocationHashbangUrl,LocationHtml5Url],function(Location){Location.prototype=Object.create(locationPrototype),Location.prototype.state=function(state){if(!arguments.length)return this.$$state;if(Location!==LocationHtml5Url||!this.$$html5)throw $locationMinErr("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=isUndefined(state)?null:state,this}});var $parseMinErr=minErr("$parse"),CALL=Function.prototype.call,APPLY=Function.prototype.apply,BIND=Function.prototype.bind,OPERATORS=createMap();forEach("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(operator){OPERATORS[operator]=!0});var ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"\x0B","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.tokens=[];this.index<this.text.length;){var ch=this.text.charAt(this.index);if('"'===ch||"'"===ch)this.readString(ch);else if(this.isNumber(ch)||"."===ch&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(ch,"(){}[].,;:?"))this.tokens.push({index:this.index,text:ch}),this.index++;else if(this.isWhitespace(ch))this.index++;else{var ch2=ch+this.peek(),ch3=ch2+this.peek(2),op1=OPERATORS[ch],op2=OPERATORS[ch2],op3=OPERATORS[ch3];if(op1||op2||op3){var token=op3?ch3:op2?ch2:ch;this.tokens.push({index:this.index,text:token,operator:!0}),this.index+=token.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(ch,chars){return-1!==chars.indexOf(ch)},peek:function(i){var num=i||1;return this.index+num<this.text.length?this.text.charAt(this.index+num):!1},isNumber:function(ch){return ch>="0"&&"9">=ch&&"string"==typeof ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"	"===ch||"\n"===ch||"\x0B"===ch||" "===ch},isIdentifierStart:function(ch){return this.options.isIdentifierStart?this.options.isIdentifierStart(ch,this.codePointAt(ch)):this.isValidIdentifierStart(ch)},isValidIdentifierStart:function(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"===ch||"$"===ch},isIdentifierContinue:function(ch){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(ch,this.codePointAt(ch)):this.isValidIdentifierContinue(ch)},isValidIdentifierContinue:function(ch,cp){return this.isValidIdentifierStart(ch,cp)||this.isNumber(ch)},codePointAt:function(ch){return 1===ch.length?ch.charCodeAt(0):(ch.charCodeAt(0)<<10)+ch.charCodeAt(1)-56613888},peekMultichar:function(){var ch=this.text.charAt(this.index),peek=this.peek();if(!peek)return ch;var cp1=ch.charCodeAt(0),cp2=peek.charCodeAt(0);return cp1>=55296&&56319>=cp1&&cp2>=56320&&57343>=cp2?ch+peek:ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:start,text:number,constant:!0,value:Number(number)})},readIdent:function(){var start=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var ch=this.peekMultichar();if(!this.isIdentifierContinue(ch))break;this.index+=ch.length}this.tokens.push({index:start,text:this.text.slice(start,this.index),identifier:!0})},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,constant:!0,value:string});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var AST=function(lexer,options){this.lexer=lexer,this.options=options};AST.Program="Program",AST.ExpressionStatement="ExpressionStatement",AST.AssignmentExpression="AssignmentExpression",AST.ConditionalExpression="ConditionalExpression",AST.LogicalExpression="LogicalExpression",AST.BinaryExpression="BinaryExpression",AST.UnaryExpression="UnaryExpression",AST.CallExpression="CallExpression",AST.MemberExpression="MemberExpression",AST.Identifier="Identifier",AST.Literal="Literal",AST.ArrayExpression="ArrayExpression",AST.Property="Property",AST.ObjectExpression="ObjectExpression",AST.ThisExpression="ThisExpression",AST.LocalsExpression="LocalsExpression",AST.NGValueParameter="NGValueParameter",AST.prototype={ast:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value},program:function(){for(var body=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&body.push(this.expressionStatement()),!this.expect(";"))return{type:AST.Program,body:body}},expressionStatement:function(){return{type:AST.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var token,left=this.expression();token=this.expect("|");)left=this.filter(left);return left},expression:function(){return this.assignment()},assignment:function(){var result=this.ternary();return this.expect("=")&&(result={type:AST.AssignmentExpression,left:result,right:this.assignment(),operator:"="}),result},ternary:function(){var alternate,consequent,test=this.logicalOR();return this.expect("?")&&(alternate=this.expression(),this.consume(":"))?(consequent=this.expression(),{type:AST.ConditionalExpression,test:test,alternate:alternate,consequent:consequent}):test},logicalOR:function(){for(var left=this.logicalAND();this.expect("||");)left={type:AST.LogicalExpression,operator:"||",left:left,right:this.logicalAND()};return left},logicalAND:function(){for(var left=this.equality();this.expect("&&");)left={type:AST.LogicalExpression,operator:"&&",left:left,right:this.equality()};return left},equality:function(){for(var token,left=this.relational();token=this.expect("==","!=","===","!==");)left={
type:AST.BinaryExpression,operator:token.text,left:left,right:this.relational()};return left},relational:function(){for(var token,left=this.additive();token=this.expect("<",">","<=",">=");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.additive()};return left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.multiplicative()};return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.unary()};return left},unary:function(){var token;return(token=this.expect("+","-","!"))?{type:AST.UnaryExpression,operator:token.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var primary;this.expect("(")?(primary=this.filterChain(),this.consume(")")):this.expect("[")?primary=this.arrayDeclaration():this.expect("{")?primary=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?primary=copy(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?primary={type:AST.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?primary=this.identifier():this.peek().constant?primary=this.constant():this.throwError("not a primary expression",this.peek());for(var next;next=this.expect("(","[",".");)"("===next.text?(primary={type:AST.CallExpression,callee:primary,arguments:this.parseArguments()},this.consume(")")):"["===next.text?(primary={type:AST.MemberExpression,object:primary,property:this.expression(),computed:!0},this.consume("]")):"."===next.text?primary={type:AST.MemberExpression,object:primary,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return primary},filter:function(baseExpression){for(var args=[baseExpression],result={type:AST.CallExpression,callee:this.identifier(),arguments:args,filter:!0};this.expect(":");)args.push(this.expression());return result},parseArguments:function(){var args=[];if(")"!==this.peekToken().text)do args.push(this.filterChain());while(this.expect(","));return args},identifier:function(){var token=this.consume();return token.identifier||this.throwError("is not a valid identifier",token),{type:AST.Identifier,name:token.text}},constant:function(){return{type:AST.Literal,value:this.consume().value}},arrayDeclaration:function(){var elements=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;elements.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:AST.ArrayExpression,elements:elements}},object:function(){var property,properties=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;property={type:AST.Property,kind:"init"},this.peek().constant?(property.key=this.constant(),property.computed=!1,this.consume(":"),property.value=this.expression()):this.peek().identifier?(property.key=this.identifier(),property.computed=!1,this.peek(":")?(this.consume(":"),property.value=this.expression()):property.value=property.key):this.peek("[")?(this.consume("["),property.key=this.expression(),this.consume("]"),property.computed=!0,this.consume(":"),property.value=this.expression()):this.throwError("invalid key",this.peek()),properties.push(property)}while(this.expect(","));return this.consume("}"),{type:AST.ObjectExpression,properties:properties}},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},consume:function(e1){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);var token=this.expect(e1);return token||this.throwError("is unexpected, expecting ["+e1+"]",this.peek()),token},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){return this.peekAhead(0,e1,e2,e3,e4)},peekAhead:function(i,e1,e2,e3,e4){if(this.tokens.length>i){var token=this.tokens[i],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return token?(this.tokens.shift(),token):!1},selfReferential:{"this":{type:AST.ThisExpression},$locals:{type:AST.LocalsExpression}}},ASTCompiler.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.state={nextId:0,filters:{},expensiveChecks:expensiveChecks,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},findConstantAndWatchExpressions(ast,self.$filter);var assignable,extra="";if(this.stage="assign",assignable=assignableAST(ast)){this.state.computing="assign";var result=this.nextId();this.recurse(assignable,result),this.return_(result),extra="fn.assign="+this.generateFunction("assign","s,v,l")}var toWatch=getInputs(ast.body);self.stage="inputs",forEach(toWatch,function(watch,key){var fnKey="fn"+key;self.state[fnKey]={vars:[],body:[],own:{}},self.state.computing=fnKey;var intoId=self.nextId();self.recurse(watch,intoId),self.return_(intoId),self.state.inputs.push(fnKey),watch.watchId=key}),this.state.computing="fn",this.stage="main",this.recurse(ast);var fnString='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+extra+this.watchFns()+"return fn;",fn=new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext","ifDefined","plus","text",fnString)(this.$filter,ensureSafeMemberName,ensureSafeObject,ensureSafeFunction,getStringValue,ensureSafeAssignContext,ifDefined,plusFn,expression);return this.state=this.stage=void 0,fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},USE:"use",STRICT:"strict",watchFns:function(){var result=[],fns=this.state.inputs,self=this;return forEach(fns,function(name){result.push("var "+name+"="+self.generateFunction(name,"s"))}),fns.length&&result.push("fn.inputs=["+fns.join(",")+"];"),result.join("")},generateFunction:function(name,params){return"function("+params+"){"+this.varsPrefix(name)+this.body(name)+"};"},filterPrefix:function(){var parts=[],self=this;return forEach(this.state.filters,function(id,filter){parts.push(id+"=$filter("+self.escape(filter)+")")}),parts.length?"var "+parts.join(",")+";":""},varsPrefix:function(section){return this.state[section].vars.length?"var "+this.state[section].vars.join(",")+";":""},body:function(section){return this.state[section].body.join("")},recurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var left,right,args,expression,computed,self=this;if(recursionFn=recursionFn||noop,!skipWatchIdCheck&&isDefined(ast.watchId))return intoId=intoId||this.nextId(),void this.if_("i",this.lazyAssign(intoId,this.computedMember("i",ast.watchId)),this.lazyRecurse(ast,intoId,nameId,recursionFn,create,!0));switch(ast.type){case AST.Program:forEach(ast.body,function(expression,pos){self.recurse(expression.expression,void 0,void 0,function(expr){right=expr}),pos!==ast.body.length-1?self.current().body.push(right,";"):self.return_(right)});break;case AST.Literal:expression=this.escape(ast.value),this.assign(intoId,expression),recursionFn(expression);break;case AST.UnaryExpression:this.recurse(ast.argument,void 0,void 0,function(expr){right=expr}),expression=ast.operator+"("+this.ifDefined(right,0)+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.BinaryExpression:this.recurse(ast.left,void 0,void 0,function(expr){left=expr}),this.recurse(ast.right,void 0,void 0,function(expr){right=expr}),expression="+"===ast.operator?this.plus(left,right):"-"===ast.operator?this.ifDefined(left,0)+ast.operator+this.ifDefined(right,0):"("+left+")"+ast.operator+"("+right+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.LogicalExpression:intoId=intoId||this.nextId(),self.recurse(ast.left,intoId),self.if_("&&"===ast.operator?intoId:self.not(intoId),self.lazyRecurse(ast.right,intoId)),recursionFn(intoId);break;case AST.ConditionalExpression:intoId=intoId||this.nextId(),self.recurse(ast.test,intoId),self.if_(intoId,self.lazyRecurse(ast.alternate,intoId),self.lazyRecurse(ast.consequent,intoId)),recursionFn(intoId);break;case AST.Identifier:intoId=intoId||this.nextId(),nameId&&(nameId.context="inputs"===self.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",ast.name)+"?l:s"),nameId.computed=!1,nameId.name=ast.name),ensureSafeMemberName(ast.name),self.if_("inputs"===self.stage||self.not(self.getHasOwnProperty("l",ast.name)),function(){self.if_("inputs"===self.stage||"s",function(){create&&1!==create&&self.if_(self.not(self.nonComputedMember("s",ast.name)),self.lazyAssign(self.nonComputedMember("s",ast.name),"{}")),self.assign(intoId,self.nonComputedMember("s",ast.name))})},intoId&&self.lazyAssign(intoId,self.nonComputedMember("l",ast.name))),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.name))&&self.addEnsureSafeObject(intoId),recursionFn(intoId);break;case AST.MemberExpression:left=nameId&&(nameId.context=this.nextId())||this.nextId(),intoId=intoId||this.nextId(),self.recurse(ast.object,left,void 0,function(){self.if_(self.notNull(left),function(){create&&1!==create&&self.addEnsureSafeAssignContext(left),ast.computed?(right=self.nextId(),self.recurse(ast.property,right),self.getStringValue(right),self.addEnsureSafeMemberName(right),create&&1!==create&&self.if_(self.not(self.computedMember(left,right)),self.lazyAssign(self.computedMember(left,right),"{}")),expression=self.ensureSafeObject(self.computedMember(left,right)),self.assign(intoId,expression),nameId&&(nameId.computed=!0,nameId.name=right)):(ensureSafeMemberName(ast.property.name),create&&1!==create&&self.if_(self.not(self.nonComputedMember(left,ast.property.name)),self.lazyAssign(self.nonComputedMember(left,ast.property.name),"{}")),expression=self.nonComputedMember(left,ast.property.name),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.property.name))&&(expression=self.ensureSafeObject(expression)),self.assign(intoId,expression),nameId&&(nameId.computed=!1,nameId.name=ast.property.name))},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)},!!create);break;case AST.CallExpression:intoId=intoId||this.nextId(),ast.filter?(right=self.filter(ast.callee.name),args=[],forEach(ast.arguments,function(expr){var argument=self.nextId();self.recurse(expr,argument),args.push(argument)}),expression=right+"("+args.join(",")+")",self.assign(intoId,expression),recursionFn(intoId)):(right=self.nextId(),left={},args=[],self.recurse(ast.callee,right,left,function(){self.if_(self.notNull(right),function(){self.addEnsureSafeFunction(right),forEach(ast.arguments,function(expr){self.recurse(expr,self.nextId(),void 0,function(argument){args.push(self.ensureSafeObject(argument))})}),left.name?(self.state.expensiveChecks||self.addEnsureSafeObject(left.context),expression=self.member(left.context,left.name,left.computed)+"("+args.join(",")+")"):expression=right+"("+args.join(",")+")",expression=self.ensureSafeObject(expression),self.assign(intoId,expression)},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)}));break;case AST.AssignmentExpression:if(right=this.nextId(),left={},!isAssignable(ast.left))throw $parseMinErr("lval","Trying to assign a value to a non l-value");this.recurse(ast.left,void 0,left,function(){self.if_(self.notNull(left.context),function(){self.recurse(ast.right,right),self.addEnsureSafeObject(self.member(left.context,left.name,left.computed)),self.addEnsureSafeAssignContext(left.context),expression=self.member(left.context,left.name,left.computed)+ast.operator+right,self.assign(intoId,expression),recursionFn(intoId||expression)})},1);break;case AST.ArrayExpression:args=[],forEach(ast.elements,function(expr){self.recurse(expr,self.nextId(),void 0,function(argument){args.push(argument)})}),expression="["+args.join(",")+"]",this.assign(intoId,expression),recursionFn(expression);break;case AST.ObjectExpression:args=[],computed=!1,forEach(ast.properties,function(property){property.computed&&(computed=!0)}),computed?(intoId=intoId||this.nextId(),this.assign(intoId,"{}"),forEach(ast.properties,function(property){property.computed?(left=self.nextId(),self.recurse(property.key,left)):left=property.key.type===AST.Identifier?property.key.name:""+property.key.value,right=self.nextId(),self.recurse(property.value,right),self.assign(self.member(intoId,left,property.computed),right)})):(forEach(ast.properties,function(property){self.recurse(property.value,ast.constant?void 0:self.nextId(),void 0,function(expr){args.push(self.escape(property.key.type===AST.Identifier?property.key.name:""+property.key.value)+":"+expr)})}),expression="{"+args.join(",")+"}",this.assign(intoId,expression)),recursionFn(intoId||expression);break;case AST.ThisExpression:this.assign(intoId,"s"),recursionFn("s");break;case AST.LocalsExpression:this.assign(intoId,"l"),recursionFn("l");break;case AST.NGValueParameter:this.assign(intoId,"v"),recursionFn("v")}},getHasOwnProperty:function(element,property){var key=element+"."+property,own=this.current().own;return own.hasOwnProperty(key)||(own[key]=this.nextId(!1,element+"&&("+this.escape(property)+" in "+element+")")),own[key]},assign:function(id,value){return id?(this.current().body.push(id,"=",value,";"),id):void 0},filter:function(filterName){return this.state.filters.hasOwnProperty(filterName)||(this.state.filters[filterName]=this.nextId(!0)),this.state.filters[filterName]},ifDefined:function(id,defaultValue){return"ifDefined("+id+","+this.escape(defaultValue)+")"},plus:function(left,right){return"plus("+left+","+right+")"},return_:function(id){this.current().body.push("return ",id,";")},if_:function(test,alternate,consequent){if(test===!0)alternate();else{var body=this.current().body;body.push("if(",test,"){"),alternate(),body.push("}"),consequent&&(body.push("else{"),consequent(),body.push("}"))}},not:function(expression){return"!("+expression+")"},notNull:function(expression){return expression+"!=null"},nonComputedMember:function(left,right){var SAFE_IDENTIFIER=/[$_a-zA-Z][$_a-zA-Z0-9]*/,UNSAFE_CHARACTERS=/[^$_a-zA-Z0-9]/g;return SAFE_IDENTIFIER.test(right)?left+"."+right:left+'["'+right.replace(UNSAFE_CHARACTERS,this.stringEscapeFn)+'"]'},computedMember:function(left,right){return left+"["+right+"]"},member:function(left,right,computed){return computed?this.computedMember(left,right):this.nonComputedMember(left,right)},addEnsureSafeObject:function(item){this.current().body.push(this.ensureSafeObject(item),";")},addEnsureSafeMemberName:function(item){this.current().body.push(this.ensureSafeMemberName(item),";")},addEnsureSafeFunction:function(item){this.current().body.push(this.ensureSafeFunction(item),";")},addEnsureSafeAssignContext:function(item){this.current().body.push(this.ensureSafeAssignContext(item),";")},ensureSafeObject:function(item){return"ensureSafeObject("+item+",text)"},ensureSafeMemberName:function(item){return"ensureSafeMemberName("+item+",text)"},ensureSafeFunction:function(item){return"ensureSafeFunction("+item+",text)"},getStringValue:function(item){this.assign(item,"getStringValue("+item+")")},ensureSafeAssignContext:function(item){return"ensureSafeAssignContext("+item+",text)"},lazyRecurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var self=this;return function(){self.recurse(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck)}},lazyAssign:function(id,value){var self=this;return function(){self.assign(id,value)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)},escape:function(value){if(isString(value))return"'"+value.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(isNumber(value))return value.toString();if(value===!0)return"true";if(value===!1)return"false";if(null===value)return"null";if("undefined"==typeof value)return"undefined";throw $parseMinErr("esc","IMPOSSIBLE")},nextId:function(skip,init){var id="v"+this.state.nextId++;return skip||this.current().vars.push(id+(init?"="+init:"")),id},current:function(){return this.state[this.state.computing]}},ASTInterpreter.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.expression=expression,this.expensiveChecks=expensiveChecks,findConstantAndWatchExpressions(ast,self.$filter);var assignable,assign;(assignable=assignableAST(ast))&&(assign=this.recurse(assignable));var inputs,toWatch=getInputs(ast.body);toWatch&&(inputs=[],forEach(toWatch,function(watch,key){var input=self.recurse(watch);watch.input=input,inputs.push(input),watch.watchId=key}));var expressions=[];forEach(ast.body,function(expression){expressions.push(self.recurse(expression.expression))});var fn=0===ast.body.length?noop:1===ast.body.length?expressions[0]:function(scope,locals){var lastValue;return forEach(expressions,function(exp){lastValue=exp(scope,locals)}),lastValue};return assign&&(fn.assign=function(scope,value,locals){return assign(scope,locals,value)}),inputs&&(fn.inputs=inputs),fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},recurse:function(ast,context,create){var left,right,args,self=this;if(ast.input)return this.inputs(ast.input,ast.watchId);switch(ast.type){case AST.Literal:return this.value(ast.value,context);case AST.UnaryExpression:return right=this.recurse(ast.argument),this["unary"+ast.operator](right,context);case AST.BinaryExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.LogicalExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.ConditionalExpression:return this["ternary?:"](this.recurse(ast.test),this.recurse(ast.alternate),this.recurse(ast.consequent),context);case AST.Identifier:return ensureSafeMemberName(ast.name,self.expression),self.identifier(ast.name,self.expensiveChecks||isPossiblyDangerousMemberName(ast.name),context,create,self.expression);case AST.MemberExpression:return left=this.recurse(ast.object,!1,!!create),ast.computed||(ensureSafeMemberName(ast.property.name,self.expression),right=ast.property.name),ast.computed&&(right=this.recurse(ast.property)),ast.computed?this.computedMember(left,right,context,create,self.expression):this.nonComputedMember(left,right,self.expensiveChecks,context,create,self.expression);case AST.CallExpression:return args=[],forEach(ast.arguments,function(expr){args.push(self.recurse(expr))}),ast.filter&&(right=this.$filter(ast.callee.name)),ast.filter||(right=this.recurse(ast.callee,!0)),ast.filter?function(scope,locals,assign,inputs){for(var values=[],i=0;i<args.length;++i)values.push(args[i](scope,locals,assign,inputs));var value=right.apply(void 0,values,inputs);return context?{context:void 0,name:void 0,value:value}:value}:function(scope,locals,assign,inputs){var value,rhs=right(scope,locals,assign,inputs);if(null!=rhs.value){ensureSafeObject(rhs.context,self.expression),ensureSafeFunction(rhs.value,self.expression);for(var values=[],i=0;i<args.length;++i)values.push(ensureSafeObject(args[i](scope,locals,assign,inputs),self.expression));value=ensureSafeObject(rhs.value.apply(rhs.context,values),self.expression)}return context?{value:value}:value};case AST.AssignmentExpression:return left=this.recurse(ast.left,!0,1),right=this.recurse(ast.right),function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs);return ensureSafeObject(lhs.value,self.expression),ensureSafeAssignContext(lhs.context),lhs.context[lhs.name]=rhs,context?{value:rhs}:rhs};case AST.ArrayExpression:return args=[],forEach(ast.elements,function(expr){args.push(self.recurse(expr))}),function(scope,locals,assign,inputs){for(var value=[],i=0;i<args.length;++i)value.push(args[i](scope,locals,assign,inputs));return context?{value:value}:value};case AST.ObjectExpression:return args=[],forEach(ast.properties,function(property){property.computed?args.push({key:self.recurse(property.key),computed:!0,value:self.recurse(property.value)}):args.push({key:property.key.type===AST.Identifier?property.key.name:""+property.key.value,computed:!1,value:self.recurse(property.value)})}),function(scope,locals,assign,inputs){for(var value={},i=0;i<args.length;++i)args[i].computed?value[args[i].key(scope,locals,assign,inputs)]=args[i].value(scope,locals,assign,inputs):value[args[i].key]=args[i].value(scope,locals,assign,inputs);return context?{value:value}:value};case AST.ThisExpression:return function(scope){return context?{value:scope}:scope};case AST.LocalsExpression:return function(scope,locals){return context?{value:locals}:locals};case AST.NGValueParameter:return function(scope,locals,assign){return context?{value:assign}:assign}}},"unary+":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?+arg:0,context?{value:arg}:arg}},"unary-":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?-arg:0,context?{value:arg}:arg}},"unary!":function(argument,context){return function(scope,locals,assign,inputs){var arg=!argument(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary+":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=plusFn(lhs,rhs);return context?{value:arg}:arg}},"binary-":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=(isDefined(lhs)?lhs:0)-(isDefined(rhs)?rhs:0);return context?{value:arg}:arg}},"binary*":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)*right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary/":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)/right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary%":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)%right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary===":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)===right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary&&":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)&&right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary||":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)||right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"ternary?:":function(test,alternate,consequent,context){return function(scope,locals,assign,inputs){var arg=test(scope,locals,assign,inputs)?alternate(scope,locals,assign,inputs):consequent(scope,locals,assign,inputs);return context?{value:arg}:arg}},value:function(value,context){return function(){return context?{context:void 0,name:void 0,value:value}:value}},identifier:function(name,expensiveChecks,context,create,expression){return function(scope,locals,assign,inputs){var base=locals&&name in locals?locals:scope;create&&1!==create&&base&&!base[name]&&(base[name]={});var value=base?base[name]:void 0;return expensiveChecks&&ensureSafeObject(value,expression),context?{context:base,name:name,value:value}:value}},computedMember:function(left,right,context,create,expression){return function(scope,locals,assign,inputs){var rhs,value,lhs=left(scope,locals,assign,inputs);return null!=lhs&&(rhs=right(scope,locals,assign,inputs),rhs=getStringValue(rhs),ensureSafeMemberName(rhs,expression),create&&1!==create&&(ensureSafeAssignContext(lhs),lhs&&!lhs[rhs]&&(lhs[rhs]={})),value=lhs[rhs],ensureSafeObject(value,expression)),context?{context:lhs,name:rhs,value:value}:value}},nonComputedMember:function(left,right,expensiveChecks,context,create,expression){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs);create&&1!==create&&(ensureSafeAssignContext(lhs),lhs&&!lhs[right]&&(lhs[right]={}));var value=null!=lhs?lhs[right]:void 0;return(expensiveChecks||isPossiblyDangerousMemberName(right))&&ensureSafeObject(value,expression),context?{context:lhs,name:right,value:value}:value}},inputs:function(input,watchId){return function(scope,value,locals,inputs){return inputs?inputs[watchId]:input(scope,value,locals)}}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options,this.ast=new AST(lexer,options),this.astCompiler=options.csp?new ASTInterpreter(this.ast,$filter):new ASTCompiler(this.ast,$filter)};Parser.prototype={constructor:Parser,parse:function(text){return this.astCompiler.compile(text,this.options.expensiveChecks)}};var objectValueOf=Object.prototype.valueOf,$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},$templateRequestMinErr=minErr("$compile"),urlParsingNode=window.document.createElement("a"),originUrl=urlResolve(window.location.href);$$CookieReader.$inject=["$document"],$FilterProvider.$inject=["$provide"];var MAX_DIGITS=22,DECIMAL_SEP=".",ZERO_CHAR="0";currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DATE_FORMATS={yyyy:dateGetter("FullYear",4,0,!1,!0),yy:dateGetter("FullYear",2,0,!0,!0),y:dateGetter("FullYear",1,0,!1,!0),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),LLLL:dateStrGetter("Month",!1,!0),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter,ww:weekGetter(2),w:weekGetter(1),G:eraGetter,GG:eraGetter,GGG:eraGetter,GGGG:longEraGetter},DATE_FORMATS_SPLIT=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return attr.href||attr.xlinkHref?void 0:function(scope,element){if("a"===element[0].nodeName.toLowerCase()){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){function defaultLinkFn(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName),linkFn=defaultLinkFn;"checked"===propName&&(linkFn=function(scope,element,attr){attr.ngModel!==attr[normalized]&&defaultLinkFn(scope,element,attr)}),ngAttributeAliasDirectives[normalized]=function(){return{restrict:"A",priority:100,link:linkFn}}}}),forEach(ALIASED_ATTR,function(htmlAttr,ngAttr){ngAttributeAliasDirectives[ngAttr]=function(){return{priority:100,link:function(scope,element,attr){if("ngPattern"===ngAttr&&"/"==attr.ngPattern.charAt(0)){var match=attr.ngPattern.match(REGEX_STRING_REGEXP);if(match)return void attr.$set("ngPattern",new RegExp(match[1],match[2]))}scope.$watch(attr[ngAttr],function(value){attr.$set(ngAttr,value)})}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){return value?(attr.$set(name,value),void(msie&&propName&&element.prop(propName,attr[name]))):void("href"===attrName&&attr.$set(name,null))})}}}});var nullFormCtrl={$addControl:noop,$$renameControl:nullFormRenameControl,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop,$setSubmitted:noop},SUBMITTED_CLASS="ng-submitted";FormController.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var formDirectiveFactory=function(isNgForm){return["$timeout","$parse",function($timeout,$parse){function getSetter(expression){return""===expression?$parse('this[""]').assign:$parse(expression).assign||noop}var formDirective={name:"form",restrict:isNgForm?"EAC":"E",require:["form","^^?form"],controller:FormController,compile:function(formElement,attr){formElement.addClass(PRISTINE_CLASS).addClass(VALID_CLASS);var nameAttr=attr.name?"name":isNgForm&&attr.ngForm?"ngForm":!1;return{pre:function(scope,formElement,attr,ctrls){var controller=ctrls[0];if(!("action"in attr)){var handleFormSubmission=function(event){scope.$apply(function(){controller.$commitViewValue(),controller.$setSubmitted()}),event.preventDefault()};addEventListenerFn(formElement[0],"submit",handleFormSubmission),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",handleFormSubmission)},0,!1)})}var parentFormCtrl=ctrls[1]||controller.$$parentForm;parentFormCtrl.$addControl(controller);var setter=nameAttr?getSetter(controller.$name):noop;nameAttr&&(setter(scope,controller),attr.$observe(nameAttr,function(newValue){controller.$name!==newValue&&(setter(scope,void 0),controller.$$parentForm.$$renameControl(controller,newValue),(setter=getSetter(controller.$name))(scope,controller))})),formElement.on("$destroy",function(){controller.$$parentForm.$removeControl(controller),setter(scope,void 0),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),ISO_DATE_REGEXP=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,URL_REGEXP=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:\/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,EMAIL_REGEXP=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,DATE_REGEXP=/^(\d{4,})-(\d{2})-(\d{2})$/,DATETIMELOCAL_REGEXP=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,WEEK_REGEXP=/^(\d{4,})-W(\d\d)$/,MONTH_REGEXP=/^(\d{4,})-(\d\d)$/,TIME_REGEXP=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,PARTIAL_VALIDATION_EVENTS="keydown wheel mousedown",PARTIAL_VALIDATION_TYPES=createMap();
forEach("date,datetime-local,month,time,week".split(","),function(type){PARTIAL_VALIDATION_TYPES[type]=!0});var inputType={text:textInputType,date:createDateInputType("date",DATE_REGEXP,createDateParser(DATE_REGEXP,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":createDateInputType("datetimelocal",DATETIMELOCAL_REGEXP,createDateParser(DATETIMELOCAL_REGEXP,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:createDateInputType("time",TIME_REGEXP,createDateParser(TIME_REGEXP,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:createDateInputType("week",WEEK_REGEXP,weekParser,"yyyy-Www"),month:createDateInputType("month",MONTH_REGEXP,createDateParser(MONTH_REGEXP,["yyyy","MM"]),"yyyy-MM"),number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},inputDirective=["$browser","$sniffer","$filter","$parse",function($browser,$sniffer,$filter,$parse){return{restrict:"E",require:["?ngModel"],link:{pre:function(scope,element,attr,ctrls){ctrls[0]&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrls[0],$sniffer,$browser,$filter,$parse)}}}}],CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{restrict:"A",priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=["$compile",function($compile){return{restrict:"AC",compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBind),element=element[0],scope.$watch(attr.ngBind,function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindTemplateDirective=["$interpolate","$compile",function($interpolate,$compile){return{compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));$compile.$$addBindingInfo(element,interpolateFn.expressions),element=element[0],attr.$observe("ngBindTemplate",function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindHtmlDirective=["$sce","$parse","$compile",function($sce,$parse,$compile){return{restrict:"A",compile:function(tElement,tAttrs){var ngBindHtmlGetter=$parse(tAttrs.ngBindHtml),ngBindHtmlWatch=$parse(tAttrs.ngBindHtml,function(val){return $sce.valueOf(val)});return $compile.$$addBindingClass(tElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBindHtml),scope.$watch(ngBindHtmlWatch,function(){var value=ngBindHtmlGetter(scope);element.html($sce.getTrustedHtml(value)||"")})}}}}],ngChangeDirective=valueFn({restrict:"A",require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",void 0),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope",function($parse,$rootScope){return{restrict:"A",compile:function($element,attr){var fn=$parse(attr[directiveName],null,!0);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};forceAsyncEvents[eventName]&&$rootScope.$$phase?scope.$evalAsync(callback):scope.$apply(callback)})}}}}]});var ngIfDirective=["$animate","$compile",function($animate,$compile){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){value?childScope||$transclude(function(clone,newScope){childScope=newScope,clone[clone.length++]=$compile.$$createComment("end ngIf",$attr.ngIf),block={clone:clone},$animate.enter(clone,$element.parent(),$element)}):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockNodes(block.clone),$animate.leave(previousElements).then(function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$templateRequest","$anchorScroll","$animate",function($templateRequest,$anchorScroll,$animate){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement).then(function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch(srcExp,function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($templateRequest(src,!0).then(function(response){if(!scope.$$destroyed&&thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element).then(afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded",src),scope.$eval(onloadExp)}},function(){scope.$$destroyed||thisChangeId===changeCounter&&(cleanupLastIncludeContent(),scope.$emit("$includeContentError",src))}),scope.$emit("$includeContentRequested",src)):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){return toString.call($element[0]).match(/SVG/)?($element.empty(),void $compile(jqLiteBuildFragment(ctrl.template,window.document).childNodes)(scope,function(clone){$element.append(clone)},{futureParentElement:$element})):($element.html(ctrl.template),void $compile($element.contents())(scope))}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngListDirective=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(scope,element,attr,ctrl){var ngList=element.attr(attr.$attr.ngList)||", ",trimValues="false"!==attr.ngTrim,separator=trimValues?trim(ngList):ngList,parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trimValues?trim(value):value)}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(ngList):void 0}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",UNTOUCHED_CLASS="ng-untouched",TOUCHED_CLASS="ng-touched",PENDING_CLASS="ng-pending",EMPTY_CLASS="ng-empty",NOT_EMPTY_CLASS="ng-not-empty",ngModelMinErr=minErr("ngModel"),NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate,$timeout,$rootScope,$q,$interpolate){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=void 0,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=void 0,this.$name=$interpolate($attr.name||"",!1)($scope),this.$$parentForm=nullFormCtrl;var parserValid,parsedNgModel=$parse($attr.ngModel),parsedNgModelAssign=parsedNgModel.assign,ngModelGet=parsedNgModel,ngModelSet=parsedNgModelAssign,pendingDebounce=null,ctrl=this;this.$$setOptions=function(options){if(ctrl.$options=options,options&&options.getterSetter){var invokeModelGetter=$parse($attr.ngModel+"()"),invokeModelSetter=$parse($attr.ngModel+"($$$p)");ngModelGet=function($scope){var modelValue=parsedNgModel($scope);return isFunction(modelValue)&&(modelValue=invokeModelGetter($scope)),modelValue},ngModelSet=function($scope,newValue){isFunction(parsedNgModel($scope))?invokeModelSetter($scope,{$$$p:newValue}):parsedNgModelAssign($scope,newValue)}}else if(!parsedNgModel.assign)throw ngModelMinErr("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element))},this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value},this.$$updateEmptyClasses=function(value){ctrl.$isEmpty(value)?($animate.removeClass($element,NOT_EMPTY_CLASS),$animate.addClass($element,EMPTY_CLASS)):($animate.removeClass($element,EMPTY_CLASS),$animate.addClass($element,NOT_EMPTY_CLASS))};var currentValidationRunId=0;addSetValidityMethod({ctrl:this,$element:$element,set:function(object,property){object[property]=!0},unset:function(object,property){delete object[property]},$animate:$animate}),this.$setPristine=function(){ctrl.$dirty=!1,ctrl.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setDirty=function(){ctrl.$dirty=!0,ctrl.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),ctrl.$$parentForm.$setDirty()},this.$setUntouched=function(){ctrl.$touched=!1,ctrl.$untouched=!0,$animate.setClass($element,UNTOUCHED_CLASS,TOUCHED_CLASS)},this.$setTouched=function(){ctrl.$touched=!0,ctrl.$untouched=!1,$animate.setClass($element,TOUCHED_CLASS,UNTOUCHED_CLASS)},this.$rollbackViewValue=function(){$timeout.cancel(pendingDebounce),ctrl.$viewValue=ctrl.$$lastCommittedViewValue,ctrl.$render()},this.$validate=function(){if(!isNumber(ctrl.$modelValue)||!isNaN(ctrl.$modelValue)){var viewValue=ctrl.$$lastCommittedViewValue,modelValue=ctrl.$$rawModelValue,prevValid=ctrl.$valid,prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$runValidators(modelValue,viewValue,function(allValid){allowInvalid||prevValid===allValid||(ctrl.$modelValue=allValid?modelValue:void 0,ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope())})}},this.$$runValidators=function(modelValue,viewValue,doneCallback){function processParseErrors(){var errorKey=ctrl.$$parserName||"parse";return isUndefined(parserValid)?(setValidity(errorKey,null),!0):(parserValid||(forEach(ctrl.$validators,function(v,name){setValidity(name,null)}),forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)})),setValidity(errorKey,parserValid),parserValid)}function processSyncValidators(){var syncValidatorsValid=!0;return forEach(ctrl.$validators,function(validator,name){var result=validator(modelValue,viewValue);syncValidatorsValid=syncValidatorsValid&&result,setValidity(name,result)}),syncValidatorsValid?!0:(forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)}),!1)}function processAsyncValidators(){var validatorPromises=[],allValid=!0;forEach(ctrl.$asyncValidators,function(validator,name){var promise=validator(modelValue,viewValue);if(!isPromiseLike(promise))throw ngModelMinErr("nopromise","Expected asynchronous validator to return a promise but got '{0}' instead.",promise);setValidity(name,void 0),validatorPromises.push(promise.then(function(){setValidity(name,!0)},function(){allValid=!1,setValidity(name,!1)}))}),validatorPromises.length?$q.all(validatorPromises).then(function(){validationDone(allValid)},noop):validationDone(!0)}function setValidity(name,isValid){localValidationRunId===currentValidationRunId&&ctrl.$setValidity(name,isValid)}function validationDone(allValid){localValidationRunId===currentValidationRunId&&doneCallback(allValid)}currentValidationRunId++;var localValidationRunId=currentValidationRunId;return processParseErrors()&&processSyncValidators()?void processAsyncValidators():void validationDone(!1)},this.$commitViewValue=function(){var viewValue=ctrl.$viewValue;$timeout.cancel(pendingDebounce),(ctrl.$$lastCommittedViewValue!==viewValue||""===viewValue&&ctrl.$$hasNativeValidators)&&(ctrl.$$updateEmptyClasses(viewValue),ctrl.$$lastCommittedViewValue=viewValue,ctrl.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function writeToModelIfNeeded(){ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope()}var viewValue=ctrl.$$lastCommittedViewValue,modelValue=viewValue;if(parserValid=isUndefined(modelValue)?void 0:!0)for(var i=0;i<ctrl.$parsers.length;i++)if(modelValue=ctrl.$parsers[i](modelValue),isUndefined(modelValue)){parserValid=!1;break}isNumber(ctrl.$modelValue)&&isNaN(ctrl.$modelValue)&&(ctrl.$modelValue=ngModelGet($scope));var prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$rawModelValue=modelValue,allowInvalid&&(ctrl.$modelValue=modelValue,writeToModelIfNeeded()),ctrl.$$runValidators(modelValue,ctrl.$$lastCommittedViewValue,function(allValid){allowInvalid||(ctrl.$modelValue=allValid?modelValue:void 0,writeToModelIfNeeded())})},this.$$writeModelToScope=function(){ngModelSet($scope,ctrl.$modelValue),forEach(ctrl.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}})},this.$setViewValue=function(value,trigger){ctrl.$viewValue=value,ctrl.$options&&!ctrl.$options.updateOnDefault||ctrl.$$debounceViewValueCommit(trigger)},this.$$debounceViewValueCommit=function(trigger){var debounce,debounceDelay=0,options=ctrl.$options;options&&isDefined(options.debounce)&&(debounce=options.debounce,isNumber(debounce)?debounceDelay=debounce:isNumber(debounce[trigger])?debounceDelay=debounce[trigger]:isNumber(debounce["default"])&&(debounceDelay=debounce["default"])),$timeout.cancel(pendingDebounce),debounceDelay?pendingDebounce=$timeout(function(){ctrl.$commitViewValue()},debounceDelay):$rootScope.$$phase?ctrl.$commitViewValue():$scope.$apply(function(){ctrl.$commitViewValue()})},$scope.$watch(function(){var modelValue=ngModelGet($scope);if(modelValue!==ctrl.$modelValue&&(ctrl.$modelValue===ctrl.$modelValue||modelValue===modelValue)){ctrl.$modelValue=ctrl.$$rawModelValue=modelValue,parserValid=void 0;for(var formatters=ctrl.$formatters,idx=formatters.length,viewValue=modelValue;idx--;)viewValue=formatters[idx](viewValue);ctrl.$viewValue!==viewValue&&(ctrl.$$updateEmptyClasses(viewValue),ctrl.$viewValue=ctrl.$$lastCommittedViewValue=viewValue,ctrl.$render(),ctrl.$$runValidators(modelValue,viewValue,noop))}return modelValue})}],ngModelDirective=["$rootScope",function($rootScope){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:NgModelController,priority:1,compile:function(element){return element.addClass(PRISTINE_CLASS).addClass(UNTOUCHED_CLASS).addClass(VALID_CLASS),{pre:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||modelCtrl.$$parentForm;modelCtrl.$$setOptions(ctrls[2]&&ctrls[2].$options),formCtrl.$addControl(modelCtrl),attr.$observe("name",function(newValue){modelCtrl.$name!==newValue&&modelCtrl.$$parentForm.$$renameControl(modelCtrl,newValue)}),scope.$on("$destroy",function(){modelCtrl.$$parentForm.$removeControl(modelCtrl)})},post:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0];modelCtrl.$options&&modelCtrl.$options.updateOn&&element.on(modelCtrl.$options.updateOn,function(ev){modelCtrl.$$debounceViewValueCommit(ev&&ev.type)}),element.on("blur",function(){modelCtrl.$touched||($rootScope.$$phase?scope.$evalAsync(modelCtrl.$setTouched):scope.$apply(modelCtrl.$setTouched))})}}}}}],DEFAULT_REGEXP=/(\s+|^)default(\s+|$)/,ngModelOptionsDirective=function(){return{restrict:"A",controller:["$scope","$attrs",function($scope,$attrs){var that=this;this.$options=copy($scope.$eval($attrs.ngModelOptions)),isDefined(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=trim(this.$options.updateOn.replace(DEFAULT_REGEXP,function(){return that.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngOptionsMinErr=minErr("ngOptions"),NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,ngOptionsDirective=["$compile","$document","$parse",function($compile,$document,$parse){function parseOptionsExpression(optionsExp,selectElement,scope){function Option(selectValue,viewValue,label,group,disabled){this.selectValue=selectValue,this.viewValue=viewValue,this.label=label,this.group=group,this.disabled=disabled}function getOptionValuesKeys(optionValues){var optionValuesKeys;if(!keyName&&isArrayLike(optionValues))optionValuesKeys=optionValues;else{optionValuesKeys=[];for(var itemKey in optionValues)optionValues.hasOwnProperty(itemKey)&&"$"!==itemKey.charAt(0)&&optionValuesKeys.push(itemKey)}return optionValuesKeys}var match=optionsExp.match(NG_OPTIONS_REGEXP);if(!match)throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var valueName=match[5]||match[7],keyName=match[6],selectAs=/ as /.test(match[0])&&match[1],trackBy=match[9],valueFn=$parse(match[2]?match[1]:valueName),selectAsFn=selectAs&&$parse(selectAs),viewValueFn=selectAsFn||valueFn,trackByFn=trackBy&&$parse(trackBy),getTrackByValueFn=trackBy?function(value,locals){return trackByFn(scope,locals)}:function(value){return hashKey(value)},getTrackByValue=function(value,key){return getTrackByValueFn(value,getLocals(value,key))},displayFn=$parse(match[2]||match[1]),groupByFn=$parse(match[3]||""),disableWhenFn=$parse(match[4]||""),valuesFn=$parse(match[8]),locals={},getLocals=keyName?function(value,key){return locals[keyName]=key,locals[valueName]=value,locals}:function(value){return locals[valueName]=value,locals};return{trackBy:trackBy,getTrackByValue:getTrackByValue,getWatchables:$parse(valuesFn,function(optionValues){var watchedArray=[];optionValues=optionValues||[];for(var optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;optionValuesLength>index;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),selectValue=getTrackByValueFn(value,locals);if(watchedArray.push(selectValue),match[2]||match[1]){var label=displayFn(scope,locals);watchedArray.push(label)}if(match[4]){var disableWhen=disableWhenFn(scope,locals);watchedArray.push(disableWhen)}}return watchedArray}),getOptions:function(){for(var optionItems=[],selectValueMap={},optionValues=valuesFn(scope)||[],optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;optionValuesLength>index;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),viewValue=viewValueFn(scope,locals),selectValue=getTrackByValueFn(viewValue,locals),label=displayFn(scope,locals),group=groupByFn(scope,locals),disabled=disableWhenFn(scope,locals),optionItem=new Option(selectValue,viewValue,label,group,disabled);optionItems.push(optionItem),selectValueMap[selectValue]=optionItem}return{items:optionItems,selectValueMap:selectValueMap,getOptionFromViewValue:function(value){return selectValueMap[getTrackByValue(value)]},getViewValueFromOption:function(option){return trackBy?angular.copy(option.viewValue):option.viewValue}}}}}function ngOptionsPostLink(scope,selectElement,attr,ctrls){function addOptionElement(option,parent){var optionElement=optionTemplate.cloneNode(!1);parent.appendChild(optionElement),updateOptionElement(option,optionElement)}function updateOptionElement(option,element){option.element=element,element.disabled=option.disabled,option.label!==element.label&&(element.label=option.label,element.textContent=option.label),option.value!==element.value&&(element.value=option.selectValue)}function updateOptions(){var previousValue=options&&selectCtrl.readValue();if(options)for(var i=options.items.length-1;i>=0;i--){var option=options.items[i];jqLiteRemove(isDefined(option.group)?option.element.parentNode:option.element)}options=ngOptions.getOptions();var groupElementMap={};if(providedEmptyOption&&selectElement.prepend(emptyOption),options.items.forEach(function(option){var groupElement;isDefined(option.group)?(groupElement=groupElementMap[option.group],groupElement||(groupElement=optGroupTemplate.cloneNode(!1),listFragment.appendChild(groupElement),groupElement.label=null===option.group?"null":option.group,groupElementMap[option.group]=groupElement),addOptionElement(option,groupElement)):addOptionElement(option,listFragment)}),selectElement[0].appendChild(listFragment),ngModelCtrl.$render(),!ngModelCtrl.$isEmpty(previousValue)){var nextValue=selectCtrl.readValue(),isNotPrimitive=ngOptions.trackBy||multiple;(isNotPrimitive?equals(previousValue,nextValue):previousValue===nextValue)||(ngModelCtrl.$setViewValue(nextValue),ngModelCtrl.$render())}}for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,i=0,children=selectElement.children(),ii=children.length;ii>i;i++)if(""===children[i].value){emptyOption=children.eq(i);break}var providedEmptyOption=!!emptyOption,unknownOption=jqLite(optionTemplate.cloneNode(!1));unknownOption.val("?");var options,ngOptions=parseOptionsExpression(attr.ngOptions,selectElement,scope),listFragment=$document[0].createDocumentFragment(),renderEmptyOption=function(){providedEmptyOption||selectElement.prepend(emptyOption),selectElement.val(""),emptyOption.prop("selected",!0),emptyOption.attr("selected",!0)},removeEmptyOption=function(){providedEmptyOption||emptyOption.remove()},renderUnknownOption=function(){selectElement.prepend(unknownOption),selectElement.val("?"),unknownOption.prop("selected",!0),unknownOption.attr("selected",!0)},removeUnknownOption=function(){unknownOption.remove()};multiple?(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length},selectCtrl.writeValue=function(value){options.items.forEach(function(option){option.element.selected=!1}),value&&value.forEach(function(item){var option=options.getOptionFromViewValue(item);option&&(option.element.selected=!0)})},selectCtrl.readValue=function(){var selectedValues=selectElement.val()||[],selections=[];return forEach(selectedValues,function(value){var option=options.selectValueMap[value];option&&!option.disabled&&selections.push(options.getViewValueFromOption(option))}),selections},ngOptions.trackBy&&scope.$watchCollection(function(){return isArray(ngModelCtrl.$viewValue)?ngModelCtrl.$viewValue.map(function(value){return ngOptions.getTrackByValue(value)}):void 0},function(){ngModelCtrl.$render()})):(selectCtrl.writeValue=function(value){var option=options.getOptionFromViewValue(value);option?(selectElement[0].value!==option.selectValue&&(removeUnknownOption(),removeEmptyOption(),selectElement[0].value=option.selectValue,option.element.selected=!0),option.element.setAttribute("selected","selected")):null===value||providedEmptyOption?(removeUnknownOption(),renderEmptyOption()):(removeEmptyOption(),renderUnknownOption())},selectCtrl.readValue=function(){var selectedOption=options.selectValueMap[selectElement.val()];return selectedOption&&!selectedOption.disabled?(removeEmptyOption(),removeUnknownOption(),options.getViewValueFromOption(selectedOption)):null},ngOptions.trackBy&&scope.$watch(function(){return ngOptions.getTrackByValue(ngModelCtrl.$viewValue)},function(){ngModelCtrl.$render()})),providedEmptyOption?(emptyOption.remove(),$compile(emptyOption)(scope),emptyOption.removeClass("ng-scope")):emptyOption=jqLite(optionTemplate.cloneNode(!1)),selectElement.empty(),updateOptions(),scope.$watchCollection(ngOptions.getWatchables,updateOptions)}var optionTemplate=window.document.createElement("option"),optGroupTemplate=window.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(scope,selectElement,attr,ctrls){ctrls[0].registerOption=noop},post:ngOptionsPostLink}}}],ngPluralizeDirective=["$locale","$interpolate","$log",function($locale,$interpolate,$log){var BRACE=/{}/g,IS_WHEN=/^when(Minus)?(.+)$/;return{link:function(scope,element,attr){function updateElementText(newText){element.text(newText||"")}var lastCount,numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),braceReplacement=startSymbol+numberExp+"-"+offset+endSymbol,watchRemover=angular.noop;forEach(attr,function(expression,attributeName){var tmpMatch=IS_WHEN.exec(attributeName);if(tmpMatch){var whenKey=(tmpMatch[1]?"-":"")+lowercase(tmpMatch[2]);whens[whenKey]=element.attr(attr.$attr[attributeName])}}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,braceReplacement))}),scope.$watch(numberExp,function(newVal){var count=parseFloat(newVal),countIsNaN=isNaN(count);if(countIsNaN||count in whens||(count=$locale.pluralCat(count-offset)),count!==lastCount&&!(countIsNaN&&isNumber(lastCount)&&isNaN(lastCount))){watchRemover();var whenExpFn=whensExpFns[count];isUndefined(whenExpFn)?(null!=newVal&&$log.debug("ngPluralize: no rule defined for '"+count+"' in "+whenExp),watchRemover=noop,updateElementText()):watchRemover=scope.$watch(whenExpFn,updateElementText),lastCount=count}})}}}],ngRepeatDirective=["$parse","$animate","$compile",function($parse,$animate,$compile){var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat"),updateScope=function(scope,index,valueIdentifier,value,keyIdentifier,key,arrayLength){scope[valueIdentifier]=value,keyIdentifier&&(scope[keyIdentifier]=key),scope.$index=index,scope.$first=0===index,scope.$last=index===arrayLength-1,scope.$middle=!(scope.$first||scope.$last),scope.$odd=!(scope.$even=0===(1&index))},getBlockStart=function(block){return block.clone[0]},getBlockEnd=function(block){return block.clone[block.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function($element,$attr){var expression=$attr.ngRepeat,ngRepeatEndComment=$compile.$$createComment("end ngRepeat",expression),match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);var lhs=match[1],rhs=match[2],aliasAs=match[3],trackByExp=match[4];if(match=lhs.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);var valueIdentifier=match[3]||match[1],keyIdentifier=match[2];if(aliasAs&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(aliasAs)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(aliasAs)))throw ngRepeatMinErr("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",aliasAs);var trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,hashFnLocals={$id:hashKey};return trackByExp?trackByExpGetter=$parse(trackByExp):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),function($scope,$element,$attr,ctrl,$transclude){trackByExpGetter&&(trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)});var lastBlockMap=createMap();$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,collectionLength,key,value,trackById,trackByIdFn,collectionKeys,block,nextBlockOrder,elementsToRemove,previousNode=$element[0],nextBlockMap=createMap();if(aliasAs&&($scope[aliasAs]=collection),isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(var itemKey in collection)hasOwnProperty.call(collection,itemKey)&&"$"!==itemKey.charAt(0)&&collectionKeys.push(itemKey)}for(collectionLength=collectionKeys.length,nextBlockOrder=new Array(collectionLength),index=0;collectionLength>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),lastBlockMap[trackById])block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap[trackById])throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,value);nextBlockOrder[index]={id:trackById,scope:void 0,clone:void 0},nextBlockMap[trackById]=!0}for(var blockKey in lastBlockMap){if(block=lastBlockMap[blockKey],elementsToRemove=getBlockNodes(block.clone),$animate.leave(elementsToRemove),elementsToRemove[0].parentNode)for(index=0,length=elementsToRemove.length;length>index;index++)elementsToRemove[index][NG_REMOVED]=!0;block.scope.$destroy()}for(index=0;collectionLength>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],block.scope){nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockNodes(block.clone),null,previousNode),previousNode=getBlockEnd(block),updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)}else $transclude(function(clone,scope){block.scope=scope;var endNode=ngRepeatEndComment.cloneNode(!1);clone[clone.length++]=endNode,$animate.enter(clone,null,previousNode),previousNode=endNode,block.clone=clone,nextBlockMap[block.id]=block,updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)});lastBlockMap=nextBlockMap})}}}}],NG_HIDE_CLASS="ng-hide",NG_HIDE_IN_PROGRESS_CLASS="ng-hide-animate",ngShowDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[value?"removeClass":"addClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngHideDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[value?"addClass":"removeClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){
oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate","$compile",function($animate,$compile){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousLeaveAnimations=[],selectedScopes=[],spliceFactory=function(array,index){return function(){array.splice(index,1)}};scope.$watch(watchExpr,function(value){var i,ii;for(i=0,ii=previousLeaveAnimations.length;ii>i;++i)$animate.cancel(previousLeaveAnimations[i]);for(previousLeaveAnimations.length=0,i=0,ii=selectedScopes.length;ii>i;++i){var selected=getBlockNodes(selectedElements[i].clone);selectedScopes[i].$destroy();var promise=previousLeaveAnimations[i]=$animate.leave(selected);promise.then(spliceFactory(previousLeaveAnimations,i))}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&forEach(selectedTranscludes,function(selectedTransclude){selectedTransclude.transclude(function(caseElement,selectedScope){selectedScopes.push(selectedScope);var anchor=selectedTransclude.element;caseElement[caseElement.length++]=$compile.$$createComment("end ngSwitchWhen");var block={clone:caseElement};selectedElements.push(block),$animate.enter(caseElement,anchor.parent(),anchor)})})})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeMinErr=minErr("ngTransclude"),ngTranscludeDirective=["$compile",function($compile){return{restrict:"EAC",terminal:!0,compile:function(tElement){var fallbackLinkFn=$compile(tElement.contents());return tElement.empty(),function($scope,$element,$attrs,controller,$transclude){function ngTranscludeCloneAttachFn(clone,transcludedScope){clone.length?$element.append(clone):(useFallbackContent(),transcludedScope.$destroy())}function useFallbackContent(){fallbackLinkFn($scope,function(clone){$element.append(clone)})}if(!$transclude)throw ngTranscludeMinErr("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$attrs.ngTransclude===$attrs.$attr.ngTransclude&&($attrs.ngTransclude="");var slotName=$attrs.ngTransclude||$attrs.ngTranscludeSlot;$transclude(ngTranscludeCloneAttachFn,null,slotName),slotName&&!$transclude.isSlotFilled(slotName)&&useFallbackContent()}}}}],scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],noopNgModelController={$setViewValue:noop,$render:noop},SelectController=["$element","$scope",function($element,$scope){var self=this,optionsMap=new HashMap;self.ngModelCtrl=noopNgModelController,self.unknownOption=jqLite(window.document.createElement("option")),self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";self.unknownOption.val(unknownVal),$element.prepend(self.unknownOption),$element.val(unknownVal)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop}),self.removeUnknownOption=function(){self.unknownOption.parent()&&self.unknownOption.remove()},self.readValue=function(){return self.removeUnknownOption(),$element.val()},self.writeValue=function(value){self.hasOption(value)?(self.removeUnknownOption(),$element.val(value),""===value&&self.emptyOption.prop("selected",!0)):null==value&&self.emptyOption?(self.removeUnknownOption(),$element.val("")):self.renderUnknownOption(value)},self.addOption=function(value,element){if(element[0].nodeType!==NODE_TYPE_COMMENT){assertNotHasOwnProperty(value,'"option value"'),""===value&&(self.emptyOption=element);var count=optionsMap.get(value)||0;optionsMap.put(value,count+1),self.ngModelCtrl.$render(),chromeHack(element)}},self.removeOption=function(value){var count=optionsMap.get(value);count&&(1===count?(optionsMap.remove(value),""===value&&(self.emptyOption=void 0)):optionsMap.put(value,count-1))},self.hasOption=function(value){return!!optionsMap.get(value)},self.registerOption=function(optionScope,optionElement,optionAttrs,interpolateValueFn,interpolateTextFn){if(interpolateValueFn){var oldVal;optionAttrs.$observe("value",function(newVal){isDefined(oldVal)&&self.removeOption(oldVal),oldVal=newVal,self.addOption(newVal,optionElement)})}else interpolateTextFn?optionScope.$watch(interpolateTextFn,function(newVal,oldVal){optionAttrs.$set("value",newVal),oldVal!==newVal&&self.removeOption(oldVal),self.addOption(newVal,optionElement)}):self.addOption(optionAttrs.value,optionElement);optionElement.on("$destroy",function(){self.removeOption(optionAttrs.value),self.ngModelCtrl.$render()})}}],selectDirective=function(){function selectPreLink(scope,element,attr,ctrls){var ngModelCtrl=ctrls[1];if(ngModelCtrl){var selectCtrl=ctrls[0];if(selectCtrl.ngModelCtrl=ngModelCtrl,element.on("change",function(){scope.$apply(function(){ngModelCtrl.$setViewValue(selectCtrl.readValue())})}),attr.multiple){selectCtrl.readValue=function(){var array=[];return forEach(element.find("option"),function(option){option.selected&&array.push(option.value)}),array},selectCtrl.writeValue=function(value){var items=new HashMap(value);forEach(element.find("option"),function(option){option.selected=isDefined(items.get(option.value))})};var lastView,lastViewRef=NaN;scope.$watch(function(){lastViewRef!==ngModelCtrl.$viewValue||equals(lastView,ngModelCtrl.$viewValue)||(lastView=shallowCopy(ngModelCtrl.$viewValue),ngModelCtrl.$render()),lastViewRef=ngModelCtrl.$viewValue}),ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}}}}function selectPostLink(scope,element,attrs,ctrls){var ngModelCtrl=ctrls[1];if(ngModelCtrl){var selectCtrl=ctrls[0];ngModelCtrl.$render=function(){selectCtrl.writeValue(ngModelCtrl.$viewValue)}}}return{restrict:"E",require:["select","?ngModel"],controller:SelectController,priority:1,link:{pre:selectPreLink,post:selectPostLink}}},optionDirective=["$interpolate",function($interpolate){return{restrict:"E",priority:100,compile:function(element,attr){if(isDefined(attr.value))var interpolateValueFn=$interpolate(attr.value,!0);else{var interpolateTextFn=$interpolate(element.text(),!0);interpolateTextFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.registerOption(scope,element,attr,interpolateValueFn,interpolateTextFn)}}}}],styleDirective=valueFn({restrict:"E",terminal:!1}),requiredDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){ctrl&&(attr.required=!0,ctrl.$validators.required=function(modelValue,viewValue){return!attr.required||!ctrl.$isEmpty(viewValue)},attr.$observe("required",function(){ctrl.$validate()}))}}},patternDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var regexp,patternExp=attr.ngPattern||attr.pattern;attr.$observe("pattern",function(regex){if(isString(regex)&&regex.length>0&&(regex=new RegExp("^"+regex+"$")),regex&&!regex.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",patternExp,regex,startingTag(elm));regexp=regex||void 0,ctrl.$validate()}),ctrl.$validators.pattern=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(regexp)||regexp.test(viewValue)}}}}},maxlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var maxlength=-1;attr.$observe("maxlength",function(value){var intVal=toInt(value);maxlength=isNaN(intVal)?-1:intVal,ctrl.$validate()}),ctrl.$validators.maxlength=function(modelValue,viewValue){return 0>maxlength||ctrl.$isEmpty(viewValue)||viewValue.length<=maxlength}}}}},minlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var minlength=0;attr.$observe("minlength",function(value){minlength=toInt(value)||0,ctrl.$validate()}),ctrl.$validators.minlength=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||viewValue.length>=minlength}}}}};return window.angular.bootstrap?void(window.console&&console.log("WARNING: Tried to load angular more than once.")):(bindJQuery(),publishExternalAPI(angular),angular.module("ngLocale",[],["$provide",function($provide){function getDecimals(n){n+="";var i=n.indexOf(".");return-1==i?0:n.length-i-1}function getVF(n,opt_precision){var v=opt_precision;void 0===v&&(v=Math.min(getDecimals(n),3));var base=Math.pow(10,v),f=(n*base|0)%base;return{v:v,f:f}}var PLURAL_CATEGORY={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};$provide.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(n,opt_precision){var i=0|n,vf=getVF(n,opt_precision);return 1==i&&0==vf.v?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}})}]),void jqLite(window.document).ready(function(){angularInit(window.document,bootstrap)}))}(window),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>')}).call(exports,__webpack_require__(3))},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=jQuery.type(obj);return"function"===type||jQuery.isWindow(obj)?!1:"array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not})}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object={};return jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function completed(){document.removeEventListener("DOMContentLoaded",completed),window.removeEventListener("load",completed),jQuery.ready()}function Data(){this.expando=jQuery.expando+Data.uid++}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$&").toLowerCase(),data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}dataUser.set(elem,key,data)}else data=void 0;return data}function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale=1,maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=(jQuery.cssNumber[prop]||"px"!==unit&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){unit=unit||initialInUnit[3],valueParts=valueParts||[],initialInUnit=+initial||1;do scale=scale||".5",initialInUnit/=scale,jQuery.style(elem,prop,initialInUnit+unit);while(scale!==(scale=currentValue()/initial)&&1!==scale&&--maxIterations)}return valueParts&&(initialInUnit=+initialInUnit||+initial||0,adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2],tween&&(tween.unit=unit,tween.start=initialInUnit,tween.end=adjusted)),adjusted}function getAll(context,tag){var ret="undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag||"*"):"undefined"!=typeof context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;l>i;i++)dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"))}function buildFragment(elems,context,scripts,selection,ignored){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if(selection&&jQuery.inArray(elem,selection)>-1)ignored&&ignored.push(elem);else if(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts)for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function on(elem,types,selector,data,fn,one){var origFn,type;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)on(elem,type,selector,data,types[type],one);return elem}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return elem;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(dataPriv.hasData(src)&&(pdataOld=dataPriv.access(src),pdataCur=dataPriv.set(dest,pdataOld),events=pdataOld.events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}dataUser.hasData(src)&&(udataOld=dataUser.access(src),udataCur=jQuery.extend({},udataOld),dataUser.set(dest,udataCur))}}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:"input"!==nodeName&&"textarea"!==nodeName||(dest.defaultValue=src.defaultValue)}function domManip(collection,args,callback,ignored){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),domManip(self,args,callback,ignored)});if(l&&(fragment=buildFragment(args,collection[0].ownerDocument,!1,collection,ignored),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first||ignored)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(collection[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval(node.textContent.replace(rcleanScript,"")))}return collection}function remove(elem,selector,keepData){for(var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;null!=(node=nodes[i]);i++)keepData||1!==node.nodeType||jQuery.cleanData(getAll(node)),node.parentNode&&(keepData&&jQuery.contains(node.ownerDocument,node)&&setGlobalEval(getAll(node,"script")),node.parentNode.removeChild(node));return elem}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=jQuery.css(elem[0],"display");return elem.detach(),display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement),doc=iframe[0].contentDocument,doc.write(),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:void 0,""!==ret&&void 0!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),computed&&!support.pixelMarginRight()&&rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){return conditionFn()?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(name){if(name in emptyStyle)return name;for(var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in emptyStyle)return name}function setPositiveNumber(elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(document.msFullscreenElement&&window.top!==window&&elem.getClientRects().length&&(val=Math.round(100*elem.getBoundingClientRect()[name])),0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=dataPriv.get(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=dataPriv.access(elem,"olddisplay",defaultDisplay(elem.nodeName)))):(hidden=isHidden(elem),"none"===display&&hidden||dataPriv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){return window.setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=dataPriv.get(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],display=jQuery.css(elem,"display"),checkDisplay="none"===display?dataPriv.get(elem,"olddisplay")||defaultDisplay(elem.nodeName):display,"inline"===checkDisplay&&"none"===jQuery.css(elem,"float")&&(style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else display=void 0;if(jQuery.isEmptyObject(orig))"inline"===("none"===display?defaultDisplay(elem.nodeName):display)&&(style.display=display);else{dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=dataPriv.access(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;dataPriv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?(deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation,gotoEnd])):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=Animation.prefilters[index].call(animation,elem,props,animation.opts))return jQuery.isFunction(result.stop)&&(jQuery._queueHooks(animation.elem,animation.opts.queue).stop=jQuery.proxy(result.stop,result)),result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v&&null!=v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType&&elem.defaultView}var arr=[],document=window.document,slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,support={},version="2.2.3",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){
return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?0>num?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray,isWindow:function(obj){return null!=obj&&obj===obj.window},isNumeric:function(obj){var realStringObj=obj&&obj.toString();return!jQuery.isArray(obj)&&realStringObj-parseFloat(realStringObj)+1>=0},isPlainObject:function(obj){var key;if("object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype||{},"isPrototypeOf"))return!1;for(key in obj);return void 0===key||hasOwn.call(obj,key)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(1===code.indexOf("use strict")?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code))},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback){var length,i=0;if(isArrayLike(obj))for(length=obj.length;length>i&&callback.call(obj[i],i,obj[i])!==!1;i++);else for(i in obj)if(callback.call(obj[i],i,obj[i])===!1)break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArrayLike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;len>j;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;length>i;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems))for(length=elems.length;length>i;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):void 0},now:Date.now,support:support}),"function"==typeof Symbol&&(jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]),jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var m,i,elem,nid,nidselect,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;if(results=results||[],"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,documentIsHTML)){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(!(elem=context.getElementById(m)))return results;if(elem.id===m)return results.push(elem),results}else if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&!compilerCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(1!==nodeType)newContext=context,newSelector=selector;else if("object"!==context.nodeName.toLowerCase()){for((nid=context.getAttribute("id"))?nid=nid.replace(rescape,"\\$&"):context.setAttribute("id",nid=expando),groups=tokenize(selector),i=groups.length,nidselect=ridentifier.test(nid)?"#"+nid:"[id='"+nid+"']";i--;)groups[i]=nidselect+" "+toSelector(groups[i]);newSelector=groups.join(","),newContext=rsibling.test(selector)&&testContext(context.parentNode)||context}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{nid===expando&&context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=arr.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&"undefined"!=typeof context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={}),(oldCache=uniqueCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(uniqueCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context===document||context||outermost);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0,context||elem.ownerDocument===document||(setDocument(elem),xml=!documentIsHTML);matcher=elementMatchers[j++];)if(matcher(elem,context||document,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;len>i;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},unloadHandler=function(){setDocument()};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=document.documentElement,documentIsHTML=!isXML(document),(parent=document.defaultView)&&parent.top!==parent&&(parent.addEventListener?parent.addEventListener("unload",unloadHandler,!1):parent.attachEvent&&parent.attachEvent("onunload",unloadHandler)),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(document.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(document.getElementsByClassName),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!document.getElementsByName||!document.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var m=context.getElementById(id);return m?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node="undefined"!=typeof elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return"undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return"undefined"!=typeof context.getElementsByClassName&&documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(document.querySelectorAll))&&(assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\r\\' msallowcapture=''><option selected=''></option></select>",div.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),div.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(div){var input=document.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===document||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===document||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===document?-1:b===document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},document):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&!compilerCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||"undefined"!=typeof elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=!1;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(node=parent,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(node=elem,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex),diff===!1)for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&(outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),uniqueCache[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),
tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var dir=function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},siblings=function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched},rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,len=this.length,ret=[],self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;if(root=root||rootjQuery,"string"==typeof selector){if(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||root).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return elem=document.getElementById(match[2]),elem&&elem.parentNode&&(this.length=1,this[0]=elem),this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?void 0!==root.ready?root.ready(selector):selector(jQuery):(void 0!==selector.selector&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;l>i;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return siblings(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.uniqueSort(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnotwhite=/\S+/g;jQuery.Callbacks=function(options){options="string"==typeof options?createOptions(options):jQuery.extend({},options);var firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){for(locked=options.once,fired=firing=!0;queue.length;firingIndex=-1)for(memory=queue.shift();++firingIndex<list.length;)list[firingIndex].apply(memory[0],memory[1])===!1&&options.stopOnFalse&&(firingIndex=list.length,memory=!1);options.memory||(memory=!1),firing=!1,locked&&(list=memory?[]:"")},self={add:function(){return list&&(memory&&!firing&&(firingIndex=list.length-1,queue.push(memory)),function add(args){jQuery.each(args,function(_,arg){jQuery.isFunction(arg)?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==jQuery.type(arg)&&add(arg)})}(arguments),memory&&!firing&&fire()),this},remove:function(){return jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firingIndex>=index&&firingIndex--}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0},empty:function(){return list&&(list=[]),this},disable:function(){return locked=queue=[],list=memory="",this},disabled:function(){return!list},lock:function(){return locked=queue=[],memory||(list=memory=""),this},locked:function(){return!!locked},fireWith:function(context,args){return locked||(args=args||[],args=[context,args.slice?args.slice():args],queue.push(args),firing||fire()),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().progress(updateFunc(i,progressContexts,progressValues)).done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){return jQuery.ready.promise().done(fn),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){(wait===!0?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.triggerHandler&&(jQuery(document).triggerHandler("ready"),jQuery(document).off("ready"))))}}),jQuery.ready.promise=function(obj){return readyList||(readyList=jQuery.Deferred(),"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed),window.addEventListener("load",completed))),readyList.promise(obj)},jQuery.ready.promise();var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;len>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet},acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType};Data.uid=1,Data.prototype={register:function(owner,initial){var value=initial||{};return owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,writable:!0,configurable:!0}),owner[this.expando]},cache:function(owner){if(!acceptData(owner))return{};var value=owner[this.expando];return value||(value={},acceptData(owner)&&(owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,configurable:!0}))),value},set:function(owner,data,value){var prop,cache=this.cache(owner);if("string"==typeof data)cache[data]=value;else for(prop in data)cache[prop]=data[prop];return cache},get:function(owner,key){return void 0===key?this.cache(owner):owner[this.expando]&&owner[this.expando][key]},access:function(owner,key,value){var stored;return void 0===key||key&&"string"==typeof key&&void 0===value?(stored=this.get(owner,key),void 0!==stored?stored:this.get(owner,jQuery.camelCase(key))):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,name,camel,cache=owner[this.expando];if(void 0!==cache){if(void 0===key)this.register(owner);else{jQuery.isArray(key)?name=key.concat(key.map(jQuery.camelCase)):(camel=jQuery.camelCase(key),key in cache?name=[key,camel]:(name=camel,name=name in cache?[name]:name.match(rnotwhite)||[])),i=name.length;for(;i--;)delete cache[name[i]]}(void 0===key||jQuery.isEmptyObject(cache))&&(owner.nodeType?owner[this.expando]=void 0:delete owner[this.expando])}},hasData:function(owner){var cache=owner[this.expando];return void 0!==cache&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data,dataUser=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,data){return dataUser.access(elem,name,data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=dataUser.get(elem),1===elem.nodeType&&!dataPriv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));dataPriv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){dataUser.set(this,key)}):access(this,function(value){var data,camelKey;if(elem&&void 0===value){if(data=dataUser.get(elem,key)||dataUser.get(elem,key.replace(rmultiDash,"-$&").toLowerCase()),void 0!==data)return data;if(camelKey=jQuery.camelCase(key),data=dataUser.get(elem,camelKey),void 0!==data)return data;if(data=dataAttr(elem,camelKey,void 0),void 0!==data)return data}else camelKey=jQuery.camelCase(key),this.each(function(){var data=dataUser.get(this,camelKey);dataUser.set(this,camelKey,value),key.indexOf("-")>-1&&void 0!==data&&dataUser.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=dataPriv.get(elem,type),data&&(!queue||jQuery.isArray(data)?queue=dataPriv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=dataPriv.get(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},rcheckableType=/^(?:checkbox|radio)$/i,rtagName=/<([\w:-]+)/,rscriptType=/^$|\/(?:java|ecma)script/i,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var rhtml=/<|&#?\w+;/;!function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue}();var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(elemData)for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return"undefined"!=typeof jQuery&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||elem.addEventListener&&elem.addEventListener(type,eventHandle)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&dataPriv.remove(elem,"handle events")}},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=slice.call(arguments),handlers=(dataPriv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)event.rnamespace&&!event.rnamespace.test(handleObj.namespace)||(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&("click"!==event.type||isNaN(event.button)||event.button<1))for(;cur!==this;cur=cur.parentNode||this)if(1===cur.nodeType&&(cur.disabled!==!0||"click"!==event.type)){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0),event}},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=document),3===event.target.nodeType&&(event.target=event.target.parentNode),fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==safeActiveElement()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&jQuery.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle)},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.returnValue===!1?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||jQuery.contains(target,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn)},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return selector!==!1&&"function"!=typeof selector||(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;jQuery.extend({htmlPrefilter:function(html){return html.replace(rxhtmlTag,"<$1></$2>")},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0,l=srcElements.length;l>i;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;l>i;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},cleanData:function(elems){for(var data,elem,type,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=void 0}elem[dataUser.expando]&&(elem[dataUser.expando]=void 0)}}}),jQuery.fn.extend({domManip:domManip,detach:function(selector){return remove(this,selector,!0)},remove:function(selector){return remove(this,selector)},text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=value)})},null,value,arguments.length)},append:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;
if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;jQuery.inArray(this,ignored)<0&&(jQuery.cleanData(getAll(this)),parent&&parent.replaceChild(elem,this))},ignored)}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var iframe,elemdisplay={HTML:"block",BODY:"block"},rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){var view=elem.ownerDocument.defaultView;return view&&view.opener||(view=window),view.getComputedStyle(elem)},swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret},documentElement=document.documentElement;!function(){function computeStyleTests(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",div.innerHTML="",documentElement.appendChild(container);var divStyle=window.getComputedStyle(div);pixelPositionVal="1%"!==divStyle.top,reliableMarginLeftVal="2px"===divStyle.marginLeft,boxSizingReliableVal="4px"===divStyle.width,div.style.marginRight="50%",pixelMarginRightVal="4px"===divStyle.marginRight,documentElement.removeChild(container)}var pixelPositionVal,boxSizingReliableVal,pixelMarginRightVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,container.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",container.appendChild(div),jQuery.extend(support,{pixelPosition:function(){return computeStyleTests(),pixelPositionVal},boxSizingReliable:function(){return null==boxSizingReliableVal&&computeStyleTests(),boxSizingReliableVal},pixelMarginRight:function(){return null==boxSizingReliableVal&&computeStyleTests(),pixelMarginRightVal},reliableMarginLeft:function(){return null==boxSizingReliableVal&&computeStyleTests(),reliableMarginLeftVal},reliableMarginRight:function(){var ret,marginDiv=div.appendChild(document.createElement("div"));return marginDiv.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",marginDiv.style.marginRight=marginDiv.style.width="0",div.style.width="1px",documentElement.appendChild(container),ret=!parseFloat(window.getComputedStyle(marginDiv).marginRight),documentElement.removeChild(container),div.removeChild(marginDiv),ret}}))}();var rdisplayswap=/^(none|table(?!-c[ea]).+)/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"],emptyStyle=document.createElement("div").style;jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(origName)||origName),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value?hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name]:(type=typeof value,"string"===type&&(ret=rcssNum.exec(value))&&ret[1]&&(value=adjustCSS(elem,name,ret),type="number"),void(null!=value&&value===value&&("number"===type&&(value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px")),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(style[name]=value))))}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(origName)||origName),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||isFinite(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?rdisplayswap.test(jQuery.css(elem,"display"))&&0===elem.offsetWidth?swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var matches,styles=extra&&getStyles(elem),subtract=extra&&augmentWidthOrHeight(elem,name,extra,"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles);return subtract&&(matches=rcssNum.exec(value))&&"px"!==(matches[3]||"px")&&(elem.style[name]=value,value=jQuery.css(elem,name)),setPositiveNumber(elem,value,subtract)}}}),jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){return computed?(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px":void 0}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){return computed?swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||jQuery.easing._default,this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return 1!==tween.elem.nodeType||null!=tween.elem[tween.prop]&&null==tween.elem.style[tween.prop]?tween.elem[tween.prop]:(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0)},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):1!==tween.elem.nodeType||null==tween.elem.style[jQuery.cssProps[tween.prop]]&&!jQuery.cssHooks[tween.prop]?tween.elem[tween.prop]=tween.now:jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},_default:"swing"},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);return adjustCSS(tween.elem,prop,rcssNum.exec(value),tween),tween}]},tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.match(rnotwhite);for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],Animation.tweeners[prop]=Animation.tweeners[prop]||[],Animation.tweeners[prop].unshift(callback)},prefilters:[defaultPrefilter],prefilter:function(callback,prepend){prepend?Animation.prefilters.unshift(callback):Animation.prefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,null!=opt.queue&&opt.queue!==!0||(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||dataPriv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));!dequeue&&gotoEnd||jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=window.setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){window.clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})},function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,select.disabled=!0,support.optDisabled=!opt.disabled,input=document.createElement("input"),input.value="t",input.type="radio",support.radioValue="t"===input.value}();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;return 3!==nType&&8!==nType&&2!==nType?"undefined"==typeof elem.getAttribute?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:void 0)),void 0!==value?null===value?void jQuery.removeAttr(elem,name):hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret)):void 0},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)&&(elem[propName]=!1),elem.removeAttribute(name)}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;return isXML||(handle=attrHandle[name],attrHandle[name]=ret,ret=null!=getter(elem,name,isXML)?name.toLowerCase():null,attrHandle[name]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;return 3!==nType&&8!==nType&&2!==nType?(1===nType&&jQuery.isXMLDoc(elem)||(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]):void 0},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null},set:function(elem){var parent=elem.parentNode;parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex)}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))});if("string"==typeof value&&value)for(classes=value.match(rnotwhite)||[];elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&(" "+curValue+" ").replace(rclass," ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=jQuery.trim(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof value&&value)for(classes=value.match(rnotwhite)||[];elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&(" "+curValue+" ").replace(rclass," ")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>-1;)cur=cur.replace(" "+clazz+" "," ");finalValue=jQuery.trim(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)}):this.each(function(){var className,i,self,classNames;if("string"===type)for(i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else void 0!==value&&"boolean"!==type||(className=getClass(this),className&&dataPriv.set(this,"__className__",className),this.setAttribute&&this.setAttribute("class",className||value===!1?"":dataPriv.get(this,"__className__")||""))})},hasClass:function(selector){var className,elem,i=0;for(className=" "+selector+" ";elem=this[i++];)if(1===elem.nodeType&&(" "+getClass(elem)+" ").replace(rclass," ").indexOf(className)>-1)return!0;return!1}});var rreturn=/\r/g,rspaces=/[\x20\t\r\n\f]+/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];return arguments.length?(isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))})):elem?(hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)):void 0}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:jQuery.trim(jQuery.text(elem)).replace(rspaces," ")}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],(option.selected||i===index)&&(support.optDisabled?!option.disabled:null===option.getAttribute("disabled"))&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1:void 0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/;jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>-1&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(dataPriv.get(cur,"events")||{})[event.type]&&dataPriv.get(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&special._default.apply(eventPath.pop(),data)!==!1||!acceptData(elem)||ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)&&(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,elem[type](),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0});jQuery.event.trigger(e,null,elem),e.isDefaultPrevented()&&event.preventDefault()}}),jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}}),support.focusin="onfocusin"in window,support.focusin||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix)-1;attaches?dataPriv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),dataPriv.remove(doc,fix))}}});var location=window.location,nonce=jQuery.now(),rquery=/\?/;jQuery.parseJSON=function(data){return JSON.parse(data+"")},jQuery.parseXML=function(data){var xml;if(!data||"string"!=typeof data)return null;try{xml=(new window.DOMParser).parseFromString(data,"text/xml")}catch(e){xml=void 0}return xml&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href,jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&window.clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,!status&&statusText||(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||location.href)+"").replace(rhash,"").replace(rprotocol,location.protocol+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""],null==s.crossDomain){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url,urlAnchor.href=urlAnchor.href,s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!=urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=!0}}if(s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=jQuery.event&&s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){if(jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),2===state)return jqXHR;s.async&&s.timeout>0&&(timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR;
},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapAll(html.call(this,i))}):(this[0]&&(wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this)},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(elem){return!jQuery.expr.filters.visible(elem)},jQuery.expr.filters.visible=function(elem){return elem.offsetWidth>0||elem.offsetHeight>0||elem.getClientRects().length>0};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback,errorCallback;return support.cors||xhrSupported&&!options.crossDomain?{send:function(headers,complete){var i,xhr=options.xhr();if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.onreadystatechange=null,"abort"===type?xhr.abort():"error"===type?"number"!=typeof xhr.status?complete(0,"error"):complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"text"!==(xhr.responseType||"text")||"string"!=typeof xhr.responseText?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders()))}},xhr.onload=callback(),errorCallback=xhr.onerror=callback("error"),void 0!==xhr.onabort?xhr.onabort=errorCallback:xhr.onreadystatechange=function(){4===xhr.readyState&&window.setTimeout(function(){callback&&errorCallback()})},callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}:void 0}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){void 0===overwritten?jQuery(window).removeProp(callbackName):window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"):void 0}),jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,type,response,self=this,off=url.indexOf(" ");return off>-1&&(selector=jQuery.trim(url.slice(off)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR])})}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length},jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,jQuery.extend({},curOffset))),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;return doc?(docElem=doc.documentElement,jQuery.contains(docElem,elem)?(box=elem.getBoundingClientRect(),win=getWindow(doc),{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}):box):void 0},position:function(){if(this[0]){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent;offsetParent&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||documentElement})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);return void 0===val?win?win[prop]:elem[method]:void(win?win.scrollTo(top?win.pageXOffset:val,top?val:win.pageYOffset):elem[method]=val)},method,val,arguments.length)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})}),jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)},size:function(){return this.length}}),jQuery.fn.andSelf=jQuery.fn.addBack,__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return jQuery}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__));var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},noGlobal||(window.jQuery=window.$=jQuery),jQuery})},function(module,exports,__webpack_require__){__webpack_require__(5),module.exports="ngSanitize"},function(module,exports){!function(window,angular){"use strict";function $SanitizeProvider(){var svgEnabled=!1;this.$get=["$$sanitizeUri",function($$sanitizeUri){return svgEnabled&&angular.extend(validElements,svgElements),function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe:/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}],this.enableSvg=function(enableSvg){return angular.isDefined(enableSvg)?(svgEnabled=enableSvg,this):svgEnabled}}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,angular.noop);return writer.chars(chars),buf.join("")}function toMap(str,lowercaseKeys){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[lowercaseKeys?angular.lowercase(items[i]):items[i]]=!0;return obj}function htmlParser(html,handler){null===html||void 0===html?html="":"string"!=typeof html&&(html=""+html),inertBodyElement.innerHTML=html;var mXSSAttempts=5;do{if(0===mXSSAttempts)throw $sanitizeMinErr("uinput","Failed to sanitize html because the input is unstable");mXSSAttempts--,window.document.documentMode&&stripCustomNsAttrs(inertBodyElement),html=inertBodyElement.innerHTML,inertBodyElement.innerHTML=html}while(html!==inertBodyElement.innerHTML);for(var node=inertBodyElement.firstChild;node;){switch(node.nodeType){case 1:handler.start(node.nodeName.toLowerCase(),attrToMap(node.attributes));break;case 3:handler.chars(node.textContent)}var nextNode;if(!(nextNode=node.firstChild)&&(1==node.nodeType&&handler.end(node.nodeName.toLowerCase()),nextNode=node.nextSibling,!nextNode))for(;null==nextNode&&(node=node.parentNode,node!==inertBodyElement);)nextNode=node.nextSibling,1==node.nodeType&&handler.end(node.nodeName.toLowerCase());node=nextNode}for(;node=inertBodyElement.firstChild;)inertBodyElement.removeChild(node)}function attrToMap(attrs){for(var map={},i=0,ii=attrs.length;ii>i;i++){var attr=attrs[i];map[attr.name]=attr.value}return map}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignoreCurrentElement=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs){tag=angular.lowercase(tag),!ignoreCurrentElement&&blockedElements[tag]&&(ignoreCurrentElement=tag),ignoreCurrentElement||validElements[tag]!==!0||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(">"))},end:function(tag){tag=angular.lowercase(tag),ignoreCurrentElement||validElements[tag]!==!0||voidElements[tag]===!0||(out("</"),out(tag),out(">")),tag==ignoreCurrentElement&&(ignoreCurrentElement=!1)},chars:function(chars){ignoreCurrentElement||out(encodeEntities(chars))}}}function stripCustomNsAttrs(node){if(node.nodeType===window.Node.ELEMENT_NODE)for(var attrs=node.attributes,i=0,l=attrs.length;l>i;i++){var attrNode=attrs[i],attrName=attrNode.name.toLowerCase();"xmlns:ns1"!==attrName&&0!==attrName.indexOf("ns1:")||(node.removeAttributeNode(attrNode),i--,l--)}var nextNode=node.firstChild;nextNode&&stripCustomNsAttrs(nextNode),nextNode=node.nextSibling,nextNode&&stripCustomNsAttrs(nextNode)}var inertBodyElement,$sanitizeMinErr=angular.$$minErr("$sanitize"),SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~ |!])/g,voidElements=toMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=toMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=toMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,toMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,toMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),svgElements=toMap("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),blockedElements=toMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements),uriAttrs=toMap("background,cite,href,longdesc,src,xlink:href"),htmlAttrs=toMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),svgAttrs=toMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),validAttrs=angular.extend({},uriAttrs,svgAttrs,htmlAttrs);!function(window){var doc;if(!window.document||!window.document.implementation)throw $sanitizeMinErr("noinert","Can't create an inert html document");doc=window.document.implementation.createHTMLDocument("inert");var docElement=doc.documentElement||doc.getDocumentElement(),bodyElements=docElement.getElementsByTagName("body");if(1===bodyElements.length)inertBodyElement=bodyElements[0];else{var html=doc.createElement("html");inertBodyElement=doc.createElement("body"),html.appendChild(inertBodyElement),doc.appendChild(html)}}(window),angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,MAILTO_REGEXP=/^mailto:/i,linkyMinErr=angular.$$minErr("linky"),isString=angular.isString;return function(text,target,attributes){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){var key;if(html.push("<a "),angular.isFunction(attributes)&&(attributes=attributes(url)),angular.isObject(attributes))for(key in attributes)html.push(key+'="'+attributes[key]+'" ');else attributes={};!angular.isDefined(target)||"target"in attributes||html.push('target="',target,'" '),html.push('href="',url.replace(/"/g,"&quot;"),'">'),addText(text),html.push("</a>")}if(null==text||""===text)return text;if(!isString(text))throw linkyMinErr("notstring","Expected string but received: {0}",text);for(var match,url,i,raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]||match[4]||(url=(match[3]?"http://":"mailto:")+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular)},function(module,exports,__webpack_require__){__webpack_require__(7),module.exports="ngRoute"},function(module,exports){!function(window,angular,undefined){"use strict";function $RouteProvider(){function inherit(parent,extra){return angular.extend(Object.create(parent),extra)}function pathRegExp(path,opts){var insensitive=opts.caseInsensitiveMatch,ret={originalPath:path,regexp:path},keys=ret.keys=[];return path=path.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[\?\*])?/g,function(_,slash,key,option){var optional="?"===option||"*?"===option?"?":null,star="*"===option||"*?"===option?"*":null;return keys.push({name:key,optional:!!optional}),slash=slash||"",""+(optional?"":slash)+"(?:"+(optional?slash:"")+(star&&"(.+?)"||"([^/]+)")+(optional||"")+")"+(optional||"")}).replace(/([\/$\*])/g,"\\$1"),ret.regexp=new RegExp("^"+path+"$",insensitive?"i":""),ret}var routes={};this.when=function(path,route){var routeCopy=angular.copy(route);if(angular.isUndefined(routeCopy.reloadOnSearch)&&(routeCopy.reloadOnSearch=!0),angular.isUndefined(routeCopy.caseInsensitiveMatch)&&(routeCopy.caseInsensitiveMatch=this.caseInsensitiveMatch),routes[path]=angular.extend(routeCopy,path&&pathRegExp(path,routeCopy)),path){var redirectPath="/"==path[path.length-1]?path.substr(0,path.length-1):path+"/";routes[redirectPath]=angular.extend({redirectTo:path},pathRegExp(redirectPath,routeCopy))}return this},this.caseInsensitiveMatch=!1,this.otherwise=function(params){return"string"==typeof params&&(params={redirectTo:params}),this.when(null,params),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce",function($rootScope,$location,$routeParams,$q,$injector,$templateRequest,$sce){function switchRouteMatcher(on,route){var keys=route.keys,params={};if(!route.regexp)return null;var m=route.regexp.exec(on);if(!m)return null;for(var i=1,len=m.length;len>i;++i){var key=keys[i-1],val=m[i];key&&val&&(params[key.name]=val)}return params}function prepareRoute($locationEvent){var lastRoute=$route.current;preparedRoute=parseRoute(),preparedRouteIsUpdateOnly=preparedRoute&&lastRoute&&preparedRoute.$$route===lastRoute.$$route&&angular.equals(preparedRoute.pathParams,lastRoute.pathParams)&&!preparedRoute.reloadOnSearch&&!forceReload,preparedRouteIsUpdateOnly||!lastRoute&&!preparedRoute||$rootScope.$broadcast("$routeChangeStart",preparedRoute,lastRoute).defaultPrevented&&$locationEvent&&$locationEvent.preventDefault()}function commitRoute(){var lastRoute=$route.current,nextRoute=preparedRoute;preparedRouteIsUpdateOnly?(lastRoute.params=nextRoute.params,angular.copy(lastRoute.params,$routeParams),$rootScope.$broadcast("$routeUpdate",lastRoute)):(nextRoute||lastRoute)&&(forceReload=!1,$route.current=nextRoute,nextRoute&&nextRoute.redirectTo&&(angular.isString(nextRoute.redirectTo)?$location.path(interpolate(nextRoute.redirectTo,nextRoute.params)).search(nextRoute.params).replace():$location.url(nextRoute.redirectTo(nextRoute.pathParams,$location.path(),$location.search())).replace()),$q.when(nextRoute).then(function(){if(nextRoute){var template,templateUrl,locals=angular.extend({},nextRoute.resolve);return angular.forEach(locals,function(value,key){locals[key]=angular.isString(value)?$injector.get(value):$injector.invoke(value,null,null,key)}),angular.isDefined(template=nextRoute.template)?angular.isFunction(template)&&(template=template(nextRoute.params)):angular.isDefined(templateUrl=nextRoute.templateUrl)&&(angular.isFunction(templateUrl)&&(templateUrl=templateUrl(nextRoute.params)),angular.isDefined(templateUrl)&&(nextRoute.loadedTemplateUrl=$sce.valueOf(templateUrl),template=$templateRequest(templateUrl))),angular.isDefined(template)&&(locals.$template=template),$q.all(locals)}}).then(function(locals){nextRoute==$route.current&&(nextRoute&&(nextRoute.locals=locals,angular.copy(nextRoute.params,$routeParams)),$rootScope.$broadcast("$routeChangeSuccess",nextRoute,lastRoute))},function(error){nextRoute==$route.current&&$rootScope.$broadcast("$routeChangeError",nextRoute,lastRoute,error)}))}function parseRoute(){var params,match;return angular.forEach(routes,function(route,path){!match&&(params=switchRouteMatcher($location.path(),route))&&(match=inherit(route,{params:angular.extend({},$location.search(),params),pathParams:params}),match.$$route=route)}),match||routes[null]&&inherit(routes[null],{params:{},pathParams:{}})}function interpolate(string,params){var result=[];return angular.forEach((string||"").split(":"),function(segment,i){if(0===i)result.push(segment);else{var segmentMatch=segment.match(/(\w+)(?:[?*])?(.*)/),key=segmentMatch[1];result.push(params[key]),result.push(segmentMatch[2]||""),delete params[key]}}),result.join("")}var preparedRoute,preparedRouteIsUpdateOnly,forceReload=!1,$route={routes:routes,reload:function(){forceReload=!0;var fakeLocationEvent={defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0,forceReload=!1}};$rootScope.$evalAsync(function(){prepareRoute(fakeLocationEvent),fakeLocationEvent.defaultPrevented||commitRoute()})},updateParams:function(newParams){if(!this.current||!this.current.$$route)throw $routeMinErr("norout","Tried updating route when with no current route");newParams=angular.extend({},this.current.params,newParams),$location.path(interpolate(this.current.$$route.originalPath,newParams)),$location.search(newParams)}};return $rootScope.$on("$locationChangeStart",prepareRoute),$rootScope.$on("$locationChangeSuccess",commitRoute),$route}]}function $RouteParamsProvider(){this.$get=function(){return{}}}function ngViewFactory($route,$anchorScroll,$animate){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(scope,$element,attr,ctrl,$transclude){function cleanupLastView(){previousLeaveAnimation&&($animate.cancel(previousLeaveAnimation),previousLeaveAnimation=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&(previousLeaveAnimation=$animate.leave(currentElement),previousLeaveAnimation.then(function(){previousLeaveAnimation=null}),currentElement=null)}function update(){var locals=$route.current&&$route.current.locals,template=locals&&locals.$template;if(angular.isDefined(template)){var newScope=scope.$new(),current=$route.current,clone=$transclude(newScope,function(clone){$animate.enter(clone,null,currentElement||$element).then(function(){!angular.isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()}),cleanupLastView()});currentElement=clone,currentScope=current.scope=newScope,currentScope.$emit("$viewContentLoaded"),currentScope.$eval(onloadExp)}else cleanupLastView()}var currentScope,currentElement,previousLeaveAnimation,autoScrollExp=attr.autoscroll,onloadExp=attr.onload||"";scope.$on("$routeChangeSuccess",update),update()}}}function ngViewFillContentFactory($compile,$controller,$route){return{restrict:"ECA",priority:-400,link:function(scope,$element){var current=$route.current,locals=current.locals;$element.html(locals.$template);var link=$compile($element.contents());if(current.controller){locals.$scope=scope;var controller=$controller(current.controller,locals);current.controllerAs&&(scope[current.controllerAs]=controller),$element.data("$ngControllerController",controller),$element.children().data("$ngControllerController",controller)}scope[current.resolveAs||"$resolve"]=locals,link(scope)}}}var ngRouteModule=angular.module("ngRoute",["ng"]).provider("$route",$RouteProvider).run(["$route",angular.noop]),$routeMinErr=angular.$$minErr("ngRoute");ngRouteModule.provider("$routeParams",$RouteParamsProvider),ngRouteModule.directive("ngView",ngViewFactory),ngRouteModule.directive("ngView",ngViewFillContentFactory),ngViewFactory.$inject=["$route","$anchorScroll","$animate"],ngViewFillContentFactory.$inject=["$compile","$controller","$route"]}(window,window.angular)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(root,factory){"undefined"!=typeof module&&module.exports?(factory("undefined"==typeof angular?__webpack_require__(1):angular),module.exports="ngDialog"):(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1)],__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}(this,function(angular){"use strict";var m=angular.module("ngDialog",[]),$el=angular.element,isDef=angular.isDefined,style=(document.body||document.documentElement).style,animationEndSupport=isDef(style.animation)||isDef(style.WebkitAnimation)||isDef(style.MozAnimation)||isDef(style.MsAnimation)||isDef(style.OAnimation),animationEndEvent="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",focusableElementSelector="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",disabledAnimationClass="ngdialog-disabled-animation",forceElementsReload={html:!1,body:!1},scopes={},openIdStack=[],keydownIsBound=!1,openOnePerName=!1;return m.provider("ngDialog",function(){var defaults=this.defaults={className:"ngdialog-theme-default",appendClassName:"",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null,bodyClassName:"ngdialog-open"};this.setForceHtmlReload=function(_useIt){forceElementsReload.html=_useIt||!1},this.setForceBodyReload=function(_useIt){forceElementsReload.body=_useIt||!1},this.setDefaults=function(newDefaults){angular.extend(defaults,newDefaults)},this.setOpenOnePerName=function(isOpenOne){openOnePerName=isOpenOne||!1};var closeByDocumentHandler,globalID=0,dialogsCount=0,defers={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function($document,$templateCache,$compile,$q,$http,$rootScope,$timeout,$window,$controller,$injector){var $elements=[],privateMethods={onDocumentKeydown:function(event){27===event.keyCode&&publicMethods.close("$escape")},activate:function($dialog){var options=$dialog.data("$ngDialogOptions");options.trapFocus&&($dialog.on("keydown",privateMethods.onTrapFocusKeydown),$elements.body.on("keydown",privateMethods.onTrapFocusKeydown))},deactivate:function($dialog){$dialog.off("keydown",privateMethods.onTrapFocusKeydown),
$elements.body.off("keydown",privateMethods.onTrapFocusKeydown)},deactivateAll:function(els){angular.forEach(els,function(el){var $dialog=angular.element(el);privateMethods.deactivate($dialog)})},setBodyPadding:function(width){var originalBodyPadding=parseInt($elements.body.css("padding-right")||0,10);$elements.body.css("padding-right",originalBodyPadding+width+"px"),$elements.body.data("ng-dialog-original-padding",originalBodyPadding),$rootScope.$broadcast("ngDialog.setPadding",width)},resetBodyPadding:function(){var originalBodyPadding=$elements.body.data("ng-dialog-original-padding");originalBodyPadding?$elements.body.css("padding-right",originalBodyPadding+"px"):$elements.body.css("padding-right",""),$rootScope.$broadcast("ngDialog.setPadding",0)},performCloseDialog:function($dialog,value){var options=$dialog.data("$ngDialogOptions"),id=$dialog.attr("id"),scope=scopes[id];if(scope){if("undefined"!=typeof $window.Hammer){var hammerTime=scope.hammerTime;hammerTime.off("tap",closeByDocumentHandler),hammerTime.destroy&&hammerTime.destroy(),delete scope.hammerTime}else $dialog.unbind("click");1===dialogsCount&&$elements.body.unbind("keydown",privateMethods.onDocumentKeydown),$dialog.hasClass("ngdialog-closing")||(dialogsCount-=1);var previousFocus=$dialog.data("$ngDialogPreviousFocus");previousFocus&&previousFocus.focus&&previousFocus.focus(),$rootScope.$broadcast("ngDialog.closing",$dialog,value),dialogsCount=0>dialogsCount?0:dialogsCount,animationEndSupport&&!options.disableAnimation?(scope.$destroy(),$dialog.unbind(animationEndEvent).bind(animationEndEvent,function(){privateMethods.closeDialogElement($dialog,value)}).addClass("ngdialog-closing")):(scope.$destroy(),privateMethods.closeDialogElement($dialog,value)),defers[id]&&(defers[id].resolve({id:id,value:value,$dialog:$dialog,remainingDialogs:dialogsCount}),delete defers[id]),scopes[id]&&delete scopes[id],openIdStack.splice(openIdStack.indexOf(id),1),openIdStack.length||($elements.body.unbind("keydown",privateMethods.onDocumentKeydown),keydownIsBound=!1)}},closeDialogElement:function($dialog,value){var options=$dialog.data("$ngDialogOptions");$dialog.remove(),0===dialogsCount&&($elements.html.removeClass(options.bodyClassName),$elements.body.removeClass(options.bodyClassName),privateMethods.resetBodyPadding()),$rootScope.$broadcast("ngDialog.closed",$dialog,value)},closeDialog:function($dialog,value){var preCloseCallback=$dialog.data("$ngDialogPreCloseCallback");if(preCloseCallback&&angular.isFunction(preCloseCallback)){var preCloseCallbackResult=preCloseCallback.call($dialog,value);angular.isObject(preCloseCallbackResult)?preCloseCallbackResult.closePromise?preCloseCallbackResult.closePromise.then(function(){privateMethods.performCloseDialog($dialog,value)}):preCloseCallbackResult.then(function(){privateMethods.performCloseDialog($dialog,value)},function(){}):preCloseCallbackResult!==!1&&privateMethods.performCloseDialog($dialog,value)}else privateMethods.performCloseDialog($dialog,value)},onTrapFocusKeydown:function(ev){var $dialog,el=angular.element(ev.currentTarget);if(el.hasClass("ngdialog"))$dialog=el;else if($dialog=privateMethods.getActiveDialog(),null===$dialog)return;var isTab=9===ev.keyCode,backward=ev.shiftKey===!0;isTab&&privateMethods.handleTab($dialog,ev,backward)},handleTab:function($dialog,ev,backward){var focusableElements=privateMethods.getFocusableElements($dialog);if(0===focusableElements.length)return void(document.activeElement&&document.activeElement.blur());var currentFocus=document.activeElement,focusIndex=Array.prototype.indexOf.call(focusableElements,currentFocus),isFocusIndexUnknown=-1===focusIndex,isFirstElementFocused=0===focusIndex,isLastElementFocused=focusIndex===focusableElements.length-1,cancelEvent=!1;backward?(isFocusIndexUnknown||isFirstElementFocused)&&(focusableElements[focusableElements.length-1].focus(),cancelEvent=!0):(isFocusIndexUnknown||isLastElementFocused)&&(focusableElements[0].focus(),cancelEvent=!0),cancelEvent&&(ev.preventDefault(),ev.stopPropagation())},autoFocus:function($dialog){var dialogEl=$dialog[0],autoFocusEl=dialogEl.querySelector("*[autofocus]");if(null===autoFocusEl||(autoFocusEl.focus(),document.activeElement!==autoFocusEl)){var focusableElements=privateMethods.getFocusableElements($dialog);if(focusableElements.length>0)return void focusableElements[0].focus();var contentElements=privateMethods.filterVisibleElements(dialogEl.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(contentElements.length>0){var contentElement=contentElements[0];$el(contentElement).attr("tabindex","-1").css("outline","0"),contentElement.focus()}}},getFocusableElements:function($dialog){var dialogEl=$dialog[0],rawElements=dialogEl.querySelectorAll(focusableElementSelector),tabbableElements=privateMethods.filterTabbableElements(rawElements);return privateMethods.filterVisibleElements(tabbableElements)},filterTabbableElements:function(els){for(var tabbableFocusableElements=[],i=0;i<els.length;i++){var el=els[i];"-1"!==$el(el).attr("tabindex")&&tabbableFocusableElements.push(el)}return tabbableFocusableElements},filterVisibleElements:function(els){for(var visibleFocusableElements=[],i=0;i<els.length;i++){var el=els[i];(el.offsetWidth>0||el.offsetHeight>0)&&visibleFocusableElements.push(el)}return visibleFocusableElements},getActiveDialog:function(){var dialogs=document.querySelectorAll(".ngdialog");return 0===dialogs.length?null:$el(dialogs[dialogs.length-1])},applyAriaAttributes:function($dialog,options){if(options.ariaAuto){if(!options.ariaRole){var detectedRole=privateMethods.getFocusableElements($dialog).length>0?"dialog":"alertdialog";options.ariaRole=detectedRole}options.ariaLabelledBySelector||(options.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),options.ariaDescribedBySelector||(options.ariaDescribedBySelector="article,section,p")}options.ariaRole&&$dialog.attr("role",options.ariaRole),privateMethods.applyAriaAttribute($dialog,"aria-labelledby",options.ariaLabelledById,options.ariaLabelledBySelector),privateMethods.applyAriaAttribute($dialog,"aria-describedby",options.ariaDescribedById,options.ariaDescribedBySelector)},applyAriaAttribute:function($dialog,attr,id,selector){if(id&&$dialog.attr(attr,id),selector){var dialogId=$dialog.attr("id"),firstMatch=$dialog[0].querySelector(selector);if(!firstMatch)return;var generatedId=dialogId+"-"+attr;return $el(firstMatch).attr("id",generatedId),$dialog.attr(attr,generatedId),generatedId}},detectUIRouter:function(){try{return angular.module("ui.router"),!0}catch(err){return!1}},getRouterLocationEventName:function(){return privateMethods.detectUIRouter()?"$stateChangeSuccess":"$locationChangeSuccess"}},publicMethods={__PRIVATE__:privateMethods,open:function(opts){function loadTemplateUrl(tmpl,config){return $rootScope.$broadcast("ngDialog.templateLoading",tmpl),$http.get(tmpl,config||{}).then(function(res){return $rootScope.$broadcast("ngDialog.templateLoaded",tmpl),res.data||""})}function loadTemplate(tmpl){return tmpl?angular.isString(tmpl)&&options.plain?tmpl:"boolean"!=typeof options.cache||options.cache?loadTemplateUrl(tmpl,{cache:$templateCache}):loadTemplateUrl(tmpl,{cache:!1}):"Empty template"}var dialogID=null;if(opts=opts||{},!(openOnePerName&&opts.name&&(dialogID=opts.name+" dialog",this.isOpen(dialogID)))){var options=angular.copy(defaults),localID=++globalID;dialogID=dialogID||"ngdialog"+localID,openIdStack.push(dialogID),"undefined"!=typeof options.data&&("undefined"==typeof opts.data&&(opts.data={}),opts.data=angular.merge(angular.copy(options.data),opts.data)),angular.extend(options,opts);var defer;defers[dialogID]=defer=$q.defer();var scope;scopes[dialogID]=scope=angular.isObject(options.scope)?options.scope.$new():$rootScope.$new();var $dialog,$dialogParent,resolve=angular.extend({},options.resolve);return angular.forEach(resolve,function(value,key){resolve[key]=angular.isString(value)?$injector.get(value):$injector.invoke(value,null,null,key)}),$q.all({template:loadTemplate(options.template||options.templateUrl),locals:$q.all(resolve)}).then(function(setup){var template=setup.template,locals=setup.locals;options.showClose&&(template+='<div class="ngdialog-close"></div>');var hasOverlayClass=options.overlay?"":" ngdialog-no-overlay";if($dialog=$el('<div id="'+dialogID+'" class="ngdialog'+hasOverlayClass+'"></div>'),$dialog.html(options.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+template+"</div>":'<div class="ngdialog-content" role="document">'+template+"</div>"),$dialog.data("$ngDialogOptions",options),scope.ngDialogId=dialogID,options.data&&angular.isString(options.data)){var firstLetter=options.data.replace(/^\s*/,"")[0];scope.ngDialogData="{"===firstLetter||"["===firstLetter?angular.fromJson(options.data):new String(options.data),scope.ngDialogData.ngDialogId=dialogID}else options.data&&angular.isObject(options.data)&&(scope.ngDialogData=options.data,scope.ngDialogData.ngDialogId=dialogID);if(options.className&&$dialog.addClass(options.className),options.appendClassName&&$dialog.addClass(options.appendClassName),options.disableAnimation&&$dialog.addClass(disabledAnimationClass),$dialogParent=options.appendTo&&angular.isString(options.appendTo)?angular.element(document.querySelector(options.appendTo)):$elements.body,privateMethods.applyAriaAttributes($dialog,options),options.preCloseCallback){var preCloseCallback;angular.isFunction(options.preCloseCallback)?preCloseCallback=options.preCloseCallback:angular.isString(options.preCloseCallback)&&scope&&(angular.isFunction(scope[options.preCloseCallback])?preCloseCallback=scope[options.preCloseCallback]:scope.$parent&&angular.isFunction(scope.$parent[options.preCloseCallback])?preCloseCallback=scope.$parent[options.preCloseCallback]:$rootScope&&angular.isFunction($rootScope[options.preCloseCallback])&&(preCloseCallback=$rootScope[options.preCloseCallback])),preCloseCallback&&$dialog.data("$ngDialogPreCloseCallback",preCloseCallback)}if(scope.closeThisDialog=function(value){privateMethods.closeDialog($dialog,value)},options.controller&&(angular.isString(options.controller)||angular.isArray(options.controller)||angular.isFunction(options.controller))){var label;options.controllerAs&&angular.isString(options.controllerAs)&&(label=options.controllerAs);var controllerInstance=$controller(options.controller,angular.extend(locals,{$scope:scope,$element:$dialog}),!0,label);options.bindToController&&angular.extend(controllerInstance.instance,{ngDialogId:scope.ngDialogId,ngDialogData:scope.ngDialogData,closeThisDialog:scope.closeThisDialog}),$dialog.data("$ngDialogControllerController",controllerInstance())}if($timeout(function(){var $activeDialogs=document.querySelectorAll(".ngdialog");privateMethods.deactivateAll($activeDialogs),$compile($dialog)(scope);var widthDiffs=$window.innerWidth-$elements.body.prop("clientWidth");$elements.html.addClass(options.bodyClassName),$elements.body.addClass(options.bodyClassName);var scrollBarWidth=widthDiffs-($window.innerWidth-$elements.body.prop("clientWidth"));scrollBarWidth>0&&privateMethods.setBodyPadding(scrollBarWidth),$dialogParent.append($dialog),privateMethods.activate($dialog),options.trapFocus&&privateMethods.autoFocus($dialog),options.name?$rootScope.$broadcast("ngDialog.opened",{dialog:$dialog,name:options.name}):$rootScope.$broadcast("ngDialog.opened",$dialog)}),keydownIsBound||($elements.body.bind("keydown",privateMethods.onDocumentKeydown),keydownIsBound=!0),options.closeByNavigation){var eventName=privateMethods.getRouterLocationEventName();$rootScope.$on(eventName,function(){privateMethods.closeDialog($dialog)})}if(options.preserveFocus&&$dialog.data("$ngDialogPreviousFocus",document.activeElement),closeByDocumentHandler=function(event){var isOverlay=options.closeByDocument?$el(event.target).hasClass("ngdialog-overlay"):!1,isCloseBtn=$el(event.target).hasClass("ngdialog-close");(isOverlay||isCloseBtn)&&publicMethods.close($dialog.attr("id"),isCloseBtn?"$closeButton":"$document")},"undefined"!=typeof $window.Hammer){var hammerTime=scope.hammerTime=$window.Hammer($dialog[0]);hammerTime.on("tap",closeByDocumentHandler)}else $dialog.bind("click",closeByDocumentHandler);return dialogsCount+=1,publicMethods}),{id:dialogID,closePromise:defer.promise,close:function(value){privateMethods.closeDialog($dialog,value)}}}},openConfirm:function(opts){var defer=$q.defer(),options=angular.copy(defaults);opts=opts||{},"undefined"!=typeof options.data&&("undefined"==typeof opts.data&&(opts.data={}),opts.data=angular.merge(angular.copy(options.data),opts.data)),angular.extend(options,opts),options.scope=angular.isObject(options.scope)?options.scope.$new():$rootScope.$new(),options.scope.confirm=function(value){defer.resolve(value);var $dialog=$el(document.getElementById(openResult.id));privateMethods.performCloseDialog($dialog,value)};var openResult=publicMethods.open(options);return openResult?(openResult.closePromise.then(function(data){return data?defer.reject(data.value):defer.reject()}),defer.promise):void 0},isOpen:function(id){var $dialog=$el(document.getElementById(id));return $dialog.length>0},close:function(id,value){var $dialog=$el(document.getElementById(id));if($dialog.length)privateMethods.closeDialog($dialog,value);else if("$escape"===id){var topDialogId=openIdStack[openIdStack.length-1];$dialog=$el(document.getElementById(topDialogId)),$dialog.data("$ngDialogOptions").closeByEscape&&privateMethods.closeDialog($dialog,"$escape")}else publicMethods.closeAll(value);return publicMethods},closeAll:function(value){for(var $all=document.querySelectorAll(".ngdialog"),i=$all.length-1;i>=0;i--){var dialog=$all[i];privateMethods.closeDialog($el(dialog),value)}},getOpenDialogs:function(){return openIdStack},getDefaults:function(){return defaults}};return angular.forEach(["html","body"],function(elementName){if($elements[elementName]=$document.find(elementName),forceElementsReload[elementName]){var eventName=privateMethods.getRouterLocationEventName();$rootScope.$on(eventName,function(){$elements[elementName]=$document.find(elementName)})}}),publicMethods}]}),m.directive("ngDialog",["ngDialog",function(ngDialog){return{restrict:"A",scope:{ngDialogScope:"="},link:function(scope,elem,attrs){elem.on("click",function(e){e.preventDefault();var ngDialogScope=angular.isDefined(scope.ngDialogScope)?scope.ngDialogScope:"noScope";angular.isDefined(attrs.ngDialogClosePrevious)&&ngDialog.close(attrs.ngDialogClosePrevious);var defaults=ngDialog.getDefaults();ngDialog.open({template:attrs.ngDialog,className:attrs.ngDialogClass||defaults.className,appendClassName:attrs.ngDialogAppendClass,controller:attrs.ngDialogController,controllerAs:attrs.ngDialogControllerAs,bindToController:attrs.ngDialogBindToController,scope:ngDialogScope,data:attrs.ngDialogData,showClose:"false"===attrs.ngDialogShowClose?!1:"true"===attrs.ngDialogShowClose?!0:defaults.showClose,closeByDocument:"false"===attrs.ngDialogCloseByDocument?!1:"true"===attrs.ngDialogCloseByDocument?!0:defaults.closeByDocument,closeByEscape:"false"===attrs.ngDialogCloseByEscape?!1:"true"===attrs.ngDialogCloseByEscape?!0:defaults.closeByEscape,overlay:"false"===attrs.ngDialogOverlay?!1:"true"===attrs.ngDialogOverlay?!0:defaults.overlay,preCloseCallback:attrs.ngDialogPreCloseCallback||defaults.preCloseCallback,bodyClassName:attrs.ngDialogBodyClass||defaults.bodyClassName})})}}}]),m})},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_navbar=__webpack_require__(10),_navbar2=_interopRequireDefault(_navbar),_header=__webpack_require__(18),_header2=_interopRequireDefault(_header);exports["default"]=_angular2["default"].module("pgcComponents",[_navbar2["default"].name,_header2["default"].name])},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_navbar=__webpack_require__(11),_navbar2=_interopRequireDefault(_navbar),navbarModule=_angular2["default"].module("navbar",[]).component("navbar",_navbar2["default"]);exports["default"]=navbarModule},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _navbar=__webpack_require__(12),_navbar2=_interopRequireDefault(_navbar),_navbar3=__webpack_require__(13),_navbar4=_interopRequireDefault(_navbar3);__webpack_require__(14);var navbarComponent={restrict:"E",bindings:{},template:_navbar2["default"],controller:_navbar4["default"],controllerAs:"vm"};exports["default"]=navbarComponent},function(module,exports){module.exports='<aside class="sidebar">\n  <a ng-class="{ active: vm.isActive(nav.url)}" href="{{nav.url}}" ng-repeat="nav in vm.menuList"><i class="icon {{nav.icon}}"></i>{{nav.name}}</a>\n</aside>'},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),NavbarController=function(){function NavbarController($location){_classCallCheck(this,NavbarController),this.$location=$location,this.menuList=[{url:"#/",name:"写文章",icon:"art"},{url:"#/published/",name:"已发布文章",icon:"list"}],PGC.Video&&this.menuList.push({url:"#/videolib/",name:"媒体库",icon:"media"})}return _createClass(NavbarController,[{key:"isActive",value:function(viewLocation){var $location=this.$location;return viewLocation.replace("#","")===$location.path()}}]),NavbarController}();NavbarController.$inject=["$location"],exports["default"]=NavbarController},function(module,exports,__webpack_require__){var content=__webpack_require__(15);"string"==typeof content&&(content=[[module.id,content,""]]),__webpack_require__(17)(content,{}),content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(16)(),exports.push([module.id,".sidebar{background-color:#fefefe;width:205px;float:left}.sidebar.hidden{width:0;overflow:hidden}.sidebar a{display:block;height:48px;line-height:48px;font-size:14px;padding-left:55px;color:#666;position:relative;box-sizing:border-box}.sidebar a:hover{background-color:#f1f1f1}.sidebar a i{position:absolute;left:12px;top:8px}.sidebar a.active{color:#fff;background-color:#fc8383}",""])},function(module,exports){module.exports=function(){var list=[];return list.toString=function(){for(var result=[],i=0;i<this.length;i++){var item=this[i];item[2]?result.push("@media "+item[2]+"{"+item[1]+"}"):result.push(item[1])}return result.join("")},list.i=function(modules,mediaQuery){"string"==typeof modules&&(modules=[[null,modules,""]]);for(var alreadyImportedModules={},i=0;i<this.length;i++){var id=this[i][0];"number"==typeof id&&(alreadyImportedModules[id]=!0)}for(i=0;i<modules.length;i++){var item=modules[i];"number"==typeof item[0]&&alreadyImportedModules[item[0]]||(mediaQuery&&!item[2]?item[2]=mediaQuery:mediaQuery&&(item[2]="("+item[2]+") and ("+mediaQuery+")"),list.push(item))}},list}},function(module,exports,__webpack_require__){function addStylesToDom(styles,options){for(var i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j](item.parts[j]);for(;j<item.parts.length;j++)domStyle.parts.push(addStyle(item.parts[j],options))}else{for(var parts=[],j=0;j<item.parts.length;j++)parts.push(addStyle(item.parts[j],options));stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function listToStyles(list){for(var styles=[],newStyles={},i=0;i<list.length;i++){var item=list[i],id=item[0],css=item[1],media=item[2],sourceMap=item[3],part={css:css,media:media,sourceMap:sourceMap};newStyles[id]?newStyles[id].parts.push(part):styles.push(newStyles[id]={id:id,parts:[part]})}return styles}function insertStyleElement(options,styleElement){var head=getHeadElement(),lastStyleElementInsertedAtTop=styleElementsInsertedAtTop[styleElementsInsertedAtTop.length-1];if("top"===options.insertAt)lastStyleElementInsertedAtTop?lastStyleElementInsertedAtTop.nextSibling?head.insertBefore(styleElement,lastStyleElementInsertedAtTop.nextSibling):head.appendChild(styleElement):head.insertBefore(styleElement,head.firstChild),styleElementsInsertedAtTop.push(styleElement);else{if("bottom"!==options.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");head.appendChild(styleElement)}}function removeStyleElement(styleElement){styleElement.parentNode.removeChild(styleElement);var idx=styleElementsInsertedAtTop.indexOf(styleElement);idx>=0&&styleElementsInsertedAtTop.splice(idx,1)}function createStyleElement(options){var styleElement=document.createElement("style");return styleElement.type="text/css",insertStyleElement(options,styleElement),styleElement}function createLinkElement(options){var linkElement=document.createElement("link");return linkElement.rel="stylesheet",insertStyleElement(options,linkElement),linkElement}function addStyle(obj,options){var styleElement,update,remove;if(options.singleton){var styleIndex=singletonCounter++;styleElement=singletonElement||(singletonElement=createStyleElement(options)),update=applyToSingletonTag.bind(null,styleElement,styleIndex,!1),remove=applyToSingletonTag.bind(null,styleElement,styleIndex,!0)}else obj.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(styleElement=createLinkElement(options),update=updateLink.bind(null,styleElement),remove=function(){removeStyleElement(styleElement),styleElement.href&&URL.revokeObjectURL(styleElement.href)}):(styleElement=createStyleElement(options),update=applyToTag.bind(null,styleElement),remove=function(){removeStyleElement(styleElement)});return update(obj),function(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}function applyToSingletonTag(styleElement,index,remove,obj){var css=remove?"":obj.css;if(styleElement.styleSheet)styleElement.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=styleElement.childNodes;childNodes[index]&&styleElement.removeChild(childNodes[index]),childNodes.length?styleElement.insertBefore(cssNode,childNodes[index]):styleElement.appendChild(cssNode)}}function applyToTag(styleElement,obj){var css=obj.css,media=obj.media;if(obj.sourceMap,media&&styleElement.setAttribute("media",media),styleElement.styleSheet)styleElement.styleSheet.cssText=css;else{for(;styleElement.firstChild;)styleElement.removeChild(styleElement.firstChild);styleElement.appendChild(document.createTextNode(css))}}function updateLink(linkElement,obj){var css=obj.css,sourceMap=(obj.media,obj.sourceMap);sourceMap&&(css+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */");var blob=new Blob([css],{type:"text/css"}),oldSrc=linkElement.href;linkElement.href=URL.createObjectURL(blob),oldSrc&&URL.revokeObjectURL(oldSrc)}var stylesInDom={},memoize=function(fn){var memo;return function(){return"undefined"==typeof memo&&(memo=fn.apply(this,arguments)),memo}},isOldIE=memoize(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),getHeadElement=memoize(function(){return document.head||document.getElementsByTagName("head")[0]}),singletonElement=null,singletonCounter=0,styleElementsInsertedAtTop=[];module.exports=function(list,options){options=options||{},"undefined"==typeof options.singleton&&(options.singleton=isOldIE()),"undefined"==typeof options.insertAt&&(options.insertAt="bottom");var styles=listToStyles(list);return addStylesToDom(styles,options),function(newList){for(var mayRemove=[],i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];domStyle.refs--,mayRemove.push(domStyle)}if(newList){var newStyles=listToStyles(newList);addStylesToDom(newStyles,options)}for(var i=0;i<mayRemove.length;i++){var domStyle=mayRemove[i];if(0===domStyle.refs){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}}};var replaceText=function(){var textStore=[];return function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")}}()},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_header=__webpack_require__(19),_header2=_interopRequireDefault(_header),headerModule=_angular2["default"].module("header",[]).component("header",_header2["default"]);exports["default"]=headerModule},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _header=__webpack_require__(20),_header2=_interopRequireDefault(_header),_header3=__webpack_require__(21),_header4=_interopRequireDefault(_header3);__webpack_require__(23);var headerComponent={restrict:"E",bindings:{},template:_header2["default"],controller:_header4["default"],controllerAs:"vm"};exports["default"]=headerComponent},function(module,exports){module.exports='<div id="header">\n  <nav class="nav-bar">\n    <a class="logo" href="#/"></a>\n    <div class="userinfo">\n      <a href="/people/?user_id={{vm.user.ID}}" target="_blank">\n        <img ng-src="{{vm.user.smallAvatar}}" class="pg-avatar"> {{vm.user.username}}\n        <img ng-if="vm.user.isCertifyUser" class="avatar-v" src="http://img4q.duitang.com/uploads/people/201512/21/20151221104700_QMmu5.png" />\n      </a>\n    </div>\n  </nav>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _dtTools=__webpack_require__(22),_dtTools2=_interopRequireDefault(_dtTools),HeaderController=function HeaderController(){_classCallCheck(this,HeaderController),"undefind"!=typeof window.USER&&(window.USER.smallAvatar=_dtTools2["default"].dtImageTrans(window.USER.smallAvatar,!0,80,80,"c"),this.user=window.USER)};exports["default"]=HeaderController},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;(function(global){!function(root,factory){__WEBPACK_AMD_DEFINE_RESULT__=function(){return root.DtTools=factory()}.call(exports,__webpack_require__,exports,module),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}(this||global,function(){var DtTools={};return DtTools.VERSION="0.0.1",DtTools.dtImageTrans=function(url,t,w,h,c){var pathn=url.trim().replace(/^http(s)?:\/\//gi,""),pathn_array=pathn.split("/");return pathn_array[0],pathn_array[1],t?(w=w||0,h=h||0,c=c?"_"+c:"",this.dtImageTrans(url).replace(/(\.[a-z_]+)$/gi,".thumb."+w+"_"+h+c+"$1")):url.replace(/(?:\.thumb\.\w+|\.[a-z]+!\w+)(\.[a-z_]+)$/gi,"$1")},DtTools.dtUriTrans=function(uri,data){if(void 0==data)return uri;var uriParamArray=[];for(var key in data){var a=key+"="+data[key];uriParamArray.push(a)}var uriParam=uriParamArray.join("&"),newUri=uri+"?"+uriParam||"";return newUri},DtTools.getParams=function(url){url||(url=window.location.href);var name,value,i,opts={};url=url.split("#")[0];for(var idx=url.indexOf("?"),search=idx>-1?url.substr(idx+1):"",arrtmp=search.split("&"),i=0;i<arrtmp.length;i++){var paramCount=arrtmp[i].indexOf("=");if(paramCount>0){name=arrtmp[i].substring(0,paramCount),value=arrtmp[i].substr(paramCount+1);try{value.indexOf("+")>-1&&(value=value.replace(/\+/g," ")),opts[name]=decodeURIComponent(value)}catch(exp){}}}return opts},DtTools.addParam=function(url,param,value){var re=new RegExp("([&\\?])"+param+"=[^& ]*","g");url=url.replace(re,function(a,b){return"?"==b?"?":""});var idx=url.indexOf("?");return url+=(idx>-1?idx+1!=url.length?"&":"":"?")+param+"="+value},DtTools})}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){var content=__webpack_require__(24);"string"==typeof content&&(content=[[module.id,content,""]]),__webpack_require__(17)(content,{}),content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(16)(),exports.push([module.id,'.nav-bar{position:fixed;width:100%;left:0;top:0;z-index:999;background-color:#fff;margin:0;height:65px;border-bottom:1px solid #e3e3e3;padding:0 60px;box-sizing:border-box}.nav-bar .logo{float:left;background:url("http://img3.duitang.com/uploads/people/201605/04/20160504140920_f4MJH.png") 0 no-repeat;width:160px;height:100%}.nav-bar .userinfo{position:relative;float:right}.nav-bar .userinfo .avatar-v{position:absolute;width:13px;height:13px;left:25px;top:40px}.nav-bar .userinfo img{display:inline-block;vertical-align:middle;width:38px;height:38px;border-radius:50%;-webkit-border-radius:50%;-moz-border-radius:50%;margin-right:16px}.nav-bar .userinfo a{font-size:14px;color:#666;text-decoration:none;display:block;line-height:64px}',""])},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function postTransform($httpProvider){$httpProvider.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8",$httpProvider.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var param=function param(obj){var name,value,fullSubName,subName,subValue,innerObj,i,query="";for(name in obj)if(value=obj[name],value instanceof Array)for(i=0;i<value.length;++i)subValue=value[i],fullSubName=name+"["+i+"]",innerObj={},innerObj[fullSubName]=subValue,query+=param(innerObj)+"&";else if(value instanceof Object)for(subName in value)subValue=value[subName],fullSubName=name+"["+subName+"]",innerObj={},innerObj[fullSubName]=subValue,query+=param(innerObj)+"&";else void 0!==value&&null!==value&&(query+=encodeURIComponent(name)+"="+encodeURIComponent(value)+"&");return query.length?query.substr(0,query.length-1):query};$httpProvider.defaults.transformRequest=[function(data){return _angular2["default"].isObject(data)&&"[object File]"!==String(data)?param(data):data}]}Object.defineProperty(exports,"__esModule",{value:!0});var _angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_base=__webpack_require__(26),_base2=_interopRequireDefault(_base),_articleDraft=__webpack_require__(27),_articleDraft2=_interopRequireDefault(_articleDraft),_articlePublised=__webpack_require__(28),_articlePublised2=_interopRequireDefault(_articlePublised),_videoLibrary=__webpack_require__(29),_videoLibrary2=_interopRequireDefault(_videoLibrary),_article=__webpack_require__(30),_article2=_interopRequireDefault(_article);
postTransform.$inject=["$httpProvider"],exports["default"]=_angular2["default"].module("pgcServices",[],postTransform).factory("BaseService",_base2["default"].factory).factory("ArticleDraftService",_articleDraft2["default"].factory).factory("articlePublisedService",_articlePublised2["default"].factory).factory("VideoLibraryService",_videoLibrary2["default"].factory).factory("ArticleService",_article2["default"].factory).name},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),BaseService=function(){function BaseService($http,$q){_classCallCheck(this,BaseService),this.$http=$http,this.$q=$q,this.getToken()}return _createClass(BaseService,[{key:"getToken",value:function(){var deferred=this.$q.defer();return this.$http.get("/napi/security/token/").then(function(res){if(res.data.success||1===res.data.status)deferred.resolve(res.data);else{var wrongmsg=res.data.message||"出错了，但是后端没有提示错误信息";SUGAR.PopOut.alert('<div class="prompt"><h3>'+wrongmsg+"</h3></div>"),deferred.reject(data)}},function(error){SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>操作失败,请检查网络或稍后再试</h3></div>'),deferred.reject(error)}),deferred.promise}},{key:"get",value:function(_api,_config){var deferred=this.$q.defer();return _config={params:_config},this.$http.get(_api,_config).then(function(res){res.data.success||1===res.data.status?deferred.resolve(res.data):(res.data.message||"出错了，但是后端没有提示错误信息",SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>'+res.data.message+"</h3></div>"),deferred.reject(res.data))},function(error){var wrongmsg=error.data.message||"系统繁忙，请稍后再试";SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>'+error.status+wrongmsg+"</h3></div>"),deferred.reject(error)}),deferred.promise}},{key:"post",value:function(_api,_data){var deferred=this.$q.defer();return this.$http.post(_api,_data).then(function(_res){_res.data.success||1===_res.data.status?deferred.resolve(_res.data):(_res.data.message||"出错了，但是后端没有提示错误信息",deferred.resolve(_res.data))},function(error){var wrongmsg=error.data.message||"系统繁忙，请稍后再试";SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>'+error.status+wrongmsg+"</h3></div>"),deferred.reject(error)}),deferred.promise}},{key:"put",value:function(_api,_config){var deferred=this.$q.defer(),that=this;return that.token?(_angular2["default"].extend(_data,{_csrf_token_:that.token}),this.$http.put(_api,_config).success(function(data){if(data.success||1===data.status)deferred.resolve(data);else{var wrongmsg=data.message||"出错了，但是后端没有提示错误信息";SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>'+wrongmsg+"</h3></div>"),deferred.reject(data)}}).error(function(){deferred.reject("出错了")}),deferred.promise):void SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>token获取失败</h3></div>')}}],[{key:"factory",value:function($http,$q){return new BaseService($http,$q)}}]),BaseService}();BaseService.factory.$inject=["$http","$q"],exports["default"]=BaseService},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),articleDraftService=function(){function articleDraftService(BaseService){_classCallCheck(this,articleDraftService),this.BaseService=BaseService}return _createClass(articleDraftService,[{key:"getArticleList",value:function(_params){return this.BaseService.get("/napi/public/article/draft/list/",_params).then(function(jsn){return jsn})}},{key:"draftDelete",value:function(_params){return this.BaseService.post("/napi/public/article/draft/delete/",_params).then(function(jsn){return jsn})}}],[{key:"factory",value:function(BaseService){return new articleDraftService(BaseService)}}]),articleDraftService}();articleDraftService.$inject=["BaseService"],exports["default"]=articleDraftService},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),articlePublised=function(){function articlePublised(BaseService){_classCallCheck(this,articlePublised),this.BaseService=BaseService}return _createClass(articlePublised,[{key:"getArticleList",value:function(_params){return this.BaseService.get("/napi/public/article/list/",_params).then(function(jsn){return jsn})}}],[{key:"factory",value:function(BaseService){return new articlePublised(BaseService)}}]),articlePublised}();articlePublised.$inject=["BaseService"],exports["default"]=articlePublised},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),VideoLibraryService=function(){function VideoLibraryService(BaseService){_classCallCheck(this,VideoLibraryService),this.BaseService=BaseService}return _createClass(VideoLibraryService,[{key:"beginUpload",value:function(_pars){return this.BaseService.post("/napi/upload/video/begin/",_pars).then(function(_data){return _data})}},{key:"finishUpload",value:function(_pars){return this.BaseService.post("/napi/upload/video/finish/",_pars).then(function(_data){return _data})}},{key:"videoList",value:function(_pars){return this.BaseService.get("/napi/video/list/by_sender/",_pars).then(function(_data){return _data})}},{key:"videoDelete",value:function(_pars){return this.BaseService.post("/napi/video/delete/",_pars).then(function(_data){return _data})}},{key:"videoDetail",value:function(_pars){return this.BaseService.get("/napi/video/detail/",_pars).then(function(_data){return _data})}},{key:"videoUpdate",value:function(_pars){return this.BaseService.post("/napi/video/edit/",_pars).then(function(_data){return _data})}}],[{key:"factory",value:function(BaseService){return new VideoLibraryService(BaseService)}}]),VideoLibraryService}();VideoLibraryService.$inject=["BaseService"],exports["default"]=VideoLibraryService},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),ArticleService=function(){function ArticleService(BaseService,$q,$http){_classCallCheck(this,ArticleService),this.BaseService=BaseService,this.$q=$q,this.$http=$http}return _createClass(ArticleService,[{key:"createCard",value:function(_params){return this.BaseService.post("/napi/public/extrainfo/usercard/save/",_params).then(function(jsn){return jsn})}},{key:"votingOperation",value:function(_params,_type){var _apiUrl=_type?"/napi/vote/update/":"/napi/vote/create/";return this.BaseService.post(_apiUrl,_params).then(function(jsn){return jsn})}},{key:"getVoteDetail",value:function(_params){return this.BaseService.get("/napi/vote/detail/",_params).then(function(jsn){return jsn})}},{key:"getCard",value:function(_params){return this.BaseService.get("/napi/public/extrainfo/usercard/get/",_params).then(function(jsn){return jsn})}},{key:"getUserDetail",value:function(_params){return this.BaseService.get("/napi/people/profile/",_params).then(function(jsn){return jsn})}},{key:"getMusic",value:function(_params){return this.BaseService.get("/napi/xiami/song/detail/by_link/",_params).then(function(jsn){return jsn})}},{key:"getMusicDetail",value:function(_params){return this.BaseService.get("/napi/xiami/song/detail/by_id/",_params).then(function(jsn){return jsn})}},{key:"postArticleFromUrl",value:function(_params){return this.BaseService.post("/napi/public/article/crawl/",_params).then(function(jsn){return jsn})}},{key:"uploadImgeFromUrl",value:function(_params){var deferred=this.$q.defer();return this.$http({url:"/napi/upload/photo/",method:"POST",transformRequest:_angular2["default"].identity,headers:{"Content-Type":void 0},data:_params}).then(function(jsn){jsn.data.success||1===jsn.data.status?deferred.resolve(jsn.data):(jsn.data.message||"出错了，但是后端没有提示错误信息",deferred.resolve(jsn.data))},function(xhr,error){deferred.reject(error)}),deferred.promise}},{key:"getArticleContent",value:function(_type,_params){var _url="/napi/public/article/draft/detail/";return"0"===_type&&(_url="/napi/public/article/detail/"),this.BaseService.get(_url,_params).then(function(jsn){return jsn})}},{key:"articlePreview",value:function(_params){return this.BaseService.post("/napi/public/article/preview/",_params).then(function(jsn){return jsn})}},{key:"saveToDraft",value:function(_params){var _this=this;return this.BaseService.getToken().then(function(res){return _angular2["default"].extend(_params,{_csrf_token_:res.data}),_this.BaseService.post("/napi/public/article/draft/upsert/",_params).then(function(jsn){return jsn})})}},{key:"Create",value:function(_params){var _this2=this;return this.BaseService.getToken().then(function(res){return _angular2["default"].extend(_params,{_csrf_token_:res.data}),_this2.BaseService.post("/napi/public/article/create/",_params).then(function(jsn){return jsn})})}},{key:"Update",value:function(_params){return this.BaseService.post("/napi/public/article/update/",_params).then(function(jsn){return jsn})}}],[{key:"factory",value:function(BaseService,$q,$http){return new ArticleService(BaseService,$q,$http)}}]),ArticleService}();ArticleService.$inject=["BaseService","$q","$http"],exports["default"]=ArticleService},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_pgc=__webpack_require__(25),_pgc2=_interopRequireDefault(_pgc),_dtImageUpload=__webpack_require__(32),_dtImageUpload2=_interopRequireDefault(_dtImageUpload),_dtpages=__webpack_require__(33),_dtpages2=_interopRequireDefault(_dtpages),_dtImageInsert=__webpack_require__(34),_dtImageInsert2=_interopRequireDefault(_dtImageInsert),_dtElastic=__webpack_require__(35),_dtElastic2=_interopRequireDefault(_dtElastic);exports["default"]=_angular2["default"].module("pgcDirectives",[_pgc2["default"]]).directive("dtImageUpload",_dtImageUpload2["default"].factory).directive("dtPage",_dtpages2["default"].factory).directive("dtImageInsert",_dtImageInsert2["default"].factory).directive("dtElastic",_dtElastic2["default"].factory)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_dtTools=__webpack_require__(22),_dtTools2=_interopRequireDefault(_dtTools),dtImageUpload=function(){function dtImageUpload($http){_classCallCheck(this,dtImageUpload),this.$http=$http,this.restrict="E",this.scope={imgSrc:"=ngModel",photoid:"=photoId",process:"=process",uploading:"=uploading"},this.template='<div class="upload {{imgSrc?\'active\':\'\'}}"><input type="file" name="file'+(new Date).getTime()+'" /></div>'}return _createClass(dtImageUpload,[{key:"compile",value:function(){return this.link.bind(this)}},{key:"link",value:function(scope,element,attrs){var _this=this,_inputFile=element.find("input"),size=attrs.size.split(",");_inputFile.on("change",function(e){var file=e.target.files[0],imgReg=/\.(gif|jpg|jpeg|png)$/gi;imgReg.test(file.name)||(e.preventDefault(),SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>不支持文件类型</h3></div>')),scope.imgSrc="",scope.uploading=!0,_this.uploadAjax(e.target,function(e){scope.process=e.loaded/e.total*100+"%"},function(jsn){scope.uploading=!1;var data=jsn.data;if(e.target.value="",1===data.status){var imgTran=_dtTools2["default"].dtImageTrans(jsn.data.data.img_url,!0,size[0],size[1],"c");scope.imgSrc=imgTran,element.find(".upload").addClass("active"),scope.photoid=jsn.data.data.photo_id}else{var wrongmsg=data.message||"出错了，但是后端没有提示错误信息";SUGAR.PopOut.alert('<div class="prompt"><h3>'+wrongmsg+"</h3></div>")}})})}},{key:"uploadAjax",value:function(ele,process,fn){ele.disabled=!0;var _fData=new FormData;_fData.append("img",ele.files[0]),_fData.append("type","blog"),_fData.append("data","img"),this.$http({url:"/napi/upload/photo/",method:"POST",transformRequest:_angular2["default"].identity,headers:{"Content-Type":void 0},data:_fData,uploadEventHandlers:{progress:process}}).then(function(jsn){ele.disabled=!1,"function"==typeof fn&&fn(jsn)},function(xhr,error){console.log(_angular2["default"].toJson(error))})}}],[{key:"factory",value:function($http){return new dtImageUpload($http)}}]),dtImageUpload}();dtImageUpload.factory.$inject=["$http"],exports["default"]=dtImageUpload},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_angular=__webpack_require__(1),dtPages=(_interopRequireDefault(_angular),function(){function dtPages(){_classCallCheck(this,dtPages),this.restrict="E",this.scope={page:"=pagepar"},this.template='<div class="page" ng-if="page.total>page.limit"><span ng-if="hasError" style="color: #fc8383;">请输入正确的页码</span><a class="pbtn prev" ng-href="{{prevHref}}" ng-if="pagePrev"><i class="icon arrow_left"></i></a><span>{{disText}}</span><a class="pbtn next" ng-href="{{nextHref}}" ng-if="pageNext"><i class="icon arrow_right"></i></a><div class="goto"><input type="text" ng-model="page.pageSize" ng-change="pageChange()" placeholder="页码" ng-class="hasError?\'error\':\'\'"/><a class="pbtn go" ng-href="{{goLink}}">跳转</a></div></div>'}return _createClass(dtPages,[{key:"compile",value:function(){return this.link.bind(this)}},{key:"link",value:function(scope,element,attrs){var _this=this,total=Math.ceil(scope.page.total/scope.page.limit);scope.$watch("page",function(newV,oldV,scope){if(newV){document.body.scrollTop=0,scope.pagePrev=newV.start?Math.floor(newV.start/newV.limit):!1,scope.pageNext=newV.hasNext?Math.floor(newV.start/newV.limit)+2:!1;var pageNow=Math.floor(newV.start/newV.limit)+1;scope.disText=pageNow+"/"+total;var params=_this.parmasString(scope,newV.parms);scope.prevHref=newV.start?params+"page="+scope.pagePrev:"",scope.nextHref=newV.hasNext?params+"page="+scope.pageNext:""}}),scope.pageChange=function(){!isNaN(scope.page.pageSize)&&Number(scope.page.pageSize)<=total&&Number(scope.page.pageSize)>0?(scope.goLink=_this.parmasString(scope,scope.page.parms)+"page="+scope.page.pageSize,scope.hasError=!1):(scope.goLink="",scope.hasError=!0)}}},{key:"parmasString",value:function(scope,_par){var params=scope.page.url+"?";if(scope.page.parms)for(var key in scope.page.parms)params+=key+"="+scope.page.parms[key]+"&";return params}}],[{key:"factory",value:function(){return new dtPages}}]),dtPages}());exports["default"]=dtPages},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_dtTools=__webpack_require__(22),_dtTools2=_interopRequireDefault(_dtTools),dtImageInsert=function(){function dtImageInsert($http,$window,$timeout){_classCallCheck(this,dtImageInsert),this.$http=$http,this.$window=$window,this.$timeout=$timeout,this.restrict="E",this.scope={},this.template='<div class="upload""><input type="file" id="dtInsert"></div>'}return _createClass(dtImageInsert,[{key:"compile",value:function(){return this.link.bind(this)}},{key:"link",value:function(scope,iElement,iAttrs){var _this=this;if(this.$window.tinymce){var inputFile=iElement.find("input");inputFile.on("change",function(e){var file=e.target.files[0],imgReg=/\.(gif|jpg|jpeg|png)$/gi;if(!imgReg.test(file.name))return e.preventDefault(),SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>不支持文件类型</h3></div>'),!1;var Editor=tinymce.activeEditor,id=(_angular2["default"].element(".img-box"),(new Date).getTime()),_htmlStr=_this.render(id);Editor.insertContent(_htmlStr);var ImgEle=Editor.dom.$("#img"+id),range=Editor.dom.createRng();range.setStartAfter(ImgEle[0]),range.setEndAfter(ImgEle[0]),Editor.selection.getSel().removeAllRanges(),Editor.selection.setRng(range),_this.proceEle=_angular2["default"].element("<span>0</span>").appendTo(ImgEle.find(".proce")),_this.uploadAjax(e.target,function(_res){if(1===_res.status){var imgdata=_res.data;imgdata.img_url=_dtTools2["default"].dtImageTrans(imgdata.img_url,!0,600);var rate=100*imgdata.photo_height/imgdata.photo_width,_domImg='<img data-img="'+imgdata.img_url+'" src="'+imgdata.img_url+'" data-width="'+imgdata.photo_width+'" data-height="'+imgdata.photo_height+'" data-imgid="'+imgdata.photo_id+'">';ImgEle.find(".img-padding").removeClass("minheight").css({width:"100%","padding-bottom":rate.toFixed(2)+"%",height:0,"background-color":"rgb(240,240,240)"}).empty().append(_domImg)}else ImgEle.find(".img-padding").text(_res.message),_this.$timeout(function(){ImgEle.remove()},1200)})})}}},{key:"render",value:function(id){return'<figure id="img'+id+'" class="img-box" contenteditable="false"><div class="img-padding minheight" contenteditable="false"><div class="proce"></div>图片上传中，每篇文章最多支持上传50张</div><span class="imagecaption" contenteditable="true" data-txt="图片描述">图片描述</span></figure>'}},{key:"uploadAjax",value:function(ele,fn){var _this2=this,_fData=new FormData;_fData.append("img",ele.files[0]),_fData.append("type","blog"),_fData.append("data","img"),this.$http({url:"/napi/upload/photo/",method:"POST",transformRequest:_angular2["default"].identity,headers:{"Content-Type":void 0},data:_fData,uploadEventHandlers:{progress:function(e){_this2.scope.process=e.loaded/e.total*100+"%",_this2.proceEle.css({width:_this2.scope.process}).text(_this2.scope.process)}}}).then(function(jsn){fn(jsn.data),ele.value=""},function(xhr,error){console.log(_angular2["default"].toJson(error)),ele.value=""})}}],[{key:"factory",value:function($http,$window,$timeout){return new dtImageInsert($http,$window,$timeout)}}]),dtImageInsert}();dtImageInsert.factory.$inject=["$http","$window","$timeout"],exports["default"]=dtImageInsert},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),dtElastic=function(){function dtElastic(){_classCallCheck(this,dtElastic),this.restrict="A",this.scope={maxlength:"@max"}}return _createClass(dtElastic,[{key:"link",value:function(scope,element){scope.initialHeight=scope.initialHeight||element[0].style.height,scope.maxlength=scope.maxlength-1;var resize=function(e){return element[0].style.height=scope.initialHeight,element[0].style.height=""+element[0].scrollHeight+"px",13===e.keyCode?(e.returnValue=!1,!1):element[0].value.length>scope.maxlength&&8!==e.keyCode?(element[0].value=element[0].value.substr(0,scope.maxlength),e.returnValue=!1,!1):void 0};element.on("input change keydown keyup",resize)}}],[{key:"factory",value:function(){return new dtElastic}}]),dtElastic}();exports["default"]=dtElastic},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_angularMessages=__webpack_require__(37),_angularMessages2=_interopRequireDefault(_angularMessages),_videoLibrary=__webpack_require__(39),_videoLibrary2=_interopRequireDefault(_videoLibrary),_videoUpdate=__webpack_require__(40),_videoUpdate2=_interopRequireDefault(_videoUpdate),_videoCreate=__webpack_require__(41),_videoCreate2=_interopRequireDefault(_videoCreate),_articlePublised=__webpack_require__(46),_articlePublised2=_interopRequireDefault(_articlePublised),_articleDraft=__webpack_require__(47),_articleDraft2=_interopRequireDefault(_articleDraft),_articleCreate=__webpack_require__(48),_articleCreate2=_interopRequireDefault(_articleCreate),_articleSuccess=__webpack_require__(61),_articleSuccess2=_interopRequireDefault(_articleSuccess);exports["default"]=_angular2["default"].module("pgcModules",[_angularMessages2["default"]]).controller("videoLibraryCtrl",_videoLibrary2["default"]).controller("videoUpdateCtrl",_videoUpdate2["default"]).controller("videoCreateCtrl",_videoCreate2["default"]).controller("articleDraftCtrl",_articleDraft2["default"]).controller("articlePublisedCtrl",_articlePublised2["default"]).controller("articleCreateCtrl",_articleCreate2["default"]).controller("articleSuccessCtrl",_articleSuccess2["default"])},function(module,exports,__webpack_require__){__webpack_require__(38),module.exports="ngMessages"},function(module,exports){!function(window,angular,undefined){"use strict";function ngMessageDirectiveFactory(){function contains(collection,key){return collection?isArray(collection)?collection.indexOf(key)>=0:collection.hasOwnProperty(key):void 0}return["$animate",function($animate){return{restrict:"AE",transclude:"element",priority:1,terminal:!0,require:"^^ngMessages",link:function(scope,element,attrs,ngMessagesCtrl,$transclude){var records,commentNode=element[0],staticExp=attrs.ngMessage||attrs.when,dynamicExp=attrs.ngMessageExp||attrs.whenExp,assignRecords=function(items){records=items?isArray(items)?items:items.split(/[\s,]+/):null,ngMessagesCtrl.reRender()};dynamicExp?(assignRecords(scope.$eval(dynamicExp)),scope.$watchCollection(dynamicExp,assignRecords)):assignRecords(staticExp);var currentElement,messageCtrl;ngMessagesCtrl.register(commentNode,messageCtrl={test:function(name){return contains(records,name)},attach:function(){currentElement||$transclude(scope,function(elm){$animate.enter(elm,null,element),currentElement=elm;var $$attachId=currentElement.$$attachId=ngMessagesCtrl.getAttachId();currentElement.on("$destroy",function(){currentElement&&currentElement.$$attachId===$$attachId&&(ngMessagesCtrl.deregister(commentNode),messageCtrl.detach())})})},detach:function(){if(currentElement){var elm=currentElement;currentElement=null,$animate.leave(elm)}}})}}}]}var isArray=angular.isArray,forEach=angular.forEach,isString=angular.isString,jqLite=angular.element;angular.module("ngMessages",[]).directive("ngMessages",["$animate",function($animate){function isAttrTruthy(scope,attr){return isString(attr)&&0===attr.length||truthy(scope.$eval(attr))}function truthy(val){return isString(val)?val.length:!!val}var ACTIVE_CLASS="ng-active",INACTIVE_CLASS="ng-inactive";return{require:"ngMessages",restrict:"AE",controller:["$element","$scope","$attrs",function($element,$scope,$attrs){function findPreviousMessage(parent,comment){for(var prevNode=comment,parentLookup=[];prevNode&&prevNode!==parent;){var prevKey=prevNode.$$ngMessageNode;if(prevKey&&prevKey.length)return messages[prevKey];prevNode.childNodes.length&&-1==parentLookup.indexOf(prevNode)?(parentLookup.push(prevNode),prevNode=prevNode.childNodes[prevNode.childNodes.length-1]):prevNode=prevNode.previousSibling||prevNode.parentNode}}function insertMessageNode(parent,comment,key){var messageNode=messages[key];if(ctrl.head){var match=findPreviousMessage(parent,comment);match?(messageNode.next=match.next,match.next=messageNode):(messageNode.next=ctrl.head,ctrl.head=messageNode)}else ctrl.head=messageNode}function removeMessageNode(parent,comment,key){var messageNode=messages[key],match=findPreviousMessage(parent,comment);match?match.next=messageNode.next:ctrl.head=messageNode.next}var ctrl=this,latestKey=0,nextAttachId=0;this.getAttachId=function(){return nextAttachId++};var renderLater,cachedCollection,messages=this.messages={};this.render=function(collection){collection=collection||{},renderLater=!1,cachedCollection=collection;for(var multiple=isAttrTruthy($scope,$attrs.ngMessagesMultiple)||isAttrTruthy($scope,$attrs.multiple),unmatchedMessages=[],matchedKeys={},messageItem=ctrl.head,messageFound=!1,totalMessages=0;null!=messageItem;){totalMessages++;var messageCtrl=messageItem.message,messageUsed=!1;messageFound||forEach(collection,function(value,key){if(!messageUsed&&truthy(value)&&messageCtrl.test(key)){if(matchedKeys[key])return;matchedKeys[key]=!0,messageUsed=!0,messageCtrl.attach()}}),messageUsed?messageFound=!multiple:unmatchedMessages.push(messageCtrl),messageItem=messageItem.next}forEach(unmatchedMessages,function(messageCtrl){messageCtrl.detach()}),unmatchedMessages.length!==totalMessages?$animate.setClass($element,ACTIVE_CLASS,INACTIVE_CLASS):$animate.setClass($element,INACTIVE_CLASS,ACTIVE_CLASS)},$scope.$watchCollection($attrs.ngMessages||$attrs["for"],ctrl.render),this.reRender=function(){renderLater||(renderLater=!0,$scope.$evalAsync(function(){renderLater&&cachedCollection&&ctrl.render(cachedCollection)}))},this.register=function(comment,messageCtrl){var nextKey=latestKey.toString();messages[nextKey]={message:messageCtrl},insertMessageNode($element[0],comment,nextKey),comment.$$ngMessageNode=nextKey,latestKey++,ctrl.reRender()},this.deregister=function(comment){var key=comment.$$ngMessageNode;delete comment.$$ngMessageNode,removeMessageNode($element[0],comment,key),delete messages[key],ctrl.reRender()}}]}}]).directive("ngMessagesInclude",["$templateRequest","$document","$compile",function($templateRequest,$document,$compile){return{restrict:"AE",require:"^^ngMessages",link:function($scope,element,attrs){var src=attrs.ngMessagesInclude||attrs.src;$templateRequest(src).then(function(html){$compile(html)($scope,function(contents){element.after(contents);var comment=$compile.$$createComment?$compile.$$createComment("ngMessagesInclude",src):$document[0].createComment(" ngMessagesInclude: "+src+" "),anchor=jqLite(comment);element.after(anchor),element.remove()})})}}}]).directive("ngMessage",ngMessageDirectiveFactory()).directive("ngMessageExp",ngMessageDirectiveFactory())}(window,window.angular)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor);
}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_dtTools=__webpack_require__(22),_dtTools2=_interopRequireDefault(_dtTools),videoLibraryCtrl=function(){function videoLibraryCtrl(VideoLibraryService,$routeParams,$scope,ngDialog){var _this=this;_classCallCheck(this,videoLibraryCtrl),this.ngDialog=ngDialog,this.$routeParams=$routeParams,this.VideoLibraryService=VideoLibraryService,this.limit=15;var _pars=this.init();this.getVideoList(_pars),$scope.$on("$routeUpdate",function(event,route){var _par=_this.init();_this.getVideoList(_par)})}return _createClass(videoLibraryCtrl,[{key:"init",value:function(){var _start=this.$routeParams.page?(this.$routeParams.page-1)*this.limit:0,_par={start:_start,limit:this.limit,scene:"AVAILABLE"};return _par}},{key:"videoDelete",value:function(_art){var _this2=this,_par={id:_art.id},dialogId=this.ngDialog.open({template:"videoTmpl",closeByDocument:!0,showClose:!1,closeByEscape:!0,controller:["$scope",function($scope){$scope.close=function(){_this2.ngDialog.close(dialogId)},$scope.confirm=function(){_this2.VideoLibraryService.videoDelete(_par).then(function(res){_art.removed=!0,_this2.videoTotal--,_this2.ngDialog.close(dialogId)})}}]})}},{key:"getVideoList",value:function(_par,_fn){var _this3=this;this.VideoLibraryService.videoList(_par).then(function(res){_angular2["default"].forEach(res.data.object_list,function(_val,i){_val.cover.photo_path=_dtTools2["default"].dtImageTrans(_val.cover.photo_path,!0,250,150,"c")}),_this3.videoTotal=res.data.total||0,_this3.videoList=res.data.object_list,_this3.page={url:"#/videolib/",start:_par.start,hasNext:res.data.more,limit:_par.limit,total:res.data.total},_fn&&_fn()})}}]),videoLibraryCtrl}();videoLibraryCtrl.$inject=["VideoLibraryService","$routeParams","$scope","ngDialog"],exports["default"]=videoLibraryCtrl},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_dtTools=__webpack_require__(22),_dtTools2=_interopRequireDefault(_dtTools),videoUpdateCtrl=function(){function videoUpdateCtrl(VideoLibraryService,$routeParams,$location){return _classCallCheck(this,videoUpdateCtrl),this.VideoLibraryService=VideoLibraryService,this.$location=$location,$routeParams.id?(this.id=$routeParams.id,void this.getVideoInfo($routeParams.id)):void SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>参数有误！</h3></div>')}return _createClass(videoUpdateCtrl,[{key:"getVideoInfo",value:function(_id){var _this=this,_pas={id:_id};this.VideoLibraryService.videoDetail(_pas).then(function(res){_this.videofile=res.data.name,_this.videoCover=_dtTools2["default"].dtImageTrans(res.data.cover.photo_path,!0,200,150,"c"),_this.name=res.data.alias,_this.photoId=res.data.cover.id})}},{key:"saveChange",value:function(){var _this2=this,_par={id:this.id,alias:this.name,desc:this.videoDesc,cover_photo_id:this.photoId};this.VideoLibraryService.videoUpdate(_par).then(function(res){_this2.$location.url("/videolib/")})}}]),videoUpdateCtrl}();videoUpdateCtrl.$inject=["VideoLibraryService","$routeParams","$location"],exports["default"]=videoUpdateCtrl},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular);__webpack_require__(42),__webpack_require__(43),__webpack_require__(44),__webpack_require__(45);var VideoCreateCtrl=function(){function VideoCreateCtrl(VideoLibraryService,$scope,$timeout,ngDialog,$location){var _this=this;_classCallCheck(this,VideoCreateCtrl);var preventReload=function(e){return e.returnValue="若现在离开，视频将终止上传"};window.addEventListener("beforeunload",preventReload,!1),$scope.$on("$routeChangeStart",function(event,next,current){_this.uploading&&!_this.Redirect?!function(){event.preventDefault();var dialogId=_this.ngDialog.open({template:"videoTempl",showClose:!1,closeByDocument:!0,closeByEscape:!0,controller:["$scope",function($scope){$scope.close=function(){_this.ngDialog.close(dialogId)},$scope.confirm=function(){_this.ngDialog.close(dialogId),_this.Redirect=!0,window.removeEventListener("beforeunload",preventReload,!1),_this.$location.path(next.$$route.originalPath)}}]})}():window.removeEventListener("beforeunload",preventReload,!1)}),this.ngDialog=ngDialog,this.$location=$location,this.VideoLibraryService=VideoLibraryService,this.$timeout=$timeout,this.$scope=$scope,this.videoIdArr={},this.limit=15,this.cover={},this.pattern=/\.(mp4|avi|mpeg|mov)/i,this.uploader=Qiniu.uploader({runtimes:"html5,flash,html4",browse_button:"videoFile",uptoken_url:"/napi/upload/video/generate_upload_token/",get_new_uptoken:!1,domain:"http://v-1.dtstatic.com",max_file_size:"1024mb",max_retries:3,multi_selection:!1,chunk_size:"4mb",auto_start:!0,init:{FilesAdded:function(up,files){var isVideo=!1,id="";_angular2["default"].forEach(files,function(_val){isVideo="video"===_val.type.split("/")[0],id=_val.id}),isVideo||up.removeFile(id),_this.videofile=files[0].name,$scope.$$phase||_this.$scope.$apply()},BeforeUpload:function(up,file){_this.uploading=!0;var _pas={path:Qiniu.path,name:file.name,size:file.size};_this.VideoLibraryService.beginUpload(_pas).then(function(res){1===res.status?(_this.errorMes="",_this.fileId=res.data.id):(up.stop(),_this.errorMes=res.message,$scope.$$phase||_this.$scope.$apply())})},UploadProgress:function(up,file){_this.percent=file.percent,$scope.$$phase||_this.$scope.$apply()},FileUploaded:function(up,file,info){info=_angular2["default"].fromJson(info);var _pars={id:_this.fileId,key:info.key,hash:info.hash};_this.finishParams=_pars,_this.successMes=!0,$scope.$$phase||_this.$scope.$apply()},Error:function(up,err,errTip){up.stop(),up.removeFile(err.file)},UploadComplete:function(up,err,errTip){_this.successMes=!0,$scope.$$phase||_this.$scope.$apply()}}})}return _createClass(VideoCreateCtrl,[{key:"finish",value:function(){var _this2=this;this.videoInfo.$invalid||(_angular2["default"].extend(this.finishParams,{alias:this.name,photo_id:this.photoId}),this.VideoLibraryService.finishUpload(this.finishParams).then(function(res){1===res.status&&(_this2.Redirect=!0,_this2.$location.url("/videolib/"))}))}},{key:"stop",value:function(){var _this3=this,stopId=this.ngDialog.open({template:"videoStopTempl",showClose:!1,closeByDocument:!0,closeByEscape:!0,controller:["$scope",function($scope){$scope.close=function(){_this3.ngDialog.close(stopId)},$scope.confirm=function(){_this3.ngDialog.close(stopId);var _id=_this3.uploader.files[0].id;_this3.uploader.stop(),_this3.uploader.removeFile(_id),_this3.videofile="",_this3.uploading=!1,_this3.successMes=!1,_this3.percent=0}}]})}},{key:"reStart",value:function(){this.uploader.start()}}]),VideoCreateCtrl}();VideoCreateCtrl.$inject=["VideoLibraryService","$scope","$timeout","ngDialog","$location"],exports["default"]=VideoCreateCtrl},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj},!function(factory){__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(3)],__WEBPACK_AMD_DEFINE_RESULT__=function($){return factory($)}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}(function(jQuery){"use strict";var $=jQuery,_Gtools={hmt:function(trc){for(var sp=trc.split("/"),len=sp.length,arr=["_trackEvent"],i=0;len>i;i++){var item=$.trim(sp[i]);item&&"_trc"!=item&&arr.push(item)}arr.length>1&&"undefined"!=typeof _hmt&&_hmt&&(arr[2]&&(arr[2]=arr[1]+"_"+arr[2]),_hmt.push(arr))},gaq:function(trc){},isRedirect:function(href){return href=href.split("?")[0],href.indexOf("/dj/go2/")>-1||href.indexOf("/redirect/")>-1},store:function($d){var $whouse=$("#win-house");return $whouse.length||($whouse=$('<div id="win-house" class="h0"></div>').appendTo("body")),$d&&$whouse.append($d),$whouse},getUSERID:function(){return"undefined"!=typeof USER&&USER.ID?parseInt(USER.ID):""},isSTAFF:function(){return!("undefined"==typeof USER||!USER.ISSTAFF)},scrollToAnchor:function(anchor,diff){diff=diff||0;var $body=($(window),$("body,html")),$tohsh=$("a[name="+anchor+"]"),at=$tohsh.offset().top-diff||0;anchor&&$tohsh.length?$body.animate({scrollTop:at},200):window.ActiveXObject&&!window.XMLHttpRequest&&$body.animate({scrollTop:at},200)},dtImageTrans:function(url,t,width,height,c){var pathn=$.trim(url).replace(/^http(s)?:\/\//gi,"");pathn=pathn.split("/");var domain=pathn[0];return pathn=pathn[1],-1==domain.indexOf("duitang.com")||!pathn||"uploads"!=pathn&&"misc"!=pathn?url:t?(width=width||0,height=height||0,c=c?"_"+c:"",this.dtImageTrans(url).replace(/(\.[a-z_]+)$/gi,".thumb."+width+"_"+height+c+"$1")):url.replace(/(?:\.thumb\.\w+|\.[a-z]+!\w+)(\.[a-z_]+)$/gi,"$1")},removeParam:function(url,pnm){var reg1=new RegExp("\\?"+pnm+"(=[^&]*)?"),reg2=new RegExp("\\&"+pnm+"(=[^&]*)?");return url.replace(reg1,"?").replace(reg2,"").replace(/\?&/,"?").replace(/\?$/,"")},getParams:function(url){var name,value,i,opts={},url=url.split("#")[0],idx=url.indexOf("?"),search=idx>-1?url.substr(idx+1):"",arrtmp=search.split("&");for(i=0;i<arrtmp.length;i++){var paramCount=arrtmp[i].indexOf("=");if(paramCount>0){name=arrtmp[i].substring(0,paramCount),value=arrtmp[i].substr(paramCount+1);try{value.indexOf("+")>-1&&(value=value.replace(/\+/g," ")),opts[name]=decodeURIComponent(value)}catch(exp){}}}return opts},addParam:function(url,param,value){var re=new RegExp("([&\\?])"+param+"=[^& ]*","g");url=url.replace(re,function(a,b){return"?"==b?"?":""});var idx=url.indexOf("?");return url+=(idx>-1?idx+1!=url.length?"&":"":"?")+param+"="+value},isFromDomain:function(url){url=url.replace("http://","").replace("https://",""),url=url.split("?"),url=url[0].split("/"),url=url[0];for(var i=1;i<arguments.length;i++)if(url.indexOf(arguments[i])>-1)return!0;return!1},mergeServerMessage:function(msg){var str="";if($.isArray(msg)){for(var i=0;i<msg.length;i++){if($.isArray(msg[i])){var tm=msg[i][1]||msg[i][0]||"";str+=tm+","}str+=msg[i]+";"}str=str.slice(0,-1)}else if($.isPlainObject(msg)){for(var e in msg)str+=msg[e].toString()+";";str=str.slice(0,-1)}else str=msg;return str||""},setCookie:function(name,value){$.Bom.setSubCookie("sg",name,value)},setDayCookie:function(name,value){$.Bom.setSubCookie("sgd",name,value,{expires:1})},setWeekCookie:function(name,value){$.Bom.setSubCookie("sgw",name,value,{expires:7})},setMonthCookie:function(name,value){$.Bom.setSubCookie("sgm",name,value,{expires:30})},setYearCookie:function(name,value){$.Bom.setSubCookie("sgy",name,value,{expires:365})},isLink:function(u){return!!u.match(/^(?:http(?:s)?:\/\/)(?:(?:[\w-]+\.)+[\w-]+)(?:\:\d+)?(?:\/[^ \t\n]*)?$/gi)},trimLink:function(u,f){return u.replace(/(?:http(?:s)?:\/\/)(?:(?:[\w-]+\.)+[\w-]+)(?:\:\d+)?(?:\/[\w-\.\/%]*)?(?:[?][\w-\.\/%!*\(\);\:@&=+$,\[\]]*)?(?:#[\w-\.\/%!*\(\);\:@&=+$,\[\]]*)?/gi,function(a){return f?'<a href="'+a+'" target="_blank">'+a+"</a>":""})},getCookie:function(name){return $.Bom.getSubCookie("sg",name)},getDayCookie:function(name){return $.Bom.getSubCookie("sgd",name)},getWeekCookie:function(name){return $.Bom.getSubCookie("sgw",name)},getMonthCookie:function(name){return $.Bom.getSubCookie("sgm",name)},getYearCookie:function(name){return $.Bom.getSubCookie("sgy",name)},blinkIt:function(fn1,fn2,fn3,n,t){return t=t||1e3,0===n?void fn3():($.isFunction(fn1)&&fn1(),void window.setTimeout(function(){$.G.blinkIt(fn2,fn1,fn3,--n,t)},t))},bindChecks:function(id,id2,f,fnb,fna,fncks){function funa($idt){var av=[],rs="",$cks=$id2.find(selcks);$idt.prop("checked")?($cks.each(function(i,a){var $a=$(a),atv=$a.attr("value");$a.prop("checked",!0),void 0!==atv&&$a.attr("dvalue",atv),av.push($a.attr("dvalue"))}),$id.prop("checked",!0).add($cks).addClass("checked")):($cks.each(function(i,a){$(a).prop("checked",!1)}),$id.prop("checked",!1).add($cks).removeClass("checked")),rs=$.trim(av.join(" ")).replace(/ /gi,","),$id.attr("dvalue",rs),$id.filter("[type=checkbox]").val(rs)}var selcks="input[type=checkbox],[checked],[checked=false]",$id=$(id),$id2=$(id2);f?$id.prop("checked",!0):void 0!==f?$id.prop("checked",!1):"true"==$id.attr("dchecked")?$id.prop("checked",!0):$id.prop("checked")||$id.prop("checked",!1),funa($id),"checkbox"!=$id.attr("type")&&$id.click(function(e){var canpass=!0;$.isFunction(fnb)&&(canpass=fnb()),canpass&&$id.prop("checked",!$id.prop("checked"))}),$id.click(function(e){e.stopPropagation();var $this=$(this),canpass=!0;$.isFunction(fnb)&&(canpass=fnb.call(this,$id,$id2,selcks)),canpass&&(funa($this),$.isFunction(fna)&&fna.call(this,$id,$id2,selcks))}),$id2.delegate(selcks,"click",function(e){e.stopPropagation();var $this=$(this);"checkbox"!=$this.attr("type")&&$this.prop("checked",!$this.prop("checked"));var dvv=$.trim($id.attr("dvalue")),arrv=dvv?dvv.split(","):[],rs="",v=$this.attr("value");void 0!==v&&$this.attr("dvalue",v),v=$this.attr("dvalue"),arrv=$(arrv).filter(function(i,a){return a!==v}).get();var cked=$this.prop("checked");cked?(arrv.push(v),$this.addClass("checked")):$this.removeClass("checked"),rs=$.trim(arrv.join(" ")).replace(/ /gi,","),$id.attr("dvalue",rs),"checkbox"==$id.attr("type")&&$id.val(rs),$.isFunction(fncks)&&fncks.call(this,$id,$id2,selcks,cked)})},getNum:function(str){return str?+str.replace(/^[^\d]*(\d+\.?\d*).*/,"$1")||0:0},getFitSize:function(a,b){if(a[0]&&a[1]&&b[0]&&(b[1]||(b[1]=b[0]),a[0]>b[0]||a[1]>b[1])){var scale=a[0]/a[1],fit=scale>=b[0]/b[1];return fit?[b[0],parseInt(b[0]/scale)]:[parseInt(b[1]*scale),b[1]]}return a}};return Date.prototype.pattern=function(fmt){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12===0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},week={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};/(y+)/.test(fmt)&&(fmt=fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(fmt)&&(fmt=fmt.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"星期":"周":"")+week[this.getDay()+""]));for(var k in o)new RegExp("("+k+")").test(fmt)&&(fmt=fmt.replace(RegExp.$1,1==RegExp.$1.length?o[k]:("00"+o[k]).substr((""+o[k]).length)));return fmt},String.prototype.lenB||(String.prototype.lenB=function(){return this.replace(/[^\x00-\xff]/g,"**").length}),String.prototype.leftB||(String.prototype.leftB=function(n){var s=this,s2=s.slice(0,n),i=s2.replace(/[^\x00-\xff]/g,"**").length;if(n>=i)return s2;switch(i-=s2.length){case 0:return s2;case n:return s.slice(0,n>>1);default:var k=n-i,s3=s.slice(k,n),j=s3.replace(/[\x00-\xff]/g,"").length;return j?s.slice(0,k)+s3.leftB(j):s.slice(0,k)}}),String.prototype.cut||(String.prototype.cut=function(n,a,b){var r,s=this;return r=b?s.substr(0,n):s.leftB(n),r==s?r:r+("undefined"==typeof a?"…":a)}),window.Gtools=_Gtools,jQuery&&(jQuery.G=window.Gtools,window.$=$||jQuery),window.Gtools})},function(module,exports){(function(){(function(){var MXI_DEBUG=!0;!function(exports,undefined){"use strict";function require(ids,callback){for(var module,defs=[],i=0;i<ids.length;++i){if(module=modules[ids[i]]||resolve(ids[i]),!module)throw"module definition dependecy not found: "+ids[i];defs.push(module)}callback.apply(null,defs)}function define(id,dependencies,definition){if("string"!=typeof id)throw"invalid module definition, module id must be defined and be a string";if(dependencies===undefined)throw"invalid module definition, dependencies must be specified";if(definition===undefined)throw"invalid module definition, definition function must be specified";require(dependencies,function(){modules[id]=definition.apply(null,arguments)})}function resolve(id){for(var target=exports,fragments=id.split(/[.\/]/),fi=0;fi<fragments.length;++fi){if(!target[fragments[fi]])return;target=target[fragments[fi]]}return target}function expose(ids){for(var i=0;i<ids.length;i++){for(var target=exports,id=ids[i],fragments=id.split(/[.\/]/),fi=0;fi<fragments.length-1;++fi)target[fragments[fi]]===undefined&&(target[fragments[fi]]={}),target=target[fragments[fi]];target[fragments[fragments.length-1]]=modules[id]}}var modules={};define("moxie/core/utils/Basic",[],function(){var typeOf=function(o){var undef;return o===undef?"undefined":null===o?"null":o.nodeType?"node":{}.toString.call(o).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},extend=function(target){var undef;return each(arguments,function(arg,i){i>0&&each(arg,function(value,key){value!==undef&&(typeOf(target[key])===typeOf(value)&&~inArray(typeOf(value),["array","object"])?extend(target[key],value):target[key]=value)})}),target},each=function(obj,callback){var length,key,i;if(obj)if("number"===typeOf(obj.length)){for(i=0,length=obj.length;length>i;i++)if(callback(obj[i],i)===!1)return}else if("object"===typeOf(obj))for(key in obj)if(obj.hasOwnProperty(key)&&callback(obj[key],key)===!1)return},isEmptyObj=function(obj){var prop;if(!obj||"object"!==typeOf(obj))return!0;for(prop in obj)return!1;return!0},inSeries=function(queue,cb){function callNext(i){"function"===typeOf(queue[i])&&queue[i](function(error){++i<length&&!error?callNext(i):cb(error)})}var i=0,length=queue.length;"function"!==typeOf(cb)&&(cb=function(){}),queue&&queue.length||cb(),callNext(i)},inParallel=function(queue,cb){var count=0,num=queue.length,cbArgs=new Array(num);each(queue,function(fn,i){fn(function(error){if(error)return cb(error);var args=[].slice.call(arguments);args.shift(),cbArgs[i]=args,count++,count===num&&(cbArgs.unshift(null),cb.apply(this,cbArgs))})})},inArray=function(needle,array){if(array){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(array,needle);for(var i=0,length=array.length;length>i;i++)if(array[i]===needle)return i}return-1},arrayDiff=function(needles,array){var diff=[];"array"!==typeOf(needles)&&(needles=[needles]),"array"!==typeOf(array)&&(array=[array]);for(var i in needles)-1===inArray(needles[i],array)&&diff.push(needles[i]);return diff.length?diff:!1},arrayIntersect=function(array1,array2){var result=[];return each(array1,function(item){-1!==inArray(item,array2)&&result.push(item)}),result.length?result:null},toArray=function(obj){var i,arr=[];for(i=0;i<obj.length;i++)arr[i]=obj[i];return arr},guid=function(){var counter=0;return function(prefix){var i,guid=(new Date).getTime().toString(32);for(i=0;5>i;i++)guid+=Math.floor(65535*Math.random()).toString(32);return(prefix||"o_")+guid+(counter++).toString(32)}}(),trim=function(str){return str?String.prototype.trim?String.prototype.trim.call(str):str.toString().replace(/^\s*/,"").replace(/\s*$/,""):str},parseSizeStr=function(size){if("string"!=typeof size)return size;var mul,muls={t:1099511627776,g:1073741824,m:1048576,k:1024};return size=/^([0-9\.]+)([tmgk]?)$/.exec(size.toLowerCase().replace(/[^0-9\.tmkg]/g,"")),mul=size[2],size=+size[1],muls.hasOwnProperty(mul)&&(size*=muls[mul]),Math.floor(size)},sprintf=function(str){var args=[].slice.call(arguments,1);return str.replace(/%[a-z]/g,function(){var value=args.shift();return"undefined"!==typeOf(value)?value:""})};return{guid:guid,typeOf:typeOf,extend:extend,each:each,isEmptyObj:isEmptyObj,inSeries:inSeries,inParallel:inParallel,inArray:inArray,arrayDiff:arrayDiff,arrayIntersect:arrayIntersect,toArray:toArray,trim:trim,sprintf:sprintf,parseSizeStr:parseSizeStr}}),define("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(Basic){function version_compare(v1,v2,operator){var i=0,x=0,compare=0,vm={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},prepVersion=function(v){return v=(""+v).replace(/[_\-+]/g,"."),v=v.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),v.length?v.split("."):[-8]},numVersion=function(v){return v?isNaN(v)?vm[v]||-7:parseInt(v,10):0};for(v1=prepVersion(v1),v2=prepVersion(v2),x=Math.max(v1.length,v2.length),i=0;x>i;i++)if(v1[i]!=v2[i]){if(v1[i]=numVersion(v1[i]),v2[i]=numVersion(v2[i]),v1[i]<v2[i]){compare=-1;break}if(v1[i]>v2[i]){compare=1;break}}if(!operator)return compare;switch(operator){case">":case"gt":return compare>0;case">=":case"ge":return compare>=0;case"<=":case"le":return 0>=compare;case"==":case"=":case"eq":return 0===compare;case"<>":case"!=":case"ne":return 0!==compare;case"":case"<":case"lt":return 0>compare;default:return null}}var UAParser=function(undefined){var EMPTY="",UNKNOWN="?",FUNC_TYPE="function",UNDEF_TYPE="undefined",OBJ_TYPE="object",NAME="name",VERSION="version",util={has:function(str1,str2){return-1!==str2.toLowerCase().indexOf(str1.toLowerCase())},lowerize:function(str){return str.toLowerCase()}},mapper={rgx:function(){for(var result,j,k,p,q,matches,match,i=0,args=arguments;i<args.length;i+=2){var regex=args[i],props=args[i+1];if(typeof result===UNDEF_TYPE){result={};for(p in props)q=props[p],typeof q===OBJ_TYPE?result[q[0]]=undefined:result[q]=undefined}for(j=k=0;j<regex.length;j++)if(matches=regex[j].exec(this.getUA())){for(p=0;p<props.length;p++)match=matches[++k],q=props[p],typeof q===OBJ_TYPE&&q.length>0?2==q.length?typeof q[1]==FUNC_TYPE?result[q[0]]=q[1].call(this,match):result[q[0]]=q[1]:3==q.length?typeof q[1]!==FUNC_TYPE||q[1].exec&&q[1].test?result[q[0]]=match?match.replace(q[1],q[2]):undefined:result[q[0]]=match?q[1].call(this,match,q[2]):undefined:4==q.length&&(result[q[0]]=match?q[3].call(this,match.replace(q[1],q[2])):undefined):result[q]=match?match:undefined;break}if(matches)break}return result},str:function(str,map){for(var i in map)if(typeof map[i]===OBJ_TYPE&&map[i].length>0){for(var j=0;j<map[i].length;j++)if(util.has(map[i][j],str))return i===UNKNOWN?undefined:i}else if(util.has(map[i],str))return i===UNKNOWN?undefined:i;return str}},maps={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},regexes={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[NAME,VERSION],[/\s(opr)\/([\w\.]+)/i],[[NAME,"Opera"],VERSION],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[NAME,VERSION],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[NAME,"IE"],VERSION],[/(edge)\/((\d+)?[\w\.]+)/i],[NAME,VERSION],[/(yabrowser)\/([\w\.]+)/i],[[NAME,"Yandex"],VERSION],[/(comodo_dragon)\/([\w\.]+)/i],[[NAME,/_/g," "],VERSION],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[NAME,VERSION],[/(dolfin)\/([\w\.]+)/i],[[NAME,"Dolphin"],VERSION],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[NAME,"Chrome"],VERSION],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[VERSION,[NAME,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[VERSION,[NAME,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[VERSION,[NAME,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[VERSION,[NAME,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[VERSION,NAME],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[NAME,[VERSION,mapper.str,maps.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[NAME,VERSION],[/(navigator|netscape)\/([\w\.-]+)/i],[[NAME,"Netscape"],VERSION],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[NAME,VERSION]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[VERSION,[NAME,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[NAME,VERSION],[/rv\:([\w\.]+).*(gecko)/i],[VERSION,NAME]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[NAME,VERSION],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[NAME,[VERSION,mapper.str,maps.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[NAME,"Windows"],[VERSION,mapper.str,maps.os.windows.version]],[/\((bb)(10);/i],[[NAME,"BlackBerry"],VERSION],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[NAME,VERSION],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[NAME,"Symbian"],VERSION],[/\((series40);/i],[NAME],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[NAME,"Firefox OS"],VERSION],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[NAME,VERSION],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[NAME,"Chromium OS"],VERSION],[/(sunos)\s?([\w\.]+\d)*/i],[[NAME,"Solaris"],VERSION],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[NAME,VERSION],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[NAME,"iOS"],[VERSION,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[NAME,"Mac OS"],[VERSION,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[NAME,VERSION]]},UAParser=function(uastring){var ua=uastring||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:EMPTY);this.getBrowser=function(){return mapper.rgx.apply(this,regexes.browser)},this.getEngine=function(){return mapper.rgx.apply(this,regexes.engine)},this.getOS=function(){return mapper.rgx.apply(this,regexes.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return ua},this.setUA=function(uastring){return ua=uastring,this},this.setUA(ua)};return UAParser}(),can=function(){var caps={define_property:function(){return!1}(),create_canvas:function(){var el=document.createElement("canvas");return!(!el.getContext||!el.getContext("2d"))}(),return_response_type:function(responseType){try{if(-1!==Basic.inArray(responseType,["","text","document"]))return!0;if(window.XMLHttpRequest){var xhr=new XMLHttpRequest;if(xhr.open("get","/"),"responseType"in xhr)return xhr.responseType=responseType,xhr.responseType===responseType}}catch(ex){}return!1},use_data_uri:function(){var du=new Image;return du.onload=function(){caps.use_data_uri=1===du.width&&1===du.height},setTimeout(function(){du.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return caps.use_data_uri&&("IE"!==Env.browser||Env.version>=9)},use_data_uri_of:function(bytes){return caps.use_data_uri&&33e3>bytes||caps.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;var el=document.createElement("input");return el.setAttribute("type","file"),!el.disabled}};return function(cap){var args=[].slice.call(arguments);return args.shift(),"function"===Basic.typeOf(caps[cap])?caps[cap].apply(this,args):!!caps[cap]}}(),uaResult=(new UAParser).getResult(),Env={can:can,uaParser:UAParser,browser:uaResult.browser.name,version:uaResult.browser.version,os:uaResult.os.name,osVersion:uaResult.os.version,verComp:version_compare,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return Env.OS=Env.os,MXI_DEBUG&&(Env.debug={runtime:!0,events:!1},Env.log=function(){function logObj(data){console.appendChild(document.createTextNode(data+"\n"))}var data=arguments[0];if("string"===Basic.typeOf(data)&&(data=Basic.sprintf.apply(this,arguments)),window&&window.console&&window.console.log)window.console.log(data);else if(document){var console=document.getElementById("moxie-console");console||(console=document.createElement("pre"),console.id="moxie-console",document.body.appendChild(console)),-1!==Basic.inArray(Basic.typeOf(data),["object","array"])?logObj(data):console.appendChild(document.createTextNode(data+"\n"))}}),Env}),define("moxie/core/I18n",["moxie/core/utils/Basic"],function(Basic){var i18n={};return{addI18n:function(pack){return Basic.extend(i18n,pack)},translate:function(str){return i18n[str]||str},_:function(str){return this.translate(str)},sprintf:function(str){var args=[].slice.call(arguments,1);return str.replace(/%[a-z]/g,function(){var value=args.shift();return"undefined"!==Basic.typeOf(value)?value:""})}}}),define("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(Basic,I18n){var mimeData="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",Mime={
mimes:{},extensions:{},addMimeType:function(mimeData){var i,ii,ext,items=mimeData.split(/,/);for(i=0;i<items.length;i+=2){for(ext=items[i+1].split(/ /),ii=0;ii<ext.length;ii++)this.mimes[ext[ii]]=items[i];this.extensions[items[i]]=ext}},extList2mimes:function(filters,addMissingExtensions){var ext,i,ii,type,self=this,mimes=[];for(i=0;i<filters.length;i++)for(ext=filters[i].extensions.split(/\s*,\s*/),ii=0;ii<ext.length;ii++){if("*"===ext[ii])return[];if(type=self.mimes[ext[ii]],type&&-1===Basic.inArray(type,mimes)&&mimes.push(type),addMissingExtensions&&/^\w+$/.test(ext[ii]))mimes.push("."+ext[ii]);else if(!type)return[]}return mimes},mimes2exts:function(mimes){var self=this,exts=[];return Basic.each(mimes,function(mime){if("*"===mime)return exts=[],!1;var m=mime.match(/^(\w+)\/(\*|\w+)$/);m&&("*"===m[2]?Basic.each(self.extensions,function(arr,mime){new RegExp("^"+m[1]+"/").test(mime)&&[].push.apply(exts,self.extensions[mime])}):self.extensions[mime]&&[].push.apply(exts,self.extensions[mime]))}),exts},mimes2extList:function(mimes){var accept=[],exts=[];return"string"===Basic.typeOf(mimes)&&(mimes=Basic.trim(mimes).split(/\s*,\s*/)),exts=this.mimes2exts(mimes),accept.push({title:I18n.translate("Files"),extensions:exts.length?exts.join(","):"*"}),accept.mimes=mimes,accept},getFileExtension:function(fileName){var matches=fileName&&fileName.match(/\.([^.]+)$/);return matches?matches[1].toLowerCase():""},getFileMime:function(fileName){return this.mimes[this.getFileExtension(fileName)]||""}};return Mime.addMimeType(mimeData),Mime}),define("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(Env){var get=function(id){return"string"!=typeof id?id:document.getElementById(id)},hasClass=function(obj,name){if(!obj.className)return!1;var regExp=new RegExp("(^|\\s+)"+name+"(\\s+|$)");return regExp.test(obj.className)},addClass=function(obj,name){hasClass(obj,name)||(obj.className=obj.className?obj.className.replace(/\s+$/,"")+" "+name:name)},removeClass=function(obj,name){if(obj.className){var regExp=new RegExp("(^|\\s+)"+name+"(\\s+|$)");obj.className=obj.className.replace(regExp,function($0,$1,$2){return" "===$1&&" "===$2?" ":""})}},getStyle=function(obj,name){return obj.currentStyle?obj.currentStyle[name]:window.getComputedStyle?window.getComputedStyle(obj,null)[name]:void 0},getPos=function(node,root){function getIEPos(node){var bodyElm,rect,x=0,y=0;return node&&(rect=node.getBoundingClientRect(),bodyElm="CSS1Compat"===doc.compatMode?doc.documentElement:doc.body,x=rect.left+bodyElm.scrollLeft,y=rect.top+bodyElm.scrollTop),{x:x,y:y}}var parent,nodeRect,rootRect,x=0,y=0,doc=document;if(node=node,root=root||doc.body,node&&node.getBoundingClientRect&&"IE"===Env.browser&&(!doc.documentMode||doc.documentMode<8))return nodeRect=getIEPos(node),rootRect=getIEPos(root),{x:nodeRect.x-rootRect.x,y:nodeRect.y-rootRect.y};for(parent=node;parent&&parent!=root&&parent.nodeType;)x+=parent.offsetLeft||0,y+=parent.offsetTop||0,parent=parent.offsetParent;for(parent=node.parentNode;parent&&parent!=root&&parent.nodeType;)x-=parent.scrollLeft||0,y-=parent.scrollTop||0,parent=parent.parentNode;return{x:x,y:y}},getSize=function(node){return{w:node.offsetWidth||node.clientWidth,h:node.offsetHeight||node.clientHeight}};return{get:get,hasClass:hasClass,addClass:addClass,removeClass:removeClass,getStyle:getStyle,getPos:getPos,getSize:getSize}}),define("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(Basic){function _findKey(obj,value){var key;for(key in obj)if(obj[key]===value)return key;return null}return{RuntimeError:function(){function RuntimeError(code){this.code=code,this.name=_findKey(namecodes,code),this.message=this.name+": RuntimeError "+this.code}var namecodes={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return Basic.extend(RuntimeError,namecodes),RuntimeError.prototype=Error.prototype,RuntimeError}(),OperationNotAllowedException:function(){function OperationNotAllowedException(code){this.code=code,this.name="OperationNotAllowedException"}return Basic.extend(OperationNotAllowedException,{NOT_ALLOWED_ERR:1}),OperationNotAllowedException.prototype=Error.prototype,OperationNotAllowedException}(),ImageError:function(){function ImageError(code){this.code=code,this.name=_findKey(namecodes,code),this.message=this.name+": ImageError "+this.code}var namecodes={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};return Basic.extend(ImageError,namecodes),ImageError.prototype=Error.prototype,ImageError}(),FileException:function(){function FileException(code){this.code=code,this.name=_findKey(namecodes,code),this.message=this.name+": FileException "+this.code}var namecodes={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return Basic.extend(FileException,namecodes),FileException.prototype=Error.prototype,FileException}(),DOMException:function(){function DOMException(code){this.code=code,this.name=_findKey(namecodes,code),this.message=this.name+": DOMException "+this.code}var namecodes={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return Basic.extend(DOMException,namecodes),DOMException.prototype=Error.prototype,DOMException}(),EventException:function(){function EventException(code){this.code=code,this.name="EventException"}return Basic.extend(EventException,{UNSPECIFIED_EVENT_TYPE_ERR:0}),EventException.prototype=Error.prototype,EventException}()}}),define("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(Env,x,Basic){function EventTarget(){var eventpool={};Basic.extend(this,{uid:null,init:function(){this.uid||(this.uid=Basic.guid("uid_"))},addEventListener:function(type,fn,priority,scope){var list,self=this;return this.hasOwnProperty("uid")||(this.uid=Basic.guid("uid_")),type=Basic.trim(type),/\s/.test(type)?void Basic.each(type.split(/\s+/),function(type){self.addEventListener(type,fn,priority,scope)}):(type=type.toLowerCase(),priority=parseInt(priority,10)||0,list=eventpool[this.uid]&&eventpool[this.uid][type]||[],list.push({fn:fn,priority:priority,scope:scope||this}),eventpool[this.uid]||(eventpool[this.uid]={}),void(eventpool[this.uid][type]=list))},hasEventListener:function(type){var list=type?eventpool[this.uid]&&eventpool[this.uid][type]:eventpool[this.uid];return list?list:!1},removeEventListener:function(type,fn){type=type.toLowerCase();var i,list=eventpool[this.uid]&&eventpool[this.uid][type];if(list){if(fn){for(i=list.length-1;i>=0;i--)if(list[i].fn===fn){list.splice(i,1);break}}else list=[];list.length||(delete eventpool[this.uid][type],Basic.isEmptyObj(eventpool[this.uid])&&delete eventpool[this.uid])}},removeAllEventListeners:function(){eventpool[this.uid]&&delete eventpool[this.uid]},dispatchEvent:function(type){var uid,list,args,tmpEvt,undef,evt={},result=!0;if("string"!==Basic.typeOf(type)){if(tmpEvt=type,"string"!==Basic.typeOf(tmpEvt.type))throw new x.EventException(x.EventException.UNSPECIFIED_EVENT_TYPE_ERR);type=tmpEvt.type,tmpEvt.total!==undef&&tmpEvt.loaded!==undef&&(evt.total=tmpEvt.total,evt.loaded=tmpEvt.loaded),evt.async=tmpEvt.async||!1}if(-1!==type.indexOf("::")?!function(arr){uid=arr[0],type=arr[1]}(type.split("::")):uid=this.uid,type=type.toLowerCase(),list=eventpool[uid]&&eventpool[uid][type]){list.sort(function(a,b){return b.priority-a.priority}),args=[].slice.call(arguments),args.shift(),evt.type=type,args.unshift(evt),MXI_DEBUG&&Env.debug.events&&Env.log("Event '%s' fired on %u",evt.type,uid);var queue=[];Basic.each(list,function(handler){args[0].target=handler.scope,evt.async?queue.push(function(cb){setTimeout(function(){cb(handler.fn.apply(handler.scope,args)===!1)},1)}):queue.push(function(cb){cb(handler.fn.apply(handler.scope,args)===!1)})}),queue.length&&Basic.inSeries(queue,function(err){result=!err})}return result},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(dispatches){var self=this;this.bind(dispatches.join(" "),function(e){var prop="on"+e.type.toLowerCase();"function"===Basic.typeOf(this[prop])&&this[prop].apply(this,arguments)}),Basic.each(dispatches,function(prop){prop="on"+prop.toLowerCase(prop),"undefined"===Basic.typeOf(self[prop])&&(self[prop]=null)})}})}return EventTarget.instance=new EventTarget,EventTarget}),define("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(Env,Basic,Dom,EventTarget){function Runtime(options,type,caps,modeCaps,preferredMode){var _shim,self=this,_uid=Basic.guid(type+"_"),defaultMode=preferredMode||"browser";options=options||{},runtimes[_uid]=this,caps=Basic.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},caps),options.preferred_caps&&(defaultMode=Runtime.getMode(modeCaps,options.preferred_caps,defaultMode)),MXI_DEBUG&&Env.debug.runtime&&Env.log("	default mode: %s",defaultMode),_shim=function(){var objpool={};return{exec:function(uid,comp,fn,args){return _shim[comp]&&(objpool[uid]||(objpool[uid]={context:this,instance:new _shim[comp]}),objpool[uid].instance[fn])?objpool[uid].instance[fn].apply(this,args):void 0},removeInstance:function(uid){delete objpool[uid]},removeAllInstances:function(){var self=this;Basic.each(objpool,function(obj,uid){"function"===Basic.typeOf(obj.instance.destroy)&&obj.instance.destroy.call(obj.context),self.removeInstance(uid)})}}}(),Basic.extend(this,{initialized:!1,uid:_uid,type:type,mode:Runtime.getMode(modeCaps,options.required_caps,defaultMode),shimid:_uid+"_container",clients:0,options:options,can:function(cap,value){var refCaps=arguments[2]||caps;if("string"===Basic.typeOf(cap)&&"undefined"===Basic.typeOf(value)&&(cap=Runtime.parseCaps(cap)),"object"===Basic.typeOf(cap)){for(var key in cap)if(!this.can(key,cap[key],refCaps))return!1;return!0}return"function"===Basic.typeOf(refCaps[cap])?refCaps[cap].call(this,value):value===refCaps[cap]},getShimContainer:function(){var container,shimContainer=Dom.get(this.shimid);return shimContainer||(container=this.options.container?Dom.get(this.options.container):document.body,shimContainer=document.createElement("div"),shimContainer.id=this.shimid,shimContainer.className="moxie-shim moxie-shim-"+this.type,Basic.extend(shimContainer.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),container.appendChild(shimContainer),container=null),shimContainer},getShim:function(){return _shim},shimExec:function(component,action){var args=[].slice.call(arguments,2);return self.getShim().exec.call(this,this.uid,component,action,args)},exec:function(component,action){var args=[].slice.call(arguments,2);return self[component]&&self[component][action]?self[component][action].apply(this,args):self.shimExec.apply(this,arguments)},destroy:function(){if(self){var shimContainer=Dom.get(this.shimid);shimContainer&&shimContainer.parentNode.removeChild(shimContainer),_shim&&_shim.removeAllInstances(),this.unbindAll(),delete runtimes[this.uid],this.uid=null,_uid=self=_shim=shimContainer=null}}}),this.mode&&options.required_caps&&!this.can(options.required_caps)&&(this.mode=!1)}var runtimeConstructors={},runtimes={};return Runtime.order="html5,flash,silverlight,html4",Runtime.getRuntime=function(uid){return runtimes[uid]?runtimes[uid]:!1},Runtime.addConstructor=function(type,constructor){constructor.prototype=EventTarget.instance,runtimeConstructors[type]=constructor},Runtime.getConstructor=function(type){return runtimeConstructors[type]||null},Runtime.getInfo=function(uid){var runtime=Runtime.getRuntime(uid);return runtime?{uid:runtime.uid,type:runtime.type,mode:runtime.mode,can:function(){return runtime.can.apply(runtime,arguments)}}:null},Runtime.parseCaps=function(capStr){var capObj={};return"string"!==Basic.typeOf(capStr)?capStr||{}:(Basic.each(capStr.split(","),function(key){capObj[key]=!0}),capObj)},Runtime.can=function(type,caps){var runtime,mode,constructor=Runtime.getConstructor(type);return constructor?(runtime=new constructor({required_caps:caps}),mode=runtime.mode,runtime.destroy(),!!mode):!1},Runtime.thatCan=function(caps,runtimeOrder){var types=(runtimeOrder||Runtime.order).split(/\s*,\s*/);for(var i in types)if(Runtime.can(types[i],caps))return types[i];return null},Runtime.getMode=function(modeCaps,requiredCaps,defaultMode){var mode=null;if("undefined"===Basic.typeOf(defaultMode)&&(defaultMode="browser"),requiredCaps&&!Basic.isEmptyObj(modeCaps)){if(Basic.each(requiredCaps,function(value,cap){if(modeCaps.hasOwnProperty(cap)){var capMode=modeCaps[cap](value);if("string"==typeof capMode&&(capMode=[capMode]),mode){if(!(mode=Basic.arrayIntersect(mode,capMode)))return MXI_DEBUG&&Env.debug.runtime&&Env.log("		%c: %v (conflicting mode requested: %s)",cap,value,capMode),mode=!1}else mode=capMode}MXI_DEBUG&&Env.debug.runtime&&Env.log("		%c: %v (compatible modes: %s)",cap,value,mode)}),mode)return-1!==Basic.inArray(defaultMode,mode)?defaultMode:mode[0];if(mode===!1)return!1}return defaultMode},Runtime.capTrue=function(){return!0},Runtime.capFalse=function(){return!1},Runtime.capTest=function(expr){return function(){return!!expr}},Runtime}),define("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(Env,x,Basic,Runtime){return function(){var runtime;Basic.extend(this,{connectRuntime:function(options){function initialize(items){var type,constructor;return items.length?(type=items.shift().toLowerCase(),(constructor=Runtime.getConstructor(type))?(MXI_DEBUG&&Env.debug.runtime&&(Env.log("Trying runtime: %s",type),Env.log(options)),runtime=new constructor(options),runtime.bind("Init",function(){runtime.initialized=!0,MXI_DEBUG&&Env.debug.runtime&&Env.log("Runtime '%s' initialized",runtime.type),setTimeout(function(){runtime.clients++,comp.trigger("RuntimeInit",runtime)},1)}),runtime.bind("Error",function(){MXI_DEBUG&&Env.debug.runtime&&Env.log("Runtime '%s' failed to initialize",runtime.type),runtime.destroy(),initialize(items)}),MXI_DEBUG&&Env.debug.runtime&&Env.log("	selected mode: %s",runtime.mode),runtime.mode?void runtime.init():void runtime.trigger("Error")):void initialize(items)):(comp.trigger("RuntimeError",new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR)),void(runtime=null))}var ruid,comp=this;if("string"===Basic.typeOf(options)?ruid=options:"string"===Basic.typeOf(options.ruid)&&(ruid=options.ruid),ruid){if(runtime=Runtime.getRuntime(ruid))return runtime.clients++,runtime;throw new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR)}initialize((options.runtime_order||Runtime.order).split(/\s*,\s*/))},disconnectRuntime:function(){runtime&&--runtime.clients<=0&&runtime.destroy(),runtime=null},getRuntime:function(){return runtime&&runtime.uid?runtime:runtime=null},exec:function(){return runtime?runtime.exec.apply(this,arguments):null}})}}),define("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(Basic,Env,Mime,Dom,x,EventTarget,I18n,Runtime,RuntimeClient){function FileInput(options){MXI_DEBUG&&Env.log("Instantiating FileInput...");var container,browseButton,defaults,self=this;if(-1!==Basic.inArray(Basic.typeOf(options),["string","node"])&&(options={browse_button:options}),browseButton=Dom.get(options.browse_button),!browseButton)throw new x.DOMException(x.DOMException.NOT_FOUND_ERR);defaults={accept:[{title:I18n.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:browseButton.parentNode||document.body},options=Basic.extend({},defaults,options),"string"==typeof options.required_caps&&(options.required_caps=Runtime.parseCaps(options.required_caps)),"string"==typeof options.accept&&(options.accept=Mime.mimes2extList(options.accept)),container=Dom.get(options.container),container||(container=document.body),"static"===Dom.getStyle(container,"position")&&(container.style.position="relative"),container=browseButton=null,RuntimeClient.call(self),Basic.extend(self,{uid:Basic.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){self.bind("RuntimeInit",function(e,runtime){self.ruid=runtime.uid,self.shimid=runtime.shimid,self.bind("Ready",function(){self.trigger("Refresh")},999),self.bind("Refresh",function(){var pos,size,browseButton,shimContainer;browseButton=Dom.get(options.browse_button),shimContainer=Dom.get(runtime.shimid),browseButton&&(pos=Dom.getPos(browseButton,Dom.get(options.container)),size=Dom.getSize(browseButton),shimContainer&&Basic.extend(shimContainer.style,{top:pos.y+"px",left:pos.x+"px",width:size.w+"px",height:size.h+"px"})),shimContainer=browseButton=null}),runtime.exec.call(self,"FileInput","init",options)}),self.connectRuntime(Basic.extend({},options,{required_caps:{select_file:!0}}))},disable:function(state){var runtime=this.getRuntime();runtime&&runtime.exec.call(this,"FileInput","disable","undefined"===Basic.typeOf(state)?!0:state)},refresh:function(){self.trigger("Refresh")},destroy:function(){var runtime=this.getRuntime();runtime&&(runtime.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===Basic.typeOf(this.files)&&Basic.each(this.files,function(file){file.destroy()}),this.files=null,this.unbindAll()}}),this.handleEventProps(dispatches)}var dispatches=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return FileInput.prototype=EventTarget.instance,FileInput}),define("moxie/core/utils/Encode",[],function(){var utf8_encode=function(str){return unescape(encodeURIComponent(str))},utf8_decode=function(str_data){return decodeURIComponent(escape(str_data))},atob=function(data,utf8){if("function"==typeof window.atob)return utf8?utf8_decode(window.atob(data)):window.atob(data);var o1,o2,o3,h1,h2,h3,h4,bits,b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,ac=0,dec="",tmp_arr=[];if(!data)return data;data+="";do h1=b64.indexOf(data.charAt(i++)),h2=b64.indexOf(data.charAt(i++)),h3=b64.indexOf(data.charAt(i++)),h4=b64.indexOf(data.charAt(i++)),bits=h1<<18|h2<<12|h3<<6|h4,o1=bits>>16&255,o2=bits>>8&255,o3=255&bits,64==h3?tmp_arr[ac++]=String.fromCharCode(o1):64==h4?tmp_arr[ac++]=String.fromCharCode(o1,o2):tmp_arr[ac++]=String.fromCharCode(o1,o2,o3);while(i<data.length);return dec=tmp_arr.join(""),utf8?utf8_decode(dec):dec},btoa=function(data,utf8){if(utf8&&(data=utf8_encode(data)),"function"==typeof window.btoa)return window.btoa(data);var o1,o2,o3,h1,h2,h3,h4,bits,b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,ac=0,enc="",tmp_arr=[];if(!data)return data;do o1=data.charCodeAt(i++),o2=data.charCodeAt(i++),o3=data.charCodeAt(i++),bits=o1<<16|o2<<8|o3,h1=bits>>18&63,h2=bits>>12&63,h3=bits>>6&63,h4=63&bits,tmp_arr[ac++]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4);while(i<data.length);enc=tmp_arr.join("");var r=data.length%3;return(r?enc.slice(0,r-3):enc)+"===".slice(r||3)};return{utf8_encode:utf8_encode,utf8_decode:utf8_decode,atob:atob,btoa:btoa}}),define("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(Basic,Encode,RuntimeClient){function Blob(ruid,blob){function _sliceDetached(start,end,type){var blob,data=blobpool[this.uid];return"string"===Basic.typeOf(data)&&data.length?(blob=new Blob(null,{type:type,size:end-start}),blob.detach(data.substr(start,blob.size)),blob):null}RuntimeClient.call(this),ruid&&this.connectRuntime(ruid),blob?"string"===Basic.typeOf(blob)&&(blob={data:blob}):blob={},Basic.extend(this,{uid:blob.uid||Basic.guid("uid_"),ruid:ruid,size:blob.size||0,type:blob.type||"",slice:function(start,end,type){return this.isDetached()?_sliceDetached.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),start,end,type)},getSource:function(){return blobpool[this.uid]?blobpool[this.uid]:null},detach:function(data){if(this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),data=data||"","data:"==data.substr(0,5)){var base64Offset=data.indexOf(";base64,");this.type=data.substring(5,base64Offset),data=Encode.atob(data.substring(base64Offset+8))}this.size=data.length,blobpool[this.uid]=data},isDetached:function(){return!this.ruid&&"string"===Basic.typeOf(blobpool[this.uid])},destroy:function(){this.detach(),delete blobpool[this.uid]}}),blob.data?this.detach(blob.data):blobpool[this.uid]=blob}var blobpool={};return Blob}),define("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(Basic,Mime,Blob){function File(ruid,file){file||(file={}),Blob.apply(this,arguments),this.type||(this.type=Mime.getFileMime(file.name));var name;if(file.name)name=file.name.replace(/\\/g,"/"),name=name.substr(name.lastIndexOf("/")+1);else if(this.type){var prefix=this.type.split("/")[0];name=Basic.guid((""!==prefix?prefix:"file")+"_"),Mime.extensions[this.type]&&(name+="."+Mime.extensions[this.type][0])}Basic.extend(this,{name:name||Basic.guid("file_"),relativePath:"",lastModifiedDate:file.lastModifiedDate||(new Date).toLocaleString()})}return File.prototype=Blob.prototype,File}),define("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/core/utils/Env","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(I18n,Dom,x,Basic,Env,File,RuntimeClient,EventTarget,Mime){function FileDrop(options){MXI_DEBUG&&Env.log("Instantiating FileDrop...");var defaults,self=this;"string"==typeof options&&(options={drop_zone:options}),defaults={accept:[{title:I18n.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},options="object"==typeof options?Basic.extend({},defaults,options):defaults,options.container=Dom.get(options.drop_zone)||document.body,"static"===Dom.getStyle(options.container,"position")&&(options.container.style.position="relative"),"string"==typeof options.accept&&(options.accept=Mime.mimes2extList(options.accept)),RuntimeClient.call(self),Basic.extend(self,{uid:Basic.guid("uid_"),ruid:null,files:null,init:function(){self.bind("RuntimeInit",function(e,runtime){self.ruid=runtime.uid,runtime.exec.call(self,"FileDrop","init",options),self.dispatchEvent("ready")}),self.connectRuntime(options)},destroy:function(){var runtime=this.getRuntime();runtime&&(runtime.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null,this.unbindAll()}}),this.handleEventProps(dispatches)}var dispatches=["ready","dragenter","dragleave","drop","error"];return FileDrop.prototype=EventTarget.instance,FileDrop}),define("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/runtime/RuntimeClient"],function(Basic,Encode,x,EventTarget,Blob,RuntimeClient){function FileReader(){function _read(op,blob){if(this.trigger("loadstart"),this.readyState===FileReader.LOADING)return this.trigger("error",new x.DOMException(x.DOMException.INVALID_STATE_ERR)),void this.trigger("loadend");if(!(blob instanceof Blob))return this.trigger("error",new x.DOMException(x.DOMException.NOT_FOUND_ERR)),void this.trigger("loadend");if(this.result=null,this.readyState=FileReader.LOADING,blob.isDetached()){var src=blob.getSource();switch(op){case"readAsText":case"readAsBinaryString":this.result=src;break;case"readAsDataURL":this.result="data:"+blob.type+";base64,"+Encode.btoa(src)}this.readyState=FileReader.DONE,this.trigger("load"),this.trigger("loadend")}else this.connectRuntime(blob.ruid),this.exec("FileReader","read",op,blob)}RuntimeClient.call(this),Basic.extend(this,{uid:Basic.guid("uid_"),readyState:FileReader.EMPTY,result:null,error:null,readAsBinaryString:function(blob){_read.call(this,"readAsBinaryString",blob)},readAsDataURL:function(blob){_read.call(this,"readAsDataURL",blob)},readAsText:function(blob){_read.call(this,"readAsText",blob)},abort:function(){this.result=null,-1===Basic.inArray(this.readyState,[FileReader.EMPTY,FileReader.DONE])&&(this.readyState===FileReader.LOADING&&(this.readyState=FileReader.DONE),this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),this.exec("FileReader","destroy"),this.disconnectRuntime(),this.unbindAll()}}),this.handleEventProps(dispatches),this.bind("Error",function(e,err){this.readyState=FileReader.DONE,this.error=err},999),this.bind("Load",function(e){this.readyState=FileReader.DONE},999)}var dispatches=["loadstart","progress","load","abort","error","loadend"];return FileReader.EMPTY=0,FileReader.LOADING=1,FileReader.DONE=2,FileReader.prototype=EventTarget.instance,FileReader}),define("moxie/core/utils/Url",[],function(){var parseUrl=function(url,currentUrl){for(var key=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],i=key.length,ports={http:80,https:443},uri={},regex=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,m=regex.exec(url||"");i--;)m[i]&&(uri[key[i]]=m[i]);if(!uri.scheme){currentUrl&&"string"!=typeof currentUrl||(currentUrl=parseUrl(currentUrl||document.location.href)),uri.scheme=currentUrl.scheme,uri.host=currentUrl.host,uri.port=currentUrl.port;var path="";/^[^\/]/.test(uri.path)&&(path=currentUrl.path,path=/\/[^\/]*\.[^\/]*$/.test(path)?path.replace(/\/[^\/]+$/,"/"):path.replace(/\/?$/,"/")),uri.path=path+(uri.path||"")}return uri.port||(uri.port=ports[uri.scheme]||80),uri.port=parseInt(uri.port,10),uri.path||(uri.path="/"),delete uri.source,uri},resolveUrl=function(url){var ports={http:80,https:443},urlp="object"==typeof url?url:parseUrl(url);return urlp.scheme+"://"+urlp.host+(urlp.port!==ports[urlp.scheme]?":"+urlp.port:"")+urlp.path+(urlp.query?urlp.query:"")},hasSameOrigin=function(url){function origin(url){return[url.scheme,url.host,url.port].join("/")}return"string"==typeof url&&(url=parseUrl(url)),origin(parseUrl())===origin(url)};return{parseUrl:parseUrl,resolveUrl:resolveUrl,hasSameOrigin:hasSameOrigin}}),define("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(Basic,RuntimeClient,EventTarget){function RuntimeTarget(){this.uid=Basic.guid("uid_"),RuntimeClient.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return RuntimeTarget.prototype=EventTarget.instance,RuntimeTarget}),define("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(Basic,RuntimeClient,Encode){return function(){function _read(op,blob){if(!blob.isDetached()){var result=this.connectRuntime(blob.ruid).exec.call(this,"FileReaderSync","read",op,blob);return this.disconnectRuntime(),result}var src=blob.getSource();switch(op){case"readAsBinaryString":return src;case"readAsDataURL":return"data:"+blob.type+";base64,"+Encode.btoa(src);case"readAsText":for(var txt="",i=0,length=src.length;length>i;i++)txt+=String.fromCharCode(src[i]);return txt}}RuntimeClient.call(this),Basic.extend(this,{uid:Basic.guid("uid_"),readAsBinaryString:function(blob){return _read.call(this,"readAsBinaryString",blob)},readAsDataURL:function(blob){return _read.call(this,"readAsDataURL",blob)},readAsText:function(blob){return _read.call(this,"readAsText",blob)}})}}),define("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(x,Basic,Blob){function FormData(){var _blob,_fields=[];Basic.extend(this,{append:function(name,value){var self=this,valueType=Basic.typeOf(value);value instanceof Blob?_blob={name:name,value:value}:"array"===valueType?(name+="[]",Basic.each(value,function(value){self.append(name,value)})):"object"===valueType?Basic.each(value,function(value,key){self.append(name+"["+key+"]",value)}):"null"===valueType||"undefined"===valueType||"number"===valueType&&isNaN(value)?self.append(name,"false"):_fields.push({name:name,value:value.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return _blob&&_blob.value||null},getBlobName:function(){return _blob&&_blob.name||null},each:function(cb){Basic.each(_fields,function(field){cb(field.value,field.name)}),_blob&&cb(_blob.value,_blob.name)},destroy:function(){_blob=null,_fields=[]}})}return FormData}),define("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(Basic,x,EventTarget,Encode,Url,Runtime,RuntimeTarget,Blob,FileReaderSync,FormData,Env,Mime){function XMLHttpRequestUpload(){this.uid=Basic.guid("uid_")}function XMLHttpRequest(){function _p(prop,value){return props.hasOwnProperty(prop)?1===arguments.length?Env.can("define_property")?props[prop]:self[prop]:void(Env.can("define_property")?props[prop]=value:self[prop]=value):void 0}function _doXHR(data){function loadEnd(){_xhr&&(_xhr.destroy(),_xhr=null),self.dispatchEvent("loadend"),self=null}function exec(runtime){_xhr.bind("LoadStart",function(e){_p("readyState",XMLHttpRequest.LOADING),self.dispatchEvent("readystatechange"),self.dispatchEvent(e),_upload_events_flag&&self.upload.dispatchEvent(e)}),_xhr.bind("Progress",function(e){_p("readyState")!==XMLHttpRequest.LOADING&&(_p("readyState",XMLHttpRequest.LOADING),self.dispatchEvent("readystatechange")),self.dispatchEvent(e)}),_xhr.bind("UploadProgress",function(e){_upload_events_flag&&self.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:e.total,loaded:e.loaded})}),_xhr.bind("Load",function(e){_p("readyState",XMLHttpRequest.DONE),_p("status",Number(runtime.exec.call(_xhr,"XMLHttpRequest","getStatus")||0)),_p("statusText",httpCode[_p("status")]||""),_p("response",runtime.exec.call(_xhr,"XMLHttpRequest","getResponse",_p("responseType"))),~Basic.inArray(_p("responseType"),["text",""])?_p("responseText",_p("response")):"document"===_p("responseType")&&_p("responseXML",_p("response")),_responseHeaders=runtime.exec.call(_xhr,"XMLHttpRequest","getAllResponseHeaders"),self.dispatchEvent("readystatechange"),_p("status")>0?(_upload_events_flag&&self.upload.dispatchEvent(e),self.dispatchEvent(e)):(_error_flag=!0,self.dispatchEvent("error")),loadEnd()}),_xhr.bind("Abort",function(e){self.dispatchEvent(e),loadEnd()}),_xhr.bind("Error",function(e){_error_flag=!0,_p("readyState",XMLHttpRequest.DONE),self.dispatchEvent("readystatechange"),_upload_complete_flag=!0,self.dispatchEvent(e),loadEnd()}),runtime.exec.call(_xhr,"XMLHttpRequest","send",{url:_url,method:_method,async:_async,user:_user,password:_password,headers:_headers,
mimeType:_mimeType,encoding:_encoding,responseType:self.responseType,withCredentials:self.withCredentials,options:_options},data)}var self=this;_start_time=(new Date).getTime(),_xhr=new RuntimeTarget,"string"==typeof _options.required_caps&&(_options.required_caps=Runtime.parseCaps(_options.required_caps)),_options.required_caps=Basic.extend({},_options.required_caps,{return_response_type:self.responseType}),data instanceof FormData&&(_options.required_caps.send_multipart=!0),Basic.isEmptyObj(_headers)||(_options.required_caps.send_custom_headers=!0),_same_origin_flag||(_options.required_caps.do_cors=!0),_options.ruid?exec(_xhr.connectRuntime(_options)):(_xhr.bind("RuntimeInit",function(e,runtime){exec(runtime)}),_xhr.bind("RuntimeError",function(e,err){self.dispatchEvent("RuntimeError",err)}),_xhr.connectRuntime(_options))}function _reset(){_p("responseText",""),_p("responseXML",null),_p("response",null),_p("status",0),_p("statusText",""),_start_time=_timeoutset_time=null}var _url,_method,_user,_password,_start_time,_timeoutset_time,_xhr,_responseHeadersBag,self=this,props={timeout:0,readyState:XMLHttpRequest.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},_async=!0,_headers={},_encoding=null,_mimeType=null,_sync_flag=!1,_send_flag=!1,_upload_events_flag=!1,_upload_complete_flag=!1,_error_flag=!1,_same_origin_flag=!1,_finalMime=null,_finalCharset=null,_options={},_responseHeaders="";Basic.extend(this,props,{uid:Basic.guid("uid_"),upload:new XMLHttpRequestUpload,open:function(method,url,async,user,password){var urlp;if(!method||!url)throw new x.DOMException(x.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(method)||Encode.utf8_encode(method)!==method)throw new x.DOMException(x.DOMException.SYNTAX_ERR);if(~Basic.inArray(method.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(_method=method.toUpperCase()),~Basic.inArray(_method,["CONNECT","TRACE","TRACK"]))throw new x.DOMException(x.DOMException.SECURITY_ERR);if(url=Encode.utf8_encode(url),urlp=Url.parseUrl(url),_same_origin_flag=Url.hasSameOrigin(urlp),_url=Url.resolveUrl(url),(user||password)&&!_same_origin_flag)throw new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);if(_user=user||urlp.user,_password=password||urlp.pass,_async=async||!0,_async===!1&&(_p("timeout")||_p("withCredentials")||""!==_p("responseType")))throw new x.DOMException(x.DOMException.INVALID_ACCESS_ERR);_sync_flag=!_async,_send_flag=!1,_headers={},_reset.call(this),_p("readyState",XMLHttpRequest.OPENED),this.dispatchEvent("readystatechange")},setRequestHeader:function(header,value){var uaHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(_p("readyState")!==XMLHttpRequest.OPENED||_send_flag)throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(header)||Encode.utf8_encode(header)!==header)throw new x.DOMException(x.DOMException.SYNTAX_ERR);return header=Basic.trim(header).toLowerCase(),~Basic.inArray(header,uaHeaders)||/^(proxy\-|sec\-)/.test(header)?!1:(_headers[header]?_headers[header]+=", "+value:_headers[header]=value,!0)},getAllResponseHeaders:function(){return _responseHeaders||""},getResponseHeader:function(header){return header=header.toLowerCase(),_error_flag||~Basic.inArray(header,["set-cookie","set-cookie2"])?null:_responseHeaders&&""!==_responseHeaders&&(_responseHeadersBag||(_responseHeadersBag={},Basic.each(_responseHeaders.split(/\r\n/),function(line){var pair=line.split(/:\s+/);2===pair.length&&(pair[0]=Basic.trim(pair[0]),_responseHeadersBag[pair[0].toLowerCase()]={header:pair[0],value:Basic.trim(pair[1])})})),_responseHeadersBag.hasOwnProperty(header))?_responseHeadersBag[header].header+": "+_responseHeadersBag[header].value:null},overrideMimeType:function(mime){var matches,charset;if(~Basic.inArray(_p("readyState"),[XMLHttpRequest.LOADING,XMLHttpRequest.DONE]))throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);if(mime=Basic.trim(mime.toLowerCase()),/;/.test(mime)&&(matches=mime.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(mime=matches[1],matches[2]&&(charset=matches[2])),!Mime.mimes[mime])throw new x.DOMException(x.DOMException.SYNTAX_ERR);_finalMime=mime,_finalCharset=charset},send:function(data,options){if(_options="string"===Basic.typeOf(options)?{ruid:options}:options?options:{},this.readyState!==XMLHttpRequest.OPENED||_send_flag)throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);if(data instanceof Blob)_options.ruid=data.ruid,_mimeType=data.type||"application/octet-stream";else if(data instanceof FormData){if(data.hasBlob()){var blob=data.getBlob();_options.ruid=blob.ruid,_mimeType=blob.type||"application/octet-stream"}}else"string"==typeof data&&(_encoding="UTF-8",_mimeType="text/plain;charset=UTF-8",data=Encode.utf8_encode(data));this.withCredentials||(this.withCredentials=_options.required_caps&&_options.required_caps.send_browser_cookies&&!_same_origin_flag),_upload_events_flag=!_sync_flag&&this.upload.hasEventListener(),_error_flag=!1,_upload_complete_flag=!data,_sync_flag||(_send_flag=!0),_doXHR.call(this,data)},abort:function(){if(_error_flag=!0,_sync_flag=!1,~Basic.inArray(_p("readyState"),[XMLHttpRequest.UNSENT,XMLHttpRequest.OPENED,XMLHttpRequest.DONE]))_p("readyState",XMLHttpRequest.UNSENT);else{if(_p("readyState",XMLHttpRequest.DONE),_send_flag=!1,!_xhr)throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);_xhr.getRuntime().exec.call(_xhr,"XMLHttpRequest","abort",_upload_complete_flag),_upload_complete_flag=!0}},destroy:function(){_xhr&&("function"===Basic.typeOf(_xhr.destroy)&&_xhr.destroy(),_xhr=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}}),this.handleEventProps(dispatches.concat(["readystatechange"])),this.upload.handleEventProps(dispatches)}var httpCode={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};XMLHttpRequestUpload.prototype=EventTarget.instance;var dispatches=["loadstart","progress","abort","error","load","timeout","loadend"];return XMLHttpRequest.UNSENT=0,XMLHttpRequest.OPENED=1,XMLHttpRequest.HEADERS_RECEIVED=2,XMLHttpRequest.LOADING=3,XMLHttpRequest.DONE=4,XMLHttpRequest.prototype=EventTarget.instance,XMLHttpRequest}),define("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(Basic,Encode,RuntimeClient,EventTarget){function Transporter(){function _reset(){_size=_pos=0,_data=this.result=null}function _run(type,runtime){var self=this;_runtime=runtime,self.bind("TransportingProgress",function(e){_pos=e.loaded,_size>_pos&&-1===Basic.inArray(self.state,[Transporter.IDLE,Transporter.DONE])&&_transport.call(self)},999),self.bind("TransportingComplete",function(){_pos=_size,self.state=Transporter.DONE,_data=null,self.result=_runtime.exec.call(self,"Transporter","getAsBlob",type||"")},999),self.state=Transporter.BUSY,self.trigger("TransportingStarted"),_transport.call(self)}function _transport(){var chunk,self=this,bytesLeft=_size-_pos;_chunk_size>bytesLeft&&(_chunk_size=bytesLeft),chunk=Encode.btoa(_data.substr(_pos,_chunk_size)),_runtime.exec.call(self,"Transporter","receive",chunk,_size)}var mod,_runtime,_data,_size,_pos,_chunk_size;RuntimeClient.call(this),Basic.extend(this,{uid:Basic.guid("uid_"),state:Transporter.IDLE,result:null,transport:function(data,type,options){var self=this;if(options=Basic.extend({chunk_size:204798},options),(mod=options.chunk_size%3)&&(options.chunk_size+=3-mod),_chunk_size=options.chunk_size,_reset.call(this),_data=data,_size=data.length,"string"===Basic.typeOf(options)||options.ruid)_run.call(self,type,this.connectRuntime(options));else{var cb=function(e,runtime){self.unbind("RuntimeInit",cb),_run.call(self,type,runtime)};this.bind("RuntimeInit",cb),this.connectRuntime(options)}},abort:function(){var self=this;self.state=Transporter.IDLE,_runtime&&(_runtime.exec.call(self,"Transporter","clear"),self.trigger("TransportingAborted")),_reset.call(self)},destroy:function(){this.unbindAll(),_runtime=null,this.disconnectRuntime(),_reset.call(this)}})}return Transporter.IDLE=0,Transporter.BUSY=1,Transporter.DONE=2,Transporter.prototype=EventTarget.instance,Transporter}),define("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(Basic,Dom,x,FileReaderSync,XMLHttpRequest,Runtime,RuntimeClient,Transporter,Env,EventTarget,Blob,File,Encode){function Image(){function _updateInfo(info){info||(info=this.exec("Image","getInfo")),this.size=info.size,this.width=info.width,this.height=info.height,this.type=info.type,this.meta=info.meta,""===this.name&&(this.name=info.name)}function _load(src){var srcType=Basic.typeOf(src);try{if(src instanceof Image){if(!src.size)throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);_loadFromImage.apply(this,arguments)}else if(src instanceof Blob){if(!~Basic.inArray(src.type,["image/jpeg","image/png"]))throw new x.ImageError(x.ImageError.WRONG_FORMAT);_loadFromBlob.apply(this,arguments)}else if(-1!==Basic.inArray(srcType,["blob","file"]))_load.call(this,new File(null,src),arguments[1]);else if("string"===srcType)"data:"===src.substr(0,5)?_load.call(this,new Blob(null,{data:src}),arguments[1]):_loadFromUrl.apply(this,arguments);else{if("node"!==srcType||"img"!==src.nodeName.toLowerCase())throw new x.DOMException(x.DOMException.TYPE_MISMATCH_ERR);_load.call(this,src.src,arguments[1])}}catch(ex){this.trigger("error",ex.code)}}function _loadFromImage(img,exact){var runtime=this.connectRuntime(img.ruid);this.ruid=runtime.uid,runtime.exec.call(this,"Image","loadFromImage",img,"undefined"===Basic.typeOf(exact)?!0:exact)}function _loadFromBlob(blob,options){function exec(runtime){self.ruid=runtime.uid,runtime.exec.call(self,"Image","loadFromBlob",blob)}var self=this;self.name=blob.name||"",blob.isDetached()?(this.bind("RuntimeInit",function(e,runtime){exec(runtime)}),options&&"string"==typeof options.required_caps&&(options.required_caps=Runtime.parseCaps(options.required_caps)),this.connectRuntime(Basic.extend({required_caps:{access_image_binary:!0,resize_image:!0}},options))):exec(this.connectRuntime(blob.ruid))}function _loadFromUrl(url,options){var xhr,self=this;xhr=new XMLHttpRequest,xhr.open("get",url),xhr.responseType="blob",xhr.onprogress=function(e){self.trigger(e)},xhr.onload=function(){_loadFromBlob.call(self,xhr.response,!0)},xhr.onerror=function(e){self.trigger(e)},xhr.onloadend=function(){xhr.destroy()},xhr.bind("RuntimeError",function(e,err){self.trigger("RuntimeError",err)}),xhr.send(null,options)}RuntimeClient.call(this),Basic.extend(this,{uid:Basic.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){_load.apply(this,arguments)},downsize:function(opts){var defaults={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,preserveHeaders:!0,resample:!1};opts="object"==typeof opts?Basic.extend(defaults,opts):Basic.extend(defaults,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]});try{if(!this.size)throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);if(this.width>Image.MAX_RESIZE_WIDTH||this.height>Image.MAX_RESIZE_HEIGHT)throw new x.ImageError(x.ImageError.MAX_RESOLUTION_ERR);this.exec("Image","downsize",opts.width,opts.height,opts.crop,opts.preserveHeaders)}catch(ex){this.trigger("error",ex.code)}},crop:function(width,height,preserveHeaders){this.downsize(width,height,!0,preserveHeaders)},getAsCanvas:function(){if(!Env.can("create_canvas"))throw new x.RuntimeError(x.RuntimeError.NOT_SUPPORTED_ERR);var runtime=this.connectRuntime(this.ruid);return runtime.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(type,quality){if(!this.size)throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsBlob",type||"image/jpeg",quality||90)},getAsDataURL:function(type,quality){if(!this.size)throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",type||"image/jpeg",quality||90)},getAsBinaryString:function(type,quality){var dataUrl=this.getAsDataURL(type,quality);return Encode.atob(dataUrl.substring(dataUrl.indexOf("base64,")+7))},embed:function(el,opts){function render(type,quality){var img=this;if(Env.can("create_canvas")){var canvas=img.getAsCanvas();if(canvas)return el.appendChild(canvas),canvas=null,img.destroy(),void self.trigger("embedded")}var dataUrl=img.getAsDataURL(type,quality);if(!dataUrl)throw new x.ImageError(x.ImageError.WRONG_FORMAT);if(Env.can("use_data_uri_of",dataUrl.length))el.innerHTML='<img src="'+dataUrl+'" width="'+img.width+'" height="'+img.height+'" />',img.destroy(),self.trigger("embedded");else{var tr=new Transporter;tr.bind("TransportingComplete",function(){runtime=self.connectRuntime(this.result.ruid),self.bind("Embedded",function(){Basic.extend(runtime.getShimContainer().style,{top:"0px",left:"0px",width:img.width+"px",height:img.height+"px"}),runtime=null},999),runtime.exec.call(self,"ImageView","display",this.result.uid,width,height),img.destroy()}),tr.transport(Encode.atob(dataUrl.substring(dataUrl.indexOf("base64,")+7)),type,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:el})}}var runtime,self=this;opts=Basic.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90},opts||{});try{if(!(el=Dom.get(el)))throw new x.DOMException(x.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new x.DOMException(x.DOMException.INVALID_STATE_ERR);this.width>Image.MAX_RESIZE_WIDTH||this.height>Image.MAX_RESIZE_HEIGHT;var imgCopy=new Image;return imgCopy.bind("Resize",function(){render.call(this,opts.type,opts.quality)}),imgCopy.bind("Load",function(){imgCopy.downsize(opts)}),this.meta.thumb&&this.meta.thumb.width>=opts.width&&this.meta.thumb.height>=opts.height?imgCopy.load(this.meta.thumb.data):imgCopy.clone(this,!1),imgCopy}catch(ex){this.trigger("error",ex.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}}),this.handleEventProps(dispatches),this.bind("Load Resize",function(){_updateInfo.call(this)},999)}var dispatches=["progress","load","error","resize","embedded"];return Image.MAX_RESIZE_WIDTH=8192,Image.MAX_RESIZE_HEIGHT=8192,Image.prototype=EventTarget.instance,Image}),define("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(Basic,x,Runtime,Env){function Html5Runtime(options){var I=this,Test=Runtime.capTest,True=Runtime.capTrue,caps=Basic.extend({access_binary:Test(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return I.can("access_binary")&&!!extensions.Image},display_media:Test(Env.can("create_canvas")||Env.can("use_data_uri_over32kb")),do_cors:Test(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:Test(function(){var div=document.createElement("div");return("draggable"in div||"ondragstart"in div&&"ondrop"in div)&&("IE"!==Env.browser||Env.verComp(Env.version,9,">"))}()),filter_by_extension:Test(function(){return"Chrome"===Env.browser&&Env.verComp(Env.version,28,">=")||"IE"===Env.browser&&Env.verComp(Env.version,10,">=")||"Safari"===Env.browser&&Env.verComp(Env.version,7,">=")}()),return_response_headers:True,return_response_type:function(responseType){return"json"===responseType&&window.JSON?!0:Env.can("return_response_type",responseType)},return_status_code:True,report_upload_progress:Test(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return I.can("access_binary")&&Env.can("create_canvas")},select_file:function(){return Env.can("use_fileinput")&&window.File},select_folder:function(){return I.can("select_file")&&"Chrome"===Env.browser&&Env.verComp(Env.version,21,">=")},select_multiple:function(){return I.can("select_file")&&!("Safari"===Env.browser&&"Windows"===Env.os)&&!("iOS"===Env.os&&Env.verComp(Env.osVersion,"7.0.0",">")&&Env.verComp(Env.osVersion,"8.0.0","<"))},send_binary_string:Test(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:Test(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||I.can("send_binary_string")},slice_blob:Test(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return I.can("slice_blob")&&I.can("send_multipart")},summon_file_dialog:function(){return I.can("select_file")&&("Firefox"===Env.browser&&Env.verComp(Env.version,4,">=")||"Opera"===Env.browser&&Env.verComp(Env.version,12,">=")||"IE"===Env.browser&&Env.verComp(Env.version,10,">=")||!!~Basic.inArray(Env.browser,["Chrome","Safari"]))},upload_filesize:True},arguments[2]);Runtime.call(this,options,arguments[1]||type,caps),Basic.extend(this,{init:function(){this.trigger("Init")},destroy:function(destroy){return function(){destroy.call(I),destroy=I=null}}(this.destroy)}),Basic.extend(this.getShim(),extensions)}var type="html5",extensions={};return Runtime.addConstructor(type,Html5Runtime),extensions}),define("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(Basic){function preventDefault(){this.returnValue=!1}function stopPropagation(){this.cancelBubble=!0}var eventhash={},uid="moxie_"+Basic.guid(),addEvent=function(obj,name,callback,key){var func,events;name=name.toLowerCase(),obj.addEventListener?(func=callback,obj.addEventListener(name,func,!1)):obj.attachEvent&&(func=function(){var evt=window.event;evt.target||(evt.target=evt.srcElement),evt.preventDefault=preventDefault,evt.stopPropagation=stopPropagation,callback(evt)},obj.attachEvent("on"+name,func)),obj[uid]||(obj[uid]=Basic.guid()),eventhash.hasOwnProperty(obj[uid])||(eventhash[obj[uid]]={}),events=eventhash[obj[uid]],events.hasOwnProperty(name)||(events[name]=[]),events[name].push({func:func,orig:callback,key:key})},removeEvent=function(obj,name,callback){var type,undef;if(name=name.toLowerCase(),obj[uid]&&eventhash[obj[uid]]&&eventhash[obj[uid]][name]){type=eventhash[obj[uid]][name];for(var i=type.length-1;i>=0&&(type[i].orig!==callback&&type[i].key!==callback||(obj.removeEventListener?obj.removeEventListener(name,type[i].func,!1):obj.detachEvent&&obj.detachEvent("on"+name,type[i].func),type[i].orig=null,type[i].func=null,type.splice(i,1),callback===undef));i--);if(type.length||delete eventhash[obj[uid]][name],Basic.isEmptyObj(eventhash[obj[uid]])){delete eventhash[obj[uid]];try{delete obj[uid]}catch(e){obj[uid]=undef}}}},removeAllEvents=function(obj,key){obj&&obj[uid]&&Basic.each(eventhash[obj[uid]],function(events,name){removeEvent(obj,name,key)})};return{addEvent:addEvent,removeEvent:removeEvent,removeAllEvents:removeAllEvents}}),define("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(extensions,File,Basic,Dom,Events,Mime,Env){function FileInput(){var _options;Basic.extend(this,{init:function(options){var input,shimContainer,mimes,browseButton,zIndex,top,comp=this,I=comp.getRuntime();_options=options,mimes=_options.accept.mimes||Mime.extList2mimes(_options.accept,I.can("filter_by_extension")),shimContainer=I.getShimContainer(),shimContainer.innerHTML='<input id="'+I.uid+'" type="file" style="font-size:999px;opacity:0;"'+(_options.multiple&&I.can("select_multiple")?"multiple":"")+(_options.directory&&I.can("select_folder")?"webkitdirectory directory":"")+(mimes?' accept="'+mimes.join(",")+'"':"")+" />",input=Dom.get(I.uid),Basic.extend(input.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),browseButton=Dom.get(_options.browse_button),I.can("summon_file_dialog")&&("static"===Dom.getStyle(browseButton,"position")&&(browseButton.style.position="relative"),zIndex=parseInt(Dom.getStyle(browseButton,"z-index"),10)||1,browseButton.style.zIndex=zIndex,shimContainer.style.zIndex=zIndex-1,Events.addEvent(browseButton,"click",function(e){var input=Dom.get(I.uid);input&&!input.disabled&&input.click(),e.preventDefault()},comp.uid)),top=I.can("summon_file_dialog")?browseButton:shimContainer,Events.addEvent(top,"mouseover",function(){comp.trigger("mouseenter")},comp.uid),Events.addEvent(top,"mouseout",function(){comp.trigger("mouseleave")},comp.uid),Events.addEvent(top,"mousedown",function(){comp.trigger("mousedown")},comp.uid),Events.addEvent(Dom.get(_options.container),"mouseup",function(){comp.trigger("mouseup")},comp.uid),input.onchange=function onChange(e){if(comp.files=[],Basic.each(this.files,function(file){var relativePath="";return _options.directory&&"."==file.name?!0:(file.webkitRelativePath&&(relativePath="/"+file.webkitRelativePath.replace(/^\//,"")),file=new File(I.uid,file),file.relativePath=relativePath,void comp.files.push(file))}),"IE"!==Env.browser&&"IEMobile"!==Env.browser)this.value="";else{var clone=this.cloneNode(!0);this.parentNode.replaceChild(clone,this),clone.onchange=onChange}comp.files.length&&comp.trigger("change")},comp.trigger({type:"ready",async:!0}),shimContainer=null},disable:function(state){var input,I=this.getRuntime();(input=Dom.get(I.uid))&&(input.disabled=!!state)},destroy:function(){var I=this.getRuntime(),shim=I.getShim(),shimContainer=I.getShimContainer();Events.removeAllEvents(shimContainer,this.uid),Events.removeAllEvents(_options&&Dom.get(_options.container),this.uid),Events.removeAllEvents(_options&&Dom.get(_options.browse_button),this.uid),shimContainer&&(shimContainer.innerHTML=""),shim.removeInstance(this.uid),_options=shimContainer=shim=null}})}return extensions.FileInput=FileInput}),define("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(extensions,Blob){function HTML5Blob(){function w3cBlobSlice(blob,start,end){var blobSlice;if(!window.File.prototype.slice)return(blobSlice=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?blobSlice.call(blob,start,end):null;try{return blob.slice(),blob.slice(start,end)}catch(e){return blob.slice(start,end-start)}}this.slice=function(){return new Blob(this.getRuntime().uid,w3cBlobSlice.apply(this,arguments))}}return extensions.Blob=HTML5Blob}),define("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(extensions,File,Basic,Dom,Events,Mime){function FileDrop(){function _hasFiles(e){if(!e.dataTransfer||!e.dataTransfer.types)return!1;var types=Basic.toArray(e.dataTransfer.types||[]);return-1!==Basic.inArray("Files",types)||-1!==Basic.inArray("public.file-url",types)||-1!==Basic.inArray("application/x-moz-file",types)}function _addFile(file,relativePath){if(_isAcceptable(file)){var fileObj=new File(_ruid,file);fileObj.relativePath=relativePath||"",_files.push(fileObj)}}function _extractExts(accept){for(var exts=[],i=0;i<accept.length;i++)[].push.apply(exts,accept[i].extensions.split(/\s*,\s*/));return-1===Basic.inArray("*",exts)?exts:[]}function _isAcceptable(file){if(!_allowedExts.length)return!0;var ext=Mime.getFileExtension(file.name);return!ext||-1!==Basic.inArray(ext,_allowedExts)}function _readItems(items,cb){var entries=[];Basic.each(items,function(item){var entry=item.webkitGetAsEntry();entry&&(entry.isFile?_addFile(item.getAsFile(),entry.fullPath):entries.push(entry))}),entries.length?_readEntries(entries,cb):cb()}function _readEntries(entries,cb){var queue=[];Basic.each(entries,function(entry){queue.push(function(cbcb){_readEntry(entry,cbcb)})}),Basic.inSeries(queue,function(){cb()})}function _readEntry(entry,cb){entry.isFile?entry.file(function(file){_addFile(file,entry.fullPath),cb()},function(){cb()}):entry.isDirectory?_readDirEntry(entry,cb):cb()}function _readDirEntry(dirEntry,cb){function getEntries(cbcb){dirReader.readEntries(function(moreEntries){moreEntries.length?([].push.apply(entries,moreEntries),getEntries(cbcb)):cbcb()},cbcb)}var entries=[],dirReader=dirEntry.createReader();getEntries(function(){_readEntries(entries,cb)})}var _options,_ruid,_files=[],_allowedExts=[];Basic.extend(this,{init:function(options){var dropZone,comp=this;_options=options,_ruid=comp.ruid,_allowedExts=_extractExts(_options.accept),dropZone=_options.container,Events.addEvent(dropZone,"dragover",function(e){_hasFiles(e)&&(e.preventDefault(),e.dataTransfer.dropEffect="copy")},comp.uid),Events.addEvent(dropZone,"drop",function(e){_hasFiles(e)&&(e.preventDefault(),_files=[],e.dataTransfer.items&&e.dataTransfer.items[0].webkitGetAsEntry?_readItems(e.dataTransfer.items,function(){comp.files=_files,comp.trigger("drop")}):(Basic.each(e.dataTransfer.files,function(file){_addFile(file)}),comp.files=_files,comp.trigger("drop")))},comp.uid),Events.addEvent(dropZone,"dragenter",function(e){comp.trigger("dragenter")},comp.uid),Events.addEvent(dropZone,"dragleave",function(e){comp.trigger("dragleave")},comp.uid)},destroy:function(){Events.removeAllEvents(_options&&Dom.get(_options.container),this.uid),_ruid=_files=_allowedExts=_options=null}})}return extensions.FileDrop=FileDrop}),define("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(extensions,Encode,Basic){function FileReader(){function _toBinary(str){return Encode.atob(str.substring(str.indexOf("base64,")+7))}var _fr,_convertToBinary=!1;Basic.extend(this,{read:function(op,blob){var comp=this;comp.result="",_fr=new window.FileReader,_fr.addEventListener("progress",function(e){comp.trigger(e)}),_fr.addEventListener("load",function(e){comp.result=_convertToBinary?_toBinary(_fr.result):_fr.result,comp.trigger(e)}),_fr.addEventListener("error",function(e){comp.trigger(e,_fr.error)}),_fr.addEventListener("loadend",function(e){_fr=null,comp.trigger(e)}),"function"===Basic.typeOf(_fr[op])?(_convertToBinary=!1,_fr[op](blob.getSource())):"readAsBinaryString"===op&&(_convertToBinary=!0,_fr.readAsDataURL(blob.getSource()))},abort:function(){_fr&&_fr.abort()},destroy:function(){_fr=null}})}return extensions.FileReader=FileReader}),define("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(extensions,Basic,Mime,Url,File,Blob,FormData,x,Env){function XMLHttpRequest(){function _preloadAndSend(meta,data){var blob,fr,target=this;blob=data.getBlob().getSource(),fr=new window.FileReader,fr.onload=function(){data.append(data.getBlobName(),new Blob(null,{type:blob.type,data:fr.result})),self.send.call(target,meta,data)},fr.readAsBinaryString(blob)}function _getNativeXHR(){return!window.XMLHttpRequest||"IE"===Env.browser&&Env.verComp(Env.version,8,"<")?function(){for(var progIDs=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],i=0;i<progIDs.length;i++)try{return new ActiveXObject(progIDs[i])}catch(ex){}}():new window.XMLHttpRequest}function _getDocument(xhr){var rXML=xhr.responseXML,rText=xhr.responseText;return"IE"===Env.browser&&rText&&rXML&&!rXML.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(xhr.getResponseHeader("Content-Type"))&&(rXML=new window.ActiveXObject("Microsoft.XMLDOM"),rXML.async=!1,rXML.validateOnParse=!1,rXML.loadXML(rText)),rXML&&("IE"===Env.browser&&0!==rXML.parseError||!rXML.documentElement||"parsererror"===rXML.documentElement.tagName)?null:rXML}function _prepareMultipart(fd){var boundary="----moxieboundary"+(new Date).getTime(),dashdash="--",crlf="\r\n",multipart="",I=this.getRuntime();if(!I.can("send_binary_string"))throw new x.RuntimeError(x.RuntimeError.NOT_SUPPORTED_ERR);return _xhr.setRequestHeader("Content-Type","multipart/form-data; boundary="+boundary),fd.each(function(value,name){multipart+=value instanceof Blob?dashdash+boundary+crlf+'Content-Disposition: form-data; name="'+name+'"; filename="'+unescape(encodeURIComponent(value.name||"blob"))+'"'+crlf+"Content-Type: "+(value.type||"application/octet-stream")+crlf+crlf+value.getSource()+crlf:dashdash+boundary+crlf+'Content-Disposition: form-data; name="'+name+'"'+crlf+crlf+unescape(encodeURIComponent(value))+crlf}),multipart+=dashdash+boundary+dashdash+crlf}var _xhr,_filename,self=this;Basic.extend(this,{send:function(meta,data){var target=this,isGecko2_5_6="Mozilla"===Env.browser&&Env.verComp(Env.version,4,">=")&&Env.verComp(Env.version,7,"<"),isAndroidBrowser="Android Browser"===Env.browser,mustSendAsBinary=!1;if(_filename=meta.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),_xhr=_getNativeXHR(),_xhr.open(meta.method,meta.url,meta.async,meta.user,meta.password),data instanceof Blob)data.isDetached()&&(mustSendAsBinary=!0),data=data.getSource();else if(data instanceof FormData){if(data.hasBlob())if(data.getBlob().isDetached())data=_prepareMultipart.call(target,data),mustSendAsBinary=!0;else if((isGecko2_5_6||isAndroidBrowser)&&"blob"===Basic.typeOf(data.getBlob().getSource())&&window.FileReader)return void _preloadAndSend.call(target,meta,data);if(data instanceof FormData){var fd=new window.FormData;data.each(function(value,name){value instanceof Blob?fd.append(name,value.getSource()):fd.append(name,value)}),data=fd}}_xhr.upload?(meta.withCredentials&&(_xhr.withCredentials=!0),_xhr.addEventListener("load",function(e){target.trigger(e)}),_xhr.addEventListener("error",function(e){target.trigger(e)}),_xhr.addEventListener("progress",function(e){target.trigger(e)}),_xhr.upload.addEventListener("progress",function(e){target.trigger({type:"UploadProgress",loaded:e.loaded,total:e.total})})):_xhr.onreadystatechange=function(){switch(_xhr.readyState){case 1:break;case 2:break;case 3:var total,loaded;try{Url.hasSameOrigin(meta.url)&&(total=_xhr.getResponseHeader("Content-Length")||0),_xhr.responseText&&(loaded=_xhr.responseText.length)}catch(ex){total=loaded=0}target.trigger({type:"progress",lengthComputable:!!total,total:parseInt(total,10),loaded:loaded});break;case 4:_xhr.onreadystatechange=function(){},0===_xhr.status?target.trigger("error"):target.trigger("load")}},Basic.isEmptyObj(meta.headers)||Basic.each(meta.headers,function(value,header){_xhr.setRequestHeader(header,value)}),""!==meta.responseType&&"responseType"in _xhr&&("json"!==meta.responseType||Env.can("return_response_type","json")?_xhr.responseType=meta.responseType:_xhr.responseType="text"),
mustSendAsBinary?_xhr.sendAsBinary?_xhr.sendAsBinary(data):!function(){for(var ui8a=new Uint8Array(data.length),i=0;i<data.length;i++)ui8a[i]=255&data.charCodeAt(i);_xhr.send(ui8a.buffer)}():_xhr.send(data),target.trigger("loadstart")},getStatus:function(){try{if(_xhr)return _xhr.status}catch(ex){}return 0},getResponse:function(responseType){var I=this.getRuntime();try{switch(responseType){case"blob":var file=new File(I.uid,_xhr.response),disposition=_xhr.getResponseHeader("Content-Disposition");if(disposition){var match=disposition.match(/filename=([\'\"'])([^\1]+)\1/);match&&(_filename=match[2])}return file.name=_filename,file.type||(file.type=Mime.getFileMime(_filename)),file;case"json":return Env.can("return_response_type","json")?_xhr.response:200===_xhr.status&&window.JSON?JSON.parse(_xhr.responseText):null;case"document":return _getDocument(_xhr);default:return""!==_xhr.responseText?_xhr.responseText:null}}catch(ex){return null}},getAllResponseHeaders:function(){try{return _xhr.getAllResponseHeaders()}catch(ex){}return""},abort:function(){_xhr&&_xhr.abort()},destroy:function(){self=_filename=null}})}return extensions.XMLHttpRequest=XMLHttpRequest}),define("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(Basic){function BinaryReader(data){data instanceof ArrayBuffer?ArrayBufferReader.apply(this,arguments):UTF16StringReader.apply(this,arguments)}function ArrayBufferReader(data){var _dv=new DataView(data);Basic.extend(this,{readByteAt:function(idx){return _dv.getUint8(idx)},writeByteAt:function(idx,value){_dv.setUint8(idx,value)},SEGMENT:function(idx,size,value){switch(arguments.length){case 2:return data.slice(idx,idx+size);case 1:return data.slice(idx);case 3:if(null===value&&(value=new ArrayBuffer),value instanceof ArrayBuffer){var arr=new Uint8Array(this.length()-size+value.byteLength);idx>0&&arr.set(new Uint8Array(data.slice(0,idx)),0),arr.set(new Uint8Array(value),idx),arr.set(new Uint8Array(data.slice(idx+size)),idx+value.byteLength),this.clear(),data=arr.buffer,_dv=new DataView(data);break}default:return data}},length:function(){return data?data.byteLength:0},clear:function(){_dv=data=null}})}function UTF16StringReader(data){function putstr(segment,idx,length){length=3===arguments.length?length:data.length-idx-1,data=data.substr(0,idx)+segment+data.substr(length+idx)}Basic.extend(this,{readByteAt:function(idx){return data.charCodeAt(idx)},writeByteAt:function(idx,value){putstr(String.fromCharCode(value),idx,1)},SEGMENT:function(idx,length,segment){switch(arguments.length){case 1:return data.substr(idx);case 2:return data.substr(idx,length);case 3:putstr(null!==segment?segment:"",idx,length);break;default:return data}},length:function(){return data?data.length:0},clear:function(){data=null}})}return Basic.extend(BinaryReader.prototype,{littleEndian:!1,read:function(idx,size){var sum,mv,i;if(idx+size>this.length())throw new Error("You are trying to read outside the source boundaries.");for(mv=this.littleEndian?0:-8*(size-1),i=0,sum=0;size>i;i++)sum|=this.readByteAt(idx+i)<<Math.abs(mv+8*i);return sum},write:function(idx,num,size){var mv,i;if(idx>this.length())throw new Error("You are trying to write outside the source boundaries.");for(mv=this.littleEndian?0:-8*(size-1),i=0;size>i;i++)this.writeByteAt(idx+i,num>>Math.abs(mv+8*i)&255)},BYTE:function(idx){return this.read(idx,1)},SHORT:function(idx){return this.read(idx,2)},LONG:function(idx){return this.read(idx,4)},SLONG:function(idx){var num=this.read(idx,4);return num>2147483647?num-4294967296:num},CHAR:function(idx){return String.fromCharCode(this.read(idx,1))},STRING:function(idx,count){return this.asArray("CHAR",idx,count).join("")},asArray:function(type,idx,count){for(var values=[],i=0;count>i;i++)values[i]=this[type](idx+i);return values}}),BinaryReader}),define("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(BinaryReader,x){return function JPEGHeaders(data){var _br,idx,marker,headers=[],length=0;if(_br=new BinaryReader(data),65496!==_br.SHORT(0))throw _br.clear(),new x.ImageError(x.ImageError.WRONG_FORMAT);for(idx=2;idx<=_br.length();)if(marker=_br.SHORT(idx),marker>=65488&&65495>=marker)idx+=2;else{if(65498===marker||65497===marker)break;length=_br.SHORT(idx+2)+2,marker>=65505&&65519>=marker&&headers.push({hex:marker,name:"APP"+(15&marker),start:idx,length:length,segment:_br.SEGMENT(idx,length)}),idx+=length}return _br.clear(),{headers:headers,restore:function(data){var max,i,br;for(br=new BinaryReader(data),idx=65504==br.SHORT(2)?4+br.SHORT(4):2,i=0,max=headers.length;max>i;i++)br.SEGMENT(idx,0,headers[i].segment),idx+=headers[i].length;return data=br.SEGMENT(),br.clear(),data},strip:function(data){var br,headers,jpegHeaders,i;for(jpegHeaders=new JPEGHeaders(data),headers=jpegHeaders.headers,jpegHeaders.purge(),br=new BinaryReader(data),i=headers.length;i--;)br.SEGMENT(headers[i].start,headers[i].length,"");return data=br.SEGMENT(),br.clear(),data},get:function(name){for(var array=[],i=0,max=headers.length;max>i;i++)headers[i].name===name.toUpperCase()&&array.push(headers[i].segment);return array},set:function(name,segment){var i,ii,max,array=[];for("string"==typeof segment?array.push(segment):array=segment,i=ii=0,max=headers.length;max>i&&(headers[i].name===name.toUpperCase()&&(headers[i].segment=array[ii],headers[i].length=array[ii].length,ii++),!(ii>=array.length));i++);},purge:function(){this.headers=headers=[]}}}}),define("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(Basic,BinaryReader,x){function ExifParser(data){function extractTags(IFD_offset,tags2extract){var length,i,tag,type,count,size,offset,value,data=this,values=[],hash={},types={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},sizes={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(length=data.SHORT(IFD_offset),i=0;length>i;i++)if(values=[],offset=IFD_offset+2+12*i,tag=tags2extract[data.SHORT(offset)],tag!==undefined){if(type=types[data.SHORT(offset+=2)],count=data.LONG(offset+=2),size=sizes[type],!size)throw new x.ImageError(x.ImageError.INVALID_META_ERR);if(offset+=4,size*count>4&&(offset=data.LONG(offset)+offsets.tiffHeader),offset+size*count>=this.length())throw new x.ImageError(x.ImageError.INVALID_META_ERR);"ASCII"!==type?(values=data.asArray(type,offset,count),value=1==count?values[0]:values,tagDescs.hasOwnProperty(tag)&&"object"!=typeof value?hash[tag]=tagDescs[tag][value]:hash[tag]=value):hash[tag]=Basic.trim(data.STRING(offset,count).replace(/\0$/,""))}return hash}function setTag(ifd,tag,value){var offset,length,tagOffset,valueOffset=0;if("string"==typeof tag){var tmpTags=tags[ifd.toLowerCase()];for(var hex in tmpTags)if(tmpTags[hex]===tag){tag=hex;break}}offset=offsets[ifd.toLowerCase()+"IFD"],length=this.SHORT(offset);for(var i=0;length>i;i++)if(tagOffset=offset+12*i+2,this.SHORT(tagOffset)==tag){valueOffset=tagOffset+8;break}if(!valueOffset)return!1;try{this.write(valueOffset,value,4)}catch(ex){return!1}return!0}var __super__,tags,tagDescs,offsets,idx,Tiff;if(BinaryReader.call(this,data),tags={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},tagDescs={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},offsets={tiffHeader:10},idx=offsets.tiffHeader,__super__={clear:this.clear},Basic.extend(this,{read:function(){try{return ExifParser.prototype.read.apply(this,arguments)}catch(ex){throw new x.ImageError(x.ImageError.INVALID_META_ERR)}},write:function(){try{return ExifParser.prototype.write.apply(this,arguments)}catch(ex){throw new x.ImageError(x.ImageError.INVALID_META_ERR)}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(idx){return this.LONG(idx)/this.LONG(idx+4)},SRATIONAL:function(idx){return this.SLONG(idx)/this.SLONG(idx+4)},ASCII:function(idx){return this.CHAR(idx)},TIFF:function(){return Tiff||null},EXIF:function(){var Exif=null;if(offsets.exifIFD){try{Exif=extractTags.call(this,offsets.exifIFD,tags.exif)}catch(ex){return null}if(Exif.ExifVersion&&"array"===Basic.typeOf(Exif.ExifVersion)){for(var i=0,exifVersion="";i<Exif.ExifVersion.length;i++)exifVersion+=String.fromCharCode(Exif.ExifVersion[i]);Exif.ExifVersion=exifVersion}}return Exif},GPS:function(){var GPS=null;if(offsets.gpsIFD){try{GPS=extractTags.call(this,offsets.gpsIFD,tags.gps)}catch(ex){return null}GPS.GPSVersionID&&"array"===Basic.typeOf(GPS.GPSVersionID)&&(GPS.GPSVersionID=GPS.GPSVersionID.join("."))}return GPS},thumb:function(){if(offsets.IFD1)try{var IFD1Tags=extractTags.call(this,offsets.IFD1,tags.thumb);if("JPEGInterchangeFormat"in IFD1Tags)return this.SEGMENT(offsets.tiffHeader+IFD1Tags.JPEGInterchangeFormat,IFD1Tags.JPEGInterchangeFormatLength)}catch(ex){}return null},setExif:function(tag,value){return"PixelXDimension"!==tag&&"PixelYDimension"!==tag?!1:setTag.call(this,"exif",tag,value)},clear:function(){__super__.clear(),data=tags=tagDescs=Tiff=offsets=__super__=null}}),65505!==this.SHORT(0)||"EXIF\x00"!==this.STRING(4,5).toUpperCase())throw new x.ImageError(x.ImageError.INVALID_META_ERR);if(this.littleEndian=18761==this.SHORT(idx),42!==this.SHORT(idx+=2))throw new x.ImageError(x.ImageError.INVALID_META_ERR);offsets.IFD0=offsets.tiffHeader+this.LONG(idx+=2),Tiff=extractTags.call(this,offsets.IFD0,tags.tiff),"ExifIFDPointer"in Tiff&&(offsets.exifIFD=offsets.tiffHeader+Tiff.ExifIFDPointer,delete Tiff.ExifIFDPointer),"GPSInfoIFDPointer"in Tiff&&(offsets.gpsIFD=offsets.tiffHeader+Tiff.GPSInfoIFDPointer,delete Tiff.GPSInfoIFDPointer),Basic.isEmptyObj(Tiff)&&(Tiff=null);var IFD1Offset=this.LONG(offsets.IFD0+12*this.SHORT(offsets.IFD0)+2);IFD1Offset&&(offsets.IFD1=offsets.tiffHeader+IFD1Offset)}return ExifParser.prototype=BinaryReader.prototype,ExifParser}),define("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(Basic,x,JPEGHeaders,BinaryReader,ExifParser){function JPEG(data){function _getDimensions(br){var marker,length,idx=0;for(br||(br=_br);idx<=br.length();){if(marker=br.SHORT(idx+=2),marker>=65472&&65475>=marker)return idx+=5,{height:br.SHORT(idx),width:br.SHORT(idx+=2)};length=br.SHORT(idx+=2),idx+=length-2}return null}function _getThumb(){var br,info,data=_ep.thumb();return data&&(br=new BinaryReader(data),info=_getDimensions(br),br.clear(),info)?(info.data=data,info):null}function _purge(){_ep&&_hm&&_br&&(_ep.clear(),_hm.purge(),_br.clear(),_info=_hm=_ep=_br=null)}var _br,_hm,_ep,_info;if(_br=new BinaryReader(data),65496!==_br.SHORT(0))throw new x.ImageError(x.ImageError.WRONG_FORMAT);_hm=new JPEGHeaders(data);try{_ep=new ExifParser(_hm.get("app1")[0])}catch(ex){}_info=_getDimensions.call(this),Basic.extend(this,{type:"image/jpeg",size:_br.length(),width:_info&&_info.width||0,height:_info&&_info.height||0,setExif:function(tag,value){return _ep?("object"===Basic.typeOf(tag)?Basic.each(tag,function(value,tag){_ep.setExif(tag,value)}):_ep.setExif(tag,value),void _hm.set("app1",_ep.SEGMENT())):!1},writeHeaders:function(){return arguments.length?_hm.restore(arguments[0]):_hm.restore(data)},stripHeaders:function(data){return _hm.strip(data)},purge:function(){_purge.call(this)}}),_ep&&(this.meta={tiff:_ep.TIFF(),exif:_ep.EXIF(),gps:_ep.GPS(),thumb:_getThumb()})}return JPEG}),define("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(x,Basic,BinaryReader){function PNG(data){function _getDimensions(){var chunk,idx;return chunk=_getChunkAt.call(this,8),"IHDR"==chunk.type?(idx=chunk.start,{width:_br.LONG(idx),height:_br.LONG(idx+=4)}):null}function _purge(){_br&&(_br.clear(),data=_info=_hm=_ep=_br=null)}function _getChunkAt(idx){var length,type,start,CRC;return length=_br.LONG(idx),type=_br.STRING(idx+=4,4),start=idx+=4,CRC=_br.LONG(idx+length),{length:length,type:type,start:start,CRC:CRC}}var _br,_hm,_ep,_info;_br=new BinaryReader(data),function(){var idx=0,i=0,signature=[35152,20039,3338,6666];for(i=0;i<signature.length;i++,idx+=2)if(signature[i]!=_br.SHORT(idx))throw new x.ImageError(x.ImageError.WRONG_FORMAT)}(),_info=_getDimensions.call(this),Basic.extend(this,{type:"image/png",size:_br.length(),width:_info.width,height:_info.height,purge:function(){_purge.call(this)}}),_purge.call(this)}return PNG}),define("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(Basic,x,JPEG,PNG){return function(data){var _img,_cs=[JPEG,PNG];_img=function(){for(var i=0;i<_cs.length;i++)try{return new _cs[i](data)}catch(ex){}throw new x.ImageError(x.ImageError.WRONG_FORMAT)}(),Basic.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(data){return data},stripHeaders:function(data){return data},purge:function(){data=null}}),Basic.extend(this,_img),this.purge=function(){_img.purge(),_img=null}}}),define("moxie/runtime/html5/image/MegaPixel",[],function(){function renderImageToCanvas(img,canvas,options){var iw=img.naturalWidth,ih=img.naturalHeight,width=options.width,height=options.height,x=options.x||0,y=options.y||0,ctx=canvas.getContext("2d");detectSubsampling(img)&&(iw/=2,ih/=2);var d=1024,tmpCanvas=document.createElement("canvas");tmpCanvas.width=tmpCanvas.height=d;for(var tmpCtx=tmpCanvas.getContext("2d"),vertSquashRatio=detectVerticalSquash(img,iw,ih),sy=0;ih>sy;){for(var sh=sy+d>ih?ih-sy:d,sx=0;iw>sx;){var sw=sx+d>iw?iw-sx:d;tmpCtx.clearRect(0,0,d,d),tmpCtx.drawImage(img,-sx,-sy);var dx=sx*width/iw+x<<0,dw=Math.ceil(sw*width/iw),dy=sy*height/ih/vertSquashRatio+y<<0,dh=Math.ceil(sh*height/ih/vertSquashRatio);ctx.drawImage(tmpCanvas,0,0,sw,sh,dx,dy,dw,dh),sx+=d}sy+=d}tmpCanvas=tmpCtx=null}function detectSubsampling(img){var iw=img.naturalWidth,ih=img.naturalHeight;if(iw*ih>1048576){var canvas=document.createElement("canvas");canvas.width=canvas.height=1;var ctx=canvas.getContext("2d");return ctx.drawImage(img,-iw+1,0),0===ctx.getImageData(0,0,1,1).data[3]}return!1}function detectVerticalSquash(img,iw,ih){var canvas=document.createElement("canvas");canvas.width=1,canvas.height=ih;var ctx=canvas.getContext("2d");ctx.drawImage(img,0,0);for(var data=ctx.getImageData(0,0,1,ih).data,sy=0,ey=ih,py=ih;py>sy;){var alpha=data[4*(py-1)+3];0===alpha?ey=py:sy=py,py=ey+sy>>1}canvas=null;var ratio=py/ih;return 0===ratio?1:ratio}return{isSubsampled:detectSubsampling,renderTo:renderImageToCanvas}}),define("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/MegaPixel","moxie/core/utils/Mime","moxie/core/utils/Env"],function(extensions,Basic,x,Encode,Blob,File,ImageInfo,MegaPixel,Mime,Env){function HTML5Image(){function _getImg(){if(!_canvas&&!_img)throw new x.ImageError(x.DOMException.INVALID_STATE_ERR);return _canvas||_img}function _toBinary(str){return Encode.atob(str.substring(str.indexOf("base64,")+7))}function _toDataUrl(str,type){return"data:"+(type||"")+";base64,"+Encode.btoa(str)}function _preload(str){var comp=this;_img=new Image,_img.onerror=function(){_purge.call(this),comp.trigger("error",x.ImageError.WRONG_FORMAT)},_img.onload=function(){comp.trigger("load")},_img.src="data:"==str.substr(0,5)?str:_toDataUrl(str,_blob.type)}function _readAsDataUrl(file,callback){var fr,comp=this;return window.FileReader?(fr=new FileReader,fr.onload=function(){callback(this.result)},fr.onerror=function(){comp.trigger("error",x.ImageError.WRONG_FORMAT)},void fr.readAsDataURL(file)):callback(file.getAsDataURL())}function _downsize(width,height,crop,preserveHeaders){var scale,img,destWidth,destHeight,orientation,self=this,x=0,y=0;if(_preserveHeaders=preserveHeaders,orientation=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==Basic.inArray(orientation,[5,6,7,8])){var tmp=width;width=height,height=tmp}return img=_getImg(),crop?(width=Math.min(width,img.width),height=Math.min(height,img.height),scale=Math.max(width/img.width,height/img.height)):scale=Math.min(width/img.width,height/img.height),scale>1&&!crop&&preserveHeaders?void this.trigger("Resize"):(_canvas||(_canvas=document.createElement("canvas")),destWidth=Math.round(img.width*scale),destHeight=Math.round(img.height*scale),crop?(_canvas.width=width,_canvas.height=height,destWidth>width&&(x=Math.round((destWidth-width)/2)),destHeight>height&&(y=Math.round((destHeight-height)/2))):(_canvas.width=destWidth,_canvas.height=destHeight),_preserveHeaders||_rotateToOrientaion(_canvas.width,_canvas.height,orientation),_drawToCanvas.call(this,img,_canvas,-x,-y,destWidth,destHeight),this.width=_canvas.width,this.height=_canvas.height,_modified=!0,void self.trigger("Resize"))}function _drawToCanvas(img,canvas,x,y,w,h){if("iOS"===Env.OS)MegaPixel.renderTo(img,canvas,{width:w,height:h,x:x,y:y});else{var ctx=canvas.getContext("2d");ctx.drawImage(img,x,y,w,h)}}function _rotateToOrientaion(width,height,orientation){switch(orientation){case 5:case 6:case 7:case 8:_canvas.width=height,_canvas.height=width;break;default:_canvas.width=width,_canvas.height=height}var ctx=_canvas.getContext("2d");switch(orientation){case 2:ctx.translate(width,0),ctx.scale(-1,1);break;case 3:ctx.translate(width,height),ctx.rotate(Math.PI);break;case 4:ctx.translate(0,height),ctx.scale(1,-1);break;case 5:ctx.rotate(.5*Math.PI),ctx.scale(1,-1);break;case 6:ctx.rotate(.5*Math.PI),ctx.translate(0,-height);break;case 7:ctx.rotate(.5*Math.PI),ctx.translate(width,-height),ctx.scale(-1,1);break;case 8:ctx.rotate(-.5*Math.PI),ctx.translate(-width,0)}}function _purge(){_imgInfo&&(_imgInfo.purge(),_imgInfo=null),_binStr=_img=_canvas=_blob=null,_modified=!1}var _img,_imgInfo,_canvas,_binStr,_blob,me=this,_modified=!1,_preserveHeaders=!0;Basic.extend(this,{loadFromBlob:function(blob){var comp=this,I=comp.getRuntime(),asBinary=arguments.length>1?arguments[1]:!0;if(!I.can("access_binary"))throw new x.RuntimeError(x.RuntimeError.NOT_SUPPORTED_ERR);return _blob=blob,blob.isDetached()?(_binStr=blob.getSource(),void _preload.call(this,_binStr)):void _readAsDataUrl.call(this,blob.getSource(),function(dataUrl){asBinary&&(_binStr=_toBinary(dataUrl)),_preload.call(comp,dataUrl)})},loadFromImage:function(img,exact){this.meta=img.meta,_blob=new File(null,{name:img.name,size:img.size,type:img.type}),_preload.call(this,exact?_binStr=img.getAsBinaryString():img.getAsDataURL())},getInfo:function(){var info,I=this.getRuntime();return!_imgInfo&&_binStr&&I.can("access_image_binary")&&(_imgInfo=new ImageInfo(_binStr)),info={width:_getImg().width||0,height:_getImg().height||0,type:_blob.type||Mime.getFileMime(_blob.name),size:_binStr&&_binStr.length||_blob.size||0,name:_blob.name||"",meta:_imgInfo&&_imgInfo.meta||this.meta||{}},!info.meta||!info.meta.thumb||info.meta.thumb.data instanceof Blob||(info.meta.thumb.data=new Blob(null,{type:"image/jpeg",data:info.meta.thumb.data})),info},downsize:function(){_downsize.apply(this,arguments)},getAsCanvas:function(){return _canvas&&(_canvas.id=this.uid+"_canvas"),_canvas},getAsBlob:function(type,quality){return type!==this.type&&_downsize.call(this,this.width,this.height,!1),new File(null,{name:_blob.name||"",type:type,data:me.getAsBinaryString.call(this,type,quality)})},getAsDataURL:function(type){var quality=arguments[1]||90;if(!_modified)return _img.src;if("image/jpeg"!==type)return _canvas.toDataURL("image/png");try{return _canvas.toDataURL("image/jpeg",quality/100)}catch(ex){return _canvas.toDataURL("image/jpeg")}},getAsBinaryString:function(type,quality){if(!_modified)return _binStr||(_binStr=_toBinary(me.getAsDataURL(type,quality))),_binStr;if("image/jpeg"!==type)_binStr=_toBinary(me.getAsDataURL(type,quality));else{var dataUrl;quality||(quality=90);try{dataUrl=_canvas.toDataURL("image/jpeg",quality/100)}catch(ex){dataUrl=_canvas.toDataURL("image/jpeg")}_binStr=_toBinary(dataUrl),_imgInfo&&(_binStr=_imgInfo.stripHeaders(_binStr),_preserveHeaders&&(_imgInfo.meta&&_imgInfo.meta.exif&&_imgInfo.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),_binStr=_imgInfo.writeHeaders(_binStr)),_imgInfo.purge(),_imgInfo=null)}return _modified=!1,_binStr},destroy:function(){me=null,_purge.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return extensions.Image=HTML5Image}),define("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(Basic,Env,Dom,x,Runtime){function getShimVersion(){var version;try{version=navigator.plugins["Shockwave Flash"],version=version.description}catch(e1){try{version=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e2){version="0.0"}}return version=version.match(/\d+/g),parseFloat(version[0]+"."+version[1])}function removeSWF(id){var obj=Dom.get(id);obj&&"OBJECT"==obj.nodeName&&("IE"===Env.browser?(obj.style.display="none",function onInit(){4==obj.readyState?removeObjectInIE(id):setTimeout(onInit,10)}()):obj.parentNode.removeChild(obj))}function removeObjectInIE(id){var obj=Dom.get(id);if(obj){for(var i in obj)"function"==typeof obj[i]&&(obj[i]=null);obj.parentNode.removeChild(obj)}}function FlashRuntime(options){var initTimer,I=this;options=Basic.extend({swf_url:Env.swf_url},options),Runtime.call(this,options,type,{access_binary:function(value){return value&&"browser"===I.mode},access_image_binary:function(value){return value&&"browser"===I.mode},display_media:Runtime.capTrue,do_cors:Runtime.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===I.mode},resize_image:Runtime.capTrue,return_response_headers:!1,return_response_type:function(responseType){return"json"===responseType&&window.JSON?!0:!Basic.arrayDiff(responseType,["","text","document"])||"browser"===I.mode},return_status_code:function(code){return"browser"===I.mode||!Basic.arrayDiff(code,[200,404])},select_file:Runtime.capTrue,select_multiple:Runtime.capTrue,send_binary_string:function(value){return value&&"browser"===I.mode},send_browser_cookies:function(value){return value&&"browser"===I.mode},send_custom_headers:function(value){return value&&"browser"===I.mode},send_multipart:Runtime.capTrue,slice_blob:function(value){return value&&"browser"===I.mode},stream_upload:function(value){return value&&"browser"===I.mode},summon_file_dialog:!1,upload_filesize:function(size){return Basic.parseSizeStr(size)<=2097152||"client"===I.mode},use_http_method:function(methods){return!Basic.arrayDiff(methods,["GET","POST"])}},{access_binary:function(value){return value?"browser":"client"},access_image_binary:function(value){return value?"browser":"client"},report_upload_progress:function(value){return value?"browser":"client"},return_response_type:function(responseType){return Basic.arrayDiff(responseType,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(code){return Basic.arrayDiff(code,[200,404])?"browser":["client","browser"]},send_binary_string:function(value){return value?"browser":"client"},send_browser_cookies:function(value){return value?"browser":"client"},send_custom_headers:function(value){return value?"browser":"client"},stream_upload:function(value){return value?"client":"browser"},upload_filesize:function(size){return Basic.parseSizeStr(size)>=2097152?"client":"browser"}},"client"),getShimVersion()<10&&(MXI_DEBUG&&Env.debug.runtime&&Env.log("	Flash didn't meet minimal version requirement (10)."),this.mode=!1),Basic.extend(this,{getShim:function(){return Dom.get(this.uid)},shimExec:function(component,action){var args=[].slice.call(arguments,2);return I.getShim().exec(this.uid,component,action,args)},init:function(){var html,el,container;container=this.getShimContainer(),Basic.extend(container.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),html='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+options.swf_url+'" ',"IE"===Env.browser&&(html+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),html+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+options.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+Env.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===Env.browser?(el=document.createElement("div"),container.appendChild(el),el.outerHTML=html,el=container=null):container.innerHTML=html,initTimer=setTimeout(function(){I&&!I.initialized&&(I.trigger("Error",new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR)),MXI_DEBUG&&Env.debug.runtime&&Env.log("	Flash failed to initialize within a specified period of time (typically 5s)."))},5e3)},destroy:function(destroy){return function(){removeSWF(I.uid),destroy.call(I),clearTimeout(initTimer),options=initTimer=destroy=I=null}}(this.destroy)},extensions)}var type="flash",extensions={};return Runtime.addConstructor(type,FlashRuntime),extensions}),define("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(extensions,File,Basic){var FileInput={init:function(options){var comp=this,I=this.getRuntime();this.bind("Change",function(){var files=I.shimExec.call(comp,"FileInput","getFiles");comp.files=[],Basic.each(files,function(file){comp.files.push(new File(I.uid,file))})},999),this.getRuntime().shimExec.call(this,"FileInput","init",{name:options.name,accept:options.accept,multiple:options.multiple}),this.trigger("ready")}};return extensions.FileInput=FileInput}),define("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(extensions,Blob){var FlashBlob={slice:function(blob,start,end,type){var self=this.getRuntime();return 0>start?start=Math.max(blob.size+start,0):start>0&&(start=Math.min(start,blob.size)),0>end?end=Math.max(blob.size+end,0):end>0&&(end=Math.min(end,blob.size)),blob=self.shimExec.call(this,"Blob","slice",start,end,type||""),blob&&(blob=new Blob(self.uid,blob)),blob}};return extensions.Blob=FlashBlob}),define("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(extensions,Encode){function _formatData(data,op){switch(op){case"readAsText":return Encode.atob(data,"utf8");case"readAsBinaryString":return Encode.atob(data);case"readAsDataURL":return data}return null}var FileReader={read:function(op,blob){var comp=this;return comp.result="","readAsDataURL"===op&&(comp.result="data:"+(blob.type||"")+";base64,"),comp.bind("Progress",function(e,data){data&&(comp.result+=_formatData(data,op))},999),comp.getRuntime().shimExec.call(this,"FileReader","readAsBase64",blob.uid)}};return extensions.FileReader=FileReader}),define("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(extensions,Encode){function _formatData(data,op){switch(op){case"readAsText":return Encode.atob(data,"utf8");case"readAsBinaryString":return Encode.atob(data);case"readAsDataURL":return data}return null}var FileReaderSync={read:function(op,blob){var result,self=this.getRuntime();return(result=self.shimExec.call(this,"FileReaderSync","readAsBase64",blob.uid))?("readAsDataURL"===op&&(result="data:"+(blob.type||"")+";base64,"+result),_formatData(result,op,blob.type)):null}};return extensions.FileReaderSync=FileReaderSync}),define("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter"],function(extensions,Basic,Blob,File,FileReaderSync,FormData,Transporter){var XMLHttpRequest={send:function(meta,data){function send(){meta.transport=self.mode,self.shimExec.call(target,"XMLHttpRequest","send",meta,data)}function appendBlob(name,blob){self.shimExec.call(target,"XMLHttpRequest","appendBlob",name,blob.uid),data=null,send()}function attachBlob(blob,cb){var tr=new Transporter;tr.bind("TransportingComplete",function(){cb(this.result)}),tr.transport(blob.getSource(),blob.type,{ruid:self.uid})}var target=this,self=target.getRuntime();if(Basic.isEmptyObj(meta.headers)||Basic.each(meta.headers,function(value,header){self.shimExec.call(target,"XMLHttpRequest","setRequestHeader",header,value.toString())}),data instanceof FormData){var blobField;if(data.each(function(value,name){value instanceof Blob?blobField=name:self.shimExec.call(target,"XMLHttpRequest","append",name,value)}),data.hasBlob()){var blob=data.getBlob();blob.isDetached()?attachBlob(blob,function(attachedBlob){blob.destroy(),appendBlob(blobField,attachedBlob)}):appendBlob(blobField,blob)}else data=null,send()}else data instanceof Blob?data.isDetached()?attachBlob(data,function(attachedBlob){data.destroy(),data=attachedBlob.uid,send()}):(data=data.uid,send()):send()},getResponse:function(responseType){
var frs,blob,self=this.getRuntime();if(blob=self.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(blob=new File(self.uid,blob),"blob"===responseType)return blob;try{if(frs=new FileReaderSync,~Basic.inArray(responseType,["","text"]))return frs.readAsText(blob);if("json"===responseType&&window.JSON)return JSON.parse(frs.readAsText(blob))}finally{blob.destroy()}}return null},abort:function(upload_complete_flag){var self=this.getRuntime();self.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return extensions.XMLHttpRequest=XMLHttpRequest}),define("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(extensions,Blob){var Transporter={getAsBlob:function(type){var self=this.getRuntime(),blob=self.shimExec.call(this,"Transporter","getAsBlob",type);return blob?new Blob(self.uid,blob):null}};return extensions.Transporter=Transporter}),define("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(extensions,Basic,Transporter,Blob,FileReaderSync){var Image={loadFromBlob:function(blob){function exec(srcBlob){self.shimExec.call(comp,"Image","loadFromBlob",srcBlob.uid),comp=self=null}var comp=this,self=comp.getRuntime();if(blob.isDetached()){var tr=new Transporter;tr.bind("TransportingComplete",function(){exec(tr.result.getSource())}),tr.transport(blob.getSource(),blob.type,{ruid:self.uid})}else exec(blob.getSource())},loadFromImage:function(img){var self=this.getRuntime();return self.shimExec.call(this,"Image","loadFromImage",img.uid)},getInfo:function(){var self=this.getRuntime(),info=self.shimExec.call(this,"Image","getInfo");return!info.meta||!info.meta.thumb||info.meta.thumb.data instanceof Blob||(info.meta.thumb.data=new Blob(self.uid,info.meta.thumb.data)),info},getAsBlob:function(type,quality){var self=this.getRuntime(),blob=self.shimExec.call(this,"Image","getAsBlob",type,quality);return blob?new Blob(self.uid,blob):null},getAsDataURL:function(){var frs,self=this.getRuntime(),blob=self.Image.getAsBlob.apply(this,arguments);return blob?(frs=new FileReaderSync,frs.readAsDataURL(blob)):null}};return extensions.Image=Image}),define("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(Basic,Env,Dom,x,Runtime){function isInstalled(version){var actualVer,actualVerArray,reqVerArray,requiredVersionPart,actualVersionPart,isVersionSupported=!1,control=null,index=0;try{try{control=new ActiveXObject("AgControl.AgControl"),control.IsVersionSupported(version)&&(isVersionSupported=!0),control=null}catch(e){var plugin=navigator.plugins["Silverlight Plug-In"];if(plugin){for(actualVer=plugin.description,"1.0.30226.2"===actualVer&&(actualVer="2.0.30226.2"),actualVerArray=actualVer.split(".");actualVerArray.length>3;)actualVerArray.pop();for(;actualVerArray.length<4;)actualVerArray.push(0);for(reqVerArray=version.split(".");reqVerArray.length>4;)reqVerArray.pop();do requiredVersionPart=parseInt(reqVerArray[index],10),actualVersionPart=parseInt(actualVerArray[index],10),index++;while(index<reqVerArray.length&&requiredVersionPart===actualVersionPart);actualVersionPart>=requiredVersionPart&&!isNaN(requiredVersionPart)&&(isVersionSupported=!0)}}}catch(e2){isVersionSupported=!1}return isVersionSupported}function SilverlightRuntime(options){var initTimer,I=this;options=Basic.extend({xap_url:Env.xap_url},options),Runtime.call(this,options,type,{access_binary:Runtime.capTrue,access_image_binary:Runtime.capTrue,display_media:Runtime.capTrue,do_cors:Runtime.capTrue,drag_and_drop:!1,report_upload_progress:Runtime.capTrue,resize_image:Runtime.capTrue,return_response_headers:function(value){return value&&"client"===I.mode},return_response_type:function(responseType){return"json"!==responseType?!0:!!window.JSON},return_status_code:function(code){return"client"===I.mode||!Basic.arrayDiff(code,[200,404])},select_file:Runtime.capTrue,select_multiple:Runtime.capTrue,send_binary_string:Runtime.capTrue,send_browser_cookies:function(value){return value&&"browser"===I.mode},send_custom_headers:function(value){return value&&"client"===I.mode},send_multipart:Runtime.capTrue,slice_blob:Runtime.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:Runtime.capTrue,use_http_method:function(methods){return"client"===I.mode||!Basic.arrayDiff(methods,["GET","POST"])}},{return_response_headers:function(value){return value?"client":"browser"},return_status_code:function(code){return Basic.arrayDiff(code,[200,404])?"client":["client","browser"]},send_browser_cookies:function(value){return value?"browser":"client"},send_custom_headers:function(value){return value?"client":"browser"},use_http_method:function(methods){return Basic.arrayDiff(methods,["GET","POST"])?"client":["client","browser"]}}),isInstalled("2.0.31005.0")&&"Opera"!==Env.browser||(MXI_DEBUG&&Env.debug.runtime&&Env.log("	Silverlight is not installed or minimal version (2.0.31005.0) requirement not met (not likely)."),this.mode=!1),Basic.extend(this,{getShim:function(){return Dom.get(this.uid).content.Moxie},shimExec:function(component,action){var args=[].slice.call(arguments,2);return I.getShim().exec(this.uid,component,action,args)},init:function(){var container;container=this.getShimContainer(),container.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+options.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+Env.global_event_dispatcher+'"/></object>',initTimer=setTimeout(function(){I&&!I.initialized&&(I.trigger("Error",new x.RuntimeError(x.RuntimeError.NOT_INIT_ERR)),MXI_DEBUG&&Env.debug.runtime&&Env.log("Silverlight failed to initialize within a specified period of time (5-10s)."))},"Windows"!==Env.OS?1e4:5e3)},destroy:function(destroy){return function(){destroy.call(I),clearTimeout(initTimer),options=initTimer=destroy=I=null}}(this.destroy)},extensions)}var type="silverlight",extensions={};return Runtime.addConstructor(type,SilverlightRuntime),extensions}),define("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(extensions,File,Basic){var FileInput={init:function(options){function toFilters(accept){for(var filter="",i=0;i<accept.length;i++)filter+=(""!==filter?"|":"")+accept[i].title+" | *."+accept[i].extensions.replace(/,/g,";*.");return filter}var comp=this,I=this.getRuntime();this.bind("Change",function(){var files=I.shimExec.call(comp,"FileInput","getFiles");comp.files=[],Basic.each(files,function(file){comp.files.push(new File(I.uid,file))})},999),this.getRuntime().shimExec.call(this,"FileInput","init",toFilters(options.accept),options.name,options.multiple),this.trigger("ready")}};return extensions.FileInput=FileInput}),define("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(extensions,Basic,Blob){return extensions.Blob=Basic.extend({},Blob)}),define("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(extensions,Dom,Events){var FileDrop={init:function(){var dropZone,comp=this,self=comp.getRuntime();return dropZone=self.getShimContainer(),Events.addEvent(dropZone,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},comp.uid),Events.addEvent(dropZone,"dragenter",function(e){e.preventDefault();var flag=Dom.get(self.uid).dragEnter(e);flag&&e.stopPropagation()},comp.uid),Events.addEvent(dropZone,"drop",function(e){e.preventDefault();var flag=Dom.get(self.uid).dragDrop(e);flag&&e.stopPropagation()},comp.uid),self.shimExec.call(this,"FileDrop","init")}};return extensions.FileDrop=FileDrop}),define("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(extensions,Basic,FileReader){return extensions.FileReader=Basic.extend({},FileReader)}),define("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(extensions,Basic,FileReaderSync){return extensions.FileReaderSync=Basic.extend({},FileReaderSync)}),define("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(extensions,Basic,XMLHttpRequest){return extensions.XMLHttpRequest=Basic.extend({},XMLHttpRequest)}),define("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(extensions,Basic,Transporter){return extensions.Transporter=Basic.extend({},Transporter)}),define("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(extensions,Basic,Blob,Image){return extensions.Image=Basic.extend({},Image,{getInfo:function(){var self=this.getRuntime(),grps=["tiff","exif","gps","thumb"],info={meta:{}},rawInfo=self.shimExec.call(this,"Image","getInfo");return rawInfo.meta&&(Basic.each(grps,function(grp){var tag,i,length,value,meta=rawInfo.meta[grp];if(meta&&meta.keys)for(info.meta[grp]={},i=0,length=meta.keys.length;length>i;i++)tag=meta.keys[i],value=meta[tag],value&&(/^(\d|[1-9]\d+)$/.test(value)?value=parseInt(value,10):/^\d*\.\d+$/.test(value)&&(value=parseFloat(value)),info.meta[grp][tag]=value)}),!info.meta||!info.meta.thumb||info.meta.thumb.data instanceof Blob||(info.meta.thumb.data=new Blob(self.uid,info.meta.thumb.data))),info.width=parseInt(rawInfo.width,10),info.height=parseInt(rawInfo.height,10),info.size=parseInt(rawInfo.size,10),info.type=rawInfo.type,info.name=rawInfo.name,info}})}),define("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(Basic,x,Runtime,Env){function Html4Runtime(options){var I=this,Test=Runtime.capTest,True=Runtime.capTrue;Runtime.call(this,options,type,{access_binary:Test(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:Test(extensions.Image&&(Env.can("create_canvas")||Env.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:Test(function(){return"Chrome"===Env.browser&&Env.verComp(Env.version,28,">=")||"IE"===Env.browser&&Env.verComp(Env.version,10,">=")||"Safari"===Env.browser&&Env.verComp(Env.version,7,">=")}()),resize_image:function(){return extensions.Image&&I.can("access_binary")&&Env.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(responseType){return"json"===responseType&&window.JSON?!0:!!~Basic.inArray(responseType,["text","document",""])},return_status_code:function(code){return!Basic.arrayDiff(code,[200,404])},select_file:function(){return Env.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return I.can("select_file")},summon_file_dialog:function(){return I.can("select_file")&&("Firefox"===Env.browser&&Env.verComp(Env.version,4,">=")||"Opera"===Env.browser&&Env.verComp(Env.version,12,">=")||"IE"===Env.browser&&Env.verComp(Env.version,10,">=")||!!~Basic.inArray(Env.browser,["Chrome","Safari"]))},upload_filesize:True,use_http_method:function(methods){return!Basic.arrayDiff(methods,["GET","POST"])}}),Basic.extend(this,{init:function(){this.trigger("Init")},destroy:function(destroy){return function(){destroy.call(I),destroy=I=null}}(this.destroy)}),Basic.extend(this.getShim(),extensions)}var type="html4",extensions={};return Runtime.addConstructor(type,Html4Runtime),extensions}),define("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(extensions,File,Basic,Dom,Events,Mime,Env){function FileInput(){function addInput(){var shimContainer,browseButton,currForm,form,input,uid,comp=this,I=comp.getRuntime();uid=Basic.guid("uid_"),shimContainer=I.getShimContainer(),_uid&&(currForm=Dom.get(_uid+"_form"),currForm&&Basic.extend(currForm.style,{top:"100%"})),form=document.createElement("form"),form.setAttribute("id",uid+"_form"),form.setAttribute("method","post"),form.setAttribute("enctype","multipart/form-data"),form.setAttribute("encoding","multipart/form-data"),Basic.extend(form.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),input=document.createElement("input"),input.setAttribute("id",uid),input.setAttribute("type","file"),input.setAttribute("name",_options.name||"Filedata"),input.setAttribute("accept",_mimes.join(",")),Basic.extend(input.style,{fontSize:"999px",opacity:0}),form.appendChild(input),shimContainer.appendChild(form),Basic.extend(input.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===Env.browser&&Env.verComp(Env.version,10,"<")&&Basic.extend(input.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),input.onchange=function(){var file;if(this.value){if(this.files){if(file=this.files[0],0===file.size)return void form.parentNode.removeChild(form)}else file={name:this.value};file=new File(I.uid,file),this.onchange=function(){},addInput.call(comp),comp.files=[file],input.setAttribute("id",file.uid),form.setAttribute("id",file.uid+"_form"),comp.trigger("change"),input=form=null}},I.can("summon_file_dialog")&&(browseButton=Dom.get(_options.browse_button),Events.removeEvent(browseButton,"click",comp.uid),Events.addEvent(browseButton,"click",function(e){input&&!input.disabled&&input.click(),e.preventDefault()},comp.uid)),_uid=uid,shimContainer=currForm=browseButton=null}var _uid,_options,_mimes=[];Basic.extend(this,{init:function(options){var shimContainer,comp=this,I=comp.getRuntime();_options=options,_mimes=options.accept.mimes||Mime.extList2mimes(options.accept,I.can("filter_by_extension")),shimContainer=I.getShimContainer(),function(){var browseButton,zIndex,top;browseButton=Dom.get(options.browse_button),I.can("summon_file_dialog")&&("static"===Dom.getStyle(browseButton,"position")&&(browseButton.style.position="relative"),zIndex=parseInt(Dom.getStyle(browseButton,"z-index"),10)||1,browseButton.style.zIndex=zIndex,shimContainer.style.zIndex=zIndex-1),top=I.can("summon_file_dialog")?browseButton:shimContainer,Events.addEvent(top,"mouseover",function(){comp.trigger("mouseenter")},comp.uid),Events.addEvent(top,"mouseout",function(){comp.trigger("mouseleave")},comp.uid),Events.addEvent(top,"mousedown",function(){comp.trigger("mousedown")},comp.uid),Events.addEvent(Dom.get(options.container),"mouseup",function(){comp.trigger("mouseup")},comp.uid),browseButton=null}(),addInput.call(this),shimContainer=null,comp.trigger({type:"ready",async:!0})},disable:function(state){var input;(input=Dom.get(_uid))&&(input.disabled=!!state)},destroy:function(){var I=this.getRuntime(),shim=I.getShim(),shimContainer=I.getShimContainer();Events.removeAllEvents(shimContainer,this.uid),Events.removeAllEvents(_options&&Dom.get(_options.container),this.uid),Events.removeAllEvents(_options&&Dom.get(_options.browse_button),this.uid),shimContainer&&(shimContainer.innerHTML=""),shim.removeInstance(this.uid),_uid=_mimes=_options=shimContainer=shim=null}})}return extensions.FileInput=FileInput}),define("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(extensions,FileReader){return extensions.FileReader=FileReader}),define("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(extensions,Basic,Dom,Url,x,Events,Blob,FormData){function XMLHttpRequest(){function cleanup(cb){var uid,form,inputs,i,target=this,hasFile=!1;if(_iframe){if(uid=_iframe.id.replace(/_iframe$/,""),form=Dom.get(uid+"_form")){for(inputs=form.getElementsByTagName("input"),i=inputs.length;i--;)switch(inputs[i].getAttribute("type")){case"hidden":inputs[i].parentNode.removeChild(inputs[i]);break;case"file":hasFile=!0}inputs=[],hasFile||form.parentNode.removeChild(form),form=null}setTimeout(function(){Events.removeEvent(_iframe,"load",target.uid),_iframe.parentNode&&_iframe.parentNode.removeChild(_iframe);var shimContainer=target.getRuntime().getShimContainer();shimContainer.children.length||shimContainer.parentNode.removeChild(shimContainer),shimContainer=_iframe=null,cb()},1)}}var _status,_response,_iframe;Basic.extend(this,{send:function(meta,data){function createIframe(){var container=I.getShimContainer()||document.body,temp=document.createElement("div");temp.innerHTML='<iframe id="'+uid+'_iframe" name="'+uid+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',_iframe=temp.firstChild,container.appendChild(_iframe),Events.addEvent(_iframe,"load",function(){var el;try{el=_iframe.contentWindow.document||_iframe.contentDocument||window.frames[_iframe.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(el.title)?_status=el.title.replace(/^(\d+).*$/,"$1"):(_status=200,_response=Basic.trim(el.body.innerHTML),target.trigger({type:"progress",loaded:_response.length,total:_response.length}),blob&&target.trigger({type:"uploadprogress",loaded:blob.size||1025,total:blob.size||1025}))}catch(ex){if(!Url.hasSameOrigin(meta.url))return void cleanup.call(target,function(){target.trigger("error")});_status=404}cleanup.call(target,function(){target.trigger("load")})},target.uid)}var uid,form,input,blob,target=this,I=target.getRuntime();if(_status=_response=null,data instanceof FormData&&data.hasBlob()){if(blob=data.getBlob(),uid=blob.uid,input=Dom.get(uid),form=Dom.get(uid+"_form"),!form)throw new x.DOMException(x.DOMException.NOT_FOUND_ERR)}else uid=Basic.guid("uid_"),form=document.createElement("form"),form.setAttribute("id",uid+"_form"),form.setAttribute("method",meta.method),form.setAttribute("enctype","multipart/form-data"),form.setAttribute("encoding","multipart/form-data"),I.getShimContainer().appendChild(form);form.setAttribute("target",uid+"_iframe"),data instanceof FormData&&data.each(function(value,name){if(value instanceof Blob)input&&input.setAttribute("name",name);else{var hidden=document.createElement("input");Basic.extend(hidden,{type:"hidden",name:name,value:value}),input?form.insertBefore(hidden,input):form.appendChild(hidden)}}),form.setAttribute("action",meta.url),createIframe(),form.submit(),target.trigger("loadstart")},getStatus:function(){return _status},getResponse:function(responseType){if("json"===responseType&&"string"===Basic.typeOf(_response)&&window.JSON)try{return JSON.parse(_response.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(ex){return null}return _response},abort:function(){var target=this;_iframe&&_iframe.contentWindow&&(_iframe.contentWindow.stop?_iframe.contentWindow.stop():_iframe.contentWindow.document.execCommand?_iframe.contentWindow.document.execCommand("Stop"):_iframe.src="about:blank"),cleanup.call(this,function(){target.dispatchEvent("abort")})}})}return extensions.XMLHttpRequest=XMLHttpRequest}),define("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(extensions,Image){return extensions.Image=Image}),expose(["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/I18n","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/FileInput","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/runtime/Transporter","moxie/image/Image","moxie/core/utils/Events"])}(this),function(exports){"use strict";var o={},inArray=exports.moxie.core.utils.Basic.inArray;return function addAlias(ns){var name,itemType;for(name in ns)itemType=typeof ns[name],"object"!==itemType||~inArray(name,["Exceptions","Env","Mime"])?"function"===itemType&&(o[name]=ns[name]):addAlias(ns[name])}(exports.moxie),o.Env=exports.moxie.core.utils.Env,o.Mime=exports.moxie.core.utils.Mime,o.Exceptions=exports.moxie.core.Exceptions,exports.mOxie=o,exports.o||(exports.o=o),o}(this)}).call(window)}).call(window)},function(module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj};(function(){(function(){!function(window,o,undef){function normalizeCaps(settings){function resolve(feature,value,strict){var map={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};map[feature]?caps[map[feature]]=value:strict||(caps[feature]=value)}var features=settings.required_features,caps={};return"string"==typeof features?plupload.each(features.split(/\s*,\s*/),function(feature){resolve(feature,!0)}):"object"===("undefined"==typeof features?"undefined":_typeof(features))?plupload.each(features,function(value,feature){resolve(feature,value)}):features===!0&&(settings.chunk_size>0&&(caps.slice_blob=!0),!settings.resize.enabled&&settings.multipart||(caps.send_binary_string=!0),plupload.each(settings,function(value,feature){resolve(feature,!!value,!0)})),caps}var delay=window.setTimeout,fileFilters={},plupload={VERSION:"2.1.8",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:o.mimes,ua:o.ua,typeOf:o.typeOf,extend:o.extend,guid:o.guid,get:function(ids){var el,els=[];"array"!==o.typeOf(ids)&&(ids=[ids]);for(var i=ids.length;i--;)el=o.get(ids[i]),el&&els.push(el);return els.length?els:null},each:o.each,getPos:o.getPos,getSize:o.getSize,xmlEncode:function(str){var xmlEncodeChars={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},xmlEncodeRegExp=/[<>&\"\']/g;return str?(""+str).replace(xmlEncodeRegExp,function(chr){return xmlEncodeChars[chr]?"&"+xmlEncodeChars[chr]+";":chr}):str},toArray:o.toArray,inArray:o.inArray,addI18n:o.addI18n,translate:o.translate,isEmptyObj:o.isEmptyObj,hasClass:o.hasClass,addClass:o.addClass,removeClass:o.removeClass,getStyle:o.getStyle,addEvent:o.addEvent,removeEvent:o.removeEvent,removeAllEvents:o.removeAllEvents,cleanName:function(name){var i,lookup;for(lookup=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],i=0;i<lookup.length;i+=2)name=name.replace(lookup[i],lookup[i+1]);return name=name.replace(/\s+/g,"_"),name=name.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(url,items){var query="";return plupload.each(items,function(value,name){query+=(query?"&":"")+encodeURIComponent(name)+"="+encodeURIComponent(value)}),query&&(url+=(url.indexOf("?")>0?"&":"?")+query),url},formatSize:function(size){function round(num,precision){return Math.round(num*Math.pow(10,precision))/Math.pow(10,precision)}if(size===undef||/\D/.test(size))return plupload.translate("N/A");var boundary=Math.pow(1024,4);return size>boundary?round(size/boundary,1)+" "+plupload.translate("tb"):size>(boundary/=1024)?round(size/boundary,1)+" "+plupload.translate("gb"):size>(boundary/=1024)?round(size/boundary,1)+" "+plupload.translate("mb"):size>1024?Math.round(size/1024)+" "+plupload.translate("kb"):size+" "+plupload.translate("b")},parseSize:o.parseSizeStr,predictRuntime:function(config,runtimes){var up,runtime;return up=new plupload.Uploader(config),runtime=o.Runtime.thatCan(up.getOption().required_features,runtimes||config.runtimes),up.destroy(),runtime},addFileFilter:function(name,cb){fileFilters[name]=cb}};plupload.addFileFilter("mime_types",function(filters,file,cb){filters.length&&!filters.regexp.test(file.name)?(this.trigger("Error",{code:plupload.FILE_EXTENSION_ERROR,message:plupload.translate("File extension error."),file:file}),cb(!1)):cb(!0)}),plupload.addFileFilter("max_file_size",function(maxSize,file,cb){var undef;maxSize=plupload.parseSize(maxSize),file.size!==undef&&maxSize&&file.size>maxSize?(this.trigger("Error",{code:plupload.FILE_SIZE_ERROR,message:plupload.translate("File size error."),file:file}),cb(!1)):cb(!0)}),plupload.addFileFilter("prevent_duplicates",function(value,file,cb){if(value)for(var ii=this.files.length;ii--;)if(file.name===this.files[ii].name&&file.size===this.files[ii].size)return this.trigger("Error",{code:plupload.FILE_DUPLICATE_ERROR,message:plupload.translate("Duplicate file error."),file:file}),void cb(!1);cb(!0)}),plupload.Uploader=function(options){function uploadNext(){var file,i,count=0;if(this.state==plupload.STARTED){for(i=0;i<files.length;i++)file||files[i].status!=plupload.QUEUED?count++:(file=files[i],this.trigger("BeforeUpload",file)&&(file.status=plupload.UPLOADING,this.trigger("UploadFile",file)));count==files.length&&(this.state!==plupload.STOPPED&&(this.state=plupload.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",files))}}function calcFile(file){file.percent=file.size>0?Math.ceil(file.loaded/file.size*100):100,calc()}function calc(){var i,file;for(total.reset(),i=0;i<files.length;i++)file=files[i],file.size!==undef?(total.size+=file.origSize,total.loaded+=file.loaded*file.origSize/file.size):total.size=undef,file.status==plupload.DONE?total.uploaded++:file.status==plupload.FAILED?total.failed++:total.queued++;total.size===undef?total.percent=files.length>0?Math.ceil(total.uploaded/files.length*100):0:(total.bytesPerSec=Math.ceil(total.loaded/((+new Date-startTime||1)/1e3)),total.percent=total.size>0?Math.ceil(total.loaded/total.size*100):0)}function getRUID(){var ctrl=fileInputs[0]||fileDrops[0];return ctrl?ctrl.getRuntime().uid:!1}function runtimeCan(file,cap){if(file.ruid){var info=o.Runtime.getInfo(file.ruid);if(info)return info.can(cap)}return!1}function bindEventListeners(){this.bind("FilesAdded FilesRemoved",function(up){up.trigger("QueueChanged"),up.refresh()}),this.bind("CancelUpload",onCancelUpload),this.bind("BeforeUpload",onBeforeUpload),this.bind("UploadFile",onUploadFile),this.bind("UploadProgress",onUploadProgress),this.bind("StateChanged",onStateChanged),this.bind("QueueChanged",calc),this.bind("Error",onError),this.bind("FileUploaded",onFileUploaded),this.bind("Destroy",onDestroy)}function initControls(settings,cb){var self=this,inited=0,queue=[],options={runtime_order:settings.runtimes,required_caps:settings.required_features,preferred_caps:preferred_caps,swf_url:settings.flash_swf_url,xap_url:settings.silverlight_xap_url};plupload.each(settings.runtimes.split(/\s*,\s*/),function(runtime){settings[runtime]&&(options[runtime]=settings[runtime])}),settings.browse_button&&plupload.each(settings.browse_button,function(el){queue.push(function(cb){var fileInput=new o.FileInput(plupload.extend({},options,{accept:settings.filters.mime_types,name:settings.file_data_name,multiple:settings.multi_selection,container:settings.container,browse_button:el}));fileInput.onready=function(){var info=o.Runtime.getInfo(this.ruid);o.extend(self.features,{chunks:info.can("slice_blob"),multipart:info.can("send_multipart"),multi_selection:info.can("select_multiple")}),inited++,fileInputs.push(this),cb()},fileInput.onchange=function(){self.addFile(this.files)},fileInput.bind("mouseenter mouseleave mousedown mouseup",function(e){disabled||(settings.browse_button_hover&&("mouseenter"===e.type?o.addClass(el,settings.browse_button_hover):"mouseleave"===e.type&&o.removeClass(el,settings.browse_button_hover)),settings.browse_button_active&&("mousedown"===e.type?o.addClass(el,settings.browse_button_active):"mouseup"===e.type&&o.removeClass(el,settings.browse_button_active)))}),fileInput.bind("mousedown",function(){self.trigger("Browse")}),fileInput.bind("error runtimeerror",function(){fileInput=null,cb()}),fileInput.init()})}),settings.drop_element&&plupload.each(settings.drop_element,function(el){queue.push(function(cb){var fileDrop=new o.FileDrop(plupload.extend({},options,{drop_zone:el}));fileDrop.onready=function(){var info=o.Runtime.getInfo(this.ruid);self.features.dragdrop=info.can("drag_and_drop"),inited++,fileDrops.push(this),cb()},fileDrop.ondrop=function(){self.addFile(this.files)},fileDrop.bind("error runtimeerror",function(){fileDrop=null,cb()}),fileDrop.init()})}),o.inSeries(queue,function(){"function"==typeof cb&&cb(inited)})}function resizeImage(blob,params,cb){var img=new o.Image;try{img.onload=function(){return params.width>this.width&&params.height>this.height&&params.quality===undef&&params.preserve_headers&&!params.crop?(this.destroy(),cb(blob)):void img.downsize(params.width,params.height,params.crop,params.preserve_headers)},img.onresize=function(){cb(this.getAsBlob(blob.type,params.quality)),this.destroy()},img.onerror=function(){cb(blob)},img.load(blob)}catch(ex){cb(blob)}}function _setOption2(option,value,init){function _setOption(option,value,init){var oldValue=settings[option];switch(option){case"max_file_size":"max_file_size"===option&&(settings.max_file_size=settings.filters.max_file_size=value);break;case"chunk_size":(value=plupload.parseSize(value))&&(settings[option]=value,settings.send_file_name=!0);break;case"multipart":settings[option]=value,value||(settings.send_file_name=!0);break;case"unique_names":settings[option]=value,value&&(settings.send_file_name=!0);break;case"filters":"array"===plupload.typeOf(value)&&(value={mime_types:value}),init?plupload.extend(settings.filters,value):settings.filters=value,value.mime_types&&(settings.filters.mime_types.regexp=function(filters){var extensionsRegExp=[];return plupload.each(filters,function(filter){plupload.each(filter.extensions.split(/,/),function(ext){/^\s*\*\s*$/.test(ext)?extensionsRegExp.push("\\.*"):extensionsRegExp.push("\\."+ext.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+extensionsRegExp.join("|")+")$","i")}(settings.filters.mime_types));break;case"resize":init?plupload.extend(settings.resize,value,{enabled:!0}):settings.resize=value;break;case"prevent_duplicates":settings.prevent_duplicates=settings.filters.prevent_duplicates=!!value;break;case"browse_button":case"drop_element":value=plupload.get(value);case"container":case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":settings[option]=value,init||(reinitRequired=!0);break;default:settings[option]=value}init||self.trigger("OptionChanged",option,value,oldValue)}var self=this,reinitRequired=!1;"object"===("undefined"==typeof option?"undefined":_typeof(option))?plupload.each(option,function(value,option){_setOption(option,value,init)}):_setOption(option,value,init),init?(settings.required_features=normalizeCaps(plupload.extend({},settings)),
preferred_caps=normalizeCaps(plupload.extend({},settings,{required_features:!0}))):reinitRequired&&(self.trigger("Destroy"),initControls.call(self,settings,function(inited){inited?(self.runtime=o.Runtime.getInfo(getRUID()).type,self.trigger("Init",{runtime:self.runtime}),self.trigger("PostInit")):self.trigger("Error",{code:plupload.INIT_ERROR,message:plupload.translate("Init error.")})}))}function onBeforeUpload(up,file){if(up.settings.unique_names){var matches=file.name.match(/\.([^.]+)$/),ext="part";matches&&(ext=matches[1]),file.target_name=file.id+"."+ext}}function onUploadFile(up,file){function handleError(){retries-- >0?delay(uploadNextChunk,1e3):(file.loaded=offset,up.trigger("Error",{code:plupload.HTTP_ERROR,message:plupload.translate("HTTP Error."),file:file,response:xhr.responseText,status:xhr.status,responseHeaders:xhr.getAllResponseHeaders()}))}function uploadNextChunk(){var chunkBlob,formData,curChunkSize,args={};file.status===plupload.UPLOADING&&up.state!==plupload.STOPPED&&(up.settings.send_file_name&&(args.name=file.target_name||file.name),chunkSize&&features.chunks&&blob.size>chunkSize?(curChunkSize=Math.min(chunkSize,blob.size-offset),chunkBlob=blob.slice(offset,offset+curChunkSize)):(curChunkSize=blob.size,chunkBlob=blob),chunkSize&&features.chunks&&(up.settings.send_chunk_number?(args.chunk=Math.ceil(offset/chunkSize),args.chunks=Math.ceil(blob.size/chunkSize)):(args.offset=offset,args.total=blob.size)),xhr=new o.XMLHttpRequest,xhr.upload&&(xhr.upload.onprogress=function(e){file.loaded=Math.min(file.size,offset+e.loaded),up.trigger("UploadProgress",file)}),xhr.onload=function(){return xhr.status>=400?void handleError():(retries=up.settings.max_retries,curChunkSize<blob.size?(chunkBlob.destroy(),offset+=curChunkSize,file.loaded=Math.min(offset,blob.size),up.trigger("ChunkUploaded",file,{offset:file.loaded,total:blob.size,response:xhr.responseText,status:xhr.status,responseHeaders:xhr.getAllResponseHeaders()}),"Android Browser"===o.Env.browser&&up.trigger("UploadProgress",file)):file.loaded=file.size,chunkBlob=formData=null,void(!offset||offset>=blob.size?(file.size!=file.origSize&&(blob.destroy(),blob=null),up.trigger("UploadProgress",file),file.status=plupload.DONE,up.trigger("FileUploaded",file,{response:xhr.responseText,status:xhr.status,responseHeaders:xhr.getAllResponseHeaders()})):delay(uploadNextChunk,1)))},xhr.onerror=function(){handleError()},xhr.onloadend=function(){this.destroy(),xhr=null},up.settings.multipart&&features.multipart?(xhr.open("post",url,!0),plupload.each(up.settings.headers,function(value,name){xhr.setRequestHeader(name,value)}),formData=new o.FormData,plupload.each(plupload.extend(args,up.settings.multipart_params),function(value,name){formData.append(name,value)}),formData.append(up.settings.file_data_name,chunkBlob),xhr.send(formData,{runtime_order:up.settings.runtimes,required_caps:up.settings.required_features,preferred_caps:preferred_caps,swf_url:up.settings.flash_swf_url,xap_url:up.settings.silverlight_xap_url})):(url=plupload.buildUrl(up.settings.url,plupload.extend(args,up.settings.multipart_params)),xhr.open("post",url,!0),xhr.setRequestHeader("Content-Type","application/octet-stream"),plupload.each(up.settings.headers,function(value,name){xhr.setRequestHeader(name,value)}),xhr.send(chunkBlob,{runtime_order:up.settings.runtimes,required_caps:up.settings.required_features,preferred_caps:preferred_caps,swf_url:up.settings.flash_swf_url,xap_url:up.settings.silverlight_xap_url})))}var blob,url=up.settings.url,chunkSize=up.settings.chunk_size,retries=up.settings.max_retries,features=up.features,offset=0;file.loaded&&(offset=file.loaded=chunkSize?chunkSize*Math.floor(file.loaded/chunkSize):0),blob=file.getSource(),up.settings.resize.enabled&&runtimeCan(blob,"send_binary_string")&&~o.inArray(blob.type,["image/jpeg","image/png"])?resizeImage.call(this,blob,up.settings.resize,function(resizedBlob){blob=resizedBlob,file.size=resizedBlob.size,uploadNextChunk()}):uploadNextChunk()}function onUploadProgress(up,file){calcFile(file)}function onStateChanged(up){if(up.state==plupload.STARTED)startTime=+new Date;else if(up.state==plupload.STOPPED)for(var i=up.files.length-1;i>=0;i--)up.files[i].status==plupload.UPLOADING&&(up.files[i].status=plupload.QUEUED,calc())}function onCancelUpload(){xhr&&xhr.abort()}function onFileUploaded(up){calc(),delay(function(){uploadNext.call(up)},1)}function onError(up,err){err.code===plupload.INIT_ERROR?up.destroy():err.code===plupload.HTTP_ERROR&&(err.file.status=plupload.FAILED,calcFile(err.file),up.state==plupload.STARTED&&(up.trigger("CancelUpload"),delay(function(){uploadNext.call(up)},1)))}function onDestroy(up){up.stop(),plupload.each(files,function(file){file.destroy()}),files=[],fileInputs.length&&(plupload.each(fileInputs,function(fileInput){fileInput.destroy()}),fileInputs=[]),fileDrops.length&&(plupload.each(fileDrops,function(fileDrop){fileDrop.destroy()}),fileDrops=[]),preferred_caps={},disabled=!1,startTime=xhr=null,total.reset()}var settings,startTime,total,xhr,uid=plupload.guid(),files=[],preferred_caps={},fileInputs=[],fileDrops=[],disabled=!1;settings={runtimes:o.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_file_name:!0,send_chunk_number:!0},_setOption2.call(this,options,null,!0),total=new plupload.QueueProgress,plupload.extend(this,{id:uid,uid:uid,state:plupload.STOPPED,features:{},runtime:null,files:files,settings:settings,total:total,init:function(){var self=this;return"function"==typeof settings.preinit?settings.preinit(self):plupload.each(settings.preinit,function(func,name){self.bind(name,func)}),bindEventListeners.call(this),settings.browse_button&&settings.url?void initControls.call(this,settings,function(inited){"function"==typeof settings.init?settings.init(self):plupload.each(settings.init,function(func,name){self.bind(name,func)}),inited?(self.runtime=o.Runtime.getInfo(getRUID()).type,self.trigger("Init",{runtime:self.runtime}),self.trigger("PostInit")):self.trigger("Error",{code:plupload.INIT_ERROR,message:plupload.translate("Init error.")})}):void this.trigger("Error",{code:plupload.INIT_ERROR,message:plupload.translate("Init error.")})},setOption:function(option,value){_setOption2.call(this,option,value,!this.runtime)},getOption:function(option){return option?settings[option]:settings},refresh:function(){fileInputs.length&&plupload.each(fileInputs,function(fileInput){fileInput.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=plupload.STARTED&&(this.state=plupload.STARTED,this.trigger("StateChanged"),uploadNext.call(this))},stop:function(){this.state!=plupload.STOPPED&&(this.state=plupload.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){disabled=arguments[0]!==undef?arguments[0]:!0,fileInputs.length&&plupload.each(fileInputs,function(fileInput){fileInput.disable(disabled)}),this.trigger("DisableBrowse",disabled)},getFile:function(id){var i;for(i=files.length-1;i>=0;i--)if(files[i].id===id)return files[i]},addFile:function(file,fileName){function filterFile(file,cb){var queue=[];o.each(self.settings.filters,function(rule,name){fileFilters[name]&&queue.push(function(cb){fileFilters[name].call(self,rule,file,function(res){cb(!res)})})}),o.inSeries(queue,cb)}function resolveFile(file){var type=o.typeOf(file);if(file instanceof o.File){if(!file.ruid&&!file.isDetached()){if(!ruid)return!1;file.ruid=ruid,file.connectRuntime(ruid)}resolveFile(new plupload.File(file))}else file instanceof o.Blob?(resolveFile(file.getSource()),file.destroy()):file instanceof plupload.File?(fileName&&(file.name=fileName),queue.push(function(cb){filterFile(file,function(err){err||(files.push(file),filesAdded.push(file),self.trigger("FileFiltered",file)),delay(cb,1)})})):-1!==o.inArray(type,["file","blob"])?resolveFile(new o.File(null,file)):"node"===type&&"filelist"===o.typeOf(file.files)?o.each(file.files,resolveFile):"array"===type&&(fileName=null,o.each(file,resolveFile))}var ruid,self=this,queue=[],filesAdded=[];ruid=getRUID(),resolveFile(file),queue.length&&o.inSeries(queue,function(){filesAdded.length&&self.trigger("FilesAdded",filesAdded)})},removeFile:function(file){for(var id="string"==typeof file?file:file.id,i=files.length-1;i>=0;i--)if(files[i].id===id)return this.splice(i,1)[0]},splice:function(start,length){var removed=files.splice(start===undef?0:start,length===undef?files.length:length),restartRequired=!1;return this.state==plupload.STARTED&&(plupload.each(removed,function(file){return file.status===plupload.UPLOADING?(restartRequired=!0,!1):void 0}),restartRequired&&this.stop()),this.trigger("FilesRemoved",removed),plupload.each(removed,function(file){file.destroy()}),restartRequired&&this.start(),removed},dispatchEvent:function(type){var list,args;if(type=type.toLowerCase(),list=this.hasEventListener(type)){list.sort(function(a,b){return b.priority-a.priority}),args=[].slice.call(arguments),args.shift(),args.unshift(this);for(var i=0;i<list.length;i++)if(list[i].fn.apply(list[i].scope,args)===!1)return!1}return!0},bind:function(name,fn,scope,priority){plupload.Uploader.prototype.bind.call(this,name,fn,priority,scope)},destroy:function(){this.trigger("Destroy"),settings=total=null,this.unbindAll()}})},plupload.Uploader.prototype=o.EventTarget.instance,plupload.File=function(){function PluploadFile(file){plupload.extend(this,{id:plupload.guid(),name:file.name||file.fileName,type:file.type||"",size:file.size||file.fileSize,origSize:file.size||file.fileSize,loaded:0,percent:0,status:plupload.QUEUED,lastModifiedDate:file.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var file=this.getSource().getSource();return-1!==o.inArray(o.typeOf(file),["blob","file"])?file:null},getSource:function(){return filepool[this.id]?filepool[this.id]:null},destroy:function(){var src=this.getSource();src&&(src.destroy(),delete filepool[this.id])}}),filepool[this.id]=file}var filepool={};return PluploadFile}(),plupload.QueueProgress=function(){var self=this;self.size=0,self.loaded=0,self.uploaded=0,self.failed=0,self.queued=0,self.percent=0,self.bytesPerSec=0,self.reset=function(){self.size=self.loaded=self.uploaded=self.failed=self.queued=self.percent=self.bytesPerSec=0}},window.plupload=plupload}(window,mOxie)}).call(window)}).call(window)},function(module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj};(function(){!function(global){function createCookie(key,value,exp){var date=new Date;date.setTime(date.getTime()+24*exp*60*60*1e3);var expires="; expires="+date.toGMTString();document.cookie=key+"="+value+expires+"; path=/"}function readCookie(key){for(var nameEQ=key+"=",ca=document.cookie.split(";"),i=0,max=ca.length;max>i;i++){for(var c=ca[i];" "===c.charAt(0);)c=c.substring(1,c.length);if(0===c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}return null}function QiniuJsSDK(){function log(type,args){for(var header="[qiniu-js-sdk]["+type+"]",msg=header,i=0;i<args.length;i++)msg+="string"==typeof args[i]?" "+args[i]:" "+that.stringifyJSON(args[i]);that.detectIEVersion()?console.log(msg):(args.unshift(header),console.log.apply(console,args)),document.getElementById("qiniu-js-sdk-log")&&(document.getElementById("qiniu-js-sdk-log").innerHTML+="<p>"+msg+"</p>")}function makeLogFunc(code){var func=code.toLowerCase();logger[func]=function(){if(window.console&&window.console.log&&logger.level>=logger[code]){var args=Array.prototype.slice.call(arguments);log(func,args)}}}var that=this;this.detectIEVersion=function(){for(var v=4,div=document.createElement("div"),all=div.getElementsByTagName("i");div.innerHTML="<!--[if gt IE "+v+"]><i></i><![endif]-->",all[0];)v++;return v>4?v:!1};var logger={MUTE:0,FATA:1,ERROR:2,WARN:3,INFO:4,DEBUG:5,TRACE:6,level:0};for(var property in logger)logger.hasOwnProperty(property)&&"number"==typeof logger[property]&&!logger.hasOwnProperty(property.toLowerCase())&&makeLogFunc(property);var qiniuUploadUrl;qiniuUploadUrl="https:"===window.location.protocol?"https://up.qbox.me":"http://upload.qiniu.com";var qiniuUploadUrls=["http://upload.qiniu.com","http://up.qiniu.com"],changeUrlTimes=0;this.resetUploadUrl=function(){if("https:"===window.location.protocol)qiniuUploadUrl="https://up.qbox.me";else{var i=changeUrlTimes%qiniuUploadUrls.length;qiniuUploadUrl=qiniuUploadUrls[i],changeUrlTimes++}logger.debug("resetUploadUrl: "+qiniuUploadUrl)},this.resetUploadUrl(),this.isImage=function(url){return url=url.split(/[?#]/)[0],/\.(png|jpg|jpeg|gif|bmp)$/i.test(url)},this.getFileExtension=function(filename){var ext,tempArr=filename.split(".");return ext=1===tempArr.length||""===tempArr[0]&&2===tempArr.length?"":tempArr.pop().toLowerCase()},this.utf8_encode=function(argString){if(null===argString||"undefined"==typeof argString)return"";var start,end,string=argString+"",utftext="",stringl=0;start=end=0,stringl=string.length;for(var n=0;stringl>n;n++){var c1=string.charCodeAt(n),enc=null;if(128>c1)end++;else if(c1>127&&2048>c1)enc=String.fromCharCode(c1>>6|192,63&c1|128);else if(63488&c1^!0)enc=String.fromCharCode(c1>>12|224,c1>>6&63|128,63&c1|128);else{if(64512&c1^!0)throw new RangeError("Unmatched trail surrogate at "+n);var c2=string.charCodeAt(++n);if(64512&c2^!0)throw new RangeError("Unmatched lead surrogate at "+(n-1));c1=((1023&c1)<<10)+(1023&c2)+65536,enc=String.fromCharCode(c1>>18|240,c1>>12&63|128,c1>>6&63|128,63&c1|128)}null!==enc&&(end>start&&(utftext+=string.slice(start,end)),utftext+=enc,start=end=n+1)}return end>start&&(utftext+=string.slice(start,stringl)),utftext},this.base64_encode=function(data){var o1,o2,o3,h1,h2,h3,h4,bits,b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,ac=0,enc="",tmp_arr=[];if(!data)return data;data=this.utf8_encode(data+"");do o1=data.charCodeAt(i++),o2=data.charCodeAt(i++),o3=data.charCodeAt(i++),bits=o1<<16|o2<<8|o3,h1=bits>>18&63,h2=bits>>12&63,h3=bits>>6&63,h4=63&bits,tmp_arr[ac++]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4);while(i<data.length);switch(enc=tmp_arr.join(""),data.length%3){case 1:enc=enc.slice(0,-2)+"==";break;case 2:enc=enc.slice(0,-1)+"="}return enc},this.URLSafeBase64Encode=function(v){return v=this.base64_encode(v),v.replace(/\//g,"_").replace(/\+/g,"-")},this.createAjax=function(argument){var xmlhttp={};return xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},this.parseJSON=function(data){if(window.JSON&&window.JSON.parse)return window.JSON.parse(data);var rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,text=String(data);return rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),eval("("+text+")")},this.stringifyJSON=function(obj){if(window.JSON&&window.JSON.stringify)return window.JSON.stringify(obj);switch("undefined"==typeof obj?"undefined":_typeof(obj)){case"string":return'"'+obj.replace(/(["\\])/g,"\\$1")+'"';case"array":return"["+obj.map(that.stringifyJSON).join(",")+"]";case"object":if(obj instanceof Array){for(var strArr=[],len=obj.length,i=0;len>i;i++)strArr.push(that.stringifyJSON(obj[i]));return"["+strArr.join(",")+"]"}if(null===obj)return"null";var string=[];for(var property in obj)obj.hasOwnProperty(property)&&string.push(that.stringifyJSON(property)+":"+that.stringifyJSON(obj[property]));return"{"+string.join(",")+"}";case"number":return obj;case!1:return obj;case"boolean":return obj}},this.trim=function(text){return null===text?"":text.replace(/^\s+|\s+$/g,"")},this.uploader=function(op){var reset_chunk_size=function(){var BLOCK_BITS,MAX_CHUNK_SIZE,chunk_size,ie=that.detectIEVersion(),isSpecialSafari="Safari"===mOxie.Env.browser&&mOxie.Env.version<=5&&"Windows"===mOxie.Env.os&&"7"===mOxie.Env.osVersion||"Safari"===mOxie.Env.browser&&"iOS"===mOxie.Env.os&&"7"===mOxie.Env.osVersion;ie&&9>=ie&&op.chunk_size&&op.runtimes.indexOf("flash")<0?op.chunk_size=0:isSpecialSafari?op.chunk_size=0:(BLOCK_BITS=20,MAX_CHUNK_SIZE=4<<BLOCK_BITS,chunk_size=plupload.parseSize(op.chunk_size),chunk_size>MAX_CHUNK_SIZE&&(op.chunk_size=MAX_CHUNK_SIZE))},getUpToken=function(_file,_fn,_up){if(!_file)return console.log("提供必要的参数"),!1;var data=new FormData;data.append("name",_file.name);var ajax=that.createAjax();ajax.open("POST",that.uptoken_url,!0),ajax.setRequestHeader("If-Modified-Since","0"),ajax.onreadystatechange=function(){if(4===ajax.readyState&&200===ajax.status){var res=that.parseJSON(ajax.responseText);1===res.status?(that.token=res.data.token,that.path=res.data.path,"function"==typeof _fn&&_fn()):_up&&_up.trigger("Error",{code:plupload.FILE_EXTENSION_ERROR,message:res.message,file:_file}),that.directUpload=function(up,file,func){speedCalInfo.startTime=(new Date).getTime();var multipart_params_obj;multipart_params_obj=op.save_key?{token:that.token}:{key:that.path,token:that.token},logger.debug("directUpload multipart_params_obj: ",multipart_params_obj);var x_vars=op.x_vars;if(void 0!==x_vars&&"object"===("undefined"==typeof x_vars?"undefined":_typeof(x_vars)))for(var x_key in x_vars)x_vars.hasOwnProperty(x_key)&&("function"==typeof x_vars[x_key]?multipart_params_obj["x:"+x_key]=x_vars[x_key](up,file):"object"!==_typeof(x_vars[x_key])&&(multipart_params_obj["x:"+x_key]=x_vars[x_key]));up.setOption({url:qiniuUploadUrl,multipart:!0,chunk_size:that.is_android_weixin_or_qq()?op.max_file_size:void 0,multipart_params:multipart_params_obj})}}},ajax.send(data)},getFileKey=function(up,file,func){var key="",unique_names=!1;if(!op.save_key)if(unique_names=up.getOption&&up.getOption("unique_names"),unique_names=unique_names||up.settings&&up.settings.unique_names){var ext=that.getFileExtension(file.name);key=ext?file.id+"."+ext:file.id}else key="function"==typeof func?func(up,file):file.name;return key};if(op.log_level&&(logger.level=op.log_level),!op.domain)throw"domain setting in options is required!";if(!op.browse_button)throw"browse_button setting in options is required!";if(!op.uptoken&&!op.uptoken_url&&!op.uptoken_func)throw"one of [uptoken, uptoken_url, uptoken_func] settings in options is required!";logger.debug("init uploader start"),logger.debug("environment: ",mOxie.Env),logger.debug("userAgent: ",navigator.userAgent);var option={},_Error_Handler=op.init&&op.init.Error,_FileUploaded_Handler=op.init&&op.init.FileUploaded;op.init.Error=function(){},op.init.FileUploaded=function(){},that.uptoken_url=op.uptoken_url,that.token="",that.key_handler="function"==typeof op.init.Key?op.init.Key:"",this.domain=op.domain;var ctx="",speedCalInfo={isResumeUpload:!1,resumeFilesize:0,startTime:"",currentTime:""};reset_chunk_size(),logger.debug("invoke reset_chunk_size()"),logger.debug("op.chunk_size: ",op.chunk_size),plupload.extend(option,op,{url:qiniuUploadUrl,multipart_params:{token:""}}),logger.debug("option: ",option);var uploader=new plupload.Uploader(option);logger.debug("new plupload.Uploader(option)"),uploader.bind("Init",function(up,params){logger.debug("Init event activated")}),logger.debug("bind Init event"),uploader.bind("FilesAdded",function(up,files){logger.debug("FilesAdded event activated");var auto_start=up.getOption&&up.getOption("auto_start");auto_start=auto_start||up.settings&&up.settings.auto_start,logger.debug("auto_start: ",auto_start),logger.debug("files: ",files);var is_ios=function(){return"ios"===mOxie.Env.OS.toLowerCase()};if(is_ios())for(var i=0;i<files.length;i++){var file=files[i],ext=that.getFileExtension(file.name);file.name=file.id+"."+ext}plupload.each(files,function(file){that.fileSize=file.size,getUpToken(file,function(){auto_start&&up.start(),up.refresh()},up)})}),logger.debug("bind FilesAdded event"),uploader.bind("BeforeUpload",function(up,file){logger.debug("BeforeUpload event activated"),file.speed=file.speed||0,ctx="",op.get_new_uptoken&&getUpToken(file);var directUpload=function(up,file,func){speedCalInfo.startTime=(new Date).getTime();var multipart_params_obj;multipart_params_obj=op.save_key?{token:that.token}:{key:getFileKey(up,file,func),token:that.token},logger.debug("directUpload multipart_params_obj: ",multipart_params_obj);var x_vars=op.x_vars;if(void 0!==x_vars&&"object"===("undefined"==typeof x_vars?"undefined":_typeof(x_vars)))for(var x_key in x_vars)x_vars.hasOwnProperty(x_key)&&("function"==typeof x_vars[x_key]?multipart_params_obj["x:"+x_key]=x_vars[x_key](up,file):"object"!==_typeof(x_vars[x_key])&&(multipart_params_obj["x:"+x_key]=x_vars[x_key]));up.setOption({url:qiniuUploadUrl,multipart:!0,chunk_size:is_android_weixin_or_qq()?op.max_file_size:void 0,multipart_params:multipart_params_obj})},is_android_weixin_or_qq=function(){var ua=navigator.userAgent.toLowerCase();return!(!ua.match(/MicroMessenger/i)&&"QQBrowser"!==mOxie.Env.browser&&!ua.match(/V1_AND_SQ/i)||"android"!==mOxie.Env.OS.toLowerCase())},chunk_size=up.getOption&&up.getOption("chunk_size");if(chunk_size=chunk_size||up.settings&&up.settings.chunk_size,logger.debug("uploader.runtime: ",uploader.runtime),logger.debug("chunk_size: ",chunk_size),"html5"!==uploader.runtime&&"flash"!==uploader.runtime||!chunk_size)logger.debug("directUpload because uploader.runtime !== 'html5' || uploader.runtime !== 'flash' || !chunk_size"),directUpload(up,file,that.key_handler);else if(file.size<chunk_size||is_android_weixin_or_qq())logger.debug("directUpload because file.size < chunk_size || is_android_weixin_or_qq()"),directUpload(up,file,that.key_handler);else{var localFileInfo=localStorage.getItem(file.name),blockSize=chunk_size;if(localFileInfo){localFileInfo=that.parseJSON(localFileInfo);var now=(new Date).getTime(),before=localFileInfo.time||0,aDay=864e5;aDay>now-before&&100!==localFileInfo.percent&&file.size===localFileInfo.total?(file.percent=localFileInfo.percent,file.loaded=localFileInfo.offset,ctx=localFileInfo.ctx,speedCalInfo.isResumeUpload=!0,speedCalInfo.resumeFilesize=localFileInfo.offset,localFileInfo.offset+blockSize>file.size&&(blockSize=file.size-localFileInfo.offset)):localStorage.removeItem(file.name)}speedCalInfo.startTime=(new Date).getTime(),up.setOption({url:qiniuUploadUrl+"/mkblk/"+blockSize,multipart:!1,chunk_size:chunk_size,required_features:"chunks",headers:{Authorization:"UpToken "+that.token},multipart_params:{}})}}),logger.debug("bind BeforeUpload event"),uploader.bind("UploadProgress",function(up,file){logger.trace("UploadProgress event activated"),speedCalInfo.currentTime=(new Date).getTime();var timeUsed=speedCalInfo.currentTime-speedCalInfo.startTime,fileUploaded=file.loaded||0;speedCalInfo.isResumeUpload&&(fileUploaded=file.loaded-speedCalInfo.resumeFilesize),file.speed=(fileUploaded/timeUsed*1e3).toFixed(0)||0}),logger.debug("bind UploadProgress event"),uploader.bind("ChunkUploaded",function(up,file,info){logger.debug("ChunkUploaded event activated"),logger.debug("file: ",file),logger.debug("info: ",info);var res=that.parseJSON(info.response);logger.debug("res: ",res),ctx=ctx?ctx+","+res.ctx:res.ctx;var leftSize=info.total-info.offset,chunk_size=up.getOption&&up.getOption("chunk_size");chunk_size=chunk_size||up.settings&&up.settings.chunk_size,chunk_size>leftSize&&(up.setOption({url:qiniuUploadUrl+"/mkblk/"+leftSize}),logger.debug("up.setOption url: ",qiniuUploadUrl+"/mkblk/"+leftSize)),localStorage.setItem(file.name,that.stringifyJSON({ctx:ctx,percent:file.percent,total:info.total,offset:info.offset,time:(new Date).getTime()}))}),logger.debug("bind ChunkUploaded event");var retries=qiniuUploadUrls.length,unknow_error_retry=function(file){return retries-- >0?(setTimeout(function(){that.resetUploadUrl(),file.status=plupload.QUEUED,uploader.stop(),uploader.start()},0),!0):(retries=qiniuUploadUrls.length,!1)};return uploader.bind("Error",function(_Error_Handler){return function(up,err){logger.error("Error event activated"),logger.error("err: ",err);var errTip="",file=err.file;if(file){switch(err.code){case plupload.FAILED:errTip="上传失败。请稍后再试。";break;case plupload.FILE_SIZE_ERROR:var max_file_size=up.getOption&&up.getOption("max_file_size");max_file_size=max_file_size||up.settings&&up.settings.max_file_size,errTip="浏览器最大可上传"+max_file_size+"。更大文件请使用命令行工具。";break;case plupload.FILE_EXTENSION_ERROR:errTip="文件验证失败。请稍后重试。";break;case plupload.HTTP_ERROR:if(""===err.response){if(errTip=err.message||"未知网络错误。",!unknow_error_retry(file))return;break}var errorObj=that.parseJSON(err.response),errorText=errorObj.error;switch(err.status){case 400:errTip="请求报文格式错误。";break;case 401:errTip="客户端认证授权失败。请重试或提交反馈。";break;case 405:errTip="客户端请求错误。请重试或提交反馈。";break;case 579:errTip="资源上传成功，但回调失败。";break;case 599:if(errTip="网络连接异常。请重试或提交反馈。",!unknow_error_retry(file))return;break;case 614:errTip="文件已存在。";try{errorObj=that.parseJSON(errorObj.error),errorText=errorObj.error||"file exists"}catch(e){errorText=errorObj.error||"file exists"}break;case 631:errTip="指定空间不存在。";break;case 701:errTip="上传数据块校验出错。请重试或提交反馈。";break;default:if(errTip="未知错误。",!unknow_error_retry(file))return}errTip=errTip+"("+err.status+"："+errorText+")";break;case plupload.SECURITY_ERROR:errTip="安全配置错误。请联系网站管理员。";break;case plupload.GENERIC_ERROR:errTip="上传失败。请稍后再试。";break;case plupload.IO_ERROR:errTip="上传失败。请稍后再试。";break;case plupload.INIT_ERROR:errTip="网站配置错误。请联系网站管理员。",uploader.destroy();break;default:if(errTip=err.message+err.details,!unknow_error_retry(file))return}_Error_Handler&&_Error_Handler(up,err,errTip)}up.refresh()}}(_Error_Handler)),logger.debug("bind Error event"),uploader.bind("FileUploaded",function(_FileUploaded_Handler){return function(up,file,info){logger.debug("FileUploaded event activated"),logger.debug("file: ",file),logger.debug("info: ",info);var last_step=function(up,file,info){if(op.downtoken_url){var ajax_downtoken=that.createAjax();ajax_downtoken.open("POST",op.downtoken_url,!0),ajax_downtoken.setRequestHeader("Content-type","application/x-www-form-urlencoded"),ajax_downtoken.onreadystatechange=function(){if(4===ajax_downtoken.readyState)if(200===ajax_downtoken.status){var res_downtoken;try{res_downtoken=that.parseJSON(ajax_downtoken.responseText)}catch(e){throw"invalid json format"}var info_extended={};plupload.extend(info_extended,that.parseJSON(info),res_downtoken),_FileUploaded_Handler&&_FileUploaded_Handler(up,file,that.stringifyJSON(info_extended))}else uploader.trigger("Error",{status:ajax_downtoken.status,response:ajax_downtoken.responseText,file:file,code:plupload.HTTP_ERROR})},ajax_downtoken.send("key="+that.parseJSON(info).key+"&domain="+op.domain)}else _FileUploaded_Handler&&_FileUploaded_Handler(up,file,info)},res=that.parseJSON(info.response);if(ctx=ctx?ctx:res.ctx,logger.debug("ctx: ",ctx),ctx){var key="";logger.debug("save_key: ",op.save_key),op.save_key||(key="/key/"+that.URLSafeBase64Encode(that.path));var fname="/fname/"+that.URLSafeBase64Encode(file.name);logger.debug("op.x_vars: ",op.x_vars);var x_vars=op.x_vars,x_val="",x_vars_url="";if(void 0!==x_vars&&"object"===("undefined"==typeof x_vars?"undefined":_typeof(x_vars)))for(var x_key in x_vars)x_vars.hasOwnProperty(x_key)&&("function"==typeof x_vars[x_key]?x_val=that.URLSafeBase64Encode(x_vars[x_key](up,file)):"object"!==_typeof(x_vars[x_key])&&(x_val=that.URLSafeBase64Encode(x_vars[x_key])),x_vars_url+="/x:"+x_key+"/"+x_val);var ajax,url=qiniuUploadUrl+"/mkfile/"+file.size+key+fname+x_vars_url,ie=that.detectIEVersion();ie&&9>=ie?(ajax=new mOxie.XMLHttpRequest,mOxie.Env.swf_url=op.flash_swf_url):ajax=that.createAjax(),ajax.open("POST",url,!0),ajax.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),ajax.setRequestHeader("Authorization","UpToken "+that.token);var onreadystatechange=function(){if(logger.debug("ajax.readyState: ",ajax.readyState),4===ajax.readyState){localStorage.removeItem(file.name);var info;200===ajax.status?(info=ajax.responseText,logger.debug("mkfile is success: ",info),last_step(up,file,info)):(info={status:ajax.status,response:ajax.responseText,file:file,code:-200},logger.debug("mkfile is error: ",info),uploader.trigger("Error",info))}};ie&&9>=ie?ajax.bind("readystatechange",onreadystatechange):ajax.onreadystatechange=onreadystatechange,ajax.send(ctx),logger.debug("mkfile: ",url)}else last_step(up,file,info.response)}}(_FileUploaded_Handler)),logger.debug("bind FileUploaded event"),uploader.init(),logger.debug("invoke uploader.init()"),logger.debug("init uploader end"),uploader},this.getUrl=function(key){if(!key)return!1;key=encodeURI(key);var domain=this.domain;return"/"!==domain.slice(domain.length-1)&&(domain+="/"),domain+key},this.imageView2=function(op,key){var mode=op.mode||"",w=op.w||"",h=op.h||"",q=op.q||"",format=op.format||"";if(!mode)return!1;if(!w&&!h)return!1;var imageUrl="imageView2/"+mode;return imageUrl+=w?"/w/"+w:"",imageUrl+=h?"/h/"+h:"",imageUrl+=q?"/q/"+q:"",imageUrl+=format?"/format/"+format:"",key&&(imageUrl=this.getUrl(key)+"?"+imageUrl),imageUrl},this.imageMogr2=function(op,key){var auto_orient=op["auto-orient"]||"",thumbnail=op.thumbnail||"",strip=op.strip||"",gravity=op.gravity||"",crop=op.crop||"",quality=op.quality||"",rotate=op.rotate||"",format=op.format||"",blur=op.blur||"",imageUrl="imageMogr2";return imageUrl+=auto_orient?"/auto-orient":"",imageUrl+=thumbnail?"/thumbnail/"+thumbnail:"",imageUrl+=strip?"/strip":"",imageUrl+=gravity?"/gravity/"+gravity:"",imageUrl+=quality?"/quality/"+quality:"",imageUrl+=crop?"/crop/"+crop:"",imageUrl+=rotate?"/rotate/"+rotate:"",imageUrl+=format?"/format/"+format:"",imageUrl+=blur?"/blur/"+blur:"",key&&(imageUrl=this.getUrl(key)+"?"+imageUrl),imageUrl},this.watermark=function(op,key){var mode=op.mode;if(!mode)return!1;var imageUrl="watermark/"+mode;if(1===mode){var image=op.image||"";if(!image)return!1;imageUrl+=image?"/image/"+this.URLSafeBase64Encode(image):""}else{if(2!==mode)return!1;var text=op.text?op.text:"",font=op.font?op.font:"",fontsize=op.fontsize?op.fontsize:"",fill=op.fill?op.fill:"";if(!text)return!1;imageUrl+=text?"/text/"+this.URLSafeBase64Encode(text):"",imageUrl+=font?"/font/"+this.URLSafeBase64Encode(font):"",imageUrl+=fontsize?"/fontsize/"+fontsize:"",imageUrl+=fill?"/fill/"+this.URLSafeBase64Encode(fill):""}var dissolve=op.dissolve||"",gravity=op.gravity||"",dx=op.dx||"",dy=op.dy||"";return imageUrl+=dissolve?"/dissolve/"+dissolve:"",imageUrl+=gravity?"/gravity/"+gravity:"",imageUrl+=dx?"/dx/"+dx:"",imageUrl+=dy?"/dy/"+dy:"",key&&(imageUrl=this.getUrl(key)+"?"+imageUrl),imageUrl},this.imageInfo=function(key){if(!key)return!1;var info,url=this.getUrl(key)+"?imageInfo",xhr=this.createAjax(),that=this;return xhr.open("GET",url,!1),xhr.onreadystatechange=function(){4===xhr.readyState&&200===xhr.status&&(info=that.parseJSON(xhr.responseText))},xhr.send(),info},this.exif=function(key){if(!key)return!1;var info,url=this.getUrl(key)+"?exif",xhr=this.createAjax(),that=this;return xhr.open("GET",url,!1),xhr.onreadystatechange=function(){4===xhr.readyState&&200===xhr.status&&(info=that.parseJSON(xhr.responseText))},xhr.send(),info},this.get=function(type,key){return key&&type?"exif"===type?this.exif(key):"imageInfo"===type?this.imageInfo(key):!1:!1},this.pipeline=function(arr,key){var option,errOp,isArray="[object Array]"===Object.prototype.toString.call(arr),imageUrl="";if(isArray){for(var i=0,len=arr.length;len>i;i++){if(option=arr[i],!option.fop)return!1;switch(option.fop){case"watermark":imageUrl+=this.watermark(option)+"|";break;case"imageView2":imageUrl+=this.imageView2(option)+"|";break;case"imageMogr2":imageUrl+=this.imageMogr2(option)+"|";break;default:errOp=!0}if(errOp)return!1}if(key){imageUrl=this.getUrl(key)+"?"+imageUrl;var length=imageUrl.length;"|"===imageUrl.slice(length-1)&&(imageUrl=imageUrl.slice(0,length-1))}return imageUrl;
}return!1}}window.localStorage||(window.localStorage={setItem:function(key,value){createCookie(key,value,30)},getItem:function(key){return readCookie(key)},removeItem:function(key){createCookie(key,"",-1)}});var Qiniu=new QiniuJsSDK;global.Qiniu=Qiniu,global.QiniuJsSDK=QiniuJsSDK}(window)}).call(window)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_dtTools=__webpack_require__(22),_dtTools2=_interopRequireDefault(_dtTools),articlePublisedCtrl=function(){function articlePublisedCtrl(articlePublisedService,$scope,$routeParams){var _this=this;_classCallCheck(this,articlePublisedCtrl),this.limit=15,this.articlePublisedService=articlePublisedService,this.$routeParams=$routeParams;var _pars=this.init();this.getArticles(_pars),this.hostName=window.location.hostname,$scope.$on("$routeUpdate",function(event,route){var _par=_this.init();_this.getArticles(_par)})}return _createClass(articlePublisedCtrl,[{key:"init",value:function(){var _start=this.$routeParams.page&&this.$routeParams.page>0?(this.$routeParams.page-1)*this.limit:0,_pars={start:_start,limit:this.limit};return _pars}},{key:"getArticles",value:function(_pars){var _this2=this;this.articlePublisedService.getArticleList(_pars).then(function(jsn){_angular2["default"].forEach(jsn.data.object_list,function(_va){_va.cover&&(_va.cover.photo_path=_dtTools2["default"].dtImageTrans(_va.cover.photo_path,!0,144,144,"c"))}),_this2.dataList=jsn.data,_this2.page={url:"#/published/",start:_pars.start,total:jsn.data.total,hasNext:jsn.data.more,limit:_pars.limit}})}}]),articlePublisedCtrl}();articlePublisedCtrl.$inject=["articlePublisedService","$scope","$routeParams"],exports["default"]=articlePublisedCtrl},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_angular=__webpack_require__(1),articleDraftCtrl=(_interopRequireDefault(_angular),function(){function articleDraftCtrl(ArticleDraftService,$scope,$routeParams,ngDialog){var _this=this;_classCallCheck(this,articleDraftCtrl),this.ArticleDraftService=ArticleDraftService,this.$scope=$scope,this.ngDialog=ngDialog,this.$routeParams=$routeParams,this.draftType=!0,this.limit=15;var _pars=this.init();this.getArticleDrafts(_pars),$scope.$on("$routeUpdate",function(event,route){var _par=_this.init(_this.$routeParams);_this.getArticleDrafts(_par)}),this.showTips="hide"!=localStorage.getItem("showBannerTip"),localStorage.removeItem("firstEndClose"),localStorage.removeItem("second_time")}return _createClass(articleDraftCtrl,[{key:"init",value:function(){var _start=this.$routeParams.page&&this.$routeParams.page>0?(this.$routeParams.page-1)*this.limit:0,_pars={start:_start,limit:this.limit};return _pars}},{key:"closeTips",value:function(e){e.preventDefault(),e.stopPropagation(),this.showTips=!1,localStorage.setItem("showBannerTip","hide")}},{key:"getArticleDrafts",value:function(_pars){var _this2=this;this.ArticleDraftService.getArticleList(_pars).then(function(jsn){_this2.dataList=jsn.data,_this2.total=jsn.data.total,_this2.page={url:"#/",start:_pars.start,hasNext:jsn.data.more,limit:_pars.limit,total:jsn.data.total}})}},{key:"deleteDraft",value:function(_obj){var _this3=this,_pars={id:_obj.id},dialogId=this.ngDialog.open({template:"DraftTmpl",closeByDocument:!0,showClose:!1,closeByEscape:!0,controller:["$scope",function($scope){$scope.close=function(){_this3.ngDialog.close(dialogId)},$scope.confirm=function(){_this3.ArticleDraftService.draftDelete(_pars).then(function(res){var _pars=_this3.init();_this3.getArticleDrafts(_pars),_this3.ngDialog.close(dialogId)})}}]})}}]),articleDraftCtrl}());articleDraftCtrl.$inject=["ArticleDraftService","$scope","$routeParams","ngDialog"],exports["default"]=articleDraftCtrl},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_jquery=__webpack_require__(3),_jquery2=_interopRequireDefault(_jquery),_dtTools=__webpack_require__(22),_dtTools2=_interopRequireDefault(_dtTools),_angular=__webpack_require__(1),_angular2=_interopRequireDefault(_angular),_qrcode=__webpack_require__(49),_qrcode2=_interopRequireDefault(_qrcode);__webpack_require__(50),__webpack_require__(53),__webpack_require__(54),__webpack_require__(55),__webpack_require__(56),__webpack_require__(57),__webpack_require__(58),__webpack_require__(59),__webpack_require__(60);var articleCreate=function(){function articleCreate(VideoLibraryService,ArticleService,$timeout,$interval,$scope,$sce,ngDialog,$routeParams,$location,$window){var _this=this;_classCallCheck(this,articleCreate),this.VideoLibraryService=VideoLibraryService,this.ArticleService=ArticleService,this.$timeout=$timeout,this.$interval=$interval,this.$scope=$scope,this.$sce=$sce,this.ngDialog=ngDialog,this.$routeParams=$routeParams,this.$location=$location,this.$window=$window,$window.qrcode=_qrcode2["default"],this.cardEnable=!1,this.userInfo={id:USER.ID,username:USER.username,avatar:_dtTools2["default"].dtImageTrans(USER.smallAvatar,!0,100,100,"c")},this.tmpl="article.html",this.getCardInfo(),this.htmlData={},this.cover={},this.cardEnable=!0,this.baseToolBars=["fontsizeselect | bold italic underline strikethrough | bullist | alignleft aligncenter alignright | forecolor | hr link | img music vote card"],this.init(),this.Competence(),this.tinymceOptions={plugins:"link textcolor autoresize hr paste noneditable",langage:"zh_CN",inline:!0,skin_url:_angular2["default"].element("#pgcSkin").data("css"),toolbar:this.baseToolBars,fontsize_formats:"12px 15px 17px 20px",textcolor_cols:"4",textcolor_map:["ef5454","duitang1","ff7d7d","duitang2","fa974f","duitang3","6fcf95","duitang4","65cae5","duitang5","999999","duitang6","3a3a3a","duitang7","d1ca57","duitang8"],indentation:"20px",autofocus:!0,fixed_toolbar_container:"#mce-tools",statusbar:!1,resize:!1,menubar:!1,paste_text_sticky:!0,relative_urls:!1,remove_script_host:!1,paste_as_text:!0,paste_preprocess:function(plugin,args){var _reg=/(http:\/\/|https:\/\/)((\w|=|\?|\.|\/|&|-)+)/g;args.content=args.content.replace(_reg,'<a href="$1$2">$1$2</a>')},setup:function(e){return _this.editorSetUp(e)},init_instance_callback:function(editor){editor.focus(),editor.execCommand("FontSize",!1,"15px")}};var preventReload=function(e){return e.returnValue="确认文章已保存？"};window.addEventListener("beforeunload",preventReload,!1),$scope.$on("$routeChangeStart",function(event,next,current){if(window.removeEventListener("beforeunload",preventReload,!1),_this.topicId||_this.Redirect)_this.Redirect||!function(){event.preventDefault();var stopID=_this.ngDialog.open({template:"stopTempl",showClose:!1,closeByDocument:!0,closeByEscape:!0,controller:["$scope",function($scope){$scope.close=function(){_this.ngDialog.close(stopID)},$scope.confirm=function(){_this.ngDialog.close(stopID),_this.Redirect=!0,_this.$location.url(next.$$route.originalPath)}}]})}();else{var ispass=_this.publishCheck(!1);ispass?(event.preventDefault(),_this.saveDarft(function(_res){_this.drafId=_res.id,_this.Redirect=!0,_this.$location.url(next.$$route.originalPath),_this.$interval.cancel(_this.saveAuto)})):(_this.Redirect=!0,_this.$location.url(next.$$route.originalPath),_this.$interval.cancel(_this.saveAuto))}}),$scope.$watch("article.htmlData.articleModel",function(newValue,oldValue,scope){_this.Editor&&newValue&&_this.Editor.dom.$(".img-padding").each(function(_key,ele){_angular2["default"].element(ele).attr("data-count",_key+1+"/50")})})}return _createClass(articleCreate,[{key:"editorSetUp",value:function(ed){var _this2=this;this.Editor=ed,ed.on("init",function(evt){ed.dom.add("img","drop",function(e){return ed.dom.Event.cancel(e)})}),ed.on("keydown",function(e){var nodeNow=(ed.selection.getSel(),ed.selection.getNode()),pnode=nodeNow.previousSibling;if(8===e.which){if(pnode&&"figure"===pnode.nodeName.toLocaleLowerCase()&&0===nodeNow.innerText.trim().length&&"after"!==_angular2["default"].element(nodeNow).data("mce-caret"))return _this2.createNewRng(pnode),nodeNow.remove(),!1;if("span"===nodeNow.nodeName.toLocaleLowerCase()&&""!==nodeNow.className&&0===nodeNow.innerText.trim().length)return!1}}),ed.addButton("img",{title:"插入图片",icon:"icon_image",onclick:function(){_angular2["default"].element("#dtInsert").click()}}),ed.addButton("vote",{title:"投票",icon:"icon_vote",onclick:function(){_this2.voteHandle()}}),ed.addButton("card",{title:"名片",icon:"icon_card",onclick:function(){_this2.cardEnable=!0}}),ed.addButton("music",{title:"插入音乐",icon:"icon_music",onclick:function(){_this2.insertAudio()}}),PGC.Video&&ed.addButton("video",{title:"插入视频",icon:"icon_video",onclick:function(){_this2.insertVideo()}}),PGC.ArticleImport&&ed.addButton("import",{title:"文章导入",icon:"icon_import",onclick:function(){_this2.importArticle()}}),PGC.ArticleDarenCard&&ed.addButton("vcard",{title:"达人名片",icon:"icon_vcard",onclick:function(){_this2.insertCardV()}})}},{key:"init",value:function(){var _this3=this,VideoLibraryService=this.VideoLibraryService,ArticleService=this.ArticleService,$routeParams=this.$routeParams,$timeout=this.$timeout,$interval=this.$interval,that=this;if($routeParams.id&&$routeParams.type){var _pars2={};"0"===$routeParams.type?(_pars2.id=$routeParams.id,this.topicId=$routeParams.id):_pars2.id=$routeParams.id,ArticleService.getArticleContent($routeParams.type,_pars2).then(function(_res){if("0"===$routeParams.type){_this3.htmlData.title=_res.data.title,_this3.cover=_res.data.cover,_this3.cover.photo_path=_dtTools2["default"].dtImageTrans(_res.data.cover.photo_path,!0,700,389,"c"),_this3.createTime=1e3*_res.data.add_datetime_ts,_this3.isOriginal=_res.data.is_original||!1;var $body=_angular2["default"].element(_res.data.article_content);_res.data.club&&(""===_res.data.club.id?_this3.selectClub="not_in_any_club":_this3.selectClub=_res.data.club.id),_res.data.article_type&&(_this3.selectType=_res.data.article_type),_res.data.article_type&&(_this3.selectType=_res.data.article_type);var $cardDesc=$body.find(".card-user p");($cardDesc.length>0||/data-carte="true"/.test(_res.data.article_content))&&(_this3.cardEnable=!0);var $content=_angular2["default"].element(_res.data.article_content).find(".blog-content");$content.find(".imagecaption").each(function(i,_ele){var $ele=_angular2["default"].element(_ele);if(0===$ele.text().trim().length){var distext=$ele.data("txt")||"图片描述";$ele.text(distext)}});var _htmlStr=$content.html();_htmlStr=_htmlStr.replace(/(data-img=[\'\"]?([^\'\"]*)[\'\"]?)|(data-src=[\'\"]?([^\'\"]*)[\'\"]?)/gi,function(_src){return _src.replace(/data-src/gi,"data-img")+" "+_src.replace(/(data-img)|(data-src)/gi,"src")}),_htmlStr=_htmlStr.replace(/<video/gi,"/<video controls"),_this3.htmlData.articleModel=_htmlStr}else _this3.htmlData.articleModel=_res.data.article_content,_this3.drafId=_res.data.id,_this3.htmlData.title=_res.data.title,_res.data.ext_info&&(_res.data.ext_info=_angular2["default"].fromJson(_res.data.ext_info),_this3.cover=_res.data.ext_info.cover,_this3.cover.photo_path&&(_this3.cover.photo_path=_dtTools2["default"].dtImageTrans(_res.data.ext_info.cover.photo_path,!0,700,389,"c")),_this3.cardEnable=_res.data.ext_info.has_usercard,_this3.selectClub=_res.data.ext_info.club_id,_this3.selectType=_res.data.ext_info.tag)})}else this.htmlData.articleModel="",this.htmlData.title="";var _pars={start:0,limit:100,scene:"AVAILABLE"};VideoLibraryService.videoList(_pars).then(function(res){_this3.videoList=res.data.object_list,_angular2["default"].forEach(res.data.object_list,function(val){val.cover.photo=_dtTools2["default"].dtImageTrans(val.cover.photo_path,!0,600,450,"c"),val.cover.bgSrc=_dtTools2["default"].dtImageTrans(val.cover.photo_path,!0,200,150,"c")})}),_angular2["default"].element("body").on("click",function(e){var _con=_angular2["default"].element(".a-btn.save");_con.is(e.target)||0!==_con.has(e.target).length||(_this3.publishPreparation=!1,_this3.showClub=!1,_this3.showType=!1,_this3.$scope.$apply());var _conCode=_angular2["default"].element(".qcode-p");_conCode.is(e.target)||0!==_conCode.has(e.target).length||(_this3.previewEnabled=!1,_this3.$scope.$apply());var _selectBox=_angular2["default"].element(".select-box");_selectBox.is(e.target)||0!==_selectBox.has(e.target).length||(_this3.showClub=!1,_this3.showType=!1,_this3.$scope.$apply())}),_angular2["default"].element("body").on("click",".music-btn",function(e){e.preventDefault(),e.stopPropagation();var $this=_angular2["default"].element(this),_audioEle=$this.closest(".music-box").find("audio").get(0),audioList=_angular2["default"].element(".art-editor .music-box").find("audio");if($this.hasClass("stop"))_audioEle.pause(),$this.removeClass("stop");else{var _pars3={id:$this.data("id")};_angular2["default"].forEach(audioList,function(_auEle){_auEle.pause(),_angular2["default"].element(_auEle).closest(".music-box").find(".music-btn").removeClass("stop")}),$this.addClass("stop"),ArticleService.getMusicDetail(_pars3).then(function(res){_audioEle.src=res.data.source_link,_audioEle.load(),_audioEle.play()})}}),_angular2["default"].element(".upload input").on("click",function(e){var imglength=_angular2["default"].element(".art-inner").find(".img-box").length;imglength>=50&&(e.preventDefault(),_this3.messageTip(!0,"抱歉，文章内最多插入50张图片"))}),_angular2["default"].element("body").on("click",".imagecaption",function(e){e.preventDefault(),e.stopPropagation();var $this=_angular2["default"].element(e.target).attr("contenteditable",!0);$this.text()===$this.data("txt")&&$this.text("");var ele=_this3.Editor.dom.$(e.target);ele[0].focus()}),_angular2["default"].element("body").on("click",".img-box,.video-fig,.music-box,.video-iframe",function(e){that.createNewRng(this)}),_angular2["default"].element("body").on("click",".vote-box",function(e){e.preventDefault(),e.stopPropagation(),that.voteHandle(this),that.createNewRng(this)});var $toolsBar=_angular2["default"].element(".tool-bar"),$boxEle=_angular2["default"].element(".art-inner");document.onscroll=function(){var _sch=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,_toolsHeight=$boxEle.offset().top;_sch+60>_toolsHeight?$boxEle.addClass("fixed").css({"padding-top":$toolsBar.height()+"px"}):$boxEle.removeClass("fixed").removeAttr("style")},this.topicId||$timeout(function(){_this3.saveAuto=$interval(function(){var ispass=_this3.publishCheck(!1);ispass&&(_this3.draftSaving=!0,_this3.saveDarft(function(_res){_this3.drafId=_res.id}))},3e4)},1e3),this.clubList={not_in_any_club:"无","559ecf4a05434b0aee67bbb7":"星座吐槽大会","54aa79e1a3101a0f75731c7a":"铲屎工的日常","54dc1f67a310e8d4fad4cff5":"多肉植物园","54aa79f2a3101a0f75731c9b":"零食交流协会","54aa79f5a3101a0f75731ca1":"美好三餐记录者","54aa79eca3101a0f75731c89":"烘焙小分队","54bcb931a310829b892b1a9e":"安利专用小黑屋","54bdfef617c2ad47983a3569":"练字学书法","54b790c417c2cc03d7c43ba0":"粘土集中营","54b790b7a310426620c14c8c":"手帐狂魔","54b790ac17c2cc03d7c43b7e":"水彩国的居民","54b790b217c2cc03d7c43b91":"随手拍生活","54f6b416a310347c198768f2":"我们爱旅行","551283d6a310afa528d43ba7":"品质家居生活指南","54aa79d9a3101a0f75731c62":"P站二次元搬运团","54b790c817c2cc03d7c43ba6":"看电影","54b790c217c2cc03d7c43b9a":"应用推荐"},this.typeList={"兴趣":"兴趣（插画、手作、漫画）","住家":"住家（园艺、萌宠、家居、情感）","旅行":"旅行","美经":"美经（美妆护肤、穿搭心得）","文娱":"文娱（电影、音乐、书籍）","摄影":"摄影","美食":"美食","其他":"其他"}}},{key:"Competence",value:function(){var _extraToobar=[];this.hasVideo=!!PGC.Video,PGC.Video&&_extraToobar.push("video"),this.hasImport=!!PGC.ArticleImport,PGC.ArticleImport&&_extraToobar.push("import"),this.hasDarenCard=!!PGC.ArticleDarenCard,PGC.ArticleDarenCard&&_extraToobar.push("vcard"),this.baseToolBars.push(_extraToobar.join(" ")),this.hasClub=!!PGC.Club}},{key:"clubSelect",value:function(_key){var _this4=this;this.selectClub=_key,this.$timeout(function(){_this4.showClub=!1})}},{key:"typeSelect",value:function(_key){var _this5=this;this.selectType=_key,this.$timeout(function(){_this5.showType=!1})}},{key:"selectShow",value:function(_t){this.showClub=!1,this.showType=!1,"club"===_t?this.showClub=!0:this.showType=!0}},{key:"publishCheck",value:function(_tips){var htmlData=this.htmlData;if(!htmlData.title)return _tips?this.messageTip(!0,"标题不能为空!"):null,!1;if(htmlData.title.length>30)return _tips?this.messageTip(!0,"标题长度不能超过30个字!"):null,!1;if(this.Editor.getContent().length<1)return _tips?this.messageTip(!0,"内容不能为空!"):null,!1;if(!this.isPreview&&this.cardEnable&&this.cardDesc&&this.cardDesc.length<1)return _tips?this.messageTip(!0,"名片介绍不能为空!"):null,!1;var uploadEle=_angular2["default"].element(".art-inner").find(".paddingtop");if(uploadEle.length>0)return _tips?this.messageTip(!0,"图片正在上传中,请稍后.."):null,!1;var uploadsAudio=_angular2["default"].element(".art-inner").find(".music-box.loading");return uploadsAudio.length>0?(_tips?this.messageTip(!0,"音乐解析中,请稍后.."):null,!1):!0}},{key:"baseInfoHandle",value:function(fn){var htmlData=this.htmlData,$sce=this.$sce,Editor=this.Editor,$timeout=this.$timeout;if(this.publishCheck(!0)){htmlData.articleContent=Editor.getContent().replace(/<script/gi,"&lt;script").replace("</script>","&lt;script&gt;").replace(/contenteditable=\"true\"/gi,'contenteditable="false"').replace(/"music-btn stop"/gi,"music-btn").replace(/<img.*?(?:>|\/>)/gi,function(src){return src.replace(/src=[\'\"]?([^\'\"]*)[\'\"]?/gi,"")}).replace(/(\>视频描述|\>图片描述)/gi,">").replace(/<video/gi,'<video webkit-playsinline="true" playsinline="true" ').replace(/controls="controls"/gi,"").replace(/<p><\/p>/gi,""),htmlData.domain=window.location.protocol+"//"+window.location.hostname,htmlData.updateTime=this.createTime||(new Date).getTime(),htmlData.escapeTitle=htmlData.title.replace(/<script/gi,"&lt;script").replace("</script>","&lt;script&gt;"),htmlData.articleContent=$sce.trustAsHtml(htmlData.articleContent);var _content=Editor.getContent().replace(/<figure[^>]*[^>]*>[\w\W]*?<\/figure>/gi,"").replace(/(\n|\t)/gi,"").replace(/<\/?[^>]*>/g,"").replace(/&nbsp;/gi,"");_content.length>100&&(_content=_content.substring(0,100)+"..."),$timeout(function(){fn({title:htmlData.title,content:_content,article_body:_angular2["default"].element("#articleContent").html(),app_tpl:"/lifeArtist/tmpls/article_app_v2",pc_tpl:"/lifeArtist/tmpls/article_pc_v1",template:"static_pgc"})})}}},{key:"messageTip",value:function(_eor,_mes){var _this6=this;this.showMes=!0,this.hasError=_eor,this.Message=_mes,this.$timeout(function(){_this6.showMes=!1},1200),_eor&&(this.submiting=!1)}},{key:"getCardInfo",value:function(){var _this7=this,_pas={user_id:USER.ID};this.ArticleService.getCard(_pas).then(function(res){_this7.cardDesc=res.data?res.data.content:""})}},{key:"saveCareInfo",value:function(){var ArticleService=this.ArticleService,cardDesc=this.cardDesc,_pars={content:cardDesc};ArticleService.createCard(_pars)}},{key:"saveDarft",value:function(_fn){var _this8=this;this.baseInfoHandle(function(res){_this8.drafId&&(res.id=_this8.drafId),res.article_content=tinyMCE.activeEditor.getContent({format:"raw"});var _cover=_angular2["default"].extend({},_this8.cover);_cover.uploading&&(delete _cover.uploading,delete _cover.process),res.ext_info=_angular2["default"].toJson({cover:_cover,has_usercard:_this8.cardEnable,club_id:_this8.selectClub?_this8.selectClub:"not_in_any_club",tag:_this8.selectType}),_this8.ArticleService.saveToDraft(res).then(function(_jsn){_this8.draftSaving=!1,"function"==typeof _fn?_fn(_jsn.data):1===_jsn.status?(_this8.drafId=_jsn.data.id,_this8.messageTip(!1,"保存成功！")):_this8.messageTip(!0,_jsn.data.message)})["finally"](function(){_this8.$timeout(function(){_this8.draftSaving=void 0},3e3)})})}},{key:"insertCardV",value:function(){var _this9=this,darenBox=this.ngDialog.open({template:"darenTmpl",closeByDocument:!0,showClose:!1,overlay:!1,closeByEscape:!0,scope:this.$scope,controller:["$scope",function($scope){$scope.close=function(){_this9.ngDialog.close(darenBox)},$scope.confirm=function(){var id=(new Date).getTime();_this9.ArticleService.getUserDetail({user_id:$scope.darenId}).then(function(res){var _reg=/_certify$/gi,dinfo="";if(_angular2["default"].forEach(res.data.identity,function(_val){return _reg.test(_val)?void(dinfo=res.data.identity_info):void 0}),""===dinfo)return _this9.ngDialog.close(darenBox),void _this9.messageTip(!0,"该用户不是认证达人!");var cardStr='<figure class="v-card" contenteditable="false" id="vcard'+id+'"><div class="v-card-img"><a href="http://www.duitang.com/people/?user_id='+res.data.id+'"><img data-img="'+_dtTools2["default"].dtImageTrans(res.data.avatar,!0,130,130,"c")+'" src="'+_dtTools2["default"].dtImageTrans(res.data.avatar,!0,130,130,"c")+'"/></a><figcaption class="v-card-info"><a class="link" href="http://www.duitang.com/people/?user_id='+res.data.id+'">'+res.data.username+"</a><p>"+dinfo+"</p></figcaption></figure>";_this9.Editor.insertContent(cardStr);var $cardEle=_this9.Editor.dom.$("#vcard"+id);_this9.createNewRng($cardEle[0]),_this9.ngDialog.close(darenBox)})}}]})}},{key:"voteHandle",value:function(_ele){var _this10=this,voteEles=_angular2["default"].element(".art-inner").find(".vote-box"),_voteId=void 0;if(_ele){if(this.topicId)return;_voteId=_angular2["default"].element(_ele).data("vid"),this.ArticleService.getVoteDetail({id:_voteId}).then(function(jsn){_this10.popoutVoteBox(jsn.data,_ele)})}else{if(voteEles.length>=10)return this.messageTip(!0,"抱歉，文章内最多插入10个投票"),!1;this.popoutVoteBox()}}},{key:"popoutVoteBox",value:function(_config,_ele){var _this11=this,voteBox=this.ngDialog.open({template:"voteTmpl",closeByDocument:!0,showClose:!1,overlay:!1,closeByEscape:!0,scope:this.$scope,controller:["$scope",function($scope){$scope.editing=!!_config,$scope.name=_config?_config.name:"",$scope.type=_config?_config.type:"single",$scope.options=_config?_config.options:[{content:""},{content:""}],$scope.options.length>2&&$scope.options.forEach(function(_opt,i){i>1&&(_opt["new"]=!0)}),$scope.addEnabled=!($scope.options.length-1>=19),$scope.addNewChoice=function(){$scope.options.push({content:"","new":!0}),$scope.addEnabled=!($scope.options.length-1>=19)},$scope.close=function(){_this11.ngDialog.close(voteBox)},$scope.remove=function(i){$scope.options.splice(i,1),$scope.addEnabled=!($scope.options.length-1>=19)},$scope.confirm=function(){$scope.type="single"===$scope.type?"single":"multi";var cate="single"===$scope.type?"单选":"多选",_pars={name:$scope.name,type:$scope.type,options:_angular2["default"].toJson($scope.options)};$scope.editing&&(_pars.id=_config.id),_this11.ArticleService.votingOperation(_pars,$scope.editing).then(function(jsn){if(1===jsn.status){_pars.options=jsn.data.options;var _voteOptionStr=_pars.options.map(function(_opt,i){return'<div class="choice" data-optid="'+_opt.id+'"><label>'+_opt.content+"</label></div>"}).join(""),id=(new Date).getTime(),voteStr='<figure class="vote-box '+$scope.type+'" id="vote'+id+'" contenteditable="false" data-type="'+$scope.type+'" data-vid="'+jsn.data.id+'"><h3>'+cate+"&nbsp;|&nbsp;"+$scope.name+'</h3><div class="choice-list">'+_voteOptionStr+'</div><a class="vote-btn bg-red">投票</a></figure>';if(_ele)_this11.Editor.dom.$(_ele).replaceWith(voteStr);else{_this11.Editor.insertContent(voteStr);var $voteEle=_this11.Editor.dom.$("#vote"+id);_this11.createNewRng($voteEle[0])}}})["finally"](function(){_this11.ngDialog.close(voteBox)})}}]})}},{key:"createNewRng",value:function(ele){ele.focus();var range=this.Editor.dom.createRng();range.setStartAfter(ele),range.setEndAfter(ele),this.Editor.selection.getSel().removeAllRanges(),this.Editor.selection.setRng(range)}},{key:"insertVideo",value:function(){var _this12=this,videoBox=this.ngDialog.open({template:"videoTmpl",closeByDocument:!0,showClose:!1,overlay:!1,closeByEscape:!0,controller:["$scope",function($scope){$scope.videoList=_this12.videoList,$scope.close=function(){_this12.ngDialog.close(videoBox)},$scope.videoSelect=function(_vod){return"audit"===_vod.video_status?!1:(_angular2["default"].forEach($scope.videoList,function(_video){_video.selected=!1}),void(_vod.selected=!0))},$scope.confirm=function(){var _video="",id=(new Date).getTime();_angular2["default"].forEach($scope.videoList,function(_vid){_vid.selected&&(_video+='<figure class="video-fig" id="video'+id+'" contenteditable="false"><div class="video-box"><video preload="none" controls data-duration="'+_vid.duration+'" poster="'+_vid.cover.photo+'" data-id="'+_vid.id+'" src="'+_vid.path+'"></video></div><span class="imagecaption" contenteditable="true" data-txt="视频描述">视频描述</span></figure>',_vid.selected=!1)}),_video&&_this12.Editor.insertContent(_video);var $videoEle=_this12.Editor.dom.$("#video"+id);_this12.createNewRng($videoEle[0]),_this12.ngDialog.close(videoBox)},$scope.reload=function(){$scope.isloading=!0,_this12.$timeout(function(){$scope.isloading=!1},1e3);var _pars={start:0,limit:100,scene:"REFERENCABLE"};_this12.VideoLibraryService.videoList(_pars).then(function(res){_this12.videoList=res.data.object_list,_angular2["default"].forEach(res.data.object_list,function(val){val.cover.photo=_dtTools2["default"].dtImageTrans(val.cover.photo_path,!0,600,450,"c"),val.cover.bgSrc=_dtTools2["default"].dtImageTrans(val.cover.photo_path,!0,200,150,"c")}),$scope.videoList=_this12.videoList})}}]})}},{key:"insertAudio",value:function(){var _this13=this,length=_angular2["default"].element(".music-box").length;if(length>=10)return this.messageTip(!0,"抱歉，文章内最多插入10个音频"),!1;var audioBox=this.ngDialog.open({template:"audioTmpl",closeByDocument:!0,showClose:!1,overlay:!1,closeByEscape:!0,controller:["$scope",function($scope){$scope.close=function(){_this13.ngDialog.close(audioBox)},$scope.confirm=function(){var _id=(new Date).getTime();$scope.link&&!function(){var _audio='<figure class="music-box loading" id="audio'+_id+'" contenteditable="false" style="padding-top: 50px;">音乐解析中</figure>';_this13.Editor.insertContent(_audio),_this13.Editor.dom.$(_audio)[0].focus();var $ele=_this13.Editor.dom.$("#audio"+_id);_this13.createNewRng($ele[0]);var _pars={link:$scope.link};_this13.ngDialog.close(audioBox),_this13.ArticleService.getMusic(_pars).then(function(jsn){if($ele.removeClass("loading"),1===jsn.status){var _pars4=_angular2["default"].extend({},jsn.data);_pars4.name=_pars4.name.replace(/'/g,"’"),_pars4.artist_name=_pars4.artist_name.replace(/'/g,"’");var _musicHtml="<dl data-params='"+_angular2["default"].toJson(_pars4)+"'><dt><img data-img=\""+jsn.data.music_logo+'" src="'+jsn.data.music_logo+'"><a class="music-btn" data-id="'+jsn.data.id+'"><i class="icon icon_play_music">&nbsp;</i></a></dt><dd><h3>'+jsn.data.name+"</h3><p>"+jsn.data.artist_name+" - "+jsn.data.album_name+'</p></dd><audio id="music'+_id+'"></dl>';$ele.removeAttr("style").empty().append(_musicHtml)}else $ele.text("音乐解析失败").addClass("fail"),_this13.$timeout(function(){$ele.remove()},1200)})}()}}]})}},{key:"importArticle",value:function(){var _this14=this,importBox=this.ngDialog.open({template:"ImportTmpl",closeByDocument:!0,showClose:!1,overlay:!1,closeByEscape:!0,controller:["$scope",function($scope){function filterHtmlTag(str){var _importImages={},_id=(new Date).getTime(),_regTable=/(<table>|<\/table>|<td>|<\/td>|<tr>|<\/tr>|<tbody>|<\/tbody>)/gi,_imgReg=/<img[^>]+src="([^\"]*?)"[^>]*>/gi,_iframeReg=/<iframe[^>]+src="([^\"]*?)"[^>]*><\/iframe>/gi,_htmlStr=str.replace(_regTable,"").replace(_imgReg,function(_img){return _id++,_importImages[_id]=_img.replace(_imgReg,"$1"),'<figure id="'+_id+'" class="img-box" contenteditable="false"><div class="img-padding minheight paddingtop">图片上传中</div><span class="imagecaption" contenteditable="false" data-txt="图片描述">图片描述</span></figure>'}).replace(_iframeReg,function(_iframe){var _iframeSrc=_iframe.replace(_iframeReg,"$1");_iframeSrc=_iframeSrc.replace(/width=([0-9])*/gi,"width").replace(/height=([0-9])*/gi,"height").replace(/preview\.html/gi,"player.html");var _iframeStr='<iframe scrolling="no" frameborder="0" src='+_iframeSrc+"></iframe>";return'<figure class="video-iframe" contenteditable="false" ><div class="video-box">'+_iframeStr+'</div><span class="imagecaption" contenteditable="true" data-txt="视频描述">视频描述</span></figure>'});return{importImages:_importImages,htmlStr:_htmlStr}}$scope.tipSrc="http://img4.duitang.com/uploads/people/201605/10/20160510113515_4fNka.gif",$scope.tipTxt="链接解析中",$scope.close=function(){_this14.ngDialog.close(importBox)},$scope.confirm=function(){if($scope.url){var _pars={url:$scope.url};$scope.loading=!0,_this14.ArticleService.postArticleFromUrl(_pars).then(function(jsn){if(1==jsn.status){_this14.htmlData.title=jsn.data.title;var _filterObj=filterHtmlTag(jsn.data.content);_this14.htmlData.articleModel=_filterObj.htmlStr,_this14.uploadImgeFromUrl(_filterObj.importImages),_this14.ngDialog.close(importBox)}else $scope.tipSrc="http://img4q.duitang.com/uploads/people/201606/16/20160616144512_ykxu4.png",$scope.tipTxt=jsn.message})}}}]})}},{key:"uploadImgeFromUrl",value:function(_imgListObj){var _this15=this;_imgListObj&&_angular2["default"].forEach(_imgListObj,function(_val,_key){!function(id,url){var _fData=new FormData;_fData.append("url",url),_this15.ArticleService.uploadImgeFromUrl(_fData).then(function(jsn){var $ele=_angular2["default"].element("#"+id).find(".img-padding");if(1===jsn.status){var imgdata=jsn.data;imgdata.img_url=_dtTools2["default"].dtImageTrans(imgdata.img_url,!0,600);var rate=100*imgdata.photo_height/imgdata.photo_width,_domImg='<img data-img="'+imgdata.img_url+'" src="'+imgdata.img_url+'" data-width="'+imgdata.photo_width+'" data-height="'+imgdata.photo_height+'" data-imgid="'+imgdata.photo_id+'">';$ele.removeClass("minheight paddingtop").css({width:"100%","padding-bottom":rate.toFixed(2)+"%",height:0,"background-color":"rgb(240,240,240)"}).empty().append(_domImg)}else $ele.text("上传失败！"+jsn.message)})}(_key,_val)})}},{key:"preview",value:function(){var _this16=this,ArticleService=this.ArticleService;this.publishPreparation=!1,this.isPreview=!0,this.baseInfoHandle(function(_pars){_this16.previewId&&(_pars.url_id=_this16.previewId),
ArticleService.articlePreview(_pars).then(function(res){_this16.previewId=res.data.url_id,_this16.previewUrl="http://"+window.location.host+"/guide2/TARTICLE_DRAFT/"+res.data.url_id+"/",_this16.previewEnabled=!0,_this16.isPreview=!1})})}},{key:"checkInfo",value:function(){this.previewEnabled=!1,this.publishPreparation=!0}},{key:"publish",value:function(){var _this17=this;this.submiting=!0,this.isPreview=!1,this.baseInfoHandle(function(_pars){var _photoId=[],imgList=_angular2["default"].element("<div>"+_this17.Editor.getContent()+"</div>").find(".img-box img");_angular2["default"].forEach(imgList,function(_v){_photoId.push(_angular2["default"].element(_v).data("imgid"))});var _extData={club_id:_this17.selectClub?_this17.selectClub:"not_in_any_club",photos:_photoId.join(","),tag:_this17.selectType},video=_angular2["default"].element(_this17.Editor.getContent()).find("video");video.length>0&&(_extData.local_video_id=video.data("id"));var musiclist=_angular2["default"].element("<div>"+_this17.Editor.getContent()+"</div>").find(".music-box");musiclist.length>0&&(_extData.music_list=[],_angular2["default"].forEach(musiclist,function(_music){var _pas=(0,_jquery2["default"])(_music).find("dl").data("params");_extData.music_list.push(_pas)}),_extData.music_list=_angular2["default"].toJson(_extData.music_list));var voteList=_angular2["default"].element("<div>"+_this17.Editor.getContent()+"</div>").find(".vote-box");voteList.length>0&&(_extData.votes=[],_angular2["default"].forEach(voteList,function(_vote){var _vid=_angular2["default"].element(_vote).data("vid");_extData.votes.push(_vid)}),_extData.votes=_extData.votes.join(",")),_angular2["default"].extend(_extData,{cover_photo_id:_this17.cover.id}),_angular2["default"].extend(_extData,{is_original:_this17.isOriginal||!1}),_angular2["default"].extend(_pars,_extData),_this17.topicId?(_hmt.push(["_trackEvent","platform_article","platform_article_do_edit"]),_pars.topic_id=_this17.topicId,_this17.ArticleService.Update(_pars).then(function(res){1===res.status?(_hmt.push(["_trackEvent","platform_article","platform_article_edit_done"]),_this17.messageTip(!1,"更新成功！"),_this17.publishPreparation=!1,_this17.showClub=!1,_this17.showType=!1):(_this17.messageTip(!0,res.message),_this17.publishPreparation=!1,_this17.showClub=!1,_this17.showType=!1)})["finally"](function(){_this17.$interval.cancel(_this17.saveAuto),_this17.submiting=!1})):(_this17.drafId&&(_pars.draft_id=_this17.drafId),_hmt.push(["_trackEvent","platform_article","platform_article_do_post"]),_this17.ArticleService.Create(_pars).then(function(res){1===res.status?(_this17.Redirect=!0,_hmt.push(["_trackEvent","platform_article","platform_article_post_done"]),_this17.$location.url("/create/success/")):(_this17.messageTip(!0,res.message),_this17.publishPreparation=!1,_this17.showClub=!1,_this17.showType=!1)})["finally"](function(){_this17.$interval.cancel(_this17.saveAuto),_this17.submiting=!1}))})}}]),articleCreate}();articleCreate.$inject=["VideoLibraryService","ArticleService","$timeout","$interval","$scope","$sce","ngDialog","$routeParams","$location","$window"],exports["default"]=articleCreate},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj},function(){var qrcode=function(){function qrPolynomial(num,shift){if("undefined"==typeof num.length)throw new Error(num.length+"/"+shift);var _num=function(){for(var offset=0;offset<num.length&&0==num[offset];)offset+=1;for(var _num=new Array(num.length-offset+shift),i=0;i<num.length-offset;i+=1)_num[i]=num[i+offset];return _num}(),_this={};return _this.getAt=function(index){return _num[index]},_this.getLength=function(){return _num.length},_this.multiply=function(e){for(var num=new Array(_this.getLength()+e.getLength()-1),i=0;i<_this.getLength();i+=1)for(var j=0;j<e.getLength();j+=1)num[i+j]^=QRMath.gexp(QRMath.glog(_this.getAt(i))+QRMath.glog(e.getAt(j)));return qrPolynomial(num,0)},_this.mod=function(e){if(_this.getLength()-e.getLength()<0)return _this;for(var ratio=QRMath.glog(_this.getAt(0))-QRMath.glog(e.getAt(0)),num=new Array(_this.getLength()),i=0;i<_this.getLength();i+=1)num[i]=_this.getAt(i);for(var i=0;i<e.getLength();i+=1)num[i]^=QRMath.gexp(QRMath.glog(e.getAt(i))+ratio);return qrPolynomial(num,0).mod(e)},_this}var qrcode=function(typeNumber,errorCorrectLevel){var PAD0=236,PAD1=17,_typeNumber=typeNumber,_errorCorrectLevel=QRErrorCorrectLevel[errorCorrectLevel],_modules=null,_moduleCount=0,_dataCache=null,_dataList=new Array,_this={},makeImpl=function(test,maskPattern){_moduleCount=4*_typeNumber+17,_modules=function(moduleCount){for(var modules=new Array(moduleCount),row=0;moduleCount>row;row+=1){modules[row]=new Array(moduleCount);for(var col=0;moduleCount>col;col+=1)modules[row][col]=null}return modules}(_moduleCount),setupPositionProbePattern(0,0),setupPositionProbePattern(_moduleCount-7,0),setupPositionProbePattern(0,_moduleCount-7),setupPositionAdjustPattern(),setupTimingPattern(),setupTypeInfo(test,maskPattern),_typeNumber>=7&&setupTypeNumber(test),null==_dataCache&&(_dataCache=createData(_typeNumber,_errorCorrectLevel,_dataList)),mapData(_dataCache,maskPattern)},setupPositionProbePattern=function(row,col){for(var r=-1;7>=r;r+=1)if(!(-1>=row+r||row+r>=_moduleCount))for(var c=-1;7>=c;c+=1)-1>=col+c||col+c>=_moduleCount||(r>=0&&6>=r&&(0==c||6==c)||c>=0&&6>=c&&(0==r||6==r)||r>=2&&4>=r&&c>=2&&4>=c?_modules[row+r][col+c]=!0:_modules[row+r][col+c]=!1)},getBestMaskPattern=function(){for(var minLostPoint=0,pattern=0,i=0;8>i;i+=1){makeImpl(!0,i);var lostPoint=QRUtil.getLostPoint(_this);(0==i||minLostPoint>lostPoint)&&(minLostPoint=lostPoint,pattern=i)}return pattern},setupTimingPattern=function(){for(var r=8;_moduleCount-8>r;r+=1)null==_modules[r][6]&&(_modules[r][6]=r%2==0);for(var c=8;_moduleCount-8>c;c+=1)null==_modules[6][c]&&(_modules[6][c]=c%2==0)},setupPositionAdjustPattern=function(){for(var pos=QRUtil.getPatternPosition(_typeNumber),i=0;i<pos.length;i+=1)for(var j=0;j<pos.length;j+=1){var row=pos[i],col=pos[j];if(null==_modules[row][col])for(var r=-2;2>=r;r+=1)for(var c=-2;2>=c;c+=1)-2==r||2==r||-2==c||2==c||0==r&&0==c?_modules[row+r][col+c]=!0:_modules[row+r][col+c]=!1}},setupTypeNumber=function(test){for(var bits=QRUtil.getBCHTypeNumber(_typeNumber),i=0;18>i;i+=1){var mod=!test&&1==(bits>>i&1);_modules[Math.floor(i/3)][i%3+_moduleCount-8-3]=mod}for(var i=0;18>i;i+=1){var mod=!test&&1==(bits>>i&1);_modules[i%3+_moduleCount-8-3][Math.floor(i/3)]=mod}},setupTypeInfo=function(test,maskPattern){for(var data=_errorCorrectLevel<<3|maskPattern,bits=QRUtil.getBCHTypeInfo(data),i=0;15>i;i+=1){var mod=!test&&1==(bits>>i&1);6>i?_modules[i][8]=mod:8>i?_modules[i+1][8]=mod:_modules[_moduleCount-15+i][8]=mod}for(var i=0;15>i;i+=1){var mod=!test&&1==(bits>>i&1);8>i?_modules[8][_moduleCount-i-1]=mod:9>i?_modules[8][15-i-1+1]=mod:_modules[8][15-i-1]=mod}_modules[_moduleCount-8][8]=!test},mapData=function(data,maskPattern){for(var inc=-1,row=_moduleCount-1,bitIndex=7,byteIndex=0,maskFunc=QRUtil.getMaskFunction(maskPattern),col=_moduleCount-1;col>0;col-=2)for(6==col&&(col-=1);;){for(var c=0;2>c;c+=1)if(null==_modules[row][col-c]){var dark=!1;byteIndex<data.length&&(dark=1==(data[byteIndex]>>>bitIndex&1));var mask=maskFunc(row,col-c);mask&&(dark=!dark),_modules[row][col-c]=dark,bitIndex-=1,-1==bitIndex&&(byteIndex+=1,bitIndex=7)}if(row+=inc,0>row||row>=_moduleCount){row-=inc,inc=-inc;break}}},createBytes=function(buffer,rsBlocks){for(var offset=0,maxDcCount=0,maxEcCount=0,dcdata=new Array(rsBlocks.length),ecdata=new Array(rsBlocks.length),r=0;r<rsBlocks.length;r+=1){var dcCount=rsBlocks[r].dataCount,ecCount=rsBlocks[r].totalCount-dcCount;maxDcCount=Math.max(maxDcCount,dcCount),maxEcCount=Math.max(maxEcCount,ecCount),dcdata[r]=new Array(dcCount);for(var i=0;i<dcdata[r].length;i+=1)dcdata[r][i]=255&buffer.getBuffer()[i+offset];offset+=dcCount;var rsPoly=QRUtil.getErrorCorrectPolynomial(ecCount),rawPoly=qrPolynomial(dcdata[r],rsPoly.getLength()-1),modPoly=rawPoly.mod(rsPoly);ecdata[r]=new Array(rsPoly.getLength()-1);for(var i=0;i<ecdata[r].length;i+=1){var modIndex=i+modPoly.getLength()-ecdata[r].length;ecdata[r][i]=modIndex>=0?modPoly.getAt(modIndex):0}}for(var totalCodeCount=0,i=0;i<rsBlocks.length;i+=1)totalCodeCount+=rsBlocks[i].totalCount;for(var data=new Array(totalCodeCount),index=0,i=0;maxDcCount>i;i+=1)for(var r=0;r<rsBlocks.length;r+=1)i<dcdata[r].length&&(data[index]=dcdata[r][i],index+=1);for(var i=0;maxEcCount>i;i+=1)for(var r=0;r<rsBlocks.length;r+=1)i<ecdata[r].length&&(data[index]=ecdata[r][i],index+=1);return data},createData=function(typeNumber,errorCorrectLevel,dataList){for(var rsBlocks=QRRSBlock.getRSBlocks(typeNumber,errorCorrectLevel),buffer=qrBitBuffer(),i=0;i<dataList.length;i+=1){var data=dataList[i];buffer.put(data.getMode(),4),buffer.put(data.getLength(),QRUtil.getLengthInBits(data.getMode(),typeNumber)),data.write(buffer)}for(var totalDataCount=0,i=0;i<rsBlocks.length;i+=1)totalDataCount+=rsBlocks[i].dataCount;if(buffer.getLengthInBits()>8*totalDataCount)throw new Error("code length overflow. ("+buffer.getLengthInBits()+">"+8*totalDataCount+")");for(buffer.getLengthInBits()+4<=8*totalDataCount&&buffer.put(0,4);buffer.getLengthInBits()%8!=0;)buffer.putBit(!1);for(;!(buffer.getLengthInBits()>=8*totalDataCount)&&(buffer.put(PAD0,8),!(buffer.getLengthInBits()>=8*totalDataCount));)buffer.put(PAD1,8);return createBytes(buffer,rsBlocks)};return _this.addData=function(data){var newData=qr8BitByte(data);_dataList.push(newData),_dataCache=null},_this.isDark=function(row,col){if(0>row||row>=_moduleCount||0>col||col>=_moduleCount)throw new Error(row+","+col);return _modules[row][col]},_this.getModuleCount=function(){return _moduleCount},_this.make=function(){makeImpl(!1,getBestMaskPattern())},_this.createTableTag=function(cellSize,margin){cellSize=cellSize||2,margin="undefined"==typeof margin?4*cellSize:margin;var qrHtml="";qrHtml+='<table style="',qrHtml+=" border-width: 0px; border-style: none;",qrHtml+=" border-collapse: collapse;",qrHtml+=" padding: 0px; margin: "+margin+"px;",qrHtml+='">',qrHtml+="<tbody>";for(var r=0;r<_this.getModuleCount();r+=1){qrHtml+="<tr>";for(var c=0;c<_this.getModuleCount();c+=1)qrHtml+='<td style="',qrHtml+=" border-width: 0px; border-style: none;",qrHtml+=" border-collapse: collapse;",qrHtml+=" padding: 0px; margin: 0px;",qrHtml+=" width: "+cellSize+"px;",qrHtml+=" height: "+cellSize+"px;",qrHtml+=" background-color: ",qrHtml+=_this.isDark(r,c)?"#000000":"#ffffff",qrHtml+=";",qrHtml+='"/>';qrHtml+="</tr>"}return qrHtml+="</tbody>",qrHtml+="</table>"},_this.createSvgTag=function(cellSize,margin){cellSize=cellSize||2,margin="undefined"==typeof margin?4*cellSize:margin;var c,mc,r,mr,rect,size=_this.getModuleCount()*cellSize+2*margin,qrSvg="";for(rect="l"+cellSize+",0 0,"+cellSize+" -"+cellSize+",0 0,-"+cellSize+"z ",qrSvg+="<svg",qrSvg+=' width="'+size+'px"',qrSvg+=' height="'+size+'px"',qrSvg+=' xmlns="http://www.w3.org/2000/svg"',qrSvg+=">",qrSvg+='<path d="',r=0;r<_this.getModuleCount();r+=1)for(mr=r*cellSize+margin,c=0;c<_this.getModuleCount();c+=1)_this.isDark(r,c)&&(mc=c*cellSize+margin,qrSvg+="M"+mc+","+mr+rect);return qrSvg+='" stroke="transparent" fill="black"/>',qrSvg+="</svg>"},_this.createImgTag=function(cellSize,margin){cellSize=cellSize||2,margin="undefined"==typeof margin?4*cellSize:margin;var size=_this.getModuleCount()*cellSize+2*margin,min=margin,max=size-margin;return createImgTag(size,size,function(x,y){if(x>=min&&max>x&&y>=min&&max>y){var c=Math.floor((x-min)/cellSize),r=Math.floor((y-min)/cellSize);return _this.isDark(r,c)?0:1}return 1})},_this};qrcode.stringToBytes=function(s){for(var bytes=new Array,i=0;i<s.length;i+=1){var c=s.charCodeAt(i);bytes.push(255&c)}return bytes},qrcode.createStringToBytes=function(unicodeData,numChars){var unicodeMap=function(){for(var bin=base64DecodeInputStream(unicodeData),read=function(){var b=bin.read();if(-1==b)throw new Error;return b},count=0,unicodeMap={};;){var b0=bin.read();if(-1==b0)break;var b1=read(),b2=read(),b3=read(),k=String.fromCharCode(b0<<8|b1),v=b2<<8|b3;unicodeMap[k]=v,count+=1}if(count!=numChars)throw new Error(count+" != "+numChars);return unicodeMap}(),unknownChar="?".charCodeAt(0);return function(s){for(var bytes=new Array,i=0;i<s.length;i+=1){var c=s.charCodeAt(i);if(128>c)bytes.push(c);else{var b=unicodeMap[s.charAt(i)];"number"==typeof b?(255&b)==b?bytes.push(b):(bytes.push(b>>>8),bytes.push(255&b)):bytes.push(unknownChar)}}return bytes}};var QRMode={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},QRErrorCorrectLevel={L:1,M:0,Q:3,H:2},QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},QRUtil=function(){var PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15=1335,G18=7973,G15_MASK=21522,_this={},getBCHDigit=function(data){for(var digit=0;0!=data;)digit+=1,data>>>=1;return digit};return _this.getBCHTypeInfo=function(data){for(var d=data<<10;getBCHDigit(d)-getBCHDigit(G15)>=0;)d^=G15<<getBCHDigit(d)-getBCHDigit(G15);return(data<<10|d)^G15_MASK},_this.getBCHTypeNumber=function(data){for(var d=data<<12;getBCHDigit(d)-getBCHDigit(G18)>=0;)d^=G18<<getBCHDigit(d)-getBCHDigit(G18);return data<<12|d},_this.getPatternPosition=function(typeNumber){return PATTERN_POSITION_TABLE[typeNumber-1]},_this.getMaskFunction=function(maskPattern){switch(maskPattern){case QRMaskPattern.PATTERN000:return function(i,j){return(i+j)%2==0};case QRMaskPattern.PATTERN001:return function(i,j){return i%2==0};case QRMaskPattern.PATTERN010:return function(i,j){return j%3==0};case QRMaskPattern.PATTERN011:return function(i,j){return(i+j)%3==0};case QRMaskPattern.PATTERN100:return function(i,j){return(Math.floor(i/2)+Math.floor(j/3))%2==0};case QRMaskPattern.PATTERN101:return function(i,j){return i*j%2+i*j%3==0};case QRMaskPattern.PATTERN110:return function(i,j){return(i*j%2+i*j%3)%2==0};case QRMaskPattern.PATTERN111:return function(i,j){return(i*j%3+(i+j)%2)%2==0};default:throw new Error("bad maskPattern:"+maskPattern)}},_this.getErrorCorrectPolynomial=function(errorCorrectLength){for(var a=qrPolynomial([1],0),i=0;errorCorrectLength>i;i+=1)a=a.multiply(qrPolynomial([1,QRMath.gexp(i)],0));return a},_this.getLengthInBits=function(mode,type){if(type>=1&&10>type)switch(mode){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:return 8;case QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+mode)}else if(27>type)switch(mode){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+mode)}else{if(!(41>type))throw new Error("type:"+type);switch(mode){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+mode)}}},_this.getLostPoint=function(qrcode){for(var moduleCount=qrcode.getModuleCount(),lostPoint=0,row=0;moduleCount>row;row+=1)for(var col=0;moduleCount>col;col+=1){for(var sameCount=0,dark=qrcode.isDark(row,col),r=-1;1>=r;r+=1)if(!(0>row+r||row+r>=moduleCount))for(var c=-1;1>=c;c+=1)0>col+c||col+c>=moduleCount||0==r&&0==c||dark==qrcode.isDark(row+r,col+c)&&(sameCount+=1);sameCount>5&&(lostPoint+=3+sameCount-5)}for(var row=0;moduleCount-1>row;row+=1)for(var col=0;moduleCount-1>col;col+=1){var count=0;qrcode.isDark(row,col)&&(count+=1),qrcode.isDark(row+1,col)&&(count+=1),qrcode.isDark(row,col+1)&&(count+=1),qrcode.isDark(row+1,col+1)&&(count+=1),0!=count&&4!=count||(lostPoint+=3)}for(var row=0;moduleCount>row;row+=1)for(var col=0;moduleCount-6>col;col+=1)qrcode.isDark(row,col)&&!qrcode.isDark(row,col+1)&&qrcode.isDark(row,col+2)&&qrcode.isDark(row,col+3)&&qrcode.isDark(row,col+4)&&!qrcode.isDark(row,col+5)&&qrcode.isDark(row,col+6)&&(lostPoint+=40);for(var col=0;moduleCount>col;col+=1)for(var row=0;moduleCount-6>row;row+=1)qrcode.isDark(row,col)&&!qrcode.isDark(row+1,col)&&qrcode.isDark(row+2,col)&&qrcode.isDark(row+3,col)&&qrcode.isDark(row+4,col)&&!qrcode.isDark(row+5,col)&&qrcode.isDark(row+6,col)&&(lostPoint+=40);for(var darkCount=0,col=0;moduleCount>col;col+=1)for(var row=0;moduleCount>row;row+=1)qrcode.isDark(row,col)&&(darkCount+=1);var ratio=Math.abs(100*darkCount/moduleCount/moduleCount-50)/5;return lostPoint+=10*ratio},_this}(),QRMath=function(){for(var EXP_TABLE=new Array(256),LOG_TABLE=new Array(256),i=0;8>i;i+=1)EXP_TABLE[i]=1<<i;for(var i=8;256>i;i+=1)EXP_TABLE[i]=EXP_TABLE[i-4]^EXP_TABLE[i-5]^EXP_TABLE[i-6]^EXP_TABLE[i-8];for(var i=0;255>i;i+=1)LOG_TABLE[EXP_TABLE[i]]=i;var _this={};return _this.glog=function(n){if(1>n)throw new Error("glog("+n+")");return LOG_TABLE[n]},_this.gexp=function(n){for(;0>n;)n+=255;for(;n>=256;)n-=255;return EXP_TABLE[n]},_this}(),QRRSBlock=function(){var RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],qrRSBlock=function(totalCount,dataCount){var _this={};return _this.totalCount=totalCount,_this.dataCount=dataCount,_this},_this={},getRsBlockTable=function(typeNumber,errorCorrectLevel){switch(errorCorrectLevel){case QRErrorCorrectLevel.L:return RS_BLOCK_TABLE[4*(typeNumber-1)+0];case QRErrorCorrectLevel.M:return RS_BLOCK_TABLE[4*(typeNumber-1)+1];case QRErrorCorrectLevel.Q:return RS_BLOCK_TABLE[4*(typeNumber-1)+2];case QRErrorCorrectLevel.H:return RS_BLOCK_TABLE[4*(typeNumber-1)+3];default:return}};return _this.getRSBlocks=function(typeNumber,errorCorrectLevel){var rsBlock=getRsBlockTable(typeNumber,errorCorrectLevel);if("undefined"==typeof rsBlock)throw new Error("bad rs block @ typeNumber:"+typeNumber+"/errorCorrectLevel:"+errorCorrectLevel);for(var length=rsBlock.length/3,list=new Array,i=0;length>i;i+=1)for(var count=rsBlock[3*i+0],totalCount=rsBlock[3*i+1],dataCount=rsBlock[3*i+2],j=0;count>j;j+=1)list.push(qrRSBlock(totalCount,dataCount));return list},_this}(),qrBitBuffer=function(){var _buffer=new Array,_length=0,_this={};return _this.getBuffer=function(){return _buffer},_this.getAt=function(index){var bufIndex=Math.floor(index/8);return 1==(_buffer[bufIndex]>>>7-index%8&1)},_this.put=function(num,length){for(var i=0;length>i;i+=1)_this.putBit(1==(num>>>length-i-1&1))},_this.getLengthInBits=function(){return _length},_this.putBit=function(bit){var bufIndex=Math.floor(_length/8);_buffer.length<=bufIndex&&_buffer.push(0),bit&&(_buffer[bufIndex]|=128>>>_length%8),_length+=1},_this},qr8BitByte=function(data){var _mode=QRMode.MODE_8BIT_BYTE,_bytes=qrcode.stringToBytes(data),_this={};return _this.getMode=function(){return _mode},_this.getLength=function(buffer){return _bytes.length},_this.write=function(buffer){for(var i=0;i<_bytes.length;i+=1)buffer.put(_bytes[i],8)},_this},byteArrayOutputStream=function(){var _bytes=new Array,_this={};return _this.writeByte=function(b){_bytes.push(255&b)},_this.writeShort=function(i){_this.writeByte(i),_this.writeByte(i>>>8)},_this.writeBytes=function(b,off,len){off=off||0,len=len||b.length;for(var i=0;len>i;i+=1)_this.writeByte(b[i+off])},_this.writeString=function(s){for(var i=0;i<s.length;i+=1)_this.writeByte(s.charCodeAt(i))},_this.toByteArray=function(){return _bytes},_this.toString=function(){var s="";s+="[";for(var i=0;i<_bytes.length;i+=1)i>0&&(s+=","),s+=_bytes[i];return s+="]"},_this},base64EncodeOutputStream=function(){var _buffer=0,_buflen=0,_length=0,_base64="",_this={},writeEncoded=function(b){_base64+=String.fromCharCode(encode(63&b))},encode=function(n){if(0>n);else{if(26>n)return 65+n;if(52>n)return 97+(n-26);if(62>n)return 48+(n-52);if(62==n)return 43;if(63==n)return 47}throw new Error("n:"+n)};return _this.writeByte=function(n){for(_buffer=_buffer<<8|255&n,_buflen+=8,_length+=1;_buflen>=6;)writeEncoded(_buffer>>>_buflen-6),_buflen-=6},_this.flush=function(){if(_buflen>0&&(writeEncoded(_buffer<<6-_buflen),_buffer=0,_buflen=0),_length%3!=0)for(var padlen=3-_length%3,i=0;padlen>i;i+=1)_base64+="="},_this.toString=function(){return _base64},_this},base64DecodeInputStream=function(str){var _str=str,_pos=0,_buffer=0,_buflen=0,_this={};_this.read=function(){for(;8>_buflen;){if(_pos>=_str.length){if(0==_buflen)return-1;throw new Error("unexpected end of file./"+_buflen)}var c=_str.charAt(_pos);if(_pos+=1,"="==c)return _buflen=0,-1;c.match(/^\s$/)||(_buffer=_buffer<<6|decode(c.charCodeAt(0)),_buflen+=6)}var n=_buffer>>>_buflen-8&255;return _buflen-=8,n};var decode=function(c){if(c>=65&&90>=c)return c-65;if(c>=97&&122>=c)return c-97+26;if(c>=48&&57>=c)return c-48+52;if(43==c)return 62;if(47==c)return 63;throw new Error("c:"+c)};return _this},gifImage=function(width,height){var _width=width,_height=height,_data=new Array(width*height),_this={};_this.setPixel=function(x,y,pixel){_data[y*_width+x]=pixel},_this.write=function(out){out.writeString("GIF87a"),out.writeShort(_width),out.writeShort(_height),out.writeByte(128),out.writeByte(0),out.writeByte(0),out.writeByte(0),out.writeByte(0),out.writeByte(0),out.writeByte(255),out.writeByte(255),out.writeByte(255),out.writeString(","),out.writeShort(0),out.writeShort(0),out.writeShort(_width),out.writeShort(_height),out.writeByte(0);var lzwMinCodeSize=2,raster=getLZWRaster(lzwMinCodeSize);out.writeByte(lzwMinCodeSize);for(var offset=0;raster.length-offset>255;)out.writeByte(255),out.writeBytes(raster,offset,255),offset+=255;out.writeByte(raster.length-offset),out.writeBytes(raster,offset,raster.length-offset),out.writeByte(0),out.writeString(";")};var bitOutputStream=function(out){var _out=out,_bitLength=0,_bitBuffer=0,_this={};return _this.write=function(data,length){if(data>>>length!=0)throw new Error("length over");for(;_bitLength+length>=8;)_out.writeByte(255&(data<<_bitLength|_bitBuffer)),length-=8-_bitLength,data>>>=8-_bitLength,_bitBuffer=0,_bitLength=0;_bitBuffer=data<<_bitLength|_bitBuffer,_bitLength+=length},_this.flush=function(){_bitLength>0&&_out.writeByte(_bitBuffer)},_this},getLZWRaster=function(lzwMinCodeSize){for(var clearCode=1<<lzwMinCodeSize,endCode=(1<<lzwMinCodeSize)+1,bitLength=lzwMinCodeSize+1,table=lzwTable(),i=0;clearCode>i;i+=1)table.add(String.fromCharCode(i));table.add(String.fromCharCode(clearCode)),table.add(String.fromCharCode(endCode));var byteOut=byteArrayOutputStream(),bitOut=bitOutputStream(byteOut);bitOut.write(clearCode,bitLength);var dataIndex=0,s=String.fromCharCode(_data[dataIndex]);for(dataIndex+=1;dataIndex<_data.length;){var c=String.fromCharCode(_data[dataIndex]);dataIndex+=1,table.contains(s+c)?s+=c:(bitOut.write(table.indexOf(s),bitLength),table.size()<4095&&(table.size()==1<<bitLength&&(bitLength+=1),table.add(s+c)),s=c)}return bitOut.write(table.indexOf(s),bitLength),bitOut.write(endCode,bitLength),bitOut.flush(),byteOut.toByteArray()},lzwTable=function(){var _map={},_size=0,_this={};return _this.add=function(key){if(_this.contains(key))throw new Error("dup key:"+key);_map[key]=_size,_size+=1},_this.size=function(){return _size},_this.indexOf=function(key){return _map[key]},_this.contains=function(key){return"undefined"!=typeof _map[key]},_this};return _this},createImgTag=function(width,height,getPixel,alt){for(var gif=gifImage(width,height),y=0;height>y;y+=1)for(var x=0;width>x;x+=1)gif.setPixel(x,y,getPixel(x,y));var b=byteArrayOutputStream();gif.write(b);for(var base64=base64EncodeOutputStream(),bytes=b.toByteArray(),i=0;i<bytes.length;i+=1)base64.writeByte(bytes[i]);base64.flush();var img="";return img+="<img",img+=' src="',img+="data:image/gif;base64,",img+=base64,img+='"',img+=' width="',img+=width,img+='"',img+=' height="',img+=height,img+='"',alt&&(img+=' alt="',img+=alt,img+='"'),img+="/>"};return qrcode}();!function(factory){__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}(function(){return qrcode})}.call(window)},function(module,exports,__webpack_require__){(function(setImmediate){(function(){!function(exports,undefined){"use strict";function require(ids,callback){for(var module,defs=[],i=0;i<ids.length;++i){if(module=modules[ids[i]]||resolve(ids[i]),!module)throw"module definition dependecy not found: "+ids[i];defs.push(module)}callback.apply(null,defs)}function define(id,dependencies,definition){if("string"!=typeof id)throw"invalid module definition, module id must be defined and be a string";if(dependencies===undefined)throw"invalid module definition, dependencies must be specified";if(definition===undefined)throw"invalid module definition, definition function must be specified";require(dependencies,function(){modules[id]=definition.apply(null,arguments)})}function resolve(id){for(var target=exports,fragments=id.split(/[.\/]/),fi=0;fi<fragments.length;++fi){if(!target[fragments[fi]])return;target=target[fragments[fi]]}return target}function expose(ids){var i,target,id,fragments,privateModules;for(i=0;i<ids.length;i++){target=exports,id=ids[i],fragments=id.split(/[.\/]/);for(var fi=0;fi<fragments.length-1;++fi)target[fragments[fi]]===undefined&&(target[fragments[fi]]={}),target=target[fragments[fi]];target[fragments[fragments.length-1]]=modules[id]}if(exports.AMDLC_TESTS){privateModules=exports.privateModules||{};for(id in modules)privateModules[id]=modules[id];for(i=0;i<ids.length;i++)delete privateModules[ids[i]];exports.privateModules=privateModules}}var modules={};define("tinymce/geom/Rect",[],function(){function relativePosition(rect,targetRect,rel){var x,y,w,h,targetW,targetH;return x=targetRect.x,y=targetRect.y,w=rect.w,h=rect.h,targetW=targetRect.w,targetH=targetRect.h,rel=(rel||"").split(""),"b"===rel[0]&&(y+=targetH),"r"===rel[1]&&(x+=targetW),"c"===rel[0]&&(y+=round(targetH/2)),"c"===rel[1]&&(x+=round(targetW/2)),"b"===rel[3]&&(y-=h),"r"===rel[4]&&(x-=w),"c"===rel[3]&&(y-=round(h/2)),"c"===rel[4]&&(x-=round(w/2)),create(x,y,w,h)}function findBestRelativePosition(rect,targetRect,constrainRect,rels){var pos,i;for(i=0;i<rels.length;i++)if(pos=relativePosition(rect,targetRect,rels[i]),pos.x>=constrainRect.x&&pos.x+pos.w<=constrainRect.w+constrainRect.x&&pos.y>=constrainRect.y&&pos.y+pos.h<=constrainRect.h+constrainRect.y)return rels[i];return null}function inflate(rect,w,h){return create(rect.x-w,rect.y-h,rect.w+2*w,rect.h+2*h)}function intersect(rect,cropRect){var x1,y1,x2,y2;return x1=max(rect.x,cropRect.x),y1=max(rect.y,cropRect.y),x2=min(rect.x+rect.w,cropRect.x+cropRect.w),y2=min(rect.y+rect.h,cropRect.y+cropRect.h),0>x2-x1||0>y2-y1?null:create(x1,y1,x2-x1,y2-y1)}function clamp(rect,clampRect,fixedSize){var underflowX1,underflowY1,overflowX2,overflowY2,x1,y1,x2,y2,cx2,cy2;return x1=rect.x,y1=rect.y,x2=rect.x+rect.w,y2=rect.y+rect.h,cx2=clampRect.x+clampRect.w,cy2=clampRect.y+clampRect.h,underflowX1=max(0,clampRect.x-x1),underflowY1=max(0,clampRect.y-y1),overflowX2=max(0,x2-cx2),overflowY2=max(0,y2-cy2),x1+=underflowX1,y1+=underflowY1,fixedSize&&(x2+=underflowX1,y2+=underflowY1,x1-=overflowX2,y1-=overflowY2),x2-=overflowX2,y2-=overflowY2,create(x1,y1,x2-x1,y2-y1)}function create(x,y,w,h){return{x:x,y:y,w:w,h:h}}function fromClientRect(clientRect){return create(clientRect.left,clientRect.top,clientRect.width,clientRect.height)}var min=Math.min,max=Math.max,round=Math.round;return{inflate:inflate,relativePosition:relativePosition,findBestRelativePosition:findBestRelativePosition,intersect:intersect,clamp:clamp,create:create,fromClientRect:fromClientRect}}),define("tinymce/util/Promise",[],function(){function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],doResolve(fn,bind(resolve,this),bind(reject,this))}function handle(deferred){var me=this;return null===this._state?void this._deferreds.push(deferred):void asap(function(){var cb=me._state?deferred.onFulfilled:deferred.onRejected;if(null===cb)return void(me._state?deferred.resolve:deferred.reject)(me._value);var ret;try{ret=cb(me._value)}catch(e){return void deferred.reject(e)}deferred.resolve(ret)})}function resolve(newValue){try{if(newValue===this)throw new TypeError("A promise cannot be resolved with itself.");
if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if("function"==typeof then)return void doResolve(bind(then,newValue),bind(resolve,this),bind(reject,this))}this._state=!0,this._value=newValue,finale.call(this)}catch(e){reject.call(this,e)}}function reject(newValue){this._state=!1,this._value=newValue,finale.call(this)}function finale(){for(var i=0,len=this._deferreds.length;len>i;i++)handle.call(this,this._deferreds[i]);this._deferreds=null}function Handler(onFulfilled,onRejected,resolve,reject){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.resolve=resolve,this.reject=reject}function doResolve(fn,onFulfilled,onRejected){var done=!1;try{fn(function(value){done||(done=!0,onFulfilled(value))},function(reason){done||(done=!0,onRejected(reason))})}catch(ex){if(done)return;done=!0,onRejected(ex)}}if(window.Promise)return window.Promise;var asap=Promise.immediateFn||"function"==typeof setImmediate&&setImmediate||function(fn){setTimeout(fn,1)},isArray=Array.isArray||function(value){return"[object Array]"===Object.prototype.toString.call(value)};return Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var me=this;return new Promise(function(resolve,reject){handle.call(me,new Handler(onFulfilled,onRejected,resolve,reject))})},Promise.all=function(){var args=Array.prototype.slice.call(1===arguments.length&&isArray(arguments[0])?arguments[0]:arguments);return new Promise(function(resolve,reject){function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0===--remaining&&resolve(args)}catch(ex){reject(ex)}}if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;len>i;i++)values[i].then(resolve,reject)})},Promise}),define("tinymce/util/Delay",["tinymce/util/Promise"],function(Promise){function requestAnimationFrame(callback,element){function featurefill(callback){window.setTimeout(callback,0)}var i,requestAnimationFrameFunc=window.requestAnimationFrame,vendors=["ms","moz","webkit"];for(i=0;i<vendors.length&&!requestAnimationFrameFunc;i++)requestAnimationFrameFunc=window[vendors[i]+"RequestAnimationFrame"];requestAnimationFrameFunc||(requestAnimationFrameFunc=featurefill),requestAnimationFrameFunc(callback,element)}function wrappedSetTimeout(callback,time){return"number"!=typeof time&&(time=0),setTimeout(callback,time)}function wrappedSetInterval(callback,time){return"number"!=typeof time&&(time=0),setInterval(callback,time)}function wrappedClearTimeout(id){return clearTimeout(id)}function wrappedClearInterval(id){return clearInterval(id)}var requestAnimationFramePromise;return{requestAnimationFrame:function(callback,element){return requestAnimationFramePromise?void requestAnimationFramePromise.then(callback):void(requestAnimationFramePromise=new Promise(function(resolve){element||(element=document.body),requestAnimationFrame(resolve,element)}).then(callback))},setTimeout:wrappedSetTimeout,setInterval:wrappedSetInterval,setEditorTimeout:function(editor,callback,time){return wrappedSetTimeout(function(){editor.removed||callback()},time)},setEditorInterval:function(editor,callback,time){var timer;return timer=wrappedSetInterval(function(){editor.removed?clearInterval(timer):callback()},time)},throttle:function(callback,time){var timer,func;return func=function(){var args=arguments;clearTimeout(timer),timer=wrappedSetTimeout(function(){callback.apply(this,args)},time)},func.stop=function(){clearTimeout(timer)},func},clearInterval:wrappedClearInterval,clearTimeout:wrappedClearTimeout}}),define("tinymce/dom/EventUtils",["tinymce/util/Delay"],function(Delay){function addEvent(target,name,callback,capture){target.addEventListener?target.addEventListener(name,callback,capture||!1):target.attachEvent&&target.attachEvent("on"+name,callback)}function removeEvent(target,name,callback,capture){target.removeEventListener?target.removeEventListener(name,callback,capture||!1):target.detachEvent&&target.detachEvent("on"+name,callback)}function fix(originalEvent,data){function returnFalse(){return!1}function returnTrue(){return!0}var name,undef,event=data||{};for(name in originalEvent)deprecated[name]||(event[name]=originalEvent[name]);if(event.target||(event.target=event.srcElement||document),event.path&&(event.target=event.path[0]),event.deepPath&&(event.target=event.deepPath[0]),originalEvent&&mouseEventRe.test(originalEvent.type)&&originalEvent.pageX===undef&&originalEvent.clientX!==undef){var eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body;event.pageX=originalEvent.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=originalEvent.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}return event.preventDefault=function(){event.isDefaultPrevented=returnTrue,originalEvent&&(originalEvent.preventDefault?originalEvent.preventDefault():originalEvent.returnValue=!1)},event.stopPropagation=function(){event.isPropagationStopped=returnTrue,originalEvent&&(originalEvent.stopPropagation?originalEvent.stopPropagation():originalEvent.cancelBubble=!0)},event.stopImmediatePropagation=function(){event.isImmediatePropagationStopped=returnTrue,event.stopPropagation()},event.isDefaultPrevented||(event.isDefaultPrevented=returnFalse,event.isPropagationStopped=returnFalse,event.isImmediatePropagationStopped=returnFalse),"undefined"==typeof event.metaKey&&(event.metaKey=!1),event}function bindOnReady(win,callback,eventUtils){function readyHandler(){eventUtils.domLoaded||(eventUtils.domLoaded=!0,callback(event))}function waitForDomLoaded(){("complete"===doc.readyState||"interactive"===doc.readyState&&doc.body)&&(removeEvent(doc,"readystatechange",waitForDomLoaded),readyHandler())}function tryScroll(){try{doc.documentElement.doScroll("left")}catch(ex){return void Delay.setTimeout(tryScroll)}readyHandler()}var doc=win.document,event={type:"ready"};return eventUtils.domLoaded?void callback(event):(doc.addEventListener?"complete"===doc.readyState?readyHandler():addEvent(win,"DOMContentLoaded",readyHandler):(addEvent(doc,"readystatechange",waitForDomLoaded),doc.documentElement.doScroll&&win.self===win.top&&tryScroll()),void addEvent(win,"load",readyHandler))}function EventUtils(){function executeHandlers(evt,id){var callbackList,i,l,callback,container=events[id];if(callbackList=container&&container[evt.type])for(i=0,l=callbackList.length;l>i;i++)if(callback=callbackList[i],callback&&callback.func.call(callback.scope,evt)===!1&&evt.preventDefault(),evt.isImmediatePropagationStopped())return}var count,expando,hasFocusIn,hasMouseEnterLeave,mouseEnterLeave,self=this,events={};expando=eventExpandoPrefix+(+new Date).toString(32),hasMouseEnterLeave="onmouseenter"in document.documentElement,hasFocusIn="onfocusin"in document.documentElement,mouseEnterLeave={mouseenter:"mouseover",mouseleave:"mouseout"},count=1,self.domLoaded=!1,self.events=events,self.bind=function(target,names,callback,scope){function defaultNativeHandler(evt){executeHandlers(fix(evt||win.event),id)}var id,callbackList,i,name,fakeName,nativeHandler,capture,win=window;if(target&&3!==target.nodeType&&8!==target.nodeType){for(target[expando]?id=target[expando]:(id=count++,target[expando]=id,events[id]={}),scope=scope||target,names=names.split(" "),i=names.length;i--;)name=names[i],nativeHandler=defaultNativeHandler,fakeName=capture=!1,"DOMContentLoaded"===name&&(name="ready"),self.domLoaded&&"ready"===name&&"complete"==target.readyState?callback.call(scope,fix({type:name})):(hasMouseEnterLeave||(fakeName=mouseEnterLeave[name],fakeName&&(nativeHandler=function(evt){var current,related;if(current=evt.currentTarget,related=evt.relatedTarget,related&&current.contains)related=current.contains(related);else for(;related&&related!==current;)related=related.parentNode;related||(evt=fix(evt||win.event),evt.type="mouseout"===evt.type?"mouseleave":"mouseenter",evt.target=current,executeHandlers(evt,id))})),hasFocusIn||"focusin"!==name&&"focusout"!==name||(capture=!0,fakeName="focusin"===name?"focus":"blur",nativeHandler=function(evt){evt=fix(evt||win.event),evt.type="focus"===evt.type?"focusin":"focusout",executeHandlers(evt,id)}),callbackList=events[id][name],callbackList?"ready"===name&&self.domLoaded?callback({type:name}):callbackList.push({func:callback,scope:scope}):(events[id][name]=callbackList=[{func:callback,scope:scope}],callbackList.fakeName=fakeName,callbackList.capture=capture,callbackList.nativeHandler=nativeHandler,"ready"===name?bindOnReady(target,nativeHandler,self):addEvent(target,fakeName||name,nativeHandler,capture)));return target=callbackList=0,callback}},self.unbind=function(target,names,callback){var id,callbackList,i,ci,name,eventMap;if(!target||3===target.nodeType||8===target.nodeType)return self;if(id=target[expando]){if(eventMap=events[id],names){for(names=names.split(" "),i=names.length;i--;)if(name=names[i],callbackList=eventMap[name]){if(callback)for(ci=callbackList.length;ci--;)if(callbackList[ci].func===callback){var nativeHandler=callbackList.nativeHandler,fakeName=callbackList.fakeName,capture=callbackList.capture;callbackList=callbackList.slice(0,ci).concat(callbackList.slice(ci+1)),callbackList.nativeHandler=nativeHandler,callbackList.fakeName=fakeName,callbackList.capture=capture,eventMap[name]=callbackList}callback&&0!==callbackList.length||(delete eventMap[name],removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture))}}else{for(name in eventMap)callbackList=eventMap[name],removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture);eventMap={}}for(name in eventMap)return self;delete events[id];try{delete target[expando]}catch(ex){target[expando]=null}}return self},self.fire=function(target,name,args){var id;if(!target||3===target.nodeType||8===target.nodeType)return self;args=fix(null,args),args.type=name,args.target=target;do id=target[expando],id&&executeHandlers(args,id),target=target.parentNode||target.ownerDocument||target.defaultView||target.parentWindow;while(target&&!args.isPropagationStopped());return self},self.clean=function(target){var i,children,unbind=self.unbind;if(!target||3===target.nodeType||8===target.nodeType)return self;if(target[expando]&&unbind(target),target.getElementsByTagName||(target=target.document),target&&target.getElementsByTagName)for(unbind(target),children=target.getElementsByTagName("*"),i=children.length;i--;)target=children[i],target[expando]&&unbind(target);return self},self.destroy=function(){events={}},self.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1}}var eventExpandoPrefix="mce-data-",mouseEventRe=/^(?:mouse|contextmenu)|click/,deprecated={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1};return EventUtils.Event=new EventUtils,EventUtils.Event.bind(window,"ready",function(){}),EventUtils}),define("tinymce/dom/Sizzle",[],function(){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){for(var i=0,len=this.length;len>i;i++)if(this[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,documentIsHTML=!isXML(doc),parent&&parent!==parent.top&&(parent.addEventListener?parent.addEventListener("unload",function(){setDocument()},!1):parent.attachEvent&&parent.attachEvent("onunload",function(){setDocument()})),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(doc.getElementsByClassName),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){div.innerHTML="<select msallowcapture=''><option selected=''></option></select>",div.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode;
}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}),define("tinymce/Env",[],function(){function matchMediaQuery(query){return"matchMedia"in window?matchMedia(query).matches:!1}var opera,webkit,ie,ie11,ie12,gecko,mac,iDevice,android,fileApi,phone,tablet,windowsPhone,nav=navigator,userAgent=nav.userAgent;opera=window.opera&&window.opera.buildNumber,android=/Android/.test(userAgent),webkit=/WebKit/.test(userAgent),ie=!webkit&&!opera&&/MSIE/gi.test(userAgent)&&/Explorer/gi.test(nav.appName),ie=ie&&/MSIE (\w+)\./.exec(userAgent)[1],ie11=-1==userAgent.indexOf("Trident/")||-1==userAgent.indexOf("rv:")&&-1==nav.appName.indexOf("Netscape")?!1:11,ie12=-1==userAgent.indexOf("Edge/")||ie||ie11?!1:12,ie=ie||ie11||ie12,gecko=!webkit&&!ie11&&/Gecko/.test(userAgent),mac=-1!=userAgent.indexOf("Mac"),iDevice=/(iPad|iPhone)/.test(userAgent),fileApi="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL,phone=matchMediaQuery("only screen and (max-device-width: 480px)")&&(android||iDevice),tablet=matchMediaQuery("only screen and (min-width: 800px)")&&(android||iDevice),windowsPhone=-1!=userAgent.indexOf("Windows Phone"),ie12&&(webkit=!1);var contentEditable=!iDevice||fileApi||userAgent.match(/AppleWebKit\/(\d*)/)[1]>=534;return{opera:opera,webkit:webkit,ie:ie,gecko:gecko,mac:mac,iOS:iDevice,android:android,contentEditable:contentEditable,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:8!=ie,range:window.getSelection&&"Range"in window,documentMode:ie&&!ie12?document.documentMode||7:10,fileApi:fileApi,ceFalse:ie===!1||ie>8,desktop:!phone&&!tablet,windowsPhone:windowsPhone}}),define("tinymce/util/Arr",[],function(){function toArray(obj){var i,l,array=obj;if(!isArray(obj))for(array=[],i=0,l=obj.length;l>i;i++)array[i]=obj[i];return array}function each(o,cb,s){var n,l;if(!o)return 0;if(s=s||o,o.length!==undefined){for(n=0,l=o.length;l>n;n++)if(cb.call(s,o[n],n,o)===!1)return 0}else for(n in o)if(o.hasOwnProperty(n)&&cb.call(s,o[n],n,o)===!1)return 0;return 1}function map(array,callback){var out=[];return each(array,function(item,index){out.push(callback(item,index,array))}),out}function filter(a,f){var o=[];return each(a,function(v,index){f&&!f(v,index,a)||o.push(v)}),o}function indexOf(a,v){var i,l;if(a)for(i=0,l=a.length;l>i;i++)if(a[i]===v)return i;return-1}function reduce(collection,iteratee,accumulator,thisArg){var i=0;for(arguments.length<3&&(accumulator=collection[0]);i<collection.length;i++)accumulator=iteratee.call(thisArg,accumulator,collection[i],i);return accumulator}function findIndex(array,predicate,thisArg){var i,l;for(i=0,l=array.length;l>i;i++)if(predicate.call(thisArg,array[i],i,array))return i;return-1}function find(array,predicate,thisArg){var idx=findIndex(array,predicate,thisArg);return-1!==idx?array[idx]:undefined}function last(collection){return collection[collection.length-1]}var isArray=Array.isArray||function(obj){return"[object Array]"===Object.prototype.toString.call(obj)};return{isArray:isArray,toArray:toArray,each:each,map:map,filter:filter,indexOf:indexOf,reduce:reduce,findIndex:findIndex,find:find,last:last}}),define("tinymce/util/Tools",["tinymce/Env","tinymce/util/Arr"],function(Env,Arr){function trim(str){return null===str||str===undefined?"":(""+str).replace(whiteSpaceRegExp,"")}function is(obj,type){return type?"array"==type&&Arr.isArray(obj)?!0:typeof obj==type:obj!==undefined}function makeMap(items,delim,map){var i;for(items=items||[],delim=delim||",","string"==typeof items&&(items=items.split(delim)),map=map||{},i=items.length;i--;)map[items[i]]={};return map}function create(s,p,root){var sp,ns,cn,scn,c,self=this,de=0;if(s=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(s),cn=s[3].match(/(^|\.)(\w+)$/i)[2],ns=self.createNS(s[3].replace(/\.\w+$/,""),root),!ns[cn]){if("static"==s[2])return ns[cn]=p,void(this.onCreate&&this.onCreate(s[2],s[3],ns[cn]));p[cn]||(p[cn]=function(){},de=1),ns[cn]=p[cn],self.extend(ns[cn].prototype,p),s[5]&&(sp=self.resolve(s[5]).prototype,scn=s[5].match(/\.(\w+)$/i)[1],c=ns[cn],de?ns[cn]=function(){return sp[scn].apply(this,arguments)}:ns[cn]=function(){return this.parent=sp[scn],c.apply(this,arguments)},ns[cn].prototype[cn]=ns[cn],self.each(sp,function(f,n){ns[cn].prototype[n]=sp[n]}),self.each(p,function(f,n){sp[n]?ns[cn].prototype[n]=function(){return this.parent=sp[n],f.apply(this,arguments)}:n!=cn&&(ns[cn].prototype[n]=f)})),self.each(p["static"],function(f,n){ns[cn][n]=f})}}function extend(obj,ext){var i,l,name,value,args=arguments;for(i=1,l=args.length;l>i;i++){ext=args[i];for(name in ext)ext.hasOwnProperty(name)&&(value=ext[name],value!==undefined&&(obj[name]=value))}return obj}function walk(o,f,n,s){s=s||this,o&&(n&&(o=o[n]),Arr.each(o,function(o,i){return f.call(s,o,i,n)===!1?!1:void walk(o,f,n,s)}))}function createNS(n,o){var i,v;for(o=o||window,n=n.split("."),i=0;i<n.length;i++)v=n[i],o[v]||(o[v]={}),o=o[v];return o}function resolve(n,o){var i,l;for(o=o||window,n=n.split("."),i=0,l=n.length;l>i&&(o=o[n[i]]);i++);return o}function explode(s,d){return!s||is(s,"array")?s:Arr.map(s.split(d||","),trim)}function _addCacheSuffix(url){var cacheSuffix=Env.cacheSuffix;return cacheSuffix&&(url+=(-1===url.indexOf("?")?"?":"&")+cacheSuffix),url}var whiteSpaceRegExp=/^\s*|\s*$/g;return{trim:trim,isArray:Arr.isArray,is:is,toArray:Arr.toArray,makeMap:makeMap,each:Arr.each,map:Arr.map,grep:Arr.filter,inArray:Arr.indexOf,extend:extend,create:create,walk:walk,createNS:createNS,resolve:resolve,explode:explode,_addCacheSuffix:_addCacheSuffix}}),define("tinymce/dom/DomQuery",["tinymce/dom/EventUtils","tinymce/dom/Sizzle","tinymce/util/Tools","tinymce/Env"],function(EventUtils,Sizzle,Tools,Env){function isDefined(obj){return"undefined"!=typeof obj}function isString(obj){return"string"==typeof obj}function isWindow(obj){return obj&&obj==obj.window}function createFragment(html,fragDoc){var frag,node,container;for(fragDoc=fragDoc||doc,container=fragDoc.createElement("div"),frag=fragDoc.createDocumentFragment(),container.innerHTML=html;node=container.firstChild;)frag.appendChild(node);return frag}function domManipulate(targetNodes,sourceItem,callback,reverse){var i;if(isString(sourceItem))sourceItem=createFragment(sourceItem,getElementDocument(targetNodes[0]));else if(sourceItem.length&&!sourceItem.nodeType){if(sourceItem=DomQuery.makeArray(sourceItem),reverse)for(i=sourceItem.length-1;i>=0;i--)domManipulate(targetNodes,sourceItem[i],callback,reverse);else for(i=0;i<sourceItem.length;i++)domManipulate(targetNodes,sourceItem[i],callback,reverse);return targetNodes}if(sourceItem.nodeType)for(i=targetNodes.length;i--;)callback.call(targetNodes[i],sourceItem);return targetNodes}function hasClass(node,className){return node&&className&&-1!==(" "+node.className+" ").indexOf(" "+className+" ")}function wrap(elements,wrapper,all){var lastParent,newWrapper;return wrapper=DomQuery(wrapper)[0],elements.each(function(){var self=this;all&&lastParent==self.parentNode?newWrapper.appendChild(self):(lastParent=self.parentNode,newWrapper=wrapper.cloneNode(!1),self.parentNode.insertBefore(newWrapper,self),newWrapper.appendChild(self))}),elements}function DomQuery(selector,context){return new DomQuery.fn.init(selector,context)}function inArray(item,array){var i;if(array.indexOf)return array.indexOf(item);for(i=array.length;i--;)if(array[i]===item)return i;return-1}function trim(str){return null===str||str===undef?"":(""+str).replace(whiteSpaceRegExp,"")}function each(obj,callback){var length,key,i,undef,value;if(obj)if(length=obj.length,length===undef){for(key in obj)if(obj.hasOwnProperty(key)&&(value=obj[key],callback.call(value,key,value)===!1))break}else for(i=0;length>i&&(value=obj[i],callback.call(value,i,value)!==!1);i++);return obj}function grep(array,callback){var out=[];return each(array,function(i,item){callback(item,i)&&out.push(item)}),out}function getElementDocument(element){return element?9==element.nodeType?element:element.ownerDocument:doc}function dir(el,prop,until){var matched=[],cur=el[prop];for("string"!=typeof until&&until instanceof DomQuery&&(until=until[0]);cur&&9!==cur.nodeType;){if(until!==undefined){if(cur===until)break;if("string"==typeof until&&DomQuery(cur).is(until))break}1===cur.nodeType&&matched.push(cur),cur=cur[prop]}return matched}function sibling(node,siblingName,nodeType,until){var result=[];for(until instanceof DomQuery&&(until=until[0]);node;node=node[siblingName])if(!nodeType||node.nodeType===nodeType){if(until!==undefined){if(node===until)break;if("string"==typeof until&&DomQuery(node).is(until))break}result.push(node)}return result}function firstSibling(node,siblingName,nodeType){for(node=node[siblingName];node;node=node[siblingName])if(node.nodeType==nodeType)return node;return null}function appendHooks(targetHooks,prop,hooks){each(hooks,function(name,func){targetHooks[name]=targetHooks[name]||{},targetHooks[name][prop]=func})}var undef,doc=document,push=Array.prototype.push,slice=Array.prototype.slice,rquickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Event=EventUtils.Event,skipUniques=Tools.makeMap("children,contents,next,prev"),numericCssMap=Tools.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),booleanMap=Tools.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),propFix={"for":"htmlFor","class":"className",readonly:"readOnly"},cssFix={"float":"cssFloat"},attrHooks={},cssHooks={},whiteSpaceRegExp=/^\s*|\s*$/g;return DomQuery.fn=DomQuery.prototype={constructor:DomQuery,selector:"",context:null,length:0,init:function(selector,context){var match,node,self=this;if(!selector)return self;if(selector.nodeType)return self.context=self[0]=selector,self.length=1,self;if(context&&context.nodeType)self.context=context;else{if(context)return DomQuery(selector).attr(context);self.context=context=document}if(isString(selector)){if(self.selector=selector,match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match)return DomQuery(context).find(selector);if(match[1])for(node=createFragment(selector,getElementDocument(context)).firstChild;node;)push.call(self,node),node=node.nextSibling;else{if(node=getElementDocument(context).getElementById(match[2]),!node)return self;if(node.id!==match[2])return self.find(selector);self.length=1,self[0]=node}}else this.add(selector,!1);return self},toArray:function(){return Tools.toArray(this)},add:function(items,sort){var nodes,i,self=this;if(isString(items))return self.add(DomQuery(items));if(sort!==!1)for(nodes=DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items))),self.length=nodes.length,i=0;i<nodes.length;i++)self[i]=nodes[i];else push.apply(self,DomQuery.makeArray(items));return self},attr:function(name,value){var hook,self=this;if("object"==typeof name)each(name,function(name,value){self.attr(name,value)});else{if(!isDefined(value)){if(self[0]&&1===self[0].nodeType){if(hook=attrHooks[name],hook&&hook.get)return hook.get(self[0],name);if(booleanMap[name])return self.prop(name)?name:undef;value=self[0].getAttribute(name,2),null===value&&(value=undef)}return value}this.each(function(){var hook;if(1===this.nodeType){if(hook=attrHooks[name],hook&&hook.set)return void hook.set(this,value);null===value?this.removeAttribute(name,2):this.setAttribute(name,value,2)}})}return self},removeAttr:function(name){return this.attr(name,null)},prop:function(name,value){var self=this;if(name=propFix[name]||name,"object"==typeof name)each(name,function(name,value){self.prop(name,value)});else{if(!isDefined(value))return self[0]&&self[0].nodeType&&name in self[0]?self[0][name]:value;this.each(function(){1==this.nodeType&&(this[name]=value)})}return self},css:function(name,value){function camel(name){return name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()})}function dashed(name){return name.replace(/[A-Z]/g,function(a){return"-"+a})}var elm,hook,self=this;if("object"==typeof name)each(name,function(name,value){self.css(name,value)});else if(isDefined(value))name=camel(name),"number"!=typeof value||numericCssMap[name]||(value+="px"),self.each(function(){var style=this.style;if(hook=cssHooks[name],hook&&hook.set)return void hook.set(this,value);try{this.style[cssFix[name]||name]=value}catch(ex){}null!==value&&""!==value||(style.removeProperty?style.removeProperty(dashed(name)):style.removeAttribute(name))});else{if(elm=self[0],hook=cssHooks[name],hook&&hook.get)return hook.get(elm);if(elm.ownerDocument.defaultView)try{return elm.ownerDocument.defaultView.getComputedStyle(elm,null).getPropertyValue(dashed(name))}catch(ex){return undef}else if(elm.currentStyle)return elm.currentStyle[camel(name)]}return self},remove:function(){for(var node,self=this,i=this.length;i--;)node=self[i],Event.clean(node),node.parentNode&&node.parentNode.removeChild(node);return this},empty:function(){for(var node,self=this,i=this.length;i--;)for(node=self[i];node.firstChild;)node.removeChild(node.firstChild);return this},html:function(value){var i,self=this;if(isDefined(value)){i=self.length;try{for(;i--;)self[i].innerHTML=value}catch(ex){DomQuery(self[i]).empty().append(value)}return self}return self[0]?self[0].innerHTML:""},text:function(value){var i,self=this;if(isDefined(value)){for(i=self.length;i--;)"innerText"in self[i]?self[i].innerText=value:self[0].textContent=value;return self}return self[0]?self[0].innerText||self[0].textContent:""},append:function(){return domManipulate(this,arguments,function(node){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(node)})},prepend:function(){return domManipulate(this,arguments,function(node){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(node,this.firstChild)},!0)},before:function(){var self=this;return self[0]&&self[0].parentNode?domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this)}):self},after:function(){var self=this;return self[0]&&self[0].parentNode?domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this.nextSibling)},!0):self},appendTo:function(val){return DomQuery(val).append(this),this},prependTo:function(val){return DomQuery(val).prepend(this),this},replaceWith:function(content){return this.before(content).remove()},wrap:function(content){return wrap(this,content)},wrapAll:function(content){return wrap(this,content,!0)},wrapInner:function(content){return this.each(function(){DomQuery(this).contents().wrapAll(content)}),this},unwrap:function(){return this.parent().each(function(){DomQuery(this).replaceWith(this.childNodes)})},clone:function(){var result=[];return this.each(function(){result.push(this.cloneNode(!0))}),DomQuery(result)},addClass:function(className){return this.toggleClass(className,!0)},removeClass:function(className){return this.toggleClass(className,!1)},toggleClass:function(className,state){var self=this;return"string"!=typeof className?self:(-1!==className.indexOf(" ")?each(className.split(" "),function(){self.toggleClass(this,state)}):self.each(function(index,node){var existingClassName,classState;classState=hasClass(node,className),classState!==state&&(existingClassName=node.className,classState?node.className=trim((" "+existingClassName+" ").replace(" "+className+" "," ")):node.className+=existingClassName?" "+className:className)}),self)},hasClass:function(className){return hasClass(this[0],className)},each:function(callback){return each(this,callback)},on:function(name,callback){return this.each(function(){Event.bind(this,name,callback)})},off:function(name,callback){return this.each(function(){Event.unbind(this,name,callback)})},trigger:function(name){return this.each(function(){"object"==typeof name?Event.fire(this,name.type,name):Event.fire(this,name)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new DomQuery(slice.apply(this,arguments))},eq:function(index){return-1===index?this.slice(index):this.slice(index,+index+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(selector){var i,l,ret=[];for(i=0,l=this.length;l>i;i++)DomQuery.find(selector,this[i],ret);return DomQuery(ret)},filter:function(selector){return DomQuery("function"==typeof selector?grep(this.toArray(),function(item,i){return selector(i,item)}):DomQuery.filter(selector,this.toArray()))},closest:function(selector){var result=[];return selector instanceof DomQuery&&(selector=selector[0]),this.each(function(i,node){for(;node;){if("string"==typeof selector&&DomQuery(node).is(selector)){result.push(node);break}if(node==selector){result.push(node);break}node=node.parentNode}}),DomQuery(result)},offset:function(offset){var elm,doc,docElm,pos,x=0,y=0;return offset?this.css(offset):(elm=this[0],elm&&(doc=elm.ownerDocument,docElm=doc.documentElement,elm.getBoundingClientRect&&(pos=elm.getBoundingClientRect(),x=pos.left+(docElm.scrollLeft||doc.body.scrollLeft)-docElm.clientLeft,y=pos.top+(docElm.scrollTop||doc.body.scrollTop)-docElm.clientTop)),{left:x,top:y})},push:push,sort:[].sort,splice:[].splice},Tools.extend(DomQuery,{extend:Tools.extend,makeArray:function(object){return isWindow(object)||object.nodeType?[object]:Tools.toArray(object)},inArray:inArray,isArray:Tools.isArray,each:each,trim:trim,grep:grep,find:Sizzle,expr:Sizzle.selectors,unique:Sizzle.uniqueSort,text:Sizzle.getText,contains:Sizzle.contains,filter:function(expr,elems,not){var i=elems.length;for(not&&(expr=":not("+expr+")");i--;)1!=elems[i].nodeType&&elems.splice(i,1);return elems=1===elems.length?DomQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:DomQuery.find.matches(expr,elems)}}),each({parent:function(node){var parent=node.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(node){return dir(node,"parentNode")},next:function(node){return firstSibling(node,"nextSibling",1)},prev:function(node){return firstSibling(node,"previousSibling",1)},children:function(node){return sibling(node.firstChild,"nextSibling",1)},contents:function(node){return Tools.toArray(("iframe"===node.nodeName?node.contentDocument||node.contentWindow.document:node).childNodes)}},function(name,fn){DomQuery.fn[name]=function(selector){var self=this,result=[];return self.each(function(){var nodes=fn.call(result,this,selector,result);nodes&&(DomQuery.isArray(nodes)?result.push.apply(result,nodes):result.push(nodes))}),this.length>1&&(skipUniques[name]||(result=DomQuery.unique(result)),0===name.indexOf("parents")&&(result=result.reverse())),result=DomQuery(result),selector?result.filter(selector):result}}),each({parentsUntil:function(node,until){return dir(node,"parentNode",until)},nextUntil:function(node,until){return sibling(node,"nextSibling",1,until).slice(1)},prevUntil:function(node,until){return sibling(node,"previousSibling",1,until).slice(1)}},function(name,fn){DomQuery.fn[name]=function(selector,filter){var self=this,result=[];return self.each(function(){var nodes=fn.call(result,this,selector,result);nodes&&(DomQuery.isArray(nodes)?result.push.apply(result,nodes):result.push(nodes))}),this.length>1&&(result=DomQuery.unique(result),0!==name.indexOf("parents")&&"prevUntil"!==name||(result=result.reverse())),result=DomQuery(result),filter?result.filter(filter):result}}),DomQuery.fn.is=function(selector){return!!selector&&this.filter(selector).length>0},DomQuery.fn.init.prototype=DomQuery.fn,DomQuery.overrideDefaults=function(callback){function sub(selector,context){return defaults=defaults||callback(),0===arguments.length&&(selector=defaults.element),context||(context=defaults.context),new sub.fn.init(selector,context)}var defaults;return DomQuery.extend(sub,this),sub},Env.ie&&Env.ie<8&&(appendHooks(attrHooks,"get",{maxlength:function(elm){var value=elm.maxLength;return 2147483647===value?undef:value},size:function(elm){var value=elm.size;return 20===value?undef:value},"class":function(elm){return elm.className},style:function(elm){var value=elm.style.cssText;return 0===value.length?undef:value}}),appendHooks(attrHooks,"set",{"class":function(elm,value){elm.className=value},style:function(elm,value){elm.style.cssText=value}})),Env.ie&&Env.ie<9&&(cssFix["float"]="styleFloat",appendHooks(cssHooks,"set",{opacity:function(elm,value){var style=elm.style;null===value||""===value?style.removeAttribute("filter"):(style.zoom=1,style.filter="alpha(opacity="+100*value+")")}})),DomQuery.attrHooks=attrHooks,DomQuery.cssHooks=cssHooks,DomQuery}),define("tinymce/html/Styles",[],function(){return function(settings,schema){function toHex(match,r,g,b){function hex(val){return val=parseInt(val,10).toString(16),val.length>1?val:"0"+val}return"#"+hex(r)+hex(g)+hex(b)}var undef,i,encodingItems,validStyles,invalidStyles,rgbRegExp=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,urlOrStrRegExp=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,styleRegExp=/\s*([^:]+):\s*([^;]+);?/g,trimRightRegExp=/\s+$/,encodingLookup={},invisibleChar="\ufeff";for(settings=settings||{},schema&&(validStyles=schema.getValidStyles(),invalidStyles=schema.getInvalidStyles()),encodingItems=("\\\" \\' \\; \\: ; : "+invisibleChar).split(" "),i=0;i<encodingItems.length;i++)encodingLookup[encodingItems[i]]=invisibleChar+i,encodingLookup[invisibleChar+i]=encodingItems[i];return{toHex:function(color){return color.replace(rgbRegExp,toHex)},parse:function(css){function compress(prefix,suffix,noJoin){var top,right,bottom,left;if(top=styles[prefix+"-top"+suffix],top&&(right=styles[prefix+"-right"+suffix],right&&(bottom=styles[prefix+"-bottom"+suffix],bottom&&(left=styles[prefix+"-left"+suffix])))){var box=[top,right,bottom,left];for(i=box.length-1;i--&&box[i]===box[i+1];);i>-1&&noJoin||(styles[prefix+suffix]=-1==i?box[0]:box.join(" "),delete styles[prefix+"-top"+suffix],delete styles[prefix+"-right"+suffix],delete styles[prefix+"-bottom"+suffix],delete styles[prefix+"-left"+suffix])}}function canCompress(key){var i,value=styles[key];if(value){for(value=value.split(" "),i=value.length;i--;)if(value[i]!==value[0])return!1;return styles[key]=value[0],!0}}function compress2(target,a,b,c){canCompress(a)&&canCompress(b)&&canCompress(c)&&(styles[target]=styles[a]+" "+styles[b]+" "+styles[c],delete styles[a],delete styles[b],delete styles[c])}function encode(str){return isEncoded=!0,encodingLookup[str]}function decode(str,keep_slashes){return isEncoded&&(str=str.replace(/\uFEFF[0-9]/g,function(str){return encodingLookup[str]})),keep_slashes||(str=str.replace(/\\([\'\";:])/g,"$1")),str}function processUrl(match,url,url2,url3,str,str2){if(str=str||str2)return str=decode(str),"'"+str.replace(/\'/g,"\\'")+"'";if(url=decode(url||url2||url3),!settings.allow_script_urls){var scriptUrl=url.replace(/[\s\r\n]+/,"");if(/(java|vb)script:/i.test(scriptUrl))return"";if(!settings.allow_svg_data_urls&&/^data:image\/svg/i.test(scriptUrl))return""}return urlConverter&&(url=urlConverter.call(urlConverterScope,url,"style")),"url('"+url.replace(/\'/g,"\\'")+"')"}var matches,name,value,isEncoded,styles={},urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope||this;if(css){for(css=css.replace(/[\u0000-\u001F]/g,""),css=css.replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(str){return str.replace(/[;:]/g,encode);
});matches=styleRegExp.exec(css);){if(name=matches[1].replace(trimRightRegExp,"").toLowerCase(),value=matches[2].replace(trimRightRegExp,""),value=value.replace(/\\[0-9a-f]+/g,function(e){return String.fromCharCode(parseInt(e.substr(1),16))}),name&&value.length>0){if(!settings.allow_script_urls&&("behavior"==name||/expression\s*\(|\/\*|\*\//.test(value)))continue;"font-weight"===name&&"700"===value?value="bold":"color"!==name&&"background-color"!==name||(value=value.toLowerCase()),value=value.replace(rgbRegExp,toHex),value=value.replace(urlOrStrRegExp,processUrl),styles[name]=isEncoded?decode(value,!0):value}styleRegExp.lastIndex=matches.index+matches[0].length}compress("border","",!0),compress("border","-width"),compress("border","-color"),compress("border","-style"),compress("padding",""),compress("margin",""),compress2("border","border-width","border-style","border-color"),"medium none"===styles.border&&delete styles.border,"none"===styles["border-image"]&&delete styles["border-image"]}return styles},serialize:function(styles,elementName){function serializeStyles(name){var styleList,i,l,value;if(styleList=validStyles[name])for(i=0,l=styleList.length;l>i;i++)name=styleList[i],value=styles[name],value!==undef&&value.length>0&&(css+=(css.length>0?" ":"")+name+": "+value+";")}function isValid(name,elementName){var styleMap;return styleMap=invalidStyles["*"],styleMap&&styleMap[name]?!1:(styleMap=invalidStyles[elementName],!styleMap||!styleMap[name])}var name,value,css="";if(elementName&&validStyles)serializeStyles("*"),serializeStyles(elementName);else for(name in styles)value=styles[name],value!==undef&&value.length>0&&(invalidStyles&&!isValid(name,elementName)||(css+=(css.length>0?" ":"")+name+": "+value+";"));return css}}}}),define("tinymce/dom/TreeWalker",[],function(){return function(startNode,rootNode){function findSibling(node,startName,siblingName,shallow){var sibling,parent;if(node){if(!shallow&&node[startName])return node[startName];if(node!=rootNode){if(sibling=node[siblingName])return sibling;for(parent=node.parentNode;parent&&parent!=rootNode;parent=parent.parentNode)if(sibling=parent[siblingName])return sibling}}}function findPreviousNode(node,startName,siblingName,shallow){var sibling,parent,child;if(node){if(sibling=node[siblingName],rootNode&&sibling===rootNode)return;if(sibling){if(!shallow)for(child=sibling[startName];child;child=child[startName])if(!child[startName])return child;return sibling}if(parent=node.parentNode,parent&&parent!==rootNode)return parent}}var node=startNode;this.current=function(){return node},this.next=function(shallow){return node=findSibling(node,"firstChild","nextSibling",shallow)},this.prev=function(shallow){return node=findSibling(node,"lastChild","previousSibling",shallow)},this.prev2=function(shallow){return node=findPreviousNode(node,"lastChild","previousSibling",shallow)}}}),define("tinymce/dom/Range",["tinymce/util/Tools"],function(Tools){function Range(dom){function createDocumentFragment(){return doc.createDocumentFragment()}function setStart(n,o){_setEndPoint(TRUE,n,o)}function setEnd(n,o){_setEndPoint(FALSE,n,o)}function setStartBefore(n){setStart(n.parentNode,nodeIndex(n))}function setStartAfter(n){setStart(n.parentNode,nodeIndex(n)+1)}function setEndBefore(n){setEnd(n.parentNode,nodeIndex(n))}function setEndAfter(n){setEnd(n.parentNode,nodeIndex(n)+1)}function collapse(ts){ts?(self[END_CONTAINER]=self[START_CONTAINER],self[END_OFFSET]=self[START_OFFSET]):(self[START_CONTAINER]=self[END_CONTAINER],self[START_OFFSET]=self[END_OFFSET]),self.collapsed=TRUE}function selectNode(n){setStartBefore(n),setEndAfter(n)}function selectNodeContents(n){setStart(n,0),setEnd(n,1===n.nodeType?n.childNodes.length:n.nodeValue.length)}function compareBoundaryPoints(h,r){var sc=self[START_CONTAINER],so=self[START_OFFSET],ec=self[END_CONTAINER],eo=self[END_OFFSET],rsc=r.startContainer,rso=r.startOffset,rec=r.endContainer,reo=r.endOffset;return 0===h?_compareBoundaryPoints(sc,so,rsc,rso):1===h?_compareBoundaryPoints(ec,eo,rsc,rso):2===h?_compareBoundaryPoints(ec,eo,rec,reo):3===h?_compareBoundaryPoints(sc,so,rec,reo):void 0}function deleteContents(){_traverse(DELETE)}function extractContents(){return _traverse(EXTRACT)}function cloneContents(){return _traverse(CLONE)}function insertNode(n){var nn,o,startContainer=this[START_CONTAINER],startOffset=this[START_OFFSET];3!==startContainer.nodeType&&4!==startContainer.nodeType||!startContainer.nodeValue?(startContainer.childNodes.length>0&&(o=startContainer.childNodes[startOffset]),o?startContainer.insertBefore(n,o):3==startContainer.nodeType?dom.insertAfter(n,startContainer):startContainer.appendChild(n)):startOffset?startOffset>=startContainer.nodeValue.length?dom.insertAfter(n,startContainer):(nn=startContainer.splitText(startOffset),startContainer.parentNode.insertBefore(n,nn)):startContainer.parentNode.insertBefore(n,startContainer)}function surroundContents(n){var f=self.extractContents();self.insertNode(n),n.appendChild(f),self.selectNode(n)}function cloneRange(){return extend(new Range(dom),{startContainer:self[START_CONTAINER],startOffset:self[START_OFFSET],endContainer:self[END_CONTAINER],endOffset:self[END_OFFSET],collapsed:self.collapsed,commonAncestorContainer:self.commonAncestorContainer})}function _getSelectedNode(container,offset){var child;if(3==container.nodeType)return container;if(0>offset)return container;for(child=container.firstChild;child&&offset>0;)--offset,child=child.nextSibling;return child?child:container}function _isCollapsed(){return self[START_CONTAINER]==self[END_CONTAINER]&&self[START_OFFSET]==self[END_OFFSET]}function _compareBoundaryPoints(containerA,offsetA,containerB,offsetB){var c,offsetC,n,cmnRoot,childA,childB;if(containerA==containerB)return offsetA==offsetB?0:offsetB>offsetA?-1:1;for(c=containerB;c&&c.parentNode!=containerA;)c=c.parentNode;if(c){for(offsetC=0,n=containerA.firstChild;n!=c&&offsetA>offsetC;)offsetC++,n=n.nextSibling;return offsetC>=offsetA?-1:1}for(c=containerA;c&&c.parentNode!=containerB;)c=c.parentNode;if(c){for(offsetC=0,n=containerB.firstChild;n!=c&&offsetB>offsetC;)offsetC++,n=n.nextSibling;return offsetB>offsetC?-1:1}for(cmnRoot=dom.findCommonAncestor(containerA,containerB),childA=containerA;childA&&childA.parentNode!=cmnRoot;)childA=childA.parentNode;for(childA||(childA=cmnRoot),childB=containerB;childB&&childB.parentNode!=cmnRoot;)childB=childB.parentNode;if(childB||(childB=cmnRoot),childA==childB)return 0;for(n=cmnRoot.firstChild;n;){if(n==childA)return-1;if(n==childB)return 1;n=n.nextSibling}}function _setEndPoint(st,n,o){var ec,sc;for(st?(self[START_CONTAINER]=n,self[START_OFFSET]=o):(self[END_CONTAINER]=n,self[END_OFFSET]=o),ec=self[END_CONTAINER];ec.parentNode;)ec=ec.parentNode;for(sc=self[START_CONTAINER];sc.parentNode;)sc=sc.parentNode;sc==ec?_compareBoundaryPoints(self[START_CONTAINER],self[START_OFFSET],self[END_CONTAINER],self[END_OFFSET])>0&&self.collapse(st):self.collapse(st),self.collapsed=_isCollapsed(),self.commonAncestorContainer=dom.findCommonAncestor(self[START_CONTAINER],self[END_CONTAINER])}function _traverse(how){var c,p,depthDiff,startNode,endNode,sp,ep,endContainerDepth=0,startContainerDepth=0;if(self[START_CONTAINER]==self[END_CONTAINER])return _traverseSameContainer(how);for(c=self[END_CONTAINER],p=c.parentNode;p;c=p,p=p.parentNode){if(p==self[START_CONTAINER])return _traverseCommonStartContainer(c,how);++endContainerDepth}for(c=self[START_CONTAINER],p=c.parentNode;p;c=p,p=p.parentNode){if(p==self[END_CONTAINER])return _traverseCommonEndContainer(c,how);++startContainerDepth}for(depthDiff=startContainerDepth-endContainerDepth,startNode=self[START_CONTAINER];depthDiff>0;)startNode=startNode.parentNode,depthDiff--;for(endNode=self[END_CONTAINER];0>depthDiff;)endNode=endNode.parentNode,depthDiff++;for(sp=startNode.parentNode,ep=endNode.parentNode;sp!=ep;sp=sp.parentNode,ep=ep.parentNode)startNode=sp,endNode=ep;return _traverseCommonAncestors(startNode,endNode,how)}function _traverseSameContainer(how){var frag,s,sub,n,cnt,sibling,xferNode,start,len;if(how!=DELETE&&(frag=createDocumentFragment()),self[START_OFFSET]==self[END_OFFSET])return frag;if(3==self[START_CONTAINER].nodeType){if(s=self[START_CONTAINER].nodeValue,sub=s.substring(self[START_OFFSET],self[END_OFFSET]),how!=CLONE&&(n=self[START_CONTAINER],start=self[START_OFFSET],len=self[END_OFFSET]-self[START_OFFSET],0===start&&len>=n.nodeValue.length-1?n.parentNode.removeChild(n):n.deleteData(start,len),self.collapse(TRUE)),how==DELETE)return;return sub.length>0&&frag.appendChild(doc.createTextNode(sub)),frag}for(n=_getSelectedNode(self[START_CONTAINER],self[START_OFFSET]),cnt=self[END_OFFSET]-self[START_OFFSET];n&&cnt>0;)sibling=n.nextSibling,xferNode=_traverseFullySelected(n,how),frag&&frag.appendChild(xferNode),--cnt,n=sibling;return how!=CLONE&&self.collapse(TRUE),frag}function _traverseCommonStartContainer(endAncestor,how){var frag,n,endIdx,cnt,sibling,xferNode;if(how!=DELETE&&(frag=createDocumentFragment()),n=_traverseRightBoundary(endAncestor,how),frag&&frag.appendChild(n),endIdx=nodeIndex(endAncestor),cnt=endIdx-self[START_OFFSET],0>=cnt)return how!=CLONE&&(self.setEndBefore(endAncestor),self.collapse(FALSE)),frag;for(n=endAncestor.previousSibling;cnt>0;)sibling=n.previousSibling,xferNode=_traverseFullySelected(n,how),frag&&frag.insertBefore(xferNode,frag.firstChild),--cnt,n=sibling;return how!=CLONE&&(self.setEndBefore(endAncestor),self.collapse(FALSE)),frag}function _traverseCommonEndContainer(startAncestor,how){var frag,startIdx,n,cnt,sibling,xferNode;for(how!=DELETE&&(frag=createDocumentFragment()),n=_traverseLeftBoundary(startAncestor,how),frag&&frag.appendChild(n),startIdx=nodeIndex(startAncestor),++startIdx,cnt=self[END_OFFSET]-startIdx,n=startAncestor.nextSibling;n&&cnt>0;)sibling=n.nextSibling,xferNode=_traverseFullySelected(n,how),frag&&frag.appendChild(xferNode),--cnt,n=sibling;return how!=CLONE&&(self.setStartAfter(startAncestor),self.collapse(TRUE)),frag}function _traverseCommonAncestors(startAncestor,endAncestor,how){var n,frag,startOffset,endOffset,cnt,sibling,nextSibling;for(how!=DELETE&&(frag=createDocumentFragment()),n=_traverseLeftBoundary(startAncestor,how),frag&&frag.appendChild(n),startOffset=nodeIndex(startAncestor),endOffset=nodeIndex(endAncestor),++startOffset,cnt=endOffset-startOffset,sibling=startAncestor.nextSibling;cnt>0;)nextSibling=sibling.nextSibling,n=_traverseFullySelected(sibling,how),frag&&frag.appendChild(n),sibling=nextSibling,--cnt;return n=_traverseRightBoundary(endAncestor,how),frag&&frag.appendChild(n),how!=CLONE&&(self.setStartAfter(startAncestor),self.collapse(TRUE)),frag}function _traverseRightBoundary(root,how){var parent,clonedParent,prevSibling,clonedChild,clonedGrandParent,next=_getSelectedNode(self[END_CONTAINER],self[END_OFFSET]-1),isFullySelected=next!=self[END_CONTAINER];if(next==root)return _traverseNode(next,isFullySelected,FALSE,how);for(parent=next.parentNode,clonedParent=_traverseNode(parent,FALSE,FALSE,how);parent;){for(;next;)prevSibling=next.previousSibling,clonedChild=_traverseNode(next,isFullySelected,FALSE,how),how!=DELETE&&clonedParent.insertBefore(clonedChild,clonedParent.firstChild),isFullySelected=TRUE,next=prevSibling;if(parent==root)return clonedParent;next=parent.previousSibling,parent=parent.parentNode,clonedGrandParent=_traverseNode(parent,FALSE,FALSE,how),how!=DELETE&&clonedGrandParent.appendChild(clonedParent),clonedParent=clonedGrandParent}}function _traverseLeftBoundary(root,how){var parent,clonedParent,nextSibling,clonedChild,clonedGrandParent,next=_getSelectedNode(self[START_CONTAINER],self[START_OFFSET]),isFullySelected=next!=self[START_CONTAINER];if(next==root)return _traverseNode(next,isFullySelected,TRUE,how);for(parent=next.parentNode,clonedParent=_traverseNode(parent,FALSE,TRUE,how);parent;){for(;next;)nextSibling=next.nextSibling,clonedChild=_traverseNode(next,isFullySelected,TRUE,how),how!=DELETE&&clonedParent.appendChild(clonedChild),isFullySelected=TRUE,next=nextSibling;if(parent==root)return clonedParent;next=parent.nextSibling,parent=parent.parentNode,clonedGrandParent=_traverseNode(parent,FALSE,TRUE,how),how!=DELETE&&clonedGrandParent.appendChild(clonedParent),clonedParent=clonedGrandParent}}function _traverseNode(n,isFullySelected,isLeft,how){var txtValue,newNodeValue,oldNodeValue,offset,newNode;if(isFullySelected)return _traverseFullySelected(n,how);if(3==n.nodeType){if(txtValue=n.nodeValue,isLeft?(offset=self[START_OFFSET],newNodeValue=txtValue.substring(offset),oldNodeValue=txtValue.substring(0,offset)):(offset=self[END_OFFSET],newNodeValue=txtValue.substring(0,offset),oldNodeValue=txtValue.substring(offset)),how!=CLONE&&(n.nodeValue=oldNodeValue),how==DELETE)return;return newNode=dom.clone(n,FALSE),newNode.nodeValue=newNodeValue,newNode}return how!=DELETE?dom.clone(n,FALSE):void 0}function _traverseFullySelected(n,how){return how!=DELETE?how==CLONE?dom.clone(n,TRUE):n:void n.parentNode.removeChild(n)}function toStringIE(){return dom.create("body",null,cloneContents()).outerText}var self=this,doc=dom.doc,EXTRACT=0,CLONE=1,DELETE=2,TRUE=!0,FALSE=!1,START_OFFSET="startOffset",START_CONTAINER="startContainer",END_CONTAINER="endContainer",END_OFFSET="endOffset",extend=Tools.extend,nodeIndex=dom.nodeIndex;return extend(self,{startContainer:doc,startOffset:0,endContainer:doc,endOffset:0,collapsed:TRUE,commonAncestorContainer:doc,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:setStart,setEnd:setEnd,setStartBefore:setStartBefore,setStartAfter:setStartAfter,setEndBefore:setEndBefore,setEndAfter:setEndAfter,collapse:collapse,selectNode:selectNode,selectNodeContents:selectNodeContents,compareBoundaryPoints:compareBoundaryPoints,deleteContents:deleteContents,extractContents:extractContents,cloneContents:cloneContents,insertNode:insertNode,surroundContents:surroundContents,cloneRange:cloneRange,toStringIE:toStringIE}),self}return Range.prototype.toString=function(){return this.toStringIE()},Range}),define("tinymce/html/Entities",["tinymce/util/Tools"],function(Tools){function nativeDecode(text){var elm;return elm=document.createElement("div"),elm.innerHTML=text,elm.textContent||elm.innerText||text}function buildEntitiesLookup(items,radix){var i,chr,entity,lookup={};if(items){for(items=items.split(","),radix=radix||10,i=0;i<items.length;i+=2)chr=String.fromCharCode(parseInt(items[i],radix)),baseEntities[chr]||(entity="&"+items[i+1]+";",lookup[chr]=entity,lookup[entity]=chr);return lookup}}var namedEntities,baseEntities,reverseEntities,makeMap=Tools.makeMap,attrsCharsRegExp=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,textCharsRegExp=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rawCharsRegExp=/[<>&\"\']/g,entityRegExp=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,asciiMap={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"};baseEntities={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},reverseEntities={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},namedEntities=buildEntitiesLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var Entities={encodeRaw:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeAllRaw:function(text){return(""+text).replace(rawCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeNumeric:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return chr.length>1?"&#"+(1024*(chr.charCodeAt(0)-55296)+(chr.charCodeAt(1)-56320)+65536)+";":baseEntities[chr]||"&#"+chr.charCodeAt(0)+";"})},encodeNamed:function(text,attr,entities){return entities=entities||namedEntities,text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||chr})},getEncodeFunc:function(name,entities){function encodeNamedAndNumeric(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||"&#"+chr.charCodeAt(0)+";"||chr})}function encodeCustomNamed(text,attr){return Entities.encodeNamed(text,attr,entities)}return entities=buildEntitiesLookup(entities)||namedEntities,name=makeMap(name.replace(/\+/g,",")),name.named&&name.numeric?encodeNamedAndNumeric:name.named?entities?encodeCustomNamed:Entities.encodeNamed:name.numeric?Entities.encodeNumeric:Entities.encodeRaw},decode:function(text){return text.replace(entityRegExp,function(all,numeric){return numeric?(numeric="x"===numeric.charAt(0).toLowerCase()?parseInt(numeric.substr(1),16):parseInt(numeric,10),numeric>65535?(numeric-=65536,String.fromCharCode(55296+(numeric>>10),56320+(1023&numeric))):asciiMap[numeric]||String.fromCharCode(numeric)):reverseEntities[all]||namedEntities[all]||nativeDecode(all)})}};return Entities}),define("tinymce/dom/StyleSheetLoader",["tinymce/util/Tools","tinymce/util/Delay"],function(Tools,Delay){return function(document,settings){function appendToHead(node){document.getElementsByTagName("head")[0].appendChild(node)}function load(url,loadedCallback,errorCallback){function passed(){for(var callbacks=state.passed,i=callbacks.length;i--;)callbacks[i]();state.status=2,state.passed=[],state.failed=[]}function failed(){for(var callbacks=state.failed,i=callbacks.length;i--;)callbacks[i]();state.status=3,state.passed=[],state.failed=[]}function isOldWebKit(){var webKitChunks=navigator.userAgent.match(/WebKit\/(\d*)/);return!!(webKitChunks&&webKitChunks[1]<536)}function wait(testCallback,waitCallback){testCallback()||((new Date).getTime()-startTime<maxLoadTime?Delay.setTimeout(waitCallback):failed())}function waitForWebKitLinkLoaded(){wait(function(){for(var styleSheet,owner,styleSheets=document.styleSheets,i=styleSheets.length;i--;)if(styleSheet=styleSheets[i],owner=styleSheet.ownerNode?styleSheet.ownerNode:styleSheet.owningElement,owner&&owner.id===link.id)return passed(),!0},waitForWebKitLinkLoaded)}function waitForGeckoLinkLoaded(){wait(function(){try{var cssRules=style.sheet.cssRules;return passed(),!!cssRules}catch(ex){}},waitForGeckoLinkLoaded)}var link,style,startTime,state;if(url=Tools._addCacheSuffix(url),loadedStates[url]?state=loadedStates[url]:(state={passed:[],failed:[]},loadedStates[url]=state),loadedCallback&&state.passed.push(loadedCallback),errorCallback&&state.failed.push(errorCallback),1!=state.status){if(2==state.status)return void passed();if(3==state.status)return void failed();if(state.status=1,link=document.createElement("link"),link.rel="stylesheet",link.type="text/css",link.id="u"+idCount++,link.async=!1,link.defer=!1,startTime=(new Date).getTime(),"onload"in link&&!isOldWebKit())link.onload=waitForWebKitLinkLoaded,link.onerror=failed;else{if(navigator.userAgent.indexOf("Firefox")>0)return style=document.createElement("style"),style.textContent='@import "'+url+'"',waitForGeckoLinkLoaded(),void appendToHead(style);waitForWebKitLinkLoaded()}appendToHead(link),link.href=url}}var maxLoadTime,idCount=0,loadedStates={};settings=settings||{},maxLoadTime=settings.maxLoadTime||5e3,this.load=load}}),define("tinymce/dom/DOMUtils",["tinymce/dom/Sizzle","tinymce/dom/DomQuery","tinymce/html/Styles","tinymce/dom/EventUtils","tinymce/dom/TreeWalker","tinymce/dom/Range","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools","tinymce/dom/StyleSheetLoader"],function(Sizzle,$,Styles,EventUtils,TreeWalker,Range,Entities,Env,Tools,StyleSheetLoader){function setupAttrHooks(domUtils,settings){var keepUrlHook,attrHooks={},keepValues=settings.keep_values;return keepUrlHook={set:function($elm,value,name){settings.url_converter&&(value=settings.url_converter.call(settings.url_converter_scope||domUtils,value,name,$elm[0])),$elm.attr("data-mce-"+name,value).attr(name,value)},get:function($elm,name){return $elm.attr("data-mce-"+name)||$elm.attr(name)}},attrHooks={style:{set:function($elm,value){return null!==value&&"object"==typeof value?void $elm.css(value):(keepValues&&$elm.attr("data-mce-style",value),void $elm.attr("style",value))},get:function($elm){var value=$elm.attr("data-mce-style")||$elm.attr("style");return value=domUtils.serializeStyle(domUtils.parseStyle(value),$elm[0].nodeName)}}},keepValues&&(attrHooks.href=attrHooks.src=keepUrlHook),attrHooks}function updateInternalStyleAttr(domUtils,$elm){var value=$elm.attr("style");value=domUtils.serializeStyle(domUtils.parseStyle(value),$elm[0].nodeName),value||(value=null),$elm.attr("data-mce-style",value)}function nodeIndex(node,normalized){var lastNodeType,nodeType,idx=0;if(node)for(lastNodeType=node.nodeType,node=node.previousSibling;node;node=node.previousSibling)nodeType=node.nodeType,(!normalized||3!=nodeType||nodeType!=lastNodeType&&node.nodeValue.length)&&(idx++,lastNodeType=nodeType);return idx}function DOMUtils(doc,settings){var blockElementsMap,self=this;self.doc=doc,self.win=window,self.files={},self.counter=0,self.stdMode=!isIE||doc.documentMode>=8,self.boxModel=!isIE||"CSS1Compat"==doc.compatMode||self.stdMode,self.styleSheetLoader=new StyleSheetLoader(doc),self.boundEvents=[],self.settings=settings=settings||{},self.schema=settings.schema,self.styles=new Styles({url_converter:settings.url_converter,url_converter_scope:settings.url_converter_scope},settings.schema),self.fixDoc(doc),self.events=settings.ownEvents?new EventUtils(settings.proxy):EventUtils.Event,self.attrHooks=setupAttrHooks(self,settings),blockElementsMap=settings.schema?settings.schema.getBlockElements():{},self.$=$.overrideDefaults(function(){return{context:doc,element:self.getRoot()}}),self.isBlock=function(node){if(!node)return!1;var type=node.nodeType;return type?!(1!==type||!blockElementsMap[node.nodeName]):!!blockElementsMap[node]}}var each=Tools.each,is=Tools.is,grep=Tools.grep,trim=Tools.trim,isIE=Env.ie,simpleSelectorRe=/^([a-z0-9],?)+$/i,whiteSpaceRegExp=/^[ \t\r\n]*$/;return DOMUtils.prototype={$$:function(elm){return"string"==typeof elm&&(elm=this.get(elm)),this.$(elm)},root:null,fixDoc:function(doc){var name,settings=this.settings;if(isIE&&settings.schema){"abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g,function(name){doc.createElement(name)});for(name in settings.schema.getCustomElements())doc.createElement(name)}},clone:function(node,deep){var clone,doc,self=this;return!isIE||1!==node.nodeType||deep?node.cloneNode(deep):(doc=self.doc,deep?clone.firstChild:(clone=doc.createElement(node.nodeName),each(self.getAttribs(node),function(attr){self.setAttrib(clone,attr.nodeName,self.getAttrib(node,attr.nodeName))}),clone))},getRoot:function(){var self=this;return self.settings.root_element||self.doc.body},getViewPort:function(win){var doc,rootElm;return win=win?win:this.win,doc=win.document,rootElm=this.boxModel?doc.documentElement:doc.body,{x:win.pageXOffset||rootElm.scrollLeft,y:win.pageYOffset||rootElm.scrollTop,w:win.innerWidth||rootElm.clientWidth,h:win.innerHeight||rootElm.clientHeight}},getRect:function(elm){var pos,size,self=this;return elm=self.get(elm),pos=self.getPos(elm),size=self.getSize(elm),{x:pos.x,y:pos.y,w:size.w,h:size.h}},getSize:function(elm){var w,h,self=this;return elm=self.get(elm),w=self.getStyle(elm,"width"),h=self.getStyle(elm,"height"),-1===w.indexOf("px")&&(w=0),-1===h.indexOf("px")&&(h=0),{w:parseInt(w,10)||elm.offsetWidth||elm.clientWidth,h:parseInt(h,10)||elm.offsetHeight||elm.clientHeight}},getParent:function(node,selector,root){return this.getParents(node,selector,root,!1)},getParents:function(node,selector,root,collect){var selectorVal,self=this,result=[];for(node=self.get(node),collect=collect===undefined,root=root||("BODY"!=self.getRoot().nodeName?self.getRoot().parentNode:null),is(selector,"string")&&(selectorVal=selector,selector="*"===selector?function(node){return 1==node.nodeType}:function(node){return self.is(node,selectorVal)});node&&node!=root&&node.nodeType&&9!==node.nodeType;){if(!selector||selector(node)){if(!collect)return node;result.push(node)}node=node.parentNode}return collect?result:null},get:function(elm){var name;return elm&&this.doc&&"string"==typeof elm&&(name=elm,elm=this.doc.getElementById(elm),elm&&elm.id!==name)?this.doc.getElementsByName(name)[1]:elm},getNext:function(node,selector){return this._findSib(node,selector,"nextSibling")},getPrev:function(node,selector){return this._findSib(node,selector,"previousSibling")},select:function(selector,scope){var self=this;return Sizzle(selector,self.get(scope)||self.settings.root_element||self.doc,[])},is:function(elm,selector){var i;if(elm.length===undefined){if("*"===selector)return 1==elm.nodeType;if(simpleSelectorRe.test(selector)){for(selector=selector.toLowerCase().split(/,/),elm=elm.nodeName.toLowerCase(),i=selector.length-1;i>=0;i--)if(selector[i]==elm)return!0;return!1}}if(elm.nodeType&&1!=elm.nodeType)return!1;var elms=elm.nodeType?[elm]:elm;return Sizzle(selector,elms[0].ownerDocument||elms[0],null,elms).length>0},add:function(parentElm,name,attrs,html,create){var self=this;return this.run(parentElm,function(parentElm){var newElm;return newElm=is(name,"string")?self.doc.createElement(name):name,self.setAttribs(newElm,attrs),html&&(html.nodeType?newElm.appendChild(html):self.setHTML(newElm,html)),create?newElm:parentElm.appendChild(newElm)})},create:function(name,attrs,html){return this.add(this.doc.createElement(name),name,attrs,html,1)},createHTML:function(name,attrs,html){var key,outHtml="";outHtml+="<"+name;for(key in attrs)attrs.hasOwnProperty(key)&&null!==attrs[key]&&"undefined"!=typeof attrs[key]&&(outHtml+=" "+key+'="'+this.encode(attrs[key])+'"');return"undefined"!=typeof html?outHtml+">"+html+"</"+name+">":outHtml+" />"},createFragment:function(html){var frag,node,container,doc=this.doc;for(container=doc.createElement("div"),frag=doc.createDocumentFragment(),html&&(container.innerHTML=html);node=container.firstChild;)frag.appendChild(node);return frag},remove:function(node,keepChildren){return node=this.$$(node),keepChildren?node.each(function(){for(var child;child=this.firstChild;)3==child.nodeType&&0===child.data.length?this.removeChild(child):this.parentNode.insertBefore(child,this)}).remove():node.remove(),node.length>1?node.toArray():node[0]},setStyle:function(elm,name,value){elm=this.$$(elm).css(name,value),this.settings.update_styles&&updateInternalStyleAttr(this,elm)},getStyle:function(elm,name,computed){return elm=this.$$(elm),computed?elm.css(name):(name=name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()}),"float"==name&&(name=Env.ie&&Env.ie<12?"styleFloat":"cssFloat"),elm[0]&&elm[0].style?elm[0].style[name]:undefined)},setStyles:function(elm,styles){elm=this.$$(elm).css(styles),this.settings.update_styles&&updateInternalStyleAttr(this,elm)},removeAllAttribs:function(e){return this.run(e,function(e){var i,attrs=e.attributes;for(i=attrs.length-1;i>=0;i--)e.removeAttributeNode(attrs.item(i))})},setAttrib:function(elm,name,value){var originalValue,hook,self=this,settings=self.settings;""===value&&(value=null),elm=self.$$(elm),originalValue=elm.attr(name),elm.length&&(hook=self.attrHooks[name],hook&&hook.set?hook.set(elm,value,name):elm.attr(name,value),originalValue!=value&&settings.onSetAttrib&&settings.onSetAttrib({attrElm:elm,attrName:name,attrValue:value}))},setAttribs:function(elm,attrs){var self=this;self.$$(elm).each(function(i,node){each(attrs,function(value,name){self.setAttrib(node,name,value)})})},getAttrib:function(elm,name,defaultVal){var hook,value,self=this;return elm=self.$$(elm),elm.length&&(hook=self.attrHooks[name],value=hook&&hook.get?hook.get(elm,name):elm.attr(name)),"undefined"==typeof value&&(value=defaultVal||""),value},getPos:function(elm,rootElm){var offsetParent,pos,self=this,x=0,y=0,doc=self.doc,body=doc.body;if(elm=self.get(elm),rootElm=rootElm||body,elm){if(rootElm===body&&elm.getBoundingClientRect&&"static"===$(body).css("position"))return pos=elm.getBoundingClientRect(),rootElm=self.boxModel?doc.documentElement:body,x=pos.left+(doc.documentElement.scrollLeft||body.scrollLeft)-rootElm.clientLeft,y=pos.top+(doc.documentElement.scrollTop||body.scrollTop)-rootElm.clientTop,{x:x,y:y};for(offsetParent=elm;offsetParent&&offsetParent!=rootElm&&offsetParent.nodeType;)x+=offsetParent.offsetLeft||0,y+=offsetParent.offsetTop||0,offsetParent=offsetParent.offsetParent;for(offsetParent=elm.parentNode;offsetParent&&offsetParent!=rootElm&&offsetParent.nodeType;)x-=offsetParent.scrollLeft||0,y-=offsetParent.scrollTop||0,offsetParent=offsetParent.parentNode}return{x:x,y:y}},parseStyle:function(cssText){return this.styles.parse(cssText)},serializeStyle:function(styles,name){return this.styles.serialize(styles,name)},addStyle:function(cssText){var head,styleElm,self=this,doc=self.doc;if(self!==DOMUtils.DOM&&doc===document){var addedStyles=DOMUtils.DOM.addedStyles;if(addedStyles=addedStyles||[],addedStyles[cssText])return;addedStyles[cssText]=!0,DOMUtils.DOM.addedStyles=addedStyles}styleElm=doc.getElementById("mceDefaultStyles"),styleElm||(styleElm=doc.createElement("style"),styleElm.id="mceDefaultStyles",styleElm.type="text/css",head=doc.getElementsByTagName("head")[0],head.firstChild?head.insertBefore(styleElm,head.firstChild):head.appendChild(styleElm)),styleElm.styleSheet?styleElm.styleSheet.cssText+=cssText:styleElm.appendChild(doc.createTextNode(cssText))},loadCSS:function(url){var head,self=this,doc=self.doc;return self!==DOMUtils.DOM&&doc===document?void DOMUtils.DOM.loadCSS(url):(url||(url=""),head=doc.getElementsByTagName("head")[0],void each(url.split(","),function(url){var link;url=Tools._addCacheSuffix(url),self.files[url]||(self.files[url]=!0,link=self.create("link",{rel:"stylesheet",
href:url}),isIE&&doc.documentMode&&doc.recalc&&(link.onload=function(){doc.recalc&&doc.recalc(),link.onload=null}),head.appendChild(link))}))},addClass:function(elm,cls){this.$$(elm).addClass(cls)},removeClass:function(elm,cls){this.toggleClass(elm,cls,!1)},hasClass:function(elm,cls){return this.$$(elm).hasClass(cls)},toggleClass:function(elm,cls,state){this.$$(elm).toggleClass(cls,state).each(function(){""===this.className&&$(this).attr("class",null)})},show:function(elm){this.$$(elm).show()},hide:function(elm){this.$$(elm).hide()},isHidden:function(elm){return"none"==this.$$(elm).css("display")},uniqueId:function(prefix){return(prefix?prefix:"mce_")+this.counter++},setHTML:function(elm,html){elm=this.$$(elm),isIE?elm.each(function(i,target){if(target.canHaveHTML!==!1){for(;target.firstChild;)target.removeChild(target.firstChild);try{target.innerHTML="<br>"+html,target.removeChild(target.firstChild)}catch(ex){$("<div>").html("<br>"+html).contents().slice(1).appendTo(target)}return html}}):elm.html(html)},getOuterHTML:function(elm){return elm=this.get(elm),1==elm.nodeType&&"outerHTML"in elm?elm.outerHTML:$("<div>").append($(elm).clone()).html()},setOuterHTML:function(elm,html){var self=this;self.$$(elm).each(function(){try{if("outerHTML"in this)return void(this.outerHTML=html)}catch(ex){}self.remove($(this).html(html),!0)})},decode:Entities.decode,encode:Entities.encodeAllRaw,insertAfter:function(node,referenceNode){return referenceNode=this.get(referenceNode),this.run(node,function(node){var parent,nextSibling;return parent=referenceNode.parentNode,nextSibling=referenceNode.nextSibling,nextSibling?parent.insertBefore(node,nextSibling):parent.appendChild(node),node})},replace:function(newElm,oldElm,keepChildren){var self=this;return self.run(oldElm,function(oldElm){return is(oldElm,"array")&&(newElm=newElm.cloneNode(!0)),keepChildren&&each(grep(oldElm.childNodes),function(node){newElm.appendChild(node)}),oldElm.parentNode.replaceChild(newElm,oldElm)})},rename:function(elm,name){var newElm,self=this;return elm.nodeName!=name.toUpperCase()&&(newElm=self.create(name),each(self.getAttribs(elm),function(attrNode){self.setAttrib(newElm,attrNode.nodeName,self.getAttrib(elm,attrNode.nodeName))}),self.replace(newElm,elm,1)),newElm||elm},findCommonAncestor:function(a,b){for(var pe,ps=a;ps;){for(pe=b;pe&&ps!=pe;)pe=pe.parentNode;if(ps==pe)break;ps=ps.parentNode}return!ps&&a.ownerDocument?a.ownerDocument.documentElement:ps},toHex:function(rgbVal){return this.styles.toHex(Tools.trim(rgbVal))},run:function(elm,func,scope){var result,self=this;return"string"==typeof elm&&(elm=self.get(elm)),elm?(scope=scope||this,elm.nodeType||!elm.length&&0!==elm.length?func.call(scope,elm):(result=[],each(elm,function(elm,i){elm&&("string"==typeof elm&&(elm=self.get(elm)),result.push(func.call(scope,elm,i)))}),result)):!1},getAttribs:function(elm){var attrs;if(elm=this.get(elm),!elm)return[];if(isIE){if(attrs=[],"OBJECT"==elm.nodeName)return elm.attributes;"OPTION"===elm.nodeName&&this.getAttrib(elm,"selected")&&attrs.push({specified:1,nodeName:"selected"});var attrRegExp=/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi;return elm.cloneNode(!1).outerHTML.replace(attrRegExp,"").replace(/[\w:\-]+/gi,function(a){attrs.push({specified:1,nodeName:a})}),attrs}return elm.attributes},isEmpty:function(node,elements){var i,attributes,type,walker,name,self=this,brCount=0;if(node=node.firstChild){walker=new TreeWalker(node,node.parentNode),elements=elements||(self.schema?self.schema.getNonEmptyElements():null);do{if(type=node.nodeType,1===type){if(node.getAttribute("data-mce-bogus"))continue;if(name=node.nodeName.toLowerCase(),elements&&elements[name]){if("br"===name){brCount++;continue}return!1}for(attributes=self.getAttribs(node),i=attributes.length;i--;)if(name=attributes[i].nodeName,"name"===name||"data-mce-bookmark"===name)return!1}if(8==type)return!1;if(3===type&&!whiteSpaceRegExp.test(node.nodeValue))return!1}while(node=walker.next())}return 1>=brCount},createRng:function(){var doc=this.doc;return doc.createRange?doc.createRange():new Range(this)},nodeIndex:nodeIndex,split:function(parentElm,splitElm,replacementElm){function trimNode(node){function surroundedBySpans(node){var previousIsSpan=node.previousSibling&&"SPAN"==node.previousSibling.nodeName,nextIsSpan=node.nextSibling&&"SPAN"==node.nextSibling.nodeName;return previousIsSpan&&nextIsSpan}var i,children=node.childNodes,type=node.nodeType;if(1!=type||"bookmark"!=node.getAttribute("data-mce-type")){for(i=children.length-1;i>=0;i--)trimNode(children[i]);if(9!=type){if(3==type&&node.nodeValue.length>0){var trimmedLength=trim(node.nodeValue).length;if(!self.isBlock(node.parentNode)||trimmedLength>0||0===trimmedLength&&surroundedBySpans(node))return}else if(1==type&&(children=node.childNodes,1==children.length&&children[0]&&1==children[0].nodeType&&"bookmark"==children[0].getAttribute("data-mce-type")&&node.parentNode.insertBefore(children[0],node),children.length||/^(br|hr|input|img)$/i.test(node.nodeName)))return;self.remove(node)}return node}}var bef,aft,pa,self=this,r=self.createRng();return parentElm&&splitElm?(r.setStart(parentElm.parentNode,self.nodeIndex(parentElm)),r.setEnd(splitElm.parentNode,self.nodeIndex(splitElm)),bef=r.extractContents(),r=self.createRng(),r.setStart(splitElm.parentNode,self.nodeIndex(splitElm)+1),r.setEnd(parentElm.parentNode,self.nodeIndex(parentElm)+1),aft=r.extractContents(),pa=parentElm.parentNode,pa.insertBefore(trimNode(bef),parentElm),replacementElm?pa.insertBefore(replacementElm,parentElm):pa.insertBefore(splitElm,parentElm),pa.insertBefore(trimNode(aft),parentElm),self.remove(parentElm),replacementElm||splitElm):void 0},bind:function(target,name,func,scope){var self=this;if(Tools.isArray(target)){for(var i=target.length;i--;)target[i]=self.bind(target[i],name,func,scope);return target}return!self.settings.collect||target!==self.doc&&target!==self.win||self.boundEvents.push([target,name,func,scope]),self.events.bind(target,name,func,scope||self)},unbind:function(target,name,func){var i,self=this;if(Tools.isArray(target)){for(i=target.length;i--;)target[i]=self.unbind(target[i],name,func);return target}if(self.boundEvents&&(target===self.doc||target===self.win))for(i=self.boundEvents.length;i--;){var item=self.boundEvents[i];target!=item[0]||name&&name!=item[1]||func&&func!=item[2]||this.events.unbind(item[0],item[1],item[2])}return this.events.unbind(target,name,func)},fire:function(target,name,evt){return this.events.fire(target,name,evt)},getContentEditable:function(node){var contentEditable;return node&&1==node.nodeType?(contentEditable=node.getAttribute("data-mce-contenteditable"),contentEditable&&"inherit"!==contentEditable?contentEditable:"inherit"!==node.contentEditable?node.contentEditable:null):null},getContentEditableParent:function(node){for(var root=this.getRoot(),state=null;node&&node!==root&&(state=this.getContentEditable(node),null===state);node=node.parentNode);return state},destroy:function(){var self=this;if(self.boundEvents){for(var i=self.boundEvents.length;i--;){var item=self.boundEvents[i];this.events.unbind(item[0],item[1],item[2])}self.boundEvents=null}Sizzle.setDocument&&Sizzle.setDocument(),self.win=self.doc=self.root=self.events=self.frag=null},isChildOf:function(node,parent){for(;node;){if(parent===node)return!0;node=node.parentNode}return!1},dumpRng:function(r){return"startContainer: "+r.startContainer.nodeName+", startOffset: "+r.startOffset+", endContainer: "+r.endContainer.nodeName+", endOffset: "+r.endOffset},_findSib:function(node,selector,name){var self=this,func=selector;if(node)for("string"==typeof func&&(func=function(node){return self.is(node,selector)}),node=node[name];node;node=node[name])if(func(node))return node;return null}},DOMUtils.DOM=new DOMUtils(document),DOMUtils.nodeIndex=nodeIndex,DOMUtils}),define("tinymce/dom/ScriptLoader",["tinymce/dom/DOMUtils","tinymce/util/Tools"],function(DOMUtils,Tools){function ScriptLoader(){function loadScript(url,callback){function done(){dom.remove(id),elm&&(elm.onreadystatechange=elm.onload=elm=null),callback()}function error(){"undefined"!=typeof console&&console.log&&console.log("Failed to load: "+url)}var elm,id,dom=DOM;id=dom.uniqueId(),elm=document.createElement("script"),elm.id=id,elm.type="text/javascript",elm.src=Tools._addCacheSuffix(url),"onreadystatechange"in elm?elm.onreadystatechange=function(){/loaded|complete/.test(elm.readyState)&&done()}:elm.onload=done,elm.onerror=error,(document.getElementsByTagName("head")[0]||document.body).appendChild(elm)}var undef,QUEUED=0,LOADING=1,LOADED=2,states={},queue=[],scriptLoadedCallbacks={},queueLoadedCallbacks=[],loading=0;this.isDone=function(url){return states[url]==LOADED},this.markDone=function(url){states[url]=LOADED},this.add=this.load=function(url,callback,scope){var state=states[url];state==undef&&(queue.push(url),states[url]=QUEUED),callback&&(scriptLoadedCallbacks[url]||(scriptLoadedCallbacks[url]=[]),scriptLoadedCallbacks[url].push({func:callback,scope:scope||this}))},this.loadQueue=function(callback,scope){this.loadScripts(queue,callback,scope)},this.loadScripts=function(scripts,callback,scope){function execScriptLoadedCallbacks(url){each(scriptLoadedCallbacks[url],function(callback){callback.func.call(callback.scope)}),scriptLoadedCallbacks[url]=undef}var loadScripts;queueLoadedCallbacks.push({func:callback,scope:scope||this}),(loadScripts=function(){var loadingScripts=grep(scripts);scripts.length=0,each(loadingScripts,function(url){return states[url]==LOADED?void execScriptLoadedCallbacks(url):void(states[url]!=LOADING&&(states[url]=LOADING,loading++,loadScript(url,function(){states[url]=LOADED,loading--,execScriptLoadedCallbacks(url),loadScripts()})))}),loading||(each(queueLoadedCallbacks,function(callback){callback.func.call(callback.scope)}),queueLoadedCallbacks.length=0)})()}}var DOM=DOMUtils.DOM,each=Tools.each,grep=Tools.grep;return ScriptLoader.ScriptLoader=new ScriptLoader,ScriptLoader}),define("tinymce/AddOnManager",["tinymce/dom/ScriptLoader","tinymce/util/Tools"],function(ScriptLoader,Tools){function AddOnManager(){var self=this;self.items=[],self.urls={},self.lookup={}}var each=Tools.each;return AddOnManager.prototype={get:function(name){return this.lookup[name]?this.lookup[name].instance:undefined},dependencies:function(name){var result;return this.lookup[name]&&(result=this.lookup[name].dependencies),result||[]},requireLangPack:function(name,languages){var language=AddOnManager.language;if(language&&AddOnManager.languageLoad!==!1){if(languages)if(languages=","+languages+",",-1!=languages.indexOf(","+language.substr(0,2)+","))language=language.substr(0,2);else if(-1==languages.indexOf(","+language+","))return;ScriptLoader.ScriptLoader.add(this.urls[name]+"/langs/"+language+".js")}},add:function(id,addOn,dependencies){return this.items.push(addOn),this.lookup[id]={instance:addOn,dependencies:dependencies},addOn},createUrl:function(baseUrl,dep){return"object"==typeof dep?dep:{prefix:baseUrl.prefix,resource:dep,suffix:baseUrl.suffix}},addComponents:function(pluginName,scripts){var pluginUrl=this.urls[pluginName];each(scripts,function(script){ScriptLoader.ScriptLoader.add(pluginUrl+"/"+script)})},load:function(name,addOnUrl,callback,scope){function loadDependencies(){var dependencies=self.dependencies(name);each(dependencies,function(dep){var newUrl=self.createUrl(addOnUrl,dep);self.load(newUrl.resource,newUrl,undefined,undefined)}),callback&&(scope?callback.call(scope):callback.call(ScriptLoader))}var self=this,url=addOnUrl;self.urls[name]||("object"==typeof addOnUrl&&(url=addOnUrl.prefix+addOnUrl.resource+addOnUrl.suffix),0!==url.indexOf("/")&&-1==url.indexOf("://")&&(url=AddOnManager.baseURL+"/"+url),self.urls[name]=url.substring(0,url.lastIndexOf("/")),self.lookup[name]?loadDependencies():ScriptLoader.ScriptLoader.add(url,loadDependencies,scope))}},AddOnManager.PluginManager=new AddOnManager,AddOnManager.ThemeManager=new AddOnManager,AddOnManager}),define("tinymce/dom/NodeType",[],function(){function isNodeType(type){return function(node){return!!node&&node.nodeType==type}}function matchNodeNames(names){return names=names.toLowerCase().split(" "),function(node){var i,name;if(node&&node.nodeType)for(name=node.nodeName.toLowerCase(),i=0;i<names.length;i++)if(name===names[i])return!0;return!1}}function matchStyleValues(name,values){return values=values.toLowerCase().split(" "),function(node){var i,cssValue;if(isElement(node))for(i=0;i<values.length;i++)if(cssValue=getComputedStyle(node,null).getPropertyValue(name),cssValue===values[i])return!0;return!1}}function hasPropValue(propName,propValue){return function(node){return isElement(node)&&node[propName]===propValue}}function hasAttributeValue(attrName,attrValue){return function(node){return isElement(node)&&node.getAttribute(attrName)===attrValue}}function isBogus(node){return isElement(node)&&node.hasAttribute("data-mce-bogus")}function hasContentEditableState(value){return function(node){if(isElement(node)){if(node.contentEditable===value)return!0;if(node.getAttribute("data-mce-contenteditable")===value)return!0}return!1}}var isElement=isNodeType(1);return{isText:isNodeType(3),isElement:isElement,isComment:isNodeType(8),isBr:matchNodeNames("br"),isContentEditableTrue:hasContentEditableState("true"),isContentEditableFalse:hasContentEditableState("false"),matchNodeNames:matchNodeNames,hasPropValue:hasPropValue,hasAttributeValue:hasAttributeValue,matchStyleValues:matchStyleValues,isBogus:isBogus}}),define("tinymce/text/Zwsp",[],function(){function isZwsp(chr){return chr==ZWSP}function trim(str){return str.replace(new RegExp(ZWSP,"g"),"")}var ZWSP="​";return{isZwsp:isZwsp,ZWSP:ZWSP,trim:trim}}),define("tinymce/caret/CaretContainer",["tinymce/dom/NodeType","tinymce/text/Zwsp"],function(NodeType,Zwsp){function isCaretContainerBlock(node){return isText(node)&&(node=node.parentNode),isElement(node)&&node.hasAttribute("data-mce-caret")}function isCaretContainerInline(node){return isText(node)&&Zwsp.isZwsp(node.data)}function isCaretContainer(node){return isCaretContainerBlock(node)||isCaretContainerInline(node)}function insertInline(node,before){var doc,sibling,textNode,parentNode;if(doc=node.ownerDocument,textNode=doc.createTextNode(Zwsp.ZWSP),parentNode=node.parentNode,before){if(sibling=node.previousSibling,isText(sibling)){if(isCaretContainer(sibling))return sibling;if(endsWithCaretContainer(sibling))return sibling.splitText(sibling.data.length-1)}parentNode.insertBefore(textNode,node)}else{if(sibling=node.nextSibling,isText(sibling)){if(isCaretContainer(sibling))return sibling;if(startsWithCaretContainer(sibling))return sibling.splitText(1),sibling}node.nextSibling?parentNode.insertBefore(textNode,node.nextSibling):parentNode.appendChild(textNode)}return textNode}function insertBlock(blockName,node,before){var doc,blockNode,parentNode;return doc=node.ownerDocument,blockNode=doc.createElement(blockName),blockNode.setAttribute("data-mce-caret",before?"before":"after"),blockNode.setAttribute("data-mce-bogus","all"),blockNode.appendChild(doc.createTextNode(" ")),parentNode=node.parentNode,before?parentNode.insertBefore(blockNode,node):node.nextSibling?parentNode.insertBefore(blockNode,node.nextSibling):parentNode.appendChild(blockNode),blockNode}function remove(caretContainerNode){var text;isElement(caretContainerNode)&&isCaretContainer(caretContainerNode)&&("&nbsp;"!=caretContainerNode.innerHTML?caretContainerNode.removeAttribute("data-mce-caret"):caretContainerNode.parentNode&&caretContainerNode.parentNode.removeChild(caretContainerNode)),isText(caretContainerNode)&&(text=Zwsp.trim(caretContainerNode.data),0===text.length&&caretContainerNode.parentNode&&caretContainerNode.parentNode.removeChild(caretContainerNode),caretContainerNode.nodeValue=text)}function startsWithCaretContainer(node){return isText(node)&&node.data[0]==Zwsp.ZWSP}function endsWithCaretContainer(node){return isText(node)&&node.data[node.data.length-1]==Zwsp.ZWSP}var isElement=NodeType.isElement,isText=NodeType.isText;return{isCaretContainer:isCaretContainer,isCaretContainerBlock:isCaretContainerBlock,isCaretContainerInline:isCaretContainerInline,insertInline:insertInline,insertBlock:insertBlock,remove:remove,startsWithCaretContainer:startsWithCaretContainer,endsWithCaretContainer:endsWithCaretContainer}}),define("tinymce/dom/RangeUtils",["tinymce/util/Tools","tinymce/dom/TreeWalker","tinymce/dom/NodeType","tinymce/caret/CaretContainer"],function(Tools,TreeWalker,NodeType,CaretContainer){function getEndChild(container,index){var childNodes=container.childNodes;return index--,index>childNodes.length-1?index=childNodes.length-1:0>index&&(index=0),childNodes[index]||container}function RangeUtils(dom){this.walk=function(rng,callback){function exclude(nodes){var node;return node=nodes[0],3===node.nodeType&&node===startContainer&&startOffset>=node.nodeValue.length&&nodes.splice(0,1),node=nodes[nodes.length-1],0===endOffset&&nodes.length>0&&node===endContainer&&3===node.nodeType&&nodes.splice(nodes.length-1,1),nodes}function collectSiblings(node,name,end_node){for(var siblings=[];node&&node!=end_node;node=node[name])siblings.push(node);return siblings}function findEndPoint(node,root){do{if(node.parentNode==root)return node;node=node.parentNode}while(node)}function walkBoundary(start_node,end_node,next){var siblingName=next?"nextSibling":"previousSibling";for(node=start_node,parent=node.parentNode;node&&node!=end_node;node=parent)parent=node.parentNode,siblings=collectSiblings(node==start_node?node:node[siblingName],siblingName),siblings.length&&(next||siblings.reverse(),callback(exclude(siblings)))}var ancestor,startPoint,endPoint,node,parent,siblings,nodes,startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;if(nodes=dom.select("td[data-mce-selected],th[data-mce-selected]"),nodes.length>0)return void each(nodes,function(node){callback([node])});if(1==startContainer.nodeType&&startContainer.hasChildNodes()&&(startContainer=startContainer.childNodes[startOffset]),1==endContainer.nodeType&&endContainer.hasChildNodes()&&(endContainer=getEndChild(endContainer,endOffset)),startContainer==endContainer)return callback(exclude([startContainer]));for(ancestor=dom.findCommonAncestor(startContainer,endContainer),node=startContainer;node;node=node.parentNode){if(node===endContainer)return walkBoundary(startContainer,ancestor,!0);if(node===ancestor)break}for(node=endContainer;node;node=node.parentNode){if(node===startContainer)return walkBoundary(endContainer,ancestor);if(node===ancestor)break}startPoint=findEndPoint(startContainer,ancestor)||startContainer,endPoint=findEndPoint(endContainer,ancestor)||endContainer,walkBoundary(startContainer,startPoint,!0),siblings=collectSiblings(startPoint==startContainer?startPoint:startPoint.nextSibling,"nextSibling",endPoint==endContainer?endPoint.nextSibling:endPoint),siblings.length&&callback(exclude(siblings)),walkBoundary(endContainer,endPoint)},this.split=function(rng){function splitText(node,offset){return node.splitText(offset)}var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;return startContainer==endContainer&&3==startContainer.nodeType?startOffset>0&&startOffset<startContainer.nodeValue.length&&(endContainer=splitText(startContainer,startOffset),startContainer=endContainer.previousSibling,endOffset>startOffset?(endOffset-=startOffset,startContainer=endContainer=splitText(endContainer,endOffset).previousSibling,endOffset=endContainer.nodeValue.length,startOffset=0):endOffset=0):(3==startContainer.nodeType&&startOffset>0&&startOffset<startContainer.nodeValue.length&&(startContainer=splitText(startContainer,startOffset),startOffset=0),3==endContainer.nodeType&&endOffset>0&&endOffset<endContainer.nodeValue.length&&(endContainer=splitText(endContainer,endOffset).previousSibling,endOffset=endContainer.nodeValue.length)),{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}},this.normalize=function(rng){function normalizeEndPoint(start){function isTableCell(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName)}function hasBrBeforeAfter(node,left){for(var walker=new TreeWalker(node,dom.getParent(node.parentNode,dom.isBlock)||body);node=walker[left?"prev":"next"]();)if("BR"===node.nodeName)return!0}function hasContentEditableFalseParent(node){for(;node&&node!=body;){if(isContentEditableFalse(node))return!0;node=node.parentNode}return!1}function isPrevNode(node,name){return node.previousSibling&&node.previousSibling.nodeName==name}function findTextNodeRelative(left,startNode){var walker,lastInlineElement,parentBlockContainer;if(startNode=startNode||container,parentBlockContainer=dom.getParent(startNode.parentNode,dom.isBlock)||body,left&&"BR"==startNode.nodeName&&isAfterNode&&dom.isEmpty(parentBlockContainer))return container=startNode.parentNode,offset=dom.nodeIndex(startNode),void(normalized=!0);for(walker=new TreeWalker(startNode,parentBlockContainer);node=walker[left?"prev":"next"]();){if("false"===dom.getContentEditableParent(node)||isCaretContainer(node))return;if(3===node.nodeType&&node.nodeValue.length>0)return container=node,offset=left?node.nodeValue.length:0,void(normalized=!0);if(dom.isBlock(node)||nonEmptyElementsMap[node.nodeName.toLowerCase()])return;lastInlineElement=node}collapsed&&lastInlineElement&&(container=lastInlineElement,normalized=!0,offset=0)}var container,offset,walker,node,nonEmptyElementsMap,directionLeft,isAfterNode,body=dom.getRoot();if(container=rng[(start?"start":"end")+"Container"],offset=rng[(start?"start":"end")+"Offset"],isAfterNode=1==container.nodeType&&offset===container.childNodes.length,nonEmptyElementsMap=dom.schema.getNonEmptyElements(),directionLeft=start,!isCaretContainer(container)){if(1==container.nodeType&&offset>container.childNodes.length-1&&(directionLeft=!1),9===container.nodeType&&(container=dom.getRoot(),offset=0),container===body){if(directionLeft&&(node=container.childNodes[offset>0?offset-1:0])){if(isCaretContainer(node))return;if(nonEmptyElementsMap[node.nodeName]||"TABLE"==node.nodeName)return}if(container.hasChildNodes()){if(offset=Math.min(!directionLeft&&offset>0?offset-1:offset,container.childNodes.length-1),container=container.childNodes[offset],offset=0,hasContentEditableFalseParent(container)||isCaretContainer(container))return;if(container.hasChildNodes()&&!/TABLE/.test(container.nodeName)){node=container,walker=new TreeWalker(container,body);do{if(isContentEditableFalse(node)||isCaretContainer(node)){normalized=!1;break}if(3===node.nodeType&&node.nodeValue.length>0){offset=directionLeft?0:node.nodeValue.length,container=node,normalized=!0;break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]&&!isTableCell(node)){offset=dom.nodeIndex(node),container=node.parentNode,"IMG"!=node.nodeName||directionLeft||offset++,normalized=!0;break}}while(node=directionLeft?walker.next():walker.prev())}}}collapsed&&(3===container.nodeType&&0===offset&&findTextNodeRelative(!0),1===container.nodeType&&(node=container.childNodes[offset],node||(node=container.childNodes[offset-1]),!node||"BR"!==node.nodeName||isPrevNode(node,"A")||hasBrBeforeAfter(node)||hasBrBeforeAfter(node,!0)||findTextNodeRelative(!0,node))),directionLeft&&!collapsed&&3===container.nodeType&&offset===container.nodeValue.length&&findTextNodeRelative(!1),normalized&&rng["set"+(start?"Start":"End")](container,offset)}}var normalized,collapsed;return collapsed=rng.collapsed,normalizeEndPoint(!0),collapsed||normalizeEndPoint(),normalized&&collapsed&&rng.collapse(!0),normalized}}function findClosestIeRange(clientX,clientY,doc){var element,rng,rects;if(element=doc.elementFromPoint(clientX,clientY),rng=doc.body.createTextRange(),"HTML"==element.tagName&&(element=doc.body),rng.moveToElementText(element),rects=Tools.toArray(rng.getClientRects()),rects=rects.sort(function(a,b){return a=Math.abs(Math.max(a.top-clientY,a.bottom-clientY)),b=Math.abs(Math.max(b.top-clientY,b.bottom-clientY)),a-b}),rects.length>0){clientY=(rects[0].bottom+rects[0].top)/2;try{return rng.moveToPoint(clientX,clientY),rng.collapse(!0),rng}catch(ex){}}return null}var each=Tools.each,isContentEditableFalse=NodeType.isContentEditableFalse,isCaretContainer=CaretContainer.isCaretContainer;return RangeUtils.compareRanges=function(rng1,rng2){if(rng1&&rng2){if(!rng1.item&&!rng1.duplicate)return rng1.startContainer==rng2.startContainer&&rng1.startOffset==rng2.startOffset;if(rng1.item&&rng2.item&&rng1.item(0)===rng2.item(0))return!0;if(rng1.isEqual&&rng2.isEqual&&rng2.isEqual(rng1))return!0}return!1},RangeUtils.getCaretRangeFromPoint=function(clientX,clientY,doc){var rng,point;if(doc.caretPositionFromPoint)point=doc.caretPositionFromPoint(clientX,clientY),rng=doc.createRange(),rng.setStart(point.offsetNode,point.offset),rng.collapse(!0);else if(doc.caretRangeFromPoint)rng=doc.caretRangeFromPoint(clientX,clientY);else if(doc.body.createTextRange){rng=doc.body.createTextRange();try{rng.moveToPoint(clientX,clientY),rng.collapse(!0)}catch(ex){rng=findClosestIeRange(clientX,clientY,doc)}}return rng},RangeUtils.getSelectedNode=function(range){var startContainer=range.startContainer,startOffset=range.startOffset;return startContainer.hasChildNodes()&&range.endOffset==startOffset+1?startContainer.childNodes[startOffset]:null},RangeUtils.getNode=function(container,offset){return 1==container.nodeType&&container.hasChildNodes()&&(offset>=container.childNodes.length&&(offset=container.childNodes.length-1),container=container.childNodes[offset]),container},RangeUtils}),define("tinymce/NodeChange",["tinymce/dom/RangeUtils","tinymce/Env","tinymce/util/Delay"],function(RangeUtils,Env,Delay){return function(editor){function isSameElementPath(startElm){var i,currentPath;if(currentPath=editor.$(startElm).parentsUntil(editor.getBody()).add(startElm),currentPath.length===lastPath.length){for(i=currentPath.length;i>=0&&currentPath[i]===lastPath[i];i--);if(-1===i)return lastPath=currentPath,!0}return lastPath=currentPath,!1}var lastRng,lastPath=[];"onselectionchange"in editor.getDoc()||editor.on("NodeChange Click MouseUp KeyUp Focus",function(e){var nativeRng,fakeRng;nativeRng=editor.selection.getRng(),fakeRng={startContainer:nativeRng.startContainer,startOffset:nativeRng.startOffset,endContainer:nativeRng.endContainer,endOffset:nativeRng.endOffset},"nodechange"!=e.type&&RangeUtils.compareRanges(fakeRng,lastRng)||editor.fire("SelectionChange"),lastRng=fakeRng}),editor.on("contextmenu",function(){editor.fire("SelectionChange")}),editor.on("SelectionChange",function(){var startElm=editor.selection.getStart(!0);!Env.range&&editor.selection.isCollapsed()||!isSameElementPath(startElm)&&editor.dom.isChildOf(startElm,editor.getBody())&&editor.nodeChanged({selectionChange:!0})}),editor.on("MouseUp",function(e){e.isDefaultPrevented()||("IMG"==editor.selection.getNode().nodeName?Delay.setEditorTimeout(editor,function(){editor.nodeChanged()}):editor.nodeChanged())}),this.nodeChanged=function(args){var node,parents,root,selection=editor.selection;editor.initialized&&selection&&!editor.settings.disable_nodechange&&!editor.readonly&&(root=editor.getBody(),node=selection.getStart()||root,node=node.ownerDocument!=editor.getDoc()?editor.getBody():node,"IMG"==node.nodeName&&selection.isCollapsed()&&(node=node.parentNode),parents=[],editor.dom.getParent(node,function(node){return node===root?!0:void parents.push(node)}),args=args||{},args.element=node,args.parents=parents,editor.fire("NodeChange",args))}}}),define("tinymce/html/Node",[],function(){function walk(node,root_node,prev){var sibling,parent,startName=prev?"lastChild":"firstChild",siblingName=prev?"prev":"next";if(node[startName])return node[startName];if(node!==root_node){if(sibling=node[siblingName])return sibling;for(parent=node.parent;parent&&parent!==root_node;parent=parent.parent)if(sibling=parent[siblingName])return sibling}}function Node(name,type){this.name=name,this.type=type,1===type&&(this.attributes=[],this.attributes.map={})}var whiteSpaceRegExp=/^[ \t\r\n]*$/,typeLookup={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};return Node.prototype={replace:function(node){var self=this;return node.parent&&node.remove(),self.insert(node,self),self.remove(),self},attr:function(name,value){var attrs,i,undef,self=this;if("string"!=typeof name){for(i in name)self.attr(i,name[i]);return self}if(attrs=self.attributes){if(value!==undef){if(null===value){if(name in attrs.map)for(delete attrs.map[name],i=attrs.length;i--;)if(attrs[i].name===name)return attrs=attrs.splice(i,1),self;return self}if(name in attrs.map){for(i=attrs.length;i--;)if(attrs[i].name===name){attrs[i].value=value;break}}else attrs.push({name:name,value:value});return attrs.map[name]=value,self}return attrs.map[name]}},clone:function(){var i,l,selfAttrs,selfAttr,cloneAttrs,self=this,clone=new Node(self.name,self.type);if(selfAttrs=self.attributes){for(cloneAttrs=[],cloneAttrs.map={},i=0,l=selfAttrs.length;l>i;i++)selfAttr=selfAttrs[i],"id"!==selfAttr.name&&(cloneAttrs[cloneAttrs.length]={name:selfAttr.name,value:selfAttr.value},cloneAttrs.map[selfAttr.name]=selfAttr.value);clone.attributes=cloneAttrs}return clone.value=self.value,clone.shortEnded=self.shortEnded,clone},wrap:function(wrapper){var self=this;return self.parent.insert(wrapper,self),wrapper.append(self),self},unwrap:function(){var node,next,self=this;for(node=self.firstChild;node;)next=node.next,self.insert(node,self,!0),node=next;self.remove()},remove:function(){var self=this,parent=self.parent,next=self.next,prev=self.prev;return parent&&(parent.firstChild===self?(parent.firstChild=next,next&&(next.prev=null)):prev.next=next,parent.lastChild===self?(parent.lastChild=prev,prev&&(prev.next=null)):next.prev=prev,self.parent=self.next=self.prev=null),self},append:function(node){var last,self=this;return node.parent&&node.remove(),last=self.lastChild,last?(last.next=node,node.prev=last,self.lastChild=node):self.lastChild=self.firstChild=node,node.parent=self,node},insert:function(node,ref_node,before){var parent;return node.parent&&node.remove(),parent=ref_node.parent||this,before?(ref_node===parent.firstChild?parent.firstChild=node:ref_node.prev.next=node,node.prev=ref_node.prev,node.next=ref_node,ref_node.prev=node):(ref_node===parent.lastChild?parent.lastChild=node:ref_node.next.prev=node,node.next=ref_node.next,node.prev=ref_node,ref_node.next=node),node.parent=parent,node},getAll:function(name){var node,self=this,collection=[];for(node=self.firstChild;node;node=walk(node,self))node.name===name&&collection.push(node);return collection},empty:function(){var nodes,i,node,self=this;if(self.firstChild){for(nodes=[],node=self.firstChild;node;node=walk(node,self))nodes.push(node);for(i=nodes.length;i--;)node=nodes[i],node.parent=node.firstChild=node.lastChild=node.next=node.prev=null}return self.firstChild=self.lastChild=null,self},isEmpty:function(elements){var i,name,self=this,node=self.firstChild;if(node)do{if(1===node.type){if(node.attributes.map["data-mce-bogus"])continue;if(elements[node.name])return!1;for(i=node.attributes.length;i--;)if(name=node.attributes[i].name,"name"===name||0===name.indexOf("data-mce-bookmark"))return!1}if(8===node.type)return!1;if(3===node.type&&!whiteSpaceRegExp.test(node.value))return!1}while(node=walk(node,self));return!0},walk:function(prev){return walk(this,null,prev)}},Node.create=function(name,attrs){var node,attrName;if(node=new Node(name,typeLookup[name]||1),attrs)for(attrName in attrs)node.attr(attrName,attrs[attrName]);return node},Node}),define("tinymce/html/Schema",["tinymce/util/Tools"],function(Tools){function split(items,delim){return items?items.split(delim||" "):[]}function compileSchema(type){function add(name,attributes,children){function arrayToMap(array,obj){var i,l,map={};for(i=0,l=array.length;l>i;i++)map[array[i]]=obj||{};return map}var ni,i,attributesOrder,args=arguments;
for(children=children||[],attributes=attributes||"","string"==typeof children&&(children=split(children)),i=3;i<args.length;i++)"string"==typeof args[i]&&(args[i]=split(args[i])),children.push.apply(children,args[i]);for(name=split(name),ni=name.length;ni--;)attributesOrder=[].concat(globalAttributes,split(attributes)),schema[name[ni]]={attributes:arrayToMap(attributesOrder),attributesOrder:attributesOrder,children:arrayToMap(children,dummyObj)}}function addAttrs(name,attributes){var ni,schemaItem,i,l;for(name=split(name),ni=name.length,attributes=split(attributes);ni--;)for(schemaItem=schema[name[ni]],i=0,l=attributes.length;l>i;i++)schemaItem.attributes[attributes[i]]={},schemaItem.attributesOrder.push(attributes[i])}var globalAttributes,blockContent,phrasingContent,flowContent,html4BlockContent,html4PhrasingContent,schema={};return mapCache[type]?mapCache[type]:(globalAttributes=split("id accesskey class dir lang style tabindex title"),blockContent=split("address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul"),phrasingContent=split("a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment"),"html4"!=type&&(globalAttributes.push.apply(globalAttributes,split("contenteditable contextmenu draggable dropzone hidden spellcheck translate")),blockContent.push.apply(blockContent,split("article aside details dialog figure header footer hgroup section nav")),phrasingContent.push.apply(phrasingContent,split("audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"))),"html5-strict"!=type&&(globalAttributes.push("xml:lang"),html4PhrasingContent=split("acronym applet basefont big font strike tt"),phrasingContent.push.apply(phrasingContent,html4PhrasingContent),each(html4PhrasingContent,function(name){add(name,"",phrasingContent)}),html4BlockContent=split("center dir isindex noframes"),blockContent.push.apply(blockContent,html4BlockContent),flowContent=[].concat(blockContent,phrasingContent),each(html4BlockContent,function(name){add(name,"",flowContent)})),flowContent=flowContent||[].concat(blockContent,phrasingContent),add("html","manifest","head body"),add("head","","base command link meta noscript script style title"),add("title hr noscript br"),add("base","href target"),add("link","href rel media hreflang type sizes hreflang"),add("meta","name http-equiv content charset"),add("style","media type scoped"),add("script","src async defer type charset"),add("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",flowContent),add("address dt dd div caption","",flowContent),add("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",phrasingContent),add("blockquote","cite",flowContent),add("ol","reversed start type","li"),add("ul","","li"),add("li","value",flowContent),add("dl","","dt dd"),add("a","href target rel media hreflang type",phrasingContent),add("q","cite",phrasingContent),add("ins del","cite datetime",flowContent),add("img","src sizes srcset alt usemap ismap width height"),add("iframe","src name width height",flowContent),add("embed","src type width height"),add("object","data type typemustmatch name usemap form width height",flowContent,"param"),add("param","name value"),add("map","name",flowContent,"area"),add("area","alt coords shape href target rel media hreflang type"),add("table","border","caption colgroup thead tfoot tbody tr"+("html4"==type?" col":"")),add("colgroup","span","col"),add("col","span"),add("tbody thead tfoot","","tr"),add("tr","","td th"),add("td","colspan rowspan headers",flowContent),add("th","colspan rowspan headers scope abbr",flowContent),add("form","accept-charset action autocomplete enctype method name novalidate target",flowContent),add("fieldset","disabled form name",flowContent,"legend"),add("label","form for",phrasingContent),add("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),add("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"==type?flowContent:phrasingContent),add("select","disabled form multiple name required size","option optgroup"),add("optgroup","disabled label","option"),add("option","disabled label selected value"),add("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),add("menu","type label",flowContent,"li"),add("noscript","",flowContent),"html4"!=type&&(add("wbr"),add("ruby","",phrasingContent,"rt rp"),add("figcaption","",flowContent),add("mark rt rp summary bdi","",phrasingContent),add("canvas","width height",flowContent),add("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",flowContent,"track source"),add("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",flowContent,"track source"),add("picture","","img source"),add("source","src srcset type media sizes"),add("track","kind src srclang label default"),add("datalist","",phrasingContent,"option"),add("article section nav aside header footer","",flowContent),add("hgroup","","h1 h2 h3 h4 h5 h6"),add("figure","",flowContent,"figcaption"),add("time","datetime",phrasingContent),add("dialog","open",flowContent),add("command","type label icon disabled checked radiogroup command"),add("output","for form name",phrasingContent),add("progress","value max",phrasingContent),add("meter","value min max low high optimum",phrasingContent),add("details","open",flowContent,"summary"),add("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!=type&&(addAttrs("script","language xml:space"),addAttrs("style","xml:space"),addAttrs("object","declare classid code codebase codetype archive standby align border hspace vspace"),addAttrs("embed","align name hspace vspace"),addAttrs("param","valuetype type"),addAttrs("a","charset name rev shape coords"),addAttrs("br","clear"),addAttrs("applet","codebase archive code object alt name width height align hspace vspace"),addAttrs("img","name longdesc align border hspace vspace"),addAttrs("iframe","longdesc frameborder marginwidth marginheight scrolling align"),addAttrs("font basefont","size color face"),addAttrs("input","usemap align"),addAttrs("select","onchange"),addAttrs("textarea"),addAttrs("h1 h2 h3 h4 h5 h6 div p legend caption","align"),addAttrs("ul","type compact"),addAttrs("li","type"),addAttrs("ol dl menu dir","compact"),addAttrs("pre","width xml:space"),addAttrs("hr","align noshade size width"),addAttrs("isindex","prompt"),addAttrs("table","summary width frame rules cellspacing cellpadding align bgcolor"),addAttrs("col","width align char charoff valign"),addAttrs("colgroup","width align char charoff valign"),addAttrs("thead","align char charoff valign"),addAttrs("tr","align char charoff valign bgcolor"),addAttrs("th","axis align char charoff valign nowrap bgcolor width height"),addAttrs("form","accept"),addAttrs("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),addAttrs("tfoot","align char charoff valign"),addAttrs("tbody","align char charoff valign"),addAttrs("area","nohref"),addAttrs("body","background bgcolor text link vlink alink")),"html4"!=type&&(addAttrs("input button select textarea","autofocus"),addAttrs("input textarea","placeholder"),addAttrs("a","download"),addAttrs("link script img","crossorigin"),addAttrs("iframe","sandbox seamless allowfullscreen")),each(split("a form meter progress dfn"),function(name){schema[name]&&delete schema[name].children[name]}),delete schema.caption.children.table,delete schema.script,mapCache[type]=schema,schema)}function compileElementMap(value,mode){var styles;return value&&(styles={},"string"==typeof value&&(value={"*":value}),each(value,function(value,key){styles[key]=styles[key.toUpperCase()]="map"==mode?makeMap(value,/[, ]/):explode(value,/[, ]/)})),styles}var mapCache={},dummyObj={},makeMap=Tools.makeMap,each=Tools.each,extend=Tools.extend,explode=Tools.explode,inArray=Tools.inArray;return function(settings){function createLookupTable(option,default_value,extendWith){var value=settings[option];return value?value=makeMap(value,/[, ]/,makeMap(value.toUpperCase(),/[, ]/)):(value=mapCache[option],value||(value=makeMap(default_value," ",makeMap(default_value.toUpperCase()," ")),value=extend(value,extendWith),mapCache[option]=value)),value}function patternToRegExp(str){return new RegExp("^"+str.replace(/([?+*])/g,".$1")+"$")}function addValidElements(validElements){var ei,el,ai,al,matches,element,attr,attrData,elementName,attrName,attrType,attributes,attributesOrder,prefix,outputName,globalAttributes,globalAttributesOrder,key,value,elementRuleRegExp=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,attrRuleRegExp=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,hasPatternsRegExp=/[*?+]/;if(validElements)for(validElements=split(validElements,","),elements["@"]&&(globalAttributes=elements["@"].attributes,globalAttributesOrder=elements["@"].attributesOrder),ei=0,el=validElements.length;el>ei;ei++)if(matches=elementRuleRegExp.exec(validElements[ei])){if(prefix=matches[1],elementName=matches[2],outputName=matches[3],attrData=matches[5],attributes={},attributesOrder=[],element={attributes:attributes,attributesOrder:attributesOrder},"#"===prefix&&(element.paddEmpty=!0),"-"===prefix&&(element.removeEmpty=!0),"!"===matches[4]&&(element.removeEmptyAttrs=!0),globalAttributes){for(key in globalAttributes)attributes[key]=globalAttributes[key];attributesOrder.push.apply(attributesOrder,globalAttributesOrder)}if(attrData)for(attrData=split(attrData,"|"),ai=0,al=attrData.length;al>ai;ai++)if(matches=attrRuleRegExp.exec(attrData[ai])){if(attr={},attrType=matches[1],attrName=matches[2].replace(/::/g,":"),prefix=matches[3],value=matches[4],"!"===attrType&&(element.attributesRequired=element.attributesRequired||[],element.attributesRequired.push(attrName),attr.required=!0),"-"===attrType){delete attributes[attrName],attributesOrder.splice(inArray(attributesOrder,attrName),1);continue}prefix&&("="===prefix&&(element.attributesDefault=element.attributesDefault||[],element.attributesDefault.push({name:attrName,value:value}),attr.defaultValue=value),":"===prefix&&(element.attributesForced=element.attributesForced||[],element.attributesForced.push({name:attrName,value:value}),attr.forcedValue=value),"<"===prefix&&(attr.validValues=makeMap(value,"?"))),hasPatternsRegExp.test(attrName)?(element.attributePatterns=element.attributePatterns||[],attr.pattern=patternToRegExp(attrName),element.attributePatterns.push(attr)):(attributes[attrName]||attributesOrder.push(attrName),attributes[attrName]=attr)}globalAttributes||"@"!=elementName||(globalAttributes=attributes,globalAttributesOrder=attributesOrder),outputName&&(element.outputName=elementName,elements[outputName]=element),hasPatternsRegExp.test(elementName)?(element.pattern=patternToRegExp(elementName),patternElements.push(element)):elements[elementName]=element}}function setValidElements(validElements){elements={},patternElements=[],addValidElements(validElements),each(schemaItems,function(element,name){children[name]=element.children})}function addCustomElements(customElements){var customElementRegExp=/^(~)?(.+)$/;customElements&&(mapCache.text_block_elements=mapCache.block_elements=null,each(split(customElements,","),function(rule){var matches=customElementRegExp.exec(rule),inline="~"===matches[1],cloneName=inline?"span":"div",name=matches[2];if(children[name]=children[cloneName],customElementsMap[name]=cloneName,inline||(blockElementsMap[name.toUpperCase()]={},blockElementsMap[name]={}),!elements[name]){var customRule=elements[cloneName];customRule=extend({},customRule),delete customRule.removeEmptyAttrs,delete customRule.removeEmpty,elements[name]=customRule}each(children,function(element,elmName){element[cloneName]&&(children[elmName]=element=extend({},children[elmName]),element[name]=element[cloneName])})}))}function addValidChildren(validChildren){var childRuleRegExp=/^([+\-]?)(\w+)\[([^\]]+)\]$/;mapCache[settings.schema]=null,validChildren&&each(split(validChildren,","),function(rule){var parent,prefix,matches=childRuleRegExp.exec(rule);matches&&(prefix=matches[1],parent=prefix?children[matches[2]]:children[matches[2]]={"#comment":{}},parent=children[matches[2]],each(split(matches[3],"|"),function(child){"-"===prefix?delete parent[child]:parent[child]={}}))})}function getElementRule(name){var i,element=elements[name];if(element)return element;for(i=patternElements.length;i--;)if(element=patternElements[i],element.pattern.test(name))return element}var validStyles,invalidStyles,schemaItems,whiteSpaceElementsMap,selfClosingElementsMap,shortEndedElementsMap,boolAttrMap,validClasses,blockElementsMap,nonEmptyElementsMap,moveCaretBeforeOnEnterElementsMap,textBlockElementsMap,textInlineElementsMap,self=this,elements={},children={},patternElements=[],customElementsMap={},specialElements={};settings=settings||{},schemaItems=compileSchema(settings.schema),settings.verify_html===!1&&(settings.valid_elements="*[*]"),validStyles=compileElementMap(settings.valid_styles),invalidStyles=compileElementMap(settings.invalid_styles,"map"),validClasses=compileElementMap(settings.valid_classes,"map"),whiteSpaceElementsMap=createLookupTable("whitespace_elements","pre script noscript style textarea video audio iframe object"),selfClosingElementsMap=createLookupTable("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),shortEndedElementsMap=createLookupTable("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),boolAttrMap=createLookupTable("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),nonEmptyElementsMap=createLookupTable("non_empty_elements","td th iframe video audio object script",shortEndedElementsMap),moveCaretBeforeOnEnterElementsMap=createLookupTable("move_caret_before_on_enter_elements","table",nonEmptyElementsMap),textBlockElementsMap=createLookupTable("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure"),blockElementsMap=createLookupTable("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption",textBlockElementsMap),textInlineElementsMap=createLookupTable("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp"),each((settings.special||"script noscript style textarea").split(" "),function(name){specialElements[name]=new RegExp("</"+name+"[^>]*>","gi")}),settings.valid_elements?setValidElements(settings.valid_elements):(each(schemaItems,function(element,name){elements[name]={attributes:element.attributes,attributesOrder:element.attributesOrder},children[name]=element.children}),"html5"!=settings.schema&&each(split("strong/b em/i"),function(item){item=split(item,"/"),elements[item[1]].outputName=item[0]}),elements.img.attributesDefault=[{name:"alt",value:""}],each(split("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(name){elements[name]&&(elements[name].removeEmpty=!0)}),each(split("p h1 h2 h3 h4 h5 h6 th td pre div address caption"),function(name){elements[name].paddEmpty=!0}),each(split("span"),function(name){elements[name].removeEmptyAttrs=!0})),addCustomElements(settings.custom_elements),addValidChildren(settings.valid_children),addValidElements(settings.extended_valid_elements),addValidChildren("+ol[ul|ol],+ul[ul|ol]"),settings.invalid_elements&&each(explode(settings.invalid_elements),function(item){elements[item]&&delete elements[item]}),getElementRule("span")||addValidElements("span[!data-mce-type|*]"),self.children=children,self.getValidStyles=function(){return validStyles},self.getInvalidStyles=function(){return invalidStyles},self.getValidClasses=function(){return validClasses},self.getBoolAttrs=function(){return boolAttrMap},self.getBlockElements=function(){return blockElementsMap},self.getTextBlockElements=function(){return textBlockElementsMap},self.getTextInlineElements=function(){return textInlineElementsMap},self.getShortEndedElements=function(){return shortEndedElementsMap},self.getSelfClosingElements=function(){return selfClosingElementsMap},self.getNonEmptyElements=function(){return nonEmptyElementsMap},self.getMoveCaretBeforeOnEnterElements=function(){return moveCaretBeforeOnEnterElementsMap},self.getWhiteSpaceElements=function(){return whiteSpaceElementsMap},self.getSpecialElements=function(){return specialElements},self.isValidChild=function(name,child){var parent=children[name];return!(!parent||!parent[child])},self.isValid=function(name,attr){var attrPatterns,i,rule=getElementRule(name);if(rule){if(!attr)return!0;if(rule.attributes[attr])return!0;if(attrPatterns=rule.attributePatterns)for(i=attrPatterns.length;i--;)if(attrPatterns[i].pattern.test(name))return!0}return!1},self.getElementRule=getElementRule,self.getCustomElements=function(){return customElementsMap},self.addValidElements=addValidElements,self.setValidElements=setValidElements,self.addCustomElements=addCustomElements,self.addValidChildren=addValidChildren,self.elements=elements}}),define("tinymce/html/SaxParser",["tinymce/html/Schema","tinymce/html/Entities","tinymce/util/Tools"],function(Schema,Entities,Tools){function findEndTag(schema,html,startIndex){var index,matches,tokenRegExp,shortEndedElements,count=1;for(shortEndedElements=schema.getShortEndedElements(),tokenRegExp=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g,tokenRegExp.lastIndex=index=startIndex;matches=tokenRegExp.exec(html);){if(index=tokenRegExp.lastIndex,"/"===matches[1])count--;else if(!matches[1]){if(matches[2]in shortEndedElements)continue;count++}if(0===count)break}return index}function SaxParser(settings,schema){function noop(){}var self=this;settings=settings||{},self.schema=schema=schema||new Schema,settings.fix_self_closing!==!1&&(settings.fix_self_closing=!0),each("comment cdata text start end pi doctype".split(" "),function(name){name&&(self[name]=settings[name]||noop)}),self.parse=function(html){function processEndTag(name){var pos,i;for(pos=stack.length;pos--&&stack[pos].name!==name;);if(pos>=0){for(i=stack.length-1;i>=pos;i--)name=stack[i],name.valid&&self.end(name.name);stack.length=pos}}function parseAttribute(match,name,value,val2,val3){var attrRule,i,trimRegExp=/[\s\u0000-\u001F]+/g;if(name=name.toLowerCase(),value=name in fillAttrsMap?name:decode(value||val2||val3||""),validate&&!isInternalElement&&0!==name.indexOf("data-")){if(attrRule=validAttributesMap[name],!attrRule&&validAttributePatterns){for(i=validAttributePatterns.length;i--&&(attrRule=validAttributePatterns[i],!attrRule.pattern.test(name)););-1===i&&(attrRule=null)}if(!attrRule)return;if(attrRule.validValues&&!(value in attrRule.validValues))return}if(filteredUrlAttrs[name]&&!settings.allow_script_urls){var uri=value.replace(trimRegExp,"");try{uri=decodeURIComponent(uri)}catch(ex){uri=unescape(uri)}if(scriptUriRegExp.test(uri))return;if(!settings.allow_html_data_urls&&dataUriRegExp.test(uri)&&!/^data:image\//i.test(uri))return}attrList.map[name]=value,attrList.push({name:name,value:value})}var matches,value,endRegExp,attrList,i,text,name,isInternalElement,removeInternalElements,shortEndedElements,fillAttrsMap,isShortEnded,validate,elementRule,isValidElement,attr,attribsValue,validAttributesMap,validAttributePatterns,attributesRequired,attributesDefault,attributesForced,anyAttributesRequired,selfClosing,tokenRegExp,attrRegExp,specialElements,attrValue,fixSelfClosing,self=this,index=0,stack=[],idCount=0,decode=Entities.decode,filteredUrlAttrs=Tools.makeMap("src,href,data,background,formaction,poster"),scriptUriRegExp=/((java|vb)script|mhtml):/i,dataUriRegExp=/^data:/i;for(tokenRegExp=new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([A-Za-z0-9\\-_\\:\\.]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),attrRegExp=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,shortEndedElements=schema.getShortEndedElements(),selfClosing=settings.self_closing_elements||schema.getSelfClosingElements(),fillAttrsMap=schema.getBoolAttrs(),validate=settings.validate,removeInternalElements=settings.remove_internals,fixSelfClosing=settings.fix_self_closing,specialElements=schema.getSpecialElements();matches=tokenRegExp.exec(html);){if(index<matches.index&&self.text(decode(html.substr(index,matches.index-index))),value=matches[6])value=value.toLowerCase(),":"===value.charAt(0)&&(value=value.substr(1)),processEndTag(value);else if(value=matches[7]){if(value=value.toLowerCase(),":"===value.charAt(0)&&(value=value.substr(1)),isShortEnded=value in shortEndedElements,fixSelfClosing&&selfClosing[value]&&stack.length>0&&stack[stack.length-1].name===value&&processEndTag(value),!validate||(elementRule=schema.getElementRule(value))){if(isValidElement=!0,validate&&(validAttributesMap=elementRule.attributes,validAttributePatterns=elementRule.attributePatterns),(attribsValue=matches[8])?(isInternalElement=-1!==attribsValue.indexOf("data-mce-type"),isInternalElement&&removeInternalElements&&(isValidElement=!1),attrList=[],attrList.map={},attribsValue.replace(attrRegExp,parseAttribute)):(attrList=[],attrList.map={}),validate&&!isInternalElement){if(attributesRequired=elementRule.attributesRequired,attributesDefault=elementRule.attributesDefault,attributesForced=elementRule.attributesForced,anyAttributesRequired=elementRule.removeEmptyAttrs,anyAttributesRequired&&!attrList.length&&(isValidElement=!1),attributesForced)for(i=attributesForced.length;i--;)attr=attributesForced[i],name=attr.name,attrValue=attr.value,"{$uid}"===attrValue&&(attrValue="mce_"+idCount++),attrList.map[name]=attrValue,attrList.push({name:name,value:attrValue});if(attributesDefault)for(i=attributesDefault.length;i--;)attr=attributesDefault[i],name=attr.name,name in attrList.map||(attrValue=attr.value,"{$uid}"===attrValue&&(attrValue="mce_"+idCount++),attrList.map[name]=attrValue,attrList.push({name:name,value:attrValue}));if(attributesRequired){for(i=attributesRequired.length;i--&&!(attributesRequired[i]in attrList.map););-1===i&&(isValidElement=!1)}if(attr=attrList.map["data-mce-bogus"]){if("all"===attr){index=findEndTag(schema,html,tokenRegExp.lastIndex),tokenRegExp.lastIndex=index;continue}isValidElement=!1}}isValidElement&&self.start(value,attrList,isShortEnded)}else isValidElement=!1;if(endRegExp=specialElements[value]){endRegExp.lastIndex=index=matches.index+matches[0].length,(matches=endRegExp.exec(html))?(isValidElement&&(text=html.substr(index,matches.index-index)),index=matches.index+matches[0].length):(text=html.substr(index),index=html.length),isValidElement&&(text.length>0&&self.text(text,!0),self.end(value)),tokenRegExp.lastIndex=index;continue}isShortEnded||(attribsValue&&attribsValue.indexOf("/")==attribsValue.length-1?isValidElement&&self.end(value):stack.push({name:value,valid:isValidElement}))}else(value=matches[1])?(">"===value.charAt(0)&&(value=" "+value),settings.allow_conditional_comments||"[if"!==value.substr(0,3)||(value=" "+value),self.comment(value)):(value=matches[2])?self.cdata(value):(value=matches[3])?self.doctype(value):(value=matches[4])&&self.pi(value,matches[5]);index=matches.index+matches[0].length}for(index<html.length&&self.text(decode(html.substr(index))),i=stack.length-1;i>=0;i--)value=stack[i],value.valid&&self.end(value.name)}}var each=Tools.each;return SaxParser.findEndTag=findEndTag,SaxParser}),define("tinymce/html/DomParser",["tinymce/html/Node","tinymce/html/Schema","tinymce/html/SaxParser","tinymce/util/Tools"],function(Node,Schema,SaxParser,Tools){var makeMap=Tools.makeMap,each=Tools.each,explode=Tools.explode,extend=Tools.extend;return function(settings,schema){function fixInvalidChildren(nodes){var ni,node,parent,parents,newParent,currentNode,tempNode,childNode,i,nonEmptyElements,nonSplitableElements,textBlockElements,specialElements,sibling,nextNode;for(nonSplitableElements=makeMap("tr,td,th,tbody,thead,tfoot,table"),nonEmptyElements=schema.getNonEmptyElements(),textBlockElements=schema.getTextBlockElements(),specialElements=schema.getSpecialElements(),ni=0;ni<nodes.length;ni++)if(node=nodes[ni],node.parent&&!node.fixed)if(textBlockElements[node.name]&&"li"==node.parent.name){for(sibling=node.next;sibling&&textBlockElements[sibling.name];)sibling.name="li",sibling.fixed=!0,node.parent.insert(sibling,node.parent),sibling=sibling.next;node.unwrap(node)}else{for(parents=[node],parent=node.parent;parent&&!schema.isValidChild(parent.name,node.name)&&!nonSplitableElements[parent.name];parent=parent.parent)parents.push(parent);if(parent&&parents.length>1){for(parents.reverse(),newParent=currentNode=self.filterNode(parents[0].clone()),i=0;i<parents.length-1;i++){for(schema.isValidChild(currentNode.name,parents[i].name)?(tempNode=self.filterNode(parents[i].clone()),currentNode.append(tempNode)):tempNode=currentNode,childNode=parents[i].firstChild;childNode&&childNode!=parents[i+1];)nextNode=childNode.next,tempNode.append(childNode),childNode=nextNode;currentNode=tempNode}newParent.isEmpty(nonEmptyElements)?parent.insert(node,parents[0],!0):(parent.insert(newParent,parents[0],!0),parent.insert(node,newParent)),parent=parents[0],(parent.isEmpty(nonEmptyElements)||parent.firstChild===parent.lastChild&&"br"===parent.firstChild.name)&&parent.empty().remove()}else if(node.parent){if("li"===node.name){if(sibling=node.prev,sibling&&("ul"===sibling.name||"ul"===sibling.name)){sibling.append(node);continue}if(sibling=node.next,sibling&&("ul"===sibling.name||"ul"===sibling.name)){sibling.insert(node,sibling.firstChild,!0);continue}node.wrap(self.filterNode(new Node("ul",1)));continue}schema.isValidChild(node.parent.name,"div")&&schema.isValidChild("div",node.name)?node.wrap(self.filterNode(new Node("div",1))):specialElements[node.name]?node.empty().remove():node.unwrap()}}}var self=this,nodeFilters={},attributeFilters=[],matchedNodes={},matchedAttributes={};settings=settings||{},settings.validate="validate"in settings?settings.validate:!0,settings.root_name=settings.root_name||"body",self.schema=schema=schema||new Schema,self.filterNode=function(node){var i,name,list;name in nodeFilters&&(list=matchedNodes[name],list?list.push(node):matchedNodes[name]=[node]),i=attributeFilters.length;for(;i--;)name=attributeFilters[i].name,name in node.attributes.map&&(list=matchedAttributes[name],list?list.push(node):matchedAttributes[name]=[node]);return node},self.addNodeFilter=function(name,callback){each(explode(name),function(name){var list=nodeFilters[name];list||(nodeFilters[name]=list=[]),list.push(callback)})},self.addAttributeFilter=function(name,callback){each(explode(name),function(name){var i;for(i=0;i<attributeFilters.length;i++)if(attributeFilters[i].name===name)return void attributeFilters[i].callbacks.push(callback);attributeFilters.push({name:name,callbacks:[callback]})})},self.parse=function(html,args){function addRootBlocks(){function trim(rootBlockNode){rootBlockNode&&(node=rootBlockNode.firstChild,node&&3==node.type&&(node.value=node.value.replace(startWhiteSpaceRegExp,"")),node=rootBlockNode.lastChild,node&&3==node.type&&(node.value=node.value.replace(endWhiteSpaceRegExp,"")))}var next,rootBlockNode,node=rootNode.firstChild;if(schema.isValidChild(rootNode.name,rootBlockName.toLowerCase())){for(;node;)next=node.next,3==node.type||1==node.type&&"p"!==node.name&&!blockElements[node.name]&&!node.attr("data-mce-type")?rootBlockNode?rootBlockNode.append(node):(rootBlockNode=createNode(rootBlockName,1),rootBlockNode.attr(settings.forced_root_block_attrs),rootNode.insert(rootBlockNode,node),rootBlockNode.append(node)):(trim(rootBlockNode),rootBlockNode=null),node=next;trim(rootBlockNode)}}function createNode(name,type){var list,node=new Node(name,type);return name in nodeFilters&&(list=matchedNodes[name],list?list.push(node):matchedNodes[name]=[node]),node}function removeWhitespaceBefore(node){var textNode,textNodeNext,textVal,sibling,blockElements=schema.getBlockElements();for(textNode=node.prev;textNode&&3===textNode.type;){if(textVal=textNode.value.replace(endWhiteSpaceRegExp,""),textVal.length>0)return void(textNode.value=textVal);if(textNodeNext=textNode.next){if(3==textNodeNext.type&&textNodeNext.value.length){textNode=textNode.prev;continue}if(!blockElements[textNodeNext.name]&&"script"!=textNodeNext.name&&"style"!=textNodeNext.name){textNode=textNode.prev;continue}}sibling=textNode.prev,textNode.remove(),textNode=sibling}}function cloneAndExcludeBlocks(input){var name,output={};for(name in input)"li"!==name&&"p"!=name&&(output[name]=input[name]);return output}var parser,rootNode,node,nodes,i,l,fi,fl,list,name,validate,blockElements,startWhiteSpaceRegExp,isInWhiteSpacePreservedElement,endWhiteSpaceRegExp,allWhiteSpaceRegExp,isAllWhiteSpaceRegExp,whiteSpaceElements,children,nonEmptyElements,rootBlockName,invalidChildren=[];if(args=args||{},matchedNodes={},matchedAttributes={},blockElements=extend(makeMap("script,style,head,html,body,title,meta,param"),schema.getBlockElements()),nonEmptyElements=schema.getNonEmptyElements(),children=schema.children,validate=settings.validate,rootBlockName="forced_root_block"in args?args.forced_root_block:settings.forced_root_block,whiteSpaceElements=schema.getWhiteSpaceElements(),startWhiteSpaceRegExp=/^[ \t\r\n]+/,endWhiteSpaceRegExp=/[ \t\r\n]+$/,allWhiteSpaceRegExp=/[ \t\r\n]+/g,isAllWhiteSpaceRegExp=/^[ \t\r\n]+$/,parser=new SaxParser({validate:validate,allow_script_urls:settings.allow_script_urls,allow_conditional_comments:settings.allow_conditional_comments,self_closing_elements:cloneAndExcludeBlocks(schema.getSelfClosingElements()),cdata:function(text){node.append(createNode("#cdata",4)).value=text},text:function(text,raw){var textNode;isInWhiteSpacePreservedElement||(text=text.replace(allWhiteSpaceRegExp," "),node.lastChild&&blockElements[node.lastChild.name]&&(text=text.replace(startWhiteSpaceRegExp,""))),0!==text.length&&(textNode=createNode("#text",3),textNode.raw=!!raw,node.append(textNode).value=text)},comment:function(text){node.append(createNode("#comment",8)).value=text},pi:function(name,text){node.append(createNode(name,7)).value=text,removeWhitespaceBefore(node)},doctype:function(text){var newNode;newNode=node.append(createNode("#doctype",10)),newNode.value=text,removeWhitespaceBefore(node)},start:function(name,attrs,empty){var newNode,attrFiltersLen,elementRule,attrName,parent;if(elementRule=validate?schema.getElementRule(name):{}){for(newNode=createNode(elementRule.outputName||name,1),newNode.attributes=attrs,newNode.shortEnded=empty,node.append(newNode),parent=children[node.name],parent&&children[newNode.name]&&!parent[newNode.name]&&invalidChildren.push(newNode),attrFiltersLen=attributeFilters.length;attrFiltersLen--;)attrName=attributeFilters[attrFiltersLen].name,attrName in attrs.map&&(list=matchedAttributes[attrName],list?list.push(newNode):matchedAttributes[attrName]=[newNode]);blockElements[name]&&removeWhitespaceBefore(newNode),empty||(node=newNode),!isInWhiteSpacePreservedElement&&whiteSpaceElements[name]&&(isInWhiteSpacePreservedElement=!0)}},end:function(name){var textNode,elementRule,text,sibling,tempNode;if(elementRule=validate?schema.getElementRule(name):{}){if(blockElements[name]&&!isInWhiteSpacePreservedElement){
if(textNode=node.firstChild,textNode&&3===textNode.type)if(text=textNode.value.replace(startWhiteSpaceRegExp,""),text.length>0)textNode.value=text,textNode=textNode.next;else for(sibling=textNode.next,textNode.remove(),textNode=sibling;textNode&&3===textNode.type;)text=textNode.value,sibling=textNode.next,(0===text.length||isAllWhiteSpaceRegExp.test(text))&&(textNode.remove(),textNode=sibling),textNode=sibling;if(textNode=node.lastChild,textNode&&3===textNode.type)if(text=textNode.value.replace(endWhiteSpaceRegExp,""),text.length>0)textNode.value=text,textNode=textNode.prev;else for(sibling=textNode.prev,textNode.remove(),textNode=sibling;textNode&&3===textNode.type;)text=textNode.value,sibling=textNode.prev,(0===text.length||isAllWhiteSpaceRegExp.test(text))&&(textNode.remove(),textNode=sibling),textNode=sibling}if(isInWhiteSpacePreservedElement&&whiteSpaceElements[name]&&(isInWhiteSpacePreservedElement=!1),(elementRule.removeEmpty||elementRule.paddEmpty)&&node.isEmpty(nonEmptyElements))if(elementRule.paddEmpty)node.empty().append(new Node("#text","3")).value=" ";else if(!node.attributes.map.name&&!node.attributes.map.id)return tempNode=node.parent,blockElements[node.name]?node.empty().remove():node.unwrap(),void(node=tempNode);node=node.parent}}},schema),rootNode=node=new Node(args.context||settings.root_name,11),parser.parse(html),validate&&invalidChildren.length&&(args.context?args.invalid=!0:fixInvalidChildren(invalidChildren)),rootBlockName&&("body"==rootNode.name||args.isRootContent)&&addRootBlocks(),!args.invalid){for(name in matchedNodes){for(list=nodeFilters[name],nodes=matchedNodes[name],fi=nodes.length;fi--;)nodes[fi].parent||nodes.splice(fi,1);for(i=0,l=list.length;l>i;i++)list[i](nodes,name,args)}for(i=0,l=attributeFilters.length;l>i;i++)if(list=attributeFilters[i],list.name in matchedAttributes){for(nodes=matchedAttributes[list.name],fi=nodes.length;fi--;)nodes[fi].parent||nodes.splice(fi,1);for(fi=0,fl=list.callbacks.length;fl>fi;fi++)list.callbacks[fi](nodes,list.name,args)}}return rootNode},settings.remove_trailing_brs&&self.addNodeFilter("br",function(nodes){var i,node,parent,lastParent,prev,prevName,elementRule,textNode,l=nodes.length,blockElements=extend({},schema.getBlockElements()),nonEmptyElements=schema.getNonEmptyElements();for(blockElements.body=1,i=0;l>i;i++)if(node=nodes[i],parent=node.parent,blockElements[node.parent.name]&&node===parent.lastChild){for(prev=node.prev;prev;){if(prevName=prev.name,"span"!==prevName||"bookmark"!==prev.attr("data-mce-type")){if("br"!==prevName)break;if("br"===prevName){node=null;break}}prev=prev.prev}node&&(node.remove(),parent.isEmpty(nonEmptyElements)&&(elementRule=schema.getElementRule(parent.name),elementRule&&(elementRule.removeEmpty?parent.remove():elementRule.paddEmpty&&(parent.empty().append(new Node("#text",3)).value=" "))))}else{for(lastParent=node;parent&&parent.firstChild===lastParent&&parent.lastChild===lastParent&&(lastParent=parent,!blockElements[parent.name]);)parent=parent.parent;lastParent===parent&&(textNode=new Node("#text",3),textNode.value=" ",node.replace(textNode))}}),settings.allow_html_in_named_anchor||self.addAttributeFilter("id,name",function(nodes){for(var sibling,prevSibling,parent,node,i=nodes.length;i--;)if(node=nodes[i],"a"===node.name&&node.firstChild&&!node.attr("href")){parent=node.parent,sibling=node.lastChild;do prevSibling=sibling.prev,parent.insert(sibling,node),sibling=prevSibling;while(sibling)}}),settings.validate&&schema.getValidClasses()&&self.addAttributeFilter("class",function(nodes){for(var node,classList,ci,className,classValue,validClassesMap,valid,i=nodes.length,validClasses=schema.getValidClasses();i--;){for(node=nodes[i],classList=node.attr("class").split(" "),classValue="",ci=0;ci<classList.length;ci++)className=classList[ci],valid=!1,validClassesMap=validClasses["*"],validClassesMap&&validClassesMap[className]&&(valid=!0),validClassesMap=validClasses[node.name],!valid&&validClassesMap&&validClassesMap[className]&&(valid=!0),valid&&(classValue&&(classValue+=" "),classValue+=className);classValue.length||(classValue=null),node.attr("class",classValue)}})}}),define("tinymce/html/Writer",["tinymce/html/Entities","tinymce/util/Tools"],function(Entities,Tools){var makeMap=Tools.makeMap;return function(settings){var indent,indentBefore,indentAfter,encode,htmlOutput,html=[];return settings=settings||{},indent=settings.indent,indentBefore=makeMap(settings.indent_before||""),indentAfter=makeMap(settings.indent_after||""),encode=Entities.getEncodeFunc(settings.entity_encoding||"raw",settings.entities),htmlOutput="html"==settings.element_format,{start:function(name,attrs,empty){var i,l,attr,value;if(indent&&indentBefore[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n")),html.push("<",name),attrs)for(i=0,l=attrs.length;l>i;i++)attr=attrs[i],html.push(" ",attr.name,'="',encode(attr.value,!0),'"');!empty||htmlOutput?html[html.length]=">":html[html.length]=" />",empty&&indent&&indentAfter[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n"))},end:function(name){var value;html.push("</",name,">"),indent&&indentAfter[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n"))},text:function(text,raw){text.length>0&&(html[html.length]=raw?text:encode(text))},cdata:function(text){html.push("<![CDATA[",text,"]]>")},comment:function(text){html.push("<!--",text,"-->")},pi:function(name,text){text?html.push("<?",name," ",encode(text),"?>"):html.push("<?",name,"?>"),indent&&html.push("\n")},doctype:function(text){html.push("<!DOCTYPE",text,">",indent?"\n":"")},reset:function(){html.length=0},getContent:function(){return html.join("").replace(/\n$/,"")}}}}),define("tinymce/html/Serializer",["tinymce/html/Writer","tinymce/html/Schema"],function(Writer,Schema){return function(settings,schema){var self=this,writer=new Writer(settings);settings=settings||{},settings.validate="validate"in settings?settings.validate:!0,self.schema=schema=schema||new Schema,self.writer=writer,self.serialize=function(node){function walk(node){var name,isEmpty,attrs,attrName,attrValue,sortedAttrs,i,l,elementRule,handler=handlers[node.type];if(handler)handler(node);else{if(name=node.name,isEmpty=node.shortEnded,attrs=node.attributes,validate&&attrs&&attrs.length>1&&(sortedAttrs=[],sortedAttrs.map={},elementRule=schema.getElementRule(node.name))){for(i=0,l=elementRule.attributesOrder.length;l>i;i++)attrName=elementRule.attributesOrder[i],attrName in attrs.map&&(attrValue=attrs.map[attrName],sortedAttrs.map[attrName]=attrValue,sortedAttrs.push({name:attrName,value:attrValue}));for(i=0,l=attrs.length;l>i;i++)attrName=attrs[i].name,attrName in sortedAttrs.map||(attrValue=attrs.map[attrName],sortedAttrs.map[attrName]=attrValue,sortedAttrs.push({name:attrName,value:attrValue}));attrs=sortedAttrs}if(writer.start(node.name,attrs,isEmpty),!isEmpty){if(node=node.firstChild)do walk(node);while(node=node.next);writer.end(name)}}}var handlers,validate;return validate=settings.validate,handlers={3:function(node){writer.text(node.value,node.raw)},8:function(node){writer.comment(node.value)},7:function(node){writer.pi(node.name,node.value)},10:function(node){writer.doctype(node.value)},4:function(node){writer.cdata(node.value)},11:function(node){if(node=node.firstChild)do walk(node);while(node=node.next)}},writer.reset(),1!=node.type||settings.inner?handlers[11](node):walk(node),writer.getContent()}}}),define("tinymce/dom/Serializer",["tinymce/dom/DOMUtils","tinymce/html/DomParser","tinymce/html/SaxParser","tinymce/html/Entities","tinymce/html/Serializer","tinymce/html/Node","tinymce/html/Schema","tinymce/Env","tinymce/util/Tools","tinymce/text/Zwsp"],function(DOMUtils,DomParser,SaxParser,Entities,Serializer,Node,Schema,Env,Tools,Zwsp){function trimTrailingBr(rootNode){function isBr(node){return node&&"br"===node.name}var brNode1,brNode2;brNode1=rootNode.lastChild,isBr(brNode1)&&(brNode2=brNode1.prev,isBr(brNode2)&&(brNode1.remove(),brNode2.remove()))}var each=Tools.each,trim=Tools.trim,DOM=DOMUtils.DOM,tempAttrs=["data-mce-selected"];return function(settings,editor){function trimHtml(html){var trimContentRegExp=new RegExp(["<span[^>]+data-mce-bogus[^>]+>[​\ufeff]+<\\/span>","\\s?("+tempAttrs.join("|")+')="[^"]+"'].join("|"),"gi");return html=Zwsp.trim(html.replace(trimContentRegExp,""))}function getTrimmedContent(){var endTagIndex,index,matchLength,matches,shortEndedElements,content=editor.getBody().innerHTML,bogusAllRegExp=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,schema=editor.schema;for(content=trimHtml(content),shortEndedElements=schema.getShortEndedElements();matches=bogusAllRegExp.exec(content);)index=bogusAllRegExp.lastIndex,matchLength=matches[0].length,endTagIndex=shortEndedElements[matches[1]]?index:SaxParser.findEndTag(schema,content,index),content=content.substring(0,index-matchLength)+content.substring(endTagIndex),bogusAllRegExp.lastIndex=index-matchLength;return trim(content)}function addTempAttr(name){-1===Tools.inArray(tempAttrs,name)&&(htmlParser.addAttributeFilter(name,function(nodes,name){for(var i=nodes.length;i--;)nodes[i].attr(name,null)}),tempAttrs.push(name))}var dom,schema,htmlParser;return editor&&(dom=editor.dom,schema=editor.schema),dom=dom||DOM,schema=schema||new Schema(settings),settings.entity_encoding=settings.entity_encoding||"named",settings.remove_trailing_brs="remove_trailing_brs"in settings?settings.remove_trailing_brs:!0,htmlParser=new DomParser(settings,schema),htmlParser.addAttributeFilter("data-mce-tabindex",function(nodes,name){for(var node,i=nodes.length;i--;)node=nodes[i],node.attr("tabindex",node.attributes.map["data-mce-tabindex"]),node.attr(name,null)}),htmlParser.addAttributeFilter("src,href,style",function(nodes,name){for(var node,value,undef,i=nodes.length,internalName="data-mce-"+name,urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope;i--;)node=nodes[i],value=node.attributes.map[internalName],value!==undef?(node.attr(name,value.length>0?value:null),node.attr(internalName,null)):(value=node.attributes.map[name],"style"===name?value=dom.serializeStyle(dom.parseStyle(value),node.name):urlConverter&&(value=urlConverter.call(urlConverterScope,value,name,node.name)),node.attr(name,value.length>0?value:null))}),htmlParser.addAttributeFilter("class",function(nodes){for(var node,value,i=nodes.length;i--;)node=nodes[i],value=node.attr("class"),value&&(value=node.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),node.attr("class",value.length>0?value:null))}),htmlParser.addAttributeFilter("data-mce-type",function(nodes,name,args){for(var node,i=nodes.length;i--;)node=nodes[i],"bookmark"!==node.attributes.map["data-mce-type"]||args.cleanup||node.remove()}),htmlParser.addNodeFilter("noscript",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i].firstChild,node&&(node.value=Entities.decode(node.value))}),htmlParser.addNodeFilter("script,style",function(nodes,name){function trim(value){return value.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")}for(var node,value,type,i=nodes.length;i--;)node=nodes[i],value=node.firstChild?node.firstChild.value:"","script"===name?(type=node.attr("type"),type&&node.attr("type","mce-no/type"==type?null:type.replace(/^mce\-/,"")),value.length>0&&(node.firstChild.value="// <![CDATA[\n"+trim(value)+"\n// ]]>")):value.length>0&&(node.firstChild.value="<!--\n"+trim(value)+"\n-->")}),htmlParser.addNodeFilter("#comment",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],0===node.value.indexOf("[CDATA[")?(node.name="#cdata",node.type=4,node.value=node.value.replace(/^\[CDATA\[|\]\]$/g,"")):0===node.value.indexOf("mce:protected ")&&(node.name="#text",node.type=3,node.raw=!0,node.value=unescape(node.value).substr(14))}),htmlParser.addNodeFilter("xml:namespace,input",function(nodes,name){for(var node,i=nodes.length;i--;)node=nodes[i],7===node.type?node.remove():1===node.type&&("input"!==name||"type"in node.attributes.map||node.attr("type","text"))}),settings.fix_list_elements&&htmlParser.addNodeFilter("ul,ol",function(nodes){for(var node,parentNode,i=nodes.length;i--;)node=nodes[i],parentNode=node.parent,"ul"!==parentNode.name&&"ol"!==parentNode.name||node.prev&&"li"===node.prev.name&&node.prev.append(node)}),htmlParser.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize",function(nodes,name){for(var i=nodes.length;i--;)nodes[i].attr(name,null)}),{schema:schema,addNodeFilter:htmlParser.addNodeFilter,addAttributeFilter:htmlParser.addAttributeFilter,serialize:function(node,args){var impl,doc,oldDoc,htmlSerializer,content,rootNode,self=this;return Env.ie&&dom.select("script,style,select,map").length>0?(content=node.innerHTML,node=node.cloneNode(!1),dom.setHTML(node,content)):node=node.cloneNode(!0),impl=node.ownerDocument.implementation,impl.createHTMLDocument&&(doc=impl.createHTMLDocument(""),each("BODY"==node.nodeName?node.childNodes:[node],function(node){doc.body.appendChild(doc.importNode(node,!0))}),node="BODY"!=node.nodeName?doc.body.firstChild:doc.body,oldDoc=dom.doc,dom.doc=doc),args=args||{},args.format=args.format||"html",args.selection&&(args.forced_root_block=""),args.no_events||(args.node=node,self.onPreProcess(args)),rootNode=htmlParser.parse(trim(args.getInner?node.innerHTML:dom.getOuterHTML(node)),args),trimTrailingBr(rootNode),htmlSerializer=new Serializer(settings,schema),args.content=htmlSerializer.serialize(rootNode),args.cleanup||(args.content=Zwsp.trim(args.content),args.content=args.content.replace(/\uFEFF/g,"")),args.no_events||self.onPostProcess(args),oldDoc&&(dom.doc=oldDoc),args.node=null,args.content},addRules:function(rules){schema.addValidElements(rules)},setRules:function(rules){schema.setValidElements(rules)},onPreProcess:function(args){editor&&editor.fire("PreProcess",args)},onPostProcess:function(args){editor&&editor.fire("PostProcess",args)},addTempAttr:addTempAttr,trimHtml:trimHtml,getTrimmedContent:getTrimmedContent}}}),define("tinymce/dom/TridentSelection",[],function(){function Selection(selection){function getPosition(rng,start){var checkRng,endIndex,inside,children,child,offset,index,parent,startIndex=0,position=-1;if(checkRng=rng.duplicate(),checkRng.collapse(start),parent=checkRng.parentElement(),parent.ownerDocument===selection.dom.doc){for(;"false"===parent.contentEditable;)parent=parent.parentNode;if(!parent.hasChildNodes())return{node:parent,inside:1};for(children=parent.children,endIndex=children.length-1;endIndex>=startIndex;)if(index=Math.floor((startIndex+endIndex)/2),child=children[index],checkRng.moveToElementText(child),position=checkRng.compareEndPoints(start?"StartToStart":"EndToEnd",rng),position>0)endIndex=index-1;else{if(!(0>position))return{node:child};startIndex=index+1}if(0>position)for(child?checkRng.collapse(!1):(checkRng.moveToElementText(parent),checkRng.collapse(!0),child=parent,inside=!0),offset=0;0!==checkRng.compareEndPoints(start?"StartToStart":"StartToEnd",rng)&&0!==checkRng.move("character",1)&&parent==checkRng.parentElement();)offset++;else for(checkRng.collapse(!0),offset=0;0!==checkRng.compareEndPoints(start?"StartToStart":"StartToEnd",rng)&&0!==checkRng.move("character",-1)&&parent==checkRng.parentElement();)offset++;return{node:child,position:position,offset:offset,inside:inside}}}function getRange(){function findEndPoint(start){var container,offset,sibling,undef,nodeValue,endPoint=getPosition(ieRange,start),textNodeOffset=0;if(container=endPoint.node,offset=endPoint.offset,endPoint.inside&&!container.hasChildNodes())return void domRange[start?"setStart":"setEnd"](container,0);if(offset===undef)return void domRange[start?"setStartBefore":"setEndAfter"](container);if(endPoint.position<0){if(sibling=endPoint.inside?container.firstChild:container.nextSibling,!sibling)return void domRange[start?"setStartAfter":"setEndAfter"](container);if(!offset)return void(3==sibling.nodeType?domRange[start?"setStart":"setEnd"](sibling,0):domRange[start?"setStartBefore":"setEndBefore"](sibling));for(;sibling;){if(3==sibling.nodeType&&(nodeValue=sibling.nodeValue,textNodeOffset+=nodeValue.length,textNodeOffset>=offset)){container=sibling,textNodeOffset-=offset,textNodeOffset=nodeValue.length-textNodeOffset;break}sibling=sibling.nextSibling}}else{if(sibling=container.previousSibling,!sibling)return domRange[start?"setStartBefore":"setEndBefore"](container);if(!offset)return void(3==container.nodeType?domRange[start?"setStart":"setEnd"](sibling,container.nodeValue.length):domRange[start?"setStartAfter":"setEndAfter"](sibling));for(;sibling;){if(3==sibling.nodeType&&(textNodeOffset+=sibling.nodeValue.length,textNodeOffset>=offset)){container=sibling,textNodeOffset-=offset;break}sibling=sibling.previousSibling}}domRange[start?"setStart":"setEnd"](container,textNodeOffset)}var element,collapsed,tmpRange,element2,bookmark,ieRange=selection.getRng(),domRange=dom.createRng();if(element=ieRange.item?ieRange.item(0):ieRange.parentElement(),element.ownerDocument!=dom.doc)return domRange;if(collapsed=selection.isCollapsed(),ieRange.item)return domRange.setStart(element.parentNode,dom.nodeIndex(element)),domRange.setEnd(domRange.startContainer,domRange.startOffset+1),domRange;try{findEndPoint(!0),collapsed||findEndPoint()}catch(ex){if(-2147024809!=ex.number)throw ex;bookmark=self.getBookmark(2),tmpRange=ieRange.duplicate(),tmpRange.collapse(!0),element=tmpRange.parentElement(),collapsed||(tmpRange=ieRange.duplicate(),tmpRange.collapse(!1),element2=tmpRange.parentElement(),element2.innerHTML=element2.innerHTML),element.innerHTML=element.innerHTML,self.moveToBookmark(bookmark),ieRange=selection.getRng(),findEndPoint(!0),collapsed||findEndPoint()}return domRange}var self=this,dom=selection.dom,FALSE=!1;this.getBookmark=function(type){function getIndexes(node){var parent,root,children,i,indexes=[];for(parent=node.parentNode,root=dom.getRoot().parentNode;parent!=root&&9!==parent.nodeType;){for(children=parent.children,i=children.length;i--;)if(node===children[i]){indexes.push(i);break}node=parent,parent=parent.parentNode}return indexes}function getBookmarkEndPoint(start){var position;return position=getPosition(rng,start),position?{position:position.position,offset:position.offset,indexes:getIndexes(position.node),inside:position.inside}:void 0}var rng=selection.getRng(),bookmark={};return 2===type&&(rng.item?bookmark.start={ctrl:!0,indexes:getIndexes(rng.item(0))}:(bookmark.start=getBookmarkEndPoint(!0),selection.isCollapsed()||(bookmark.end=getBookmarkEndPoint()))),bookmark},this.moveToBookmark=function(bookmark){function resolveIndexes(indexes){var node,i,idx,children;for(node=dom.getRoot(),i=indexes.length-1;i>=0;i--)children=node.children,idx=indexes[i],idx<=children.length-1&&(node=children[idx]);return node}function setBookmarkEndPoint(start){var moveLeft,moveRng,undef,offset,endPoint=bookmark[start?"start":"end"];endPoint&&(moveLeft=endPoint.position>0,moveRng=body.createTextRange(),moveRng.moveToElementText(resolveIndexes(endPoint.indexes)),offset=endPoint.offset,offset!==undef?(moveRng.collapse(endPoint.inside||moveLeft),moveRng.moveStart("character",moveLeft?-offset:offset)):moveRng.collapse(start),rng.setEndPoint(start?"StartToStart":"EndToStart",moveRng),start&&rng.collapse(!0))}var rng,body=dom.doc.body;bookmark.start&&(bookmark.start.ctrl?(rng=body.createControlRange(),rng.addElement(resolveIndexes(bookmark.start.indexes)),rng.select()):(rng=body.createTextRange(),setBookmarkEndPoint(!0),setBookmarkEndPoint(),rng.select()))},this.addRange=function(rng){function setEndPoint(start){var container,offset,marker,tmpRng,nodes;marker=dom.create("a"),container=start?startContainer:endContainer,offset=start?startOffset:endOffset,tmpRng=ieRng.duplicate(),container!=doc&&container!=doc.documentElement||(container=body,offset=0),3==container.nodeType?(container.parentNode.insertBefore(marker,container),tmpRng.moveToElementText(marker),tmpRng.moveStart("character",offset),dom.remove(marker),ieRng.setEndPoint(start?"StartToStart":"EndToEnd",tmpRng)):(nodes=container.childNodes,nodes.length?(offset>=nodes.length?dom.insertAfter(marker,nodes[nodes.length-1]):container.insertBefore(marker,nodes[offset]),tmpRng.moveToElementText(marker)):container.canHaveHTML&&(container.innerHTML="<span>&#xFEFF;</span>",marker=container.firstChild,tmpRng.moveToElementText(marker),tmpRng.collapse(FALSE)),ieRng.setEndPoint(start?"StartToStart":"EndToEnd",tmpRng),dom.remove(marker))}var ieRng,ctrlRng,startContainer,startOffset,endContainer,endOffset,sibling,nativeRng,ctrlElm,doc=selection.dom.doc,body=doc.body;if(startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,ieRng=body.createTextRange(),startContainer==endContainer&&1==startContainer.nodeType){if(startOffset==endOffset&&!startContainer.hasChildNodes()){if(startContainer.canHaveHTML)return sibling=startContainer.previousSibling,sibling&&!sibling.hasChildNodes()&&dom.isBlock(sibling)?sibling.innerHTML="&#xFEFF;":sibling=null,startContainer.innerHTML="<span>&#xFEFF;</span><span>&#xFEFF;</span>",ieRng.moveToElementText(startContainer.lastChild),ieRng.select(),dom.doc.selection.clear(),startContainer.innerHTML="",void(sibling&&(sibling.innerHTML=""));startOffset=dom.nodeIndex(startContainer),startContainer=startContainer.parentNode}if(startOffset==endOffset-1)try{if(ctrlElm=startContainer.childNodes[startOffset],ctrlRng=body.createControlRange(),ctrlRng.addElement(ctrlElm),ctrlRng.select(),nativeRng=selection.getRng(),nativeRng.item&&ctrlElm===nativeRng.item(0))return}catch(ex){}}setEndPoint(!0),setEndPoint(),ieRng.select()},this.getRangeAt=getRange}return Selection}),define("tinymce/util/VK",["tinymce/Env"],function(Env){return{BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return Env.mac?e.metaKey:e.ctrlKey&&!e.altKey}}}),define("tinymce/dom/ControlSelection",["tinymce/util/VK","tinymce/util/Tools","tinymce/util/Delay","tinymce/Env","tinymce/dom/NodeType"],function(VK,Tools,Delay,Env,NodeType){var isContentEditableFalse=NodeType.isContentEditableFalse;return function(selection,editor){function isResizable(elm){var selector=editor.settings.object_resizing;return selector===!1||Env.iOS?!1:("string"!=typeof selector&&(selector="table,img,div"),"false"===elm.getAttribute("data-mce-resize")?!1:elm==editor.getBody()?!1:editor.dom.is(elm,selector))}function resizeGhostElement(e){var deltaX,deltaY,proportional,resizeHelperX,resizeHelperY;deltaX=e.screenX-startX,deltaY=e.screenY-startY,width=deltaX*selectedHandle[2]+startW,height=deltaY*selectedHandle[3]+startH,width=5>width?5:width,height=5>height?5:height,proportional="IMG"==selectedElm.nodeName&&editor.settings.resize_img_proportional!==!1?!VK.modifierPressed(e):VK.modifierPressed(e)||"IMG"==selectedElm.nodeName&&selectedHandle[2]*selectedHandle[3]!==0,proportional&&(abs(deltaX)>abs(deltaY)?(height=round(width*ratio),width=round(height/ratio)):(width=round(height/ratio),height=round(width*ratio))),dom.setStyles(selectedElmGhost,{width:width,height:height}),resizeHelperX=selectedHandle.startPos.x+deltaX,resizeHelperY=selectedHandle.startPos.y+deltaY,resizeHelperX=resizeHelperX>0?resizeHelperX:0,resizeHelperY=resizeHelperY>0?resizeHelperY:0,dom.setStyles(resizeHelper,{left:resizeHelperX,top:resizeHelperY,display:"block"}),resizeHelper.innerHTML=width+" &times; "+height,selectedHandle[2]<0&&selectedElmGhost.clientWidth<=width&&dom.setStyle(selectedElmGhost,"left",selectedElmX+(startW-width)),selectedHandle[3]<0&&selectedElmGhost.clientHeight<=height&&dom.setStyle(selectedElmGhost,"top",selectedElmY+(startH-height)),deltaX=rootElement.scrollWidth-startScrollWidth,deltaY=rootElement.scrollHeight-startScrollHeight,deltaX+deltaY!==0&&dom.setStyles(resizeHelper,{left:resizeHelperX-deltaX,top:resizeHelperY-deltaY}),resizeStarted||(editor.fire("ObjectResizeStart",{target:selectedElm,width:startW,height:startH}),resizeStarted=!0)}function endGhostResize(){function setSizeProp(name,value){value&&(selectedElm.style[name]||!editor.schema.isValid(selectedElm.nodeName.toLowerCase(),name)?dom.setStyle(selectedElm,name,value):dom.setAttrib(selectedElm,name,value))}resizeStarted=!1,setSizeProp("width",width),setSizeProp("height",height),dom.unbind(editableDoc,"mousemove",resizeGhostElement),dom.unbind(editableDoc,"mouseup",endGhostResize),rootDocument!=editableDoc&&(dom.unbind(rootDocument,"mousemove",resizeGhostElement),dom.unbind(rootDocument,"mouseup",endGhostResize)),dom.remove(selectedElmGhost),dom.remove(resizeHelper),isIE&&"TABLE"!=selectedElm.nodeName||showResizeRect(selectedElm),editor.fire("ObjectResized",{target:selectedElm,width:width,height:height}),dom.setAttrib(selectedElm,"style",dom.getAttrib(selectedElm,"style")),editor.nodeChanged()}function showResizeRect(targetElm,mouseDownHandleName,mouseDownEvent){var position,targetWidth,targetHeight,e,rect;hideResizeRect(),unbindResizeHandleEvents(),position=dom.getPos(targetElm,rootElement),selectedElmX=position.x,selectedElmY=position.y,rect=targetElm.getBoundingClientRect(),targetWidth=rect.width||rect.right-rect.left,targetHeight=rect.height||rect.bottom-rect.top,selectedElm!=targetElm&&(detachResizeStartListener(),selectedElm=targetElm,width=height=0),e=editor.fire("ObjectSelected",{target:targetElm}),isResizable(targetElm)&&!e.isDefaultPrevented()?each(resizeHandles,function(handle,name){function startDrag(e){startX=e.screenX,startY=e.screenY,startW=selectedElm.clientWidth,startH=selectedElm.clientHeight,ratio=startH/startW,selectedHandle=handle,handle.startPos={x:targetWidth*handle[0]+selectedElmX,y:targetHeight*handle[1]+selectedElmY},startScrollWidth=rootElement.scrollWidth,startScrollHeight=rootElement.scrollHeight,selectedElmGhost=selectedElm.cloneNode(!0),dom.addClass(selectedElmGhost,"mce-clonedresizable"),dom.setAttrib(selectedElmGhost,"data-mce-bogus","all"),selectedElmGhost.contentEditable=!1,selectedElmGhost.unSelectabe=!0,dom.setStyles(selectedElmGhost,{left:selectedElmX,top:selectedElmY,margin:0}),selectedElmGhost.removeAttribute("data-mce-selected"),rootElement.appendChild(selectedElmGhost),dom.bind(editableDoc,"mousemove",resizeGhostElement),dom.bind(editableDoc,"mouseup",endGhostResize),rootDocument!=editableDoc&&(dom.bind(rootDocument,"mousemove",resizeGhostElement),dom.bind(rootDocument,"mouseup",endGhostResize)),resizeHelper=dom.add(rootElement,"div",{"class":"mce-resize-helper","data-mce-bogus":"all"},startW+" &times; "+startH)}var handleElm;return mouseDownHandleName?void(name==mouseDownHandleName&&startDrag(mouseDownEvent)):(handleElm=dom.get("mceResizeHandle"+name),handleElm&&dom.remove(handleElm),handleElm=dom.add(rootElement,"div",{id:"mceResizeHandle"+name,"data-mce-bogus":"all","class":"mce-resizehandle",unselectable:!0,style:"cursor:"+name+"-resize; margin:0; padding:0"}),Env.ie&&(handleElm.contentEditable=!1),dom.bind(handleElm,"mousedown",function(e){e.stopImmediatePropagation(),e.preventDefault(),startDrag(e)}),handle.elm=handleElm,void dom.setStyles(handleElm,{left:targetWidth*handle[0]+selectedElmX-handleElm.offsetWidth/2,top:targetHeight*handle[1]+selectedElmY-handleElm.offsetHeight/2}))}):hideResizeRect(),selectedElm.setAttribute("data-mce-selected","1")}function hideResizeRect(){var name,handleElm;unbindResizeHandleEvents(),selectedElm&&selectedElm.removeAttribute("data-mce-selected");for(name in resizeHandles)handleElm=dom.get("mceResizeHandle"+name),handleElm&&(dom.unbind(handleElm),dom.remove(handleElm))}function updateResizeRect(e){function isChildOrEqual(node,parent){if(node)do if(node===parent)return!0;while(node=node.parentNode)}var startElm,controlElm;return resizeStarted||editor.removed?void 0:(each(dom.select("img[data-mce-selected],hr[data-mce-selected]"),function(img){img.removeAttribute("data-mce-selected")}),controlElm="mousedown"==e.type?e.target:selection.getNode(),controlElm=dom.$(controlElm).closest(isIE?"table":"table,img,hr")[0],isChildOrEqual(controlElm,rootElement)&&(disableGeckoResize(),startElm=selection.getStart(!0),isChildOrEqual(startElm,controlElm)&&isChildOrEqual(selection.getEnd(!0),controlElm)&&(!isIE||controlElm!=startElm&&"IMG"!==startElm.nodeName))?void showResizeRect(controlElm):void hideResizeRect())}function attachEvent(elm,name,func){elm&&elm.attachEvent&&elm.attachEvent("on"+name,func)}function detachEvent(elm,name,func){elm&&elm.detachEvent&&elm.detachEvent("on"+name,func)}function resizeNativeStart(e){var pos,name,corner,cornerX,cornerY,relativeX,relativeY,target=e.srcElement;pos=target.getBoundingClientRect(),relativeX=lastMouseDownEvent.clientX-pos.left,relativeY=lastMouseDownEvent.clientY-pos.top;for(name in resizeHandles)if(corner=resizeHandles[name],cornerX=target.offsetWidth*corner[0],cornerY=target.offsetHeight*corner[1],abs(cornerX-relativeX)<8&&abs(cornerY-relativeY)<8){selectedHandle=corner;break}resizeStarted=!0,editor.fire("ObjectResizeStart",{target:selectedElm,width:selectedElm.clientWidth,height:selectedElm.clientHeight}),editor.getDoc().selection.empty(),showResizeRect(target,name,lastMouseDownEvent)}function preventDefault(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function nativeControlSelect(e){var target=e.srcElement;if(isContentEditableFalse(target))return void preventDefault(e);if(target!=selectedElm){if(editor.fire("ObjectSelected",{target:target}),detachResizeStartListener(),0===target.id.indexOf("mceResizeHandle"))return void(e.returnValue=!1);"IMG"!=target.nodeName&&"TABLE"!=target.nodeName||(hideResizeRect(),selectedElm=target,attachEvent(target,"resizestart",resizeNativeStart))}}function detachResizeStartListener(){detachEvent(selectedElm,"resizestart",resizeNativeStart)}function unbindResizeHandleEvents(){for(var name in resizeHandles){var handle=resizeHandles[name];handle.elm&&(dom.unbind(handle.elm),delete handle.elm)}}function disableGeckoResize(){try{editor.getDoc().execCommand("enableObjectResizing",!1,!1)}catch(ex){}}function controlSelect(elm){var ctrlRng;if(isIE){ctrlRng=editableDoc.body.createControlRange();try{return ctrlRng.addElement(elm),ctrlRng.select(),!0}catch(ex){}}}function destroy(){selectedElm=selectedElmGhost=null,isIE&&(detachResizeStartListener(),detachEvent(rootElement,"controlselect",nativeControlSelect))}var selectedElm,selectedElmGhost,resizeHelper,resizeHandles,selectedHandle,lastMouseDownEvent,startX,startY,selectedElmX,selectedElmY,startW,startH,ratio,resizeStarted,width,height,startScrollWidth,startScrollHeight,dom=editor.dom,each=Tools.each,editableDoc=editor.getDoc(),rootDocument=document,isIE=Env.ie&&Env.ie<11,abs=Math.abs,round=Math.round,rootElement=editor.getBody();resizeHandles={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var rootClass=".mce-content-body";return editor.contentStyles.push(rootClass+" div.mce-resizehandle {position: absolute;border: 1px solid black;background: #FFF;width: 7px;height: 7px;z-index: 10000}"+rootClass+" .mce-resizehandle:hover {background: #000}"+rootClass+" img[data-mce-selected],"+rootClass+" hr[data-mce-selected] {outline: 1px solid black;resize: none}"+rootClass+" .mce-clonedresizable {position: absolute;"+(Env.gecko?"":"outline: 1px dashed black;")+"opacity: .5;filter: alpha(opacity=50);z-index: 10000}"+rootClass+" .mce-resize-helper {background: #555;background: rgba(0,0,0,0.75);border-radius: 3px;border: 1px;color: white;display: none;font-family: sans-serif;font-size: 12px;white-space: nowrap;line-height: 14px;margin: 5px 10px;padding: 5px;position: absolute;z-index: 10001}"),
editor.on("init",function(){isIE?(editor.on("ObjectResized",function(e){"TABLE"!=e.target.nodeName&&(hideResizeRect(),controlSelect(e.target))}),attachEvent(rootElement,"controlselect",nativeControlSelect),editor.on("mousedown",function(e){lastMouseDownEvent=e})):(disableGeckoResize(),Env.ie>=11&&(editor.on("mousedown click",function(e){var nodeName=e.target.nodeName;!resizeStarted&&/^(TABLE|IMG|HR)$/.test(nodeName)&&(editor.selection.select(e.target,"TABLE"==nodeName),"mousedown"==e.type&&editor.nodeChanged())}),editor.dom.bind(rootElement,"mscontrolselect",function(e){function delayedSelect(node){Delay.setEditorTimeout(editor,function(){editor.selection.select(node)})}return isContentEditableFalse(e.target)?(e.preventDefault(),void delayedSelect(e.target)):void(/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"==e.target.tagName&&delayedSelect(e.target)))})));var throttledUpdateResizeRect=Delay.throttle(updateResizeRect);editor.on("nodechange ResizeEditor ResizeWindow drop",throttledUpdateResizeRect),editor.on("keydown keyup",function(e){selectedElm&&"TABLE"==selectedElm.nodeName&&throttledUpdateResizeRect(e)}),editor.on("hide blur",hideResizeRect)}),editor.on("remove",unbindResizeHandleEvents),{isResizable:isResizable,showResizeRect:showResizeRect,hideResizeRect:hideResizeRect,updateResizeRect:updateResizeRect,controlSelect:controlSelect,destroy:destroy}}}),define("tinymce/util/Fun",[],function(){function constant(value){return function(){return value}}function negate(predicate){return function(x){return!predicate(x)}}function compose(f,g){return function(x){return f(g(x))}}function or(){var args=slice.call(arguments);return function(x){for(var i=0;i<args.length;i++)if(args[i](x))return!0;return!1}}function and(){var args=slice.call(arguments);return function(x){for(var i=0;i<args.length;i++)if(!args[i](x))return!1;return!0}}function curry(fn){var args=slice.call(arguments);return args.length-1>=fn.length?fn.apply(this,args.slice(1)):function(){var tempArgs=args.concat([].slice.call(arguments));return curry.apply(this,tempArgs)}}var slice=[].slice;return{constant:constant,negate:negate,and:and,or:or,curry:curry,compose:compose}}),define("tinymce/caret/CaretCandidate",["tinymce/dom/NodeType","tinymce/util/Arr","tinymce/caret/CaretContainer"],function(NodeType,Arr,CaretContainer){function isCaretCandidate(node){return isCaretContainer(node)?!1:isText(node)?!isInvalidTextElement(node.parentNode):isAtomicInline(node)||isBr(node)||isTable(node)||isContentEditableFalse(node)}function isInEditable(node,rootNode){for(node=node.parentNode;node&&node!=rootNode;node=node.parentNode){if(isContentEditableFalse(node))return!1;if(isContentEditableTrue(node))return!0}return!0}function isAtomicContentEditableFalse(node){return isContentEditableFalse(node)?Arr.reduce(node.getElementsByTagName("*"),function(result,elm){return result||isContentEditableTrue(elm)},!1)!==!0:!1}function isAtomic(node){return isAtomicInline(node)||isAtomicContentEditableFalse(node)}function isEditableCaretCandidate(node,rootNode){return isCaretCandidate(node)&&isInEditable(node,rootNode)}var isContentEditableTrue=NodeType.isContentEditableTrue,isContentEditableFalse=NodeType.isContentEditableFalse,isBr=NodeType.isBr,isText=NodeType.isText,isInvalidTextElement=NodeType.matchNodeNames("script style textarea"),isAtomicInline=NodeType.matchNodeNames("img input textarea hr iframe video audio object"),isTable=NodeType.matchNodeNames("table"),isCaretContainer=CaretContainer.isCaretContainer;return{isCaretCandidate:isCaretCandidate,isInEditable:isInEditable,isAtomic:isAtomic,isEditableCaretCandidate:isEditableCaretCandidate}}),define("tinymce/geom/ClientRect",[],function(){function clone(rect){return rect?{left:round(rect.left),top:round(rect.top),bottom:round(rect.bottom),right:round(rect.right),width:round(rect.width),height:round(rect.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}}function collapse(clientRect,toStart){return clientRect=clone(clientRect),toStart?clientRect.right=clientRect.left:(clientRect.left=clientRect.left+clientRect.width,clientRect.right=clientRect.left),clientRect.width=0,clientRect}function isEqual(rect1,rect2){return rect1.left===rect2.left&&rect1.top===rect2.top&&rect1.bottom===rect2.bottom&&rect1.right===rect2.right}function isValidOverflow(overflowY,clientRect1,clientRect2){return overflowY>=0&&overflowY<=Math.min(clientRect1.height,clientRect2.height)/2}function isAbove(clientRect1,clientRect2){return clientRect1.bottom<clientRect2.top?!0:clientRect1.top>clientRect2.bottom?!1:isValidOverflow(clientRect2.top-clientRect1.bottom,clientRect1,clientRect2)}function isBelow(clientRect1,clientRect2){return clientRect1.top>clientRect2.bottom?!0:clientRect1.bottom<clientRect2.top?!1:isValidOverflow(clientRect2.bottom-clientRect1.top,clientRect1,clientRect2)}function isLeft(clientRect1,clientRect2){return clientRect1.left<clientRect2.left}function isRight(clientRect1,clientRect2){return clientRect1.right>clientRect2.right}function compare(clientRect1,clientRect2){return isAbove(clientRect1,clientRect2)?-1:isBelow(clientRect1,clientRect2)?1:isLeft(clientRect1,clientRect2)?-1:isRight(clientRect1,clientRect2)?1:0}function containsXY(clientRect,clientX,clientY){return clientX>=clientRect.left&&clientX<=clientRect.right&&clientY>=clientRect.top&&clientY<=clientRect.bottom}var round=Math.round;return{clone:clone,collapse:collapse,isEqual:isEqual,isAbove:isAbove,isBelow:isBelow,isLeft:isLeft,isRight:isRight,compare:compare,containsXY:containsXY}}),define("tinymce/text/ExtendingChar",[],function(){function isExtendingChar(ch){return"string"==typeof ch&&ch.charCodeAt(0)>=768&&extendingChars.test(ch)}var extendingChars=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]");return{isExtendingChar:isExtendingChar}}),define("tinymce/caret/CaretPosition",["tinymce/util/Fun","tinymce/dom/NodeType","tinymce/dom/DOMUtils","tinymce/dom/RangeUtils","tinymce/caret/CaretCandidate","tinymce/geom/ClientRect","tinymce/text/ExtendingChar"],function(Fun,NodeType,DOMUtils,RangeUtils,CaretCandidate,ClientRect,ExtendingChar){function isWhiteSpace(chr){return chr&&/[\r\n\t ]/.test(chr)}function isHiddenWhiteSpaceRange(range){var text,container=range.startContainer,offset=range.startOffset;return!!(isWhiteSpace(range.toString())&&isNotPre(container.parentNode)&&(text=container.data,isWhiteSpace(text[offset-1])||isWhiteSpace(text[offset+1])))}function getCaretPositionClientRects(caretPosition){function getBrClientRect(brNode){var clientRect,doc=brNode.ownerDocument,rng=doc.createRange(),nbsp=doc.createTextNode(" "),parentNode=brNode.parentNode;return parentNode.insertBefore(nbsp,brNode),rng.setStart(nbsp,0),rng.setEnd(nbsp,1),clientRect=ClientRect.clone(rng.getBoundingClientRect()),parentNode.removeChild(nbsp),clientRect}function getBoundingClientRect(item){var clientRect,clientRects;return clientRects=item.getClientRects(),clientRect=clientRects.length>0?ClientRect.clone(clientRects[0]):ClientRect.clone(item.getBoundingClientRect()),isBr(item)&&0===clientRect.left?getBrClientRect(item):clientRect}function collapseAndInflateWidth(clientRect,toStart){return clientRect=ClientRect.collapse(clientRect,toStart),clientRect.width=1,clientRect.right=clientRect.left+1,clientRect}function addUniqueAndValidRect(clientRect){0!==clientRect.height&&(clientRects.length>0&&ClientRect.isEqual(clientRect,clientRects[clientRects.length-1])||clientRects.push(clientRect))}function addCharacterOffset(container,offset){var range=container.ownerDocument.createRange();return offset<container.data.length&&ExtendingChar.isExtendingChar(container.data[offset])?clientRects:(offset>0&&(range.setStart(container,offset-1),range.setEnd(container,offset),isHiddenWhiteSpaceRange(range)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),!1))),void(offset<container.data.length&&(range.setStart(container,offset),range.setEnd(container,offset+1),isHiddenWhiteSpaceRange(range)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),!0)))))}var beforeNode,node,clientRects=[];if(isText(caretPosition.container()))return addCharacterOffset(caretPosition.container(),caretPosition.offset()),clientRects;if(isElement(caretPosition.container()))if(caretPosition.isAtEnd())node=resolveIndex(caretPosition.container(),caretPosition.offset()),isText(node)&&addCharacterOffset(node,node.data.length),isValidElementCaretCandidate(node)&&!isBr(node)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!1));else{if(node=resolveIndex(caretPosition.container(),caretPosition.offset()),isText(node)&&addCharacterOffset(node,0),isValidElementCaretCandidate(node)&&caretPosition.isAtEnd())return addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!1)),clientRects;beforeNode=resolveIndex(caretPosition.container(),caretPosition.offset()-1),isValidElementCaretCandidate(beforeNode)&&!isBr(beforeNode)&&(isBlock(beforeNode)||isBlock(node)||!isValidElementCaretCandidate(node))&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode),!1)),isValidElementCaretCandidate(node)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!0))}return clientRects}function CaretPosition(container,offset,clientRects){function isAtStart(){return isText(container)?0===offset:0===offset}function isAtEnd(){return isText(container)?offset>=container.data.length:offset>=container.childNodes.length}function toRange(){var range;return range=container.ownerDocument.createRange(),range.setStart(container,offset),range.setEnd(container,offset),range}function getClientRects(){return clientRects||(clientRects=getCaretPositionClientRects(new CaretPosition(container,offset))),clientRects}function isVisible(){return getClientRects().length>0}function isEqual(caretPosition){return caretPosition&&container===caretPosition.container()&&offset===caretPosition.offset()}function getNode(before){return resolveIndex(container,before?offset-1:offset)}return{container:Fun.constant(container),offset:Fun.constant(offset),toRange:toRange,getClientRects:getClientRects,isVisible:isVisible,isAtStart:isAtStart,isAtEnd:isAtEnd,isEqual:isEqual,getNode:getNode}}var isElement=NodeType.isElement,isCaretCandidate=CaretCandidate.isCaretCandidate,isBlock=NodeType.matchStyleValues("display","block table"),isFloated=NodeType.matchStyleValues("float","left right"),isValidElementCaretCandidate=Fun.and(isElement,isCaretCandidate,Fun.negate(isFloated)),isNotPre=Fun.negate(NodeType.matchStyleValues("white-space","pre pre-line pre-wrap")),isText=NodeType.isText,isBr=NodeType.isBr,nodeIndex=DOMUtils.nodeIndex,resolveIndex=RangeUtils.getNode;return CaretPosition.fromRangeStart=function(range){return new CaretPosition(range.startContainer,range.startOffset)},CaretPosition.fromRangeEnd=function(range){return new CaretPosition(range.endContainer,range.endOffset)},CaretPosition.after=function(node){return new CaretPosition(node.parentNode,nodeIndex(node)+1)},CaretPosition.before=function(node){return new CaretPosition(node.parentNode,nodeIndex(node))},CaretPosition}),define("tinymce/caret/CaretBookmark",["tinymce/dom/NodeType","tinymce/dom/DOMUtils","tinymce/util/Fun","tinymce/util/Arr","tinymce/caret/CaretPosition"],function(NodeType,DomUtils,Fun,Arr,CaretPosition){function normalizedParent(node){var parentNode=node.parentNode;return isBogus(parentNode)?normalizedParent(parentNode):parentNode}function getChildNodes(node){return node?Arr.reduce(node.childNodes,function(result,node){return isBogus(node)&&"BR"!=node.nodeName?result=result.concat(getChildNodes(node)):result.push(node),result},[]):[]}function normalizedTextOffset(textNode,offset){for(;(textNode=textNode.previousSibling)&&isText(textNode);)offset+=textNode.data.length;return offset}function equal(targetValue){return function(value){return targetValue===value}}function normalizedNodeIndex(node){var nodes,index,numTextFragments;return nodes=getChildNodes(normalizedParent(node)),index=Arr.findIndex(nodes,equal(node),node),nodes=nodes.slice(0,index+1),numTextFragments=Arr.reduce(nodes,function(result,node,i){return isText(node)&&isText(nodes[i-1])&&result++,result},0),nodes=Arr.filter(nodes,NodeType.matchNodeNames(node.nodeName)),index=Arr.findIndex(nodes,equal(node),node),index-numTextFragments}function createPathItem(node){var name;return name=isText(node)?"text()":node.nodeName.toLowerCase(),name+"["+normalizedNodeIndex(node)+"]"}function parentsUntil(rootNode,node,predicate){var parents=[];for(node=node.parentNode;!(node==rootNode||predicate&&predicate(node));node=node.parentNode)parents.push(node);return parents}function create(rootNode,caretPosition){var container,offset,outputOffset,childNodes,parents,path=[];return container=caretPosition.container(),offset=caretPosition.offset(),isText(container)?outputOffset=normalizedTextOffset(container,offset):(childNodes=container.childNodes,offset>=childNodes.length?(outputOffset="after",offset=childNodes.length-1):outputOffset="before",container=childNodes[offset]),path.push(createPathItem(container)),parents=parentsUntil(rootNode,container),parents=Arr.filter(parents,Fun.negate(NodeType.isBogus)),path=path.concat(Arr.map(parents,function(node){return createPathItem(node)})),path.reverse().join("/")+","+outputOffset}function resolvePathItem(node,name,index){var nodes=getChildNodes(node);return nodes=Arr.filter(nodes,function(node,index){return!isText(node)||!isText(nodes[index-1])}),nodes=Arr.filter(nodes,NodeType.matchNodeNames(name)),nodes[index]}function findTextPosition(container,offset){for(var dataLen,node=container,targetOffset=0;isText(node);){if(dataLen=node.data.length,offset>=targetOffset&&targetOffset+dataLen>=offset){container=node,offset-=targetOffset;break}if(!isText(node.nextSibling)){container=node,offset=dataLen;break}targetOffset+=dataLen,node=node.nextSibling}return offset>container.data.length&&(offset=container.data.length),new CaretPosition(container,offset)}function resolve(rootNode,path){var parts,container,offset;return path?(parts=path.split(","),path=parts[0].split("/"),offset=parts.length>1?parts[1]:"before",container=Arr.reduce(path,function(result,value){return(value=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(value))?("text()"===value[1]&&(value[1]="#text"),resolvePathItem(result,value[1],parseInt(value[2],10))):null},rootNode),container?isText(container)?findTextPosition(container,parseInt(offset,10)):(offset="after"===offset?nodeIndex(container)+1:nodeIndex(container),new CaretPosition(container.parentNode,offset)):null):null}var isText=NodeType.isText,isBogus=NodeType.isBogus,nodeIndex=DomUtils.nodeIndex;return{create:create,resolve:resolve}}),define("tinymce/dom/BookmarkManager",["tinymce/Env","tinymce/util/Tools","tinymce/caret/CaretContainer","tinymce/caret/CaretBookmark","tinymce/caret/CaretPosition","tinymce/dom/NodeType"],function(Env,Tools,CaretContainer,CaretBookmark,CaretPosition,NodeType){function BookmarkManager(selection){var dom=selection.dom;this.getBookmark=function(type,normalized){function findIndex(name,element){var count=0;return Tools.each(dom.select(name),function(node){return"all"!==node.getAttribute("data-mce-bogus")?node==element?!1:void count++:void 0}),count}function normalizeTableCellSelection(rng){function moveEndPoint(start){var container,offset,childNodes,prefix=start?"start":"end";container=rng[prefix+"Container"],offset=rng[prefix+"Offset"],1==container.nodeType&&"TR"==container.nodeName&&(childNodes=container.childNodes,container=childNodes[Math.min(start?offset:offset-1,childNodes.length-1)],container&&(offset=start?0:container.childNodes.length,rng["set"+(start?"Start":"End")](container,offset)))}return moveEndPoint(!0),moveEndPoint(),rng}function getLocation(rng){function getPoint(rng,start){var node,childNodes,container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],point=[],after=0;if(3==container.nodeType){if(normalized)for(node=container.previousSibling;node&&3==node.nodeType;node=node.previousSibling)offset+=node.nodeValue.length;point.push(offset)}else childNodes=container.childNodes,offset>=childNodes.length&&childNodes.length&&(after=1,offset=Math.max(0,childNodes.length-1)),point.push(dom.nodeIndex(childNodes[offset],normalized)+after);for(;container&&container!=root;container=container.parentNode)point.push(dom.nodeIndex(container,normalized));return point}var root=dom.getRoot(),bookmark={};return bookmark.start=getPoint(rng,!0),selection.isCollapsed()||(bookmark.end=getPoint(rng)),bookmark}function findAdjacentContentEditableFalseElm(rng){function findSibling(node){var sibling;if(CaretContainer.isCaretContainer(node)){if(NodeType.isText(node)&&CaretContainer.isCaretContainerBlock(node)&&(node=node.parentNode),sibling=node.previousSibling,isContentEditableFalse(sibling))return sibling;if(sibling=node.nextSibling,isContentEditableFalse(sibling))return sibling}}return findSibling(rng.startContainer)||findSibling(rng.endContainer)}var rng,rng2,id,collapsed,name,element,styles,chr="&#xFEFF;";if(2==type)return element=selection.getNode(),name=element?element.nodeName:null,rng=selection.getRng(),isContentEditableFalse(element)||"IMG"==name?{name:name,index:findIndex(name,element)}:selection.tridentSel?selection.tridentSel.getBookmark(type):(element=findAdjacentContentEditableFalseElm(rng),element?(name=element.tagName,{name:name,index:findIndex(name,element)}):getLocation(rng));if(3==type)return rng=selection.getRng(),{start:CaretBookmark.create(dom.getRoot(),CaretPosition.fromRangeStart(rng)),end:CaretBookmark.create(dom.getRoot(),CaretPosition.fromRangeEnd(rng))};if(type)return{rng:selection.getRng()};if(rng=selection.getRng(),id=dom.uniqueId(),collapsed=selection.isCollapsed(),styles="overflow:hidden;line-height:0px",rng.duplicate||rng.item){if(rng.item)return element=rng.item(0),name=element.nodeName,{name:name,index:findIndex(name,element)};rng2=rng.duplicate();try{rng.collapse(),rng.pasteHTML('<span data-mce-type="bookmark" id="'+id+'_start" style="'+styles+'">'+chr+"</span>"),collapsed||(rng2.collapse(!1),rng.moveToElementText(rng2.parentElement()),0===rng.compareEndPoints("StartToEnd",rng2)&&rng2.move("character",-1),rng2.pasteHTML('<span data-mce-type="bookmark" id="'+id+'_end" style="'+styles+'">'+chr+"</span>"))}catch(ex){return null}}else{if(element=selection.getNode(),name=element.nodeName,"IMG"==name)return{name:name,index:findIndex(name,element)};rng2=normalizeTableCellSelection(rng.cloneRange()),collapsed||(rng2.collapse(!1),rng2.insertNode(dom.create("span",{"data-mce-type":"bookmark",id:id+"_end",style:styles},chr))),rng=normalizeTableCellSelection(rng),rng.collapse(!0),rng.insertNode(dom.create("span",{"data-mce-type":"bookmark",id:id+"_start",style:styles},chr))}return selection.moveToBookmark({id:id,keep:1}),{id:id}},this.moveToBookmark=function(bookmark){function setEndPoint(start){var i,node,offset,children,point=bookmark[start?"start":"end"];if(point){for(offset=point[0],node=root,i=point.length-1;i>=1;i--){if(children=node.childNodes,point[i]>children.length-1)return;node=children[point[i]]}3===node.nodeType&&(offset=Math.min(point[0],node.nodeValue.length)),1===node.nodeType&&(offset=Math.min(point[0],node.childNodes.length)),start?rng.setStart(node,offset):rng.setEnd(node,offset)}return!0}function restoreEndPoint(suffix){var node,idx,next,prev,marker=dom.get(bookmark.id+"_"+suffix),keep=bookmark.keep;if(marker&&(node=marker.parentNode,"start"==suffix?(keep?(node=marker.firstChild,idx=1):idx=dom.nodeIndex(marker),startContainer=endContainer=node,startOffset=endOffset=idx):(keep?(node=marker.firstChild,idx=1):idx=dom.nodeIndex(marker),endContainer=node,endOffset=idx),!keep)){for(prev=marker.previousSibling,next=marker.nextSibling,Tools.each(Tools.grep(marker.childNodes),function(node){3==node.nodeType&&(node.nodeValue=node.nodeValue.replace(/\uFEFF/g,""))});marker=dom.get(bookmark.id+"_"+suffix);)dom.remove(marker,1);prev&&next&&prev.nodeType==next.nodeType&&3==prev.nodeType&&!Env.opera&&(idx=prev.nodeValue.length,prev.appendData(next.nodeValue),dom.remove(next),"start"==suffix?(startContainer=endContainer=prev,startOffset=endOffset=idx):(endContainer=prev,endOffset=idx))}}function addBogus(node){return!dom.isBlock(node)||node.innerHTML||Env.ie||(node.innerHTML='<br data-mce-bogus="1" />'),node}function resolveCaretPositionBookmark(){var rng,pos;return rng=dom.createRng(),pos=CaretBookmark.resolve(dom.getRoot(),bookmark.start),rng.setStart(pos.container(),pos.offset()),pos=CaretBookmark.resolve(dom.getRoot(),bookmark.end),rng.setEnd(pos.container(),pos.offset()),rng}var rng,root,startContainer,endContainer,startOffset,endOffset;if(bookmark)if(Tools.isArray(bookmark.start)){if(rng=dom.createRng(),root=dom.getRoot(),selection.tridentSel)return selection.tridentSel.moveToBookmark(bookmark);setEndPoint(!0)&&setEndPoint()&&selection.setRng(rng)}else"string"==typeof bookmark.start?selection.setRng(resolveCaretPositionBookmark(bookmark)):bookmark.id?(restoreEndPoint("start"),restoreEndPoint("end"),startContainer&&(rng=dom.createRng(),rng.setStart(addBogus(startContainer),startOffset),rng.setEnd(addBogus(endContainer),endOffset),selection.setRng(rng))):bookmark.name?selection.select(dom.select(bookmark.name)[bookmark.index]):bookmark.rng&&selection.setRng(bookmark.rng)}}var isContentEditableFalse=NodeType.isContentEditableFalse;return BookmarkManager.isBookmarkNode=function(node){return node&&"SPAN"===node.tagName&&"bookmark"===node.getAttribute("data-mce-type")},BookmarkManager}),define("tinymce/dom/Selection",["tinymce/dom/TreeWalker","tinymce/dom/TridentSelection","tinymce/dom/ControlSelection","tinymce/dom/RangeUtils","tinymce/dom/BookmarkManager","tinymce/dom/NodeType","tinymce/Env","tinymce/util/Tools"],function(TreeWalker,TridentSelection,ControlSelection,RangeUtils,BookmarkManager,NodeType,Env,Tools){function Selection(dom,win,serializer,editor){var self=this;self.dom=dom,self.win=win,self.serializer=serializer,self.editor=editor,self.bookmarkManager=new BookmarkManager(self),self.controlSelection=new ControlSelection(self,editor),self.win.getSelection||(self.tridentSel=new TridentSelection(self))}var each=Tools.each,trim=Tools.trim,isIE=Env.ie;return Selection.prototype={setCursorLocation:function(node,offset){var self=this,rng=self.dom.createRng();node?(rng.setStart(node,offset),rng.setEnd(node,offset),self.setRng(rng),self.collapse(!1)):(self._moveEndPoint(rng,self.editor.getBody(),!0),self.setRng(rng))},getContent:function(args){var whiteSpaceBefore,whiteSpaceAfter,fragment,self=this,rng=self.getRng(),tmpElm=self.dom.create("body"),se=self.getSel();return args=args||{},whiteSpaceBefore=whiteSpaceAfter="",args.get=!0,args.format=args.format||"html",args.selection=!0,self.editor.fire("BeforeGetContent",args),"text"==args.format?self.isCollapsed()?"":rng.text||(se.toString?se.toString():""):(rng.cloneContents?(fragment=rng.cloneContents(),fragment&&tmpElm.appendChild(fragment)):rng.item!==undefined||rng.htmlText!==undefined?(tmpElm.innerHTML="<br>"+(rng.item?rng.item(0).outerHTML:rng.htmlText),tmpElm.removeChild(tmpElm.firstChild)):tmpElm.innerHTML=rng.toString(),/^\s/.test(tmpElm.innerHTML)&&(whiteSpaceBefore=" "),/\s+$/.test(tmpElm.innerHTML)&&(whiteSpaceAfter=" "),args.getInner=!0,args.content=self.isCollapsed()?"":whiteSpaceBefore+self.serializer.serialize(tmpElm,args)+whiteSpaceAfter,self.editor.fire("GetContent",args),args.content)},setContent:function(content,args){var caretNode,frag,temp,self=this,rng=self.getRng(),doc=self.win.document;if(args=args||{format:"html"},args.set=!0,args.selection=!0,args.content=content,args.no_events||self.editor.fire("BeforeSetContent",args),content=args.content,rng.insertNode){content+='<span id="__caret">_</span>',rng.startContainer==doc&&rng.endContainer==doc?doc.body.innerHTML=content:(rng.deleteContents(),0===doc.body.childNodes.length?doc.body.innerHTML=content:rng.createContextualFragment?rng.insertNode(rng.createContextualFragment(content)):(frag=doc.createDocumentFragment(),temp=doc.createElement("div"),frag.appendChild(temp),temp.outerHTML=content,rng.insertNode(frag))),caretNode=self.dom.get("__caret"),rng=doc.createRange(),rng.setStartBefore(caretNode),rng.setEndBefore(caretNode),self.setRng(rng),self.dom.remove("__caret");try{self.setRng(rng)}catch(ex){}}else rng.item&&(doc.execCommand("Delete",!1,null),rng=self.getRng()),/^\s+/.test(content)?(rng.pasteHTML('<span id="__mce_tmp">_</span>'+content),self.dom.remove("__mce_tmp")):rng.pasteHTML(content);args.no_events||self.editor.fire("SetContent",args)},getStart:function(real){var startElement,parentElement,checkRng,node,self=this,rng=self.getRng();if(rng.duplicate||rng.item){if(rng.item)return rng.item(0);for(checkRng=rng.duplicate(),checkRng.collapse(1),startElement=checkRng.parentElement(),startElement.ownerDocument!==self.dom.doc&&(startElement=self.dom.getRoot()),parentElement=node=rng.parentElement();node=node.parentNode;)if(node==startElement){startElement=parentElement;break}return startElement}return startElement=rng.startContainer,1==startElement.nodeType&&startElement.hasChildNodes()&&(real&&rng.collapsed||(startElement=startElement.childNodes[Math.min(startElement.childNodes.length-1,rng.startOffset)])),startElement&&3==startElement.nodeType?startElement.parentNode:startElement},getEnd:function(real){var endElement,endOffset,self=this,rng=self.getRng();return rng.duplicate||rng.item?rng.item?rng.item(0):(rng=rng.duplicate(),rng.collapse(0),endElement=rng.parentElement(),endElement.ownerDocument!==self.dom.doc&&(endElement=self.dom.getRoot()),endElement&&"BODY"==endElement.nodeName?endElement.lastChild||endElement:endElement):(endElement=rng.endContainer,endOffset=rng.endOffset,1==endElement.nodeType&&endElement.hasChildNodes()&&(real&&rng.collapsed||(endElement=endElement.childNodes[endOffset>0?endOffset-1:endOffset])),endElement&&3==endElement.nodeType?endElement.parentNode:endElement)},getBookmark:function(type,normalized){return this.bookmarkManager.getBookmark(type,normalized)},moveToBookmark:function(bookmark){return this.bookmarkManager.moveToBookmark(bookmark)},select:function(node,content){var idx,self=this,dom=self.dom,rng=dom.createRng();if(self.lastFocusBookmark=null,node){if(!content&&self.controlSelection.controlSelect(node))return;idx=dom.nodeIndex(node),rng.setStart(node.parentNode,idx),rng.setEnd(node.parentNode,idx+1),content&&(self._moveEndPoint(rng,node,!0),self._moveEndPoint(rng,node)),self.setRng(rng)}return node},isCollapsed:function(){var self=this,rng=self.getRng(),sel=self.getSel();return!rng||rng.item?!1:rng.compareEndPoints?0===rng.compareEndPoints("StartToEnd",rng):!sel||rng.collapsed},collapse:function(toStart){var node,self=this,rng=self.getRng();rng.item&&(node=rng.item(0),rng=self.win.document.body.createTextRange(),rng.moveToElementText(node)),rng.collapse(!!toStart),self.setRng(rng)},getSel:function(){var win=this.win;return win.getSelection?win.getSelection():win.document.selection},getRng:function(w3c){function tryCompareBoundaryPoints(how,sourceRange,destinationRange){try{return sourceRange.compareBoundaryPoints(how,destinationRange)}catch(ex){return-1}}var selection,rng,elm,doc,ieRng,evt,self=this;if(!self.win)return null;if(doc=self.win.document,!w3c&&self.lastFocusBookmark){var bookmark=self.lastFocusBookmark;return bookmark.startContainer?(rng=doc.createRange(),rng.setStart(bookmark.startContainer,bookmark.startOffset),rng.setEnd(bookmark.endContainer,bookmark.endOffset)):rng=bookmark,rng}if(w3c&&self.tridentSel)return self.tridentSel.getRangeAt(0);try{(selection=self.getSel())&&(rng=selection.rangeCount>0?selection.getRangeAt(0):selection.createRange?selection.createRange():doc.createRange())}catch(ex){}if(evt=self.editor.fire("GetSelectionRange",{range:rng}),evt.range!==rng)return evt.range;if(isIE&&rng&&rng.setStart&&doc.selection){try{ieRng=doc.selection.createRange()}catch(ex){}ieRng&&ieRng.item&&(elm=ieRng.item(0),rng=doc.createRange(),rng.setStartBefore(elm),rng.setEndAfter(elm))}return rng||(rng=doc.createRange?doc.createRange():doc.body.createTextRange()),rng.setStart&&9===rng.startContainer.nodeType&&rng.collapsed&&(elm=self.dom.getRoot(),rng.setStart(elm,0),rng.setEnd(elm,0)),self.selectedRange&&self.explicitRange&&(0===tryCompareBoundaryPoints(rng.START_TO_START,rng,self.selectedRange)&&0===tryCompareBoundaryPoints(rng.END_TO_END,rng,self.selectedRange)?rng=self.explicitRange:(self.selectedRange=null,self.explicitRange=null)),rng},setRng:function(rng,forward){var sel,node,evt,self=this;if(rng)if(rng.select){self.explicitRange=null;try{rng.select()}catch(ex){}}else if(self.tridentSel){if(rng.cloneRange)try{self.tridentSel.addRange(rng)}catch(ex){}}else{if(sel=self.getSel(),evt=self.editor.fire("SetSelectionRange",{range:rng}),rng=evt.range,sel){self.explicitRange=rng;try{sel.removeAllRanges(),sel.addRange(rng)}catch(ex){}forward===!1&&sel.extend&&(sel.collapse(rng.endContainer,rng.endOffset),sel.extend(rng.startContainer,rng.startOffset)),self.selectedRange=sel.rangeCount>0?sel.getRangeAt(0):null}rng.collapsed||rng.startContainer!=rng.endContainer||!sel.setBaseAndExtent||Env.ie||rng.endOffset-rng.startOffset<2&&rng.startContainer.hasChildNodes()&&(node=rng.startContainer.childNodes[rng.startOffset],node&&"IMG"==node.tagName&&self.getSel().setBaseAndExtent(node,0,node,1))}},setNode:function(elm){var self=this;return self.setContent(self.dom.getOuterHTML(elm)),elm},getNode:function(){function skipEmptyTextNodes(node,forwards){for(var orig=node;node&&3===node.nodeType&&0===node.length;)node=forwards?node.nextSibling:node.previousSibling;return node||orig}var elm,self=this,rng=self.getRng(),startContainer=rng.startContainer,endContainer=rng.endContainer,startOffset=rng.startOffset,endOffset=rng.endOffset,root=self.dom.getRoot();return rng?rng.setStart?(elm=rng.commonAncestorContainer,!rng.collapsed&&(startContainer==endContainer&&2>endOffset-startOffset&&startContainer.hasChildNodes()&&(elm=startContainer.childNodes[startOffset]),3===startContainer.nodeType&&3===endContainer.nodeType&&(startContainer=startContainer.length===startOffset?skipEmptyTextNodes(startContainer.nextSibling,!0):startContainer.parentNode,endContainer=0===endOffset?skipEmptyTextNodes(endContainer.previousSibling,!1):endContainer.parentNode,startContainer&&startContainer===endContainer))?startContainer:elm&&3==elm.nodeType?elm.parentNode:elm):(elm=rng.item?rng.item(0):rng.parentElement(),elm.ownerDocument!==self.win.document&&(elm=root),elm):root},getSelectedBlocks:function(startElm,endElm){var node,root,self=this,dom=self.dom,selectedBlocks=[];if(root=dom.getRoot(),startElm=dom.getParent(startElm||self.getStart(),dom.isBlock),endElm=dom.getParent(endElm||self.getEnd(),dom.isBlock),startElm&&startElm!=root&&selectedBlocks.push(startElm),startElm&&endElm&&startElm!=endElm){node=startElm;for(var walker=new TreeWalker(startElm,root);(node=walker.next())&&node!=endElm;)dom.isBlock(node)&&selectedBlocks.push(node)}return endElm&&startElm!=endElm&&endElm!=root&&selectedBlocks.push(endElm),selectedBlocks},isForward:function(){var anchorRange,focusRange,dom=this.dom,sel=this.getSel();return sel&&sel.anchorNode&&sel.focusNode?(anchorRange=dom.createRng(),anchorRange.setStart(sel.anchorNode,sel.anchorOffset),anchorRange.collapse(!0),focusRange=dom.createRng(),focusRange.setStart(sel.focusNode,sel.focusOffset),focusRange.collapse(!0),anchorRange.compareBoundaryPoints(anchorRange.START_TO_START,focusRange)<=0):!0},normalize:function(){
var self=this,rng=self.getRng();return Env.range&&new RangeUtils(self.dom).normalize(rng)&&self.setRng(rng,self.isForward()),rng},selectorChanged:function(selector,callback){var currentSelectors,self=this;return self.selectorChangedData||(self.selectorChangedData={},currentSelectors={},self.editor.on("NodeChange",function(e){var node=e.element,dom=self.dom,parents=dom.getParents(node,null,dom.getRoot()),matchedSelectors={};each(self.selectorChangedData,function(callbacks,selector){each(parents,function(node){return dom.is(node,selector)?(currentSelectors[selector]||(each(callbacks,function(callback){callback(!0,{node:node,selector:selector,parents:parents})}),currentSelectors[selector]=callbacks),matchedSelectors[selector]=callbacks,!1):void 0})}),each(currentSelectors,function(callbacks,selector){matchedSelectors[selector]||(delete currentSelectors[selector],each(callbacks,function(callback){callback(!1,{node:node,selector:selector,parents:parents})}))})})),self.selectorChangedData[selector]||(self.selectorChangedData[selector]=[]),self.selectorChangedData[selector].push(callback),self},getScrollContainer:function(){for(var scrollContainer,node=this.dom.getRoot();node&&"BODY"!=node.nodeName;){if(node.scrollHeight>node.clientHeight){scrollContainer=node;break}node=node.parentNode}return scrollContainer},scrollIntoView:function(elm,alignToTop){function getPos(elm){for(var x=0,y=0,offsetParent=elm;offsetParent&&offsetParent.nodeType;)x+=offsetParent.offsetLeft||0,y+=offsetParent.offsetTop||0,offsetParent=offsetParent.offsetParent;return{x:x,y:y}}var y,viewPort,viewPortY,viewPortH,self=this,dom=self.dom,root=dom.getRoot(),offsetY=0;if(NodeType.isElement(elm)){if(alignToTop===!1&&(offsetY=elm.offsetHeight),"BODY"!=root.nodeName){var scrollContainer=self.getScrollContainer();if(scrollContainer)return y=getPos(elm).y-getPos(scrollContainer).y+offsetY,viewPortH=scrollContainer.clientHeight,viewPortY=scrollContainer.scrollTop,void((viewPortY>y||y+25>viewPortY+viewPortH)&&(scrollContainer.scrollTop=viewPortY>y?y:y-viewPortH+25))}viewPort=dom.getViewPort(self.editor.getWin()),y=dom.getPos(elm).y+offsetY,viewPortY=viewPort.y,viewPortH=viewPort.h,(y<viewPort.y||y+25>viewPortY+viewPortH)&&self.editor.getWin().scrollTo(0,viewPortY>y?y:y-viewPortH+25)}},placeCaretAt:function(clientX,clientY){this.setRng(RangeUtils.getCaretRangeFromPoint(clientX,clientY,this.editor.getDoc()))},_moveEndPoint:function(rng,node,start){var root=node,walker=new TreeWalker(node,root),nonEmptyElementsMap=this.dom.schema.getNonEmptyElements();do{if(3==node.nodeType&&0!==trim(node.nodeValue).length)return void(start?rng.setStart(node,0):rng.setEnd(node,node.nodeValue.length));if(nonEmptyElementsMap[node.nodeName]&&!/^(TD|TH)$/.test(node.nodeName))return void(start?rng.setStartBefore(node):"BR"==node.nodeName?rng.setEndBefore(node):rng.setEndAfter(node));if(Env.ie&&Env.ie<11&&this.dom.isBlock(node)&&this.dom.isEmpty(node))return void(start?rng.setStart(node,0):rng.setEnd(node,0))}while(node=start?walker.next():walker.prev());"BODY"==root.nodeName&&(start?rng.setStart(root,0):rng.setEnd(root,root.childNodes.length))},destroy:function(){this.win=null,this.controlSelection.destroy()}},Selection}),define("tinymce/dom/ElementUtils",["tinymce/dom/BookmarkManager","tinymce/util/Tools"],function(BookmarkManager,Tools){function ElementUtils(dom){this.compare=function(node1,node2){function getAttribs(node){var attribs={};return each(dom.getAttribs(node),function(attr){var name=attr.nodeName.toLowerCase();0!==name.indexOf("_")&&"style"!==name&&"data-mce-style"!==name&&(attribs[name]=dom.getAttrib(node,name))}),attribs}function compareObjects(obj1,obj2){var value,name;for(name in obj1)if(obj1.hasOwnProperty(name)){if(value=obj2[name],"undefined"==typeof value)return!1;if(obj1[name]!=value)return!1;delete obj2[name]}for(name in obj2)if(obj2.hasOwnProperty(name))return!1;return!0}return node1.nodeName!=node2.nodeName?!1:compareObjects(getAttribs(node1),getAttribs(node2))&&compareObjects(dom.parseStyle(dom.getAttrib(node1,"style")),dom.parseStyle(dom.getAttrib(node2,"style")))?!BookmarkManager.isBookmarkNode(node1)&&!BookmarkManager.isBookmarkNode(node2):!1}}var each=Tools.each;return ElementUtils}),define("tinymce/fmt/Preview",["tinymce/util/Tools"],function(Tools){function getCssText(editor,format){function removeVars(val){return val.replace(/%(\w+)/g,"")}var name,previewElm,parentFontSize,previewStyles,dom=editor.dom,previewCss="";if(previewStyles=editor.settings.preview_styles,previewStyles===!1)return"";if(previewStyles||(previewStyles="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"),"string"==typeof format){if(format=editor.formatter.get(format),!format)return;format=format[0]}return name=format.block||format.inline||"span",previewElm=dom.create(name),each(format.styles,function(value,name){value=removeVars(value),value&&dom.setStyle(previewElm,name,value)}),each(format.attributes,function(value,name){value=removeVars(value),value&&dom.setAttrib(previewElm,name,value)}),each(format.classes,function(value){value=removeVars(value),dom.hasClass(previewElm,value)||dom.addClass(previewElm,value)}),editor.fire("PreviewFormats"),dom.setStyles(previewElm,{position:"absolute",left:-65535}),editor.getBody().appendChild(previewElm),parentFontSize=dom.getStyle(editor.getBody(),"fontSize",!0),parentFontSize=/px$/.test(parentFontSize)?parseInt(parentFontSize,10):0,each(previewStyles.split(" "),function(name){var value=dom.getStyle(previewElm,name,!0);if(!("background-color"==name&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(value)&&(value=dom.getStyle(editor.getBody(),name,!0),"#ffffff"==dom.toHex(value).toLowerCase())||"color"==name&&"#000000"==dom.toHex(value).toLowerCase())){if("font-size"==name&&/em|%$/.test(value)){if(0===parentFontSize)return;value=parseFloat(value,10)/(/%$/.test(value)?100:1),value=value*parentFontSize+"px"}"border"==name&&value&&(previewCss+="padding:0 2px;"),previewCss+=name+":"+value+";"}}),editor.fire("AfterPreviewFormats"),dom.remove(previewElm),previewCss}var each=Tools.each;return{getCssText:getCssText}}),define("tinymce/fmt/Hooks",["tinymce/util/Arr","tinymce/dom/NodeType","tinymce/dom/DomQuery"],function(Arr,NodeType,$){function addPostProcessHook(name,hook){var hooks=postProcessHooks[name];hooks||(postProcessHooks[name]=hooks=[]),postProcessHooks[name].push(hook)}function postProcess(name,editor){each(postProcessHooks[name],function(hook){hook(editor)})}var postProcessHooks=[],filter=Arr.filter,each=Arr.each;return addPostProcessHook("pre",function(editor){function hasPreSibling(pre){return isPre(pre.previousSibling)&&-1!=Arr.indexOf(blocks,pre.previousSibling)}function joinPre(pre1,pre2){$(pre2).remove(),$(pre1).append("<br><br>").append(pre2.childNodes)}var isPre,blocks,rng=editor.selection.getRng();isPre=NodeType.matchNodeNames("pre"),rng.collapsed||(blocks=editor.selection.getSelectedBlocks(),each(filter(filter(blocks,isPre),hasPreSibling),function(pre){joinPre(pre.previousSibling,pre)}))}),{postProcess:postProcess}}),define("tinymce/Formatter",["tinymce/dom/TreeWalker","tinymce/dom/RangeUtils","tinymce/dom/BookmarkManager","tinymce/dom/ElementUtils","tinymce/util/Tools","tinymce/fmt/Preview","tinymce/fmt/Hooks"],function(TreeWalker,RangeUtils,BookmarkManager,ElementUtils,Tools,Preview,Hooks){return function(ed){function isTextBlock(name){return name.nodeType&&(name=name.nodeName),!!ed.schema.getTextBlockElements()[name.toLowerCase()]}function isTableCell(node){return/^(TH|TD)$/.test(node.nodeName)}function isInlineBlock(node){return node&&/^(IMG)$/.test(node.nodeName)}function getParents(node,selector){return dom.getParents(node,selector,dom.getRoot())}function isCaretNode(node){return 1===node.nodeType&&"_mce_caret"===node.id}function defaultFormats(){register({valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"right"}}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},defaultBlock:"div"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(){return!0},onformat:function(elm,fmt,vars){each(vars,function(value,key){dom.setAttrib(elm,key,value)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]}),each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(name){register(name,{block:name,remove:"all"})}),register(ed.settings.formats)}function addKeyboardShortcuts(){ed.addShortcut("meta+b","bold_desc","Bold"),ed.addShortcut("meta+i","italic_desc","Italic"),ed.addShortcut("meta+u","underline_desc","Underline");for(var i=1;6>=i;i++)ed.addShortcut("access+"+i,"",["FormatBlock",!1,"h"+i]);ed.addShortcut("access+7","",["FormatBlock",!1,"p"]),ed.addShortcut("access+8","",["FormatBlock",!1,"div"]),ed.addShortcut("access+9","",["FormatBlock",!1,"address"])}function get(name){return name?formats[name]:formats}function register(name,format){name&&("string"!=typeof name?each(name,function(format,name){register(name,format)}):(format=format.length?format:[format],each(format,function(format){format.deep===undef&&(format.deep=!format.selector),format.split===undef&&(format.split=!format.selector||format.inline),format.remove===undef&&format.selector&&!format.inline&&(format.remove="none"),format.selector&&format.inline&&(format.mixed=!0,format.block_expand=!0),"string"==typeof format.classes&&(format.classes=format.classes.split(/\s+/))}),formats[name]=format))}function unregister(name){return name&&formats[name]&&delete formats[name],formats}function getTextDecoration(node){var decoration;return ed.dom.getParent(node,function(n){return decoration=ed.dom.getStyle(n,"text-decoration"),decoration&&"none"!==decoration}),decoration}function processUnderlineAndColor(node){var textDecoration;1===node.nodeType&&node.parentNode&&1===node.parentNode.nodeType&&(textDecoration=getTextDecoration(node.parentNode),ed.dom.getStyle(node,"color")&&textDecoration?ed.dom.setStyle(node,"text-decoration",textDecoration):ed.dom.getStyle(node,"text-decoration")===textDecoration&&ed.dom.setStyle(node,"text-decoration",null))}function apply(name,vars,node){function setElementFormat(elm,fmt){if(fmt=fmt||format,elm){if(fmt.onformat&&fmt.onformat(elm,fmt,vars,node),each(fmt.styles,function(value,name){dom.setStyle(elm,name,replaceVars(value,vars))}),fmt.styles){var styleVal=dom.getAttrib(elm,"style");styleVal&&elm.setAttribute("data-mce-style",styleVal)}each(fmt.attributes,function(value,name){dom.setAttrib(elm,name,replaceVars(value,vars))}),each(fmt.classes,function(value){value=replaceVars(value,vars),dom.hasClass(elm,value)||dom.addClass(elm,value)})}}function adjustSelectionToVisibleSelection(){function findSelectionEnd(start,end){var walker=new TreeWalker(end);for(node=walker.current();node;node=walker.prev())if(node.childNodes.length>1||node==start||"BR"==node.tagName)return node}var rng=ed.selection.getRng(),start=rng.startContainer,end=rng.endContainer;if(start!=end&&0===rng.endOffset){var newEnd=findSelectionEnd(start,end),endOffset=3==newEnd.nodeType?newEnd.length:newEnd.childNodes.length;rng.setEnd(newEnd,endOffset)}return rng}function applyRngStyle(rng,bookmark,node_specific){var wrapName,wrapElm,newWrappers=[],contentEditable=!0;wrapName=format.inline||format.block,wrapElm=dom.create(wrapName),setElementFormat(wrapElm),rangeUtils.walk(rng,function(nodes){function process(node){var nodeName,parentName,found,hasContentEditableState,lastContentEditable;return lastContentEditable=contentEditable,nodeName=node.nodeName.toLowerCase(),parentName=node.parentNode.nodeName.toLowerCase(),1===node.nodeType&&getContentEditable(node)&&(lastContentEditable=contentEditable,contentEditable="true"===getContentEditable(node),hasContentEditableState=!0),isEq(nodeName,"br")?(currentWrapElm=0,void(format.block&&dom.remove(node))):format.wrapper&&matchNode(node,name,vars)?void(currentWrapElm=0):contentEditable&&!hasContentEditableState&&format.block&&!format.wrapper&&isTextBlock(nodeName)&&isValid(parentName,wrapName)?(node=dom.rename(node,wrapName),setElementFormat(node),newWrappers.push(node),void(currentWrapElm=0)):format.selector&&(each(formatList,function(format){return"collapsed"in format&&format.collapsed!==isCollapsed?void 0:dom.is(node,format.selector)&&!isCaretNode(node)?(setElementFormat(node,format),found=!0,!1):void 0}),!format.inline||found)?void(currentWrapElm=0):void(!contentEditable||hasContentEditableState||!isValid(wrapName,nodeName)||!isValid(parentName,wrapName)||!node_specific&&3===node.nodeType&&1===node.nodeValue.length&&65279===node.nodeValue.charCodeAt(0)||isCaretNode(node)||format.inline&&isBlock(node)?(currentWrapElm=0,each(grep(node.childNodes),process),hasContentEditableState&&(contentEditable=lastContentEditable),currentWrapElm=0):(currentWrapElm||(currentWrapElm=dom.clone(wrapElm,FALSE),node.parentNode.insertBefore(currentWrapElm,node),newWrappers.push(currentWrapElm)),currentWrapElm.appendChild(node)))}var currentWrapElm;each(nodes,process)}),format.links===!0&&each(newWrappers,function(node){function process(node){"A"===node.nodeName&&setElementFormat(node,format),each(grep(node.childNodes),process)}process(node)}),each(newWrappers,function(node){function getChildCount(node){var count=0;return each(node.childNodes,function(node){isWhiteSpaceNode(node)||isBookmarkNode(node)||count++}),count}function mergeStyles(node){var child,clone;return each(node.childNodes,function(node){return 1!=node.nodeType||isBookmarkNode(node)||isCaretNode(node)?void 0:(child=node,FALSE)}),child&&!isBookmarkNode(child)&&matchName(child,format)&&(clone=dom.clone(child,FALSE),setElementFormat(clone),dom.replace(clone,node,TRUE),dom.remove(child,1)),clone||node}var childCount;if(childCount=getChildCount(node),(newWrappers.length>1||!isBlock(node))&&0===childCount)return void dom.remove(node,1);if(format.inline||format.wrapper){if(format.exact||1!==childCount||(node=mergeStyles(node)),each(formatList,function(format){each(dom.select(format.inline,node),function(child){isBookmarkNode(child)||removeFormat(format,vars,child,format.exact?child:null)})}),matchNode(node.parentNode,name,vars))return dom.remove(node,1),node=0,TRUE;format.merge_with_parents&&dom.getParent(node.parentNode,function(parent){return matchNode(parent,name,vars)?(dom.remove(node,1),node=0,TRUE):void 0}),node&&format.merge_siblings!==!1&&(node=mergeSiblings(getNonWhiteSpaceSibling(node),node),node=mergeSiblings(node,getNonWhiteSpaceSibling(node,TRUE)))}})}var bookmark,rng,formatList=get(name),format=formatList[0],isCollapsed=!node&&selection.isCollapsed();if("false"!==getContentEditable(selection.getNode())){if(format){if(node)node.nodeType?(rng=dom.createRng(),rng.setStartBefore(node),rng.setEndAfter(node),applyRngStyle(expandRng(rng,formatList),null,!0)):applyRngStyle(node,null,!0);else if(isCollapsed&&format.inline&&!dom.select("td[data-mce-selected],th[data-mce-selected]").length)performCaretAction("apply",name,vars);else{var curSelNode=ed.selection.getNode();forcedRootBlock||!formatList[0].defaultBlock||dom.getParent(curSelNode,dom.isBlock)||apply(formatList[0].defaultBlock),ed.selection.setRng(adjustSelectionToVisibleSelection()),bookmark=selection.getBookmark(),applyRngStyle(expandRng(selection.getRng(TRUE),formatList),bookmark),format.styles&&(format.styles.color||format.styles.textDecoration)&&(walk(curSelNode,processUnderlineAndColor,"childNodes"),processUnderlineAndColor(curSelNode)),selection.moveToBookmark(bookmark),moveStart(selection.getRng(TRUE)),ed.nodeChanged()}Hooks.postProcess(name,ed)}}else{node=selection.getNode();for(var i=0,l=formatList.length;l>i;i++)if(formatList[i].ceFalseOverride&&dom.is(node,formatList[i].selector))return void setElementFormat(node,formatList[i])}}function remove(name,vars,node,similar){function process(node){var children,i,l,lastContentEditable,hasContentEditableState;if(1===node.nodeType&&getContentEditable(node)&&(lastContentEditable=contentEditable,contentEditable="true"===getContentEditable(node),hasContentEditableState=!0),children=grep(node.childNodes),contentEditable&&!hasContentEditableState)for(i=0,l=formatList.length;l>i&&!removeFormat(formatList[i],vars,node,node);i++);if(format.deep&&children.length){for(i=0,l=children.length;l>i;i++)process(children[i]);hasContentEditableState&&(contentEditable=lastContentEditable)}}function findFormatRoot(container){var formatRoot;return each(getParents(container.parentNode).reverse(),function(parent){var format;formatRoot||"_start"==parent.id||"_end"==parent.id||(format=matchNode(parent,name,vars,similar),format&&format.split!==!1&&(formatRoot=parent))}),formatRoot}function wrapAndSplit(formatRoot,container,target,split){var parent,clone,lastClone,firstClone,i,formatRootParent;if(formatRoot){for(formatRootParent=formatRoot.parentNode,parent=container.parentNode;parent&&parent!=formatRootParent;parent=parent.parentNode){for(clone=dom.clone(parent,FALSE),i=0;i<formatList.length;i++)if(removeFormat(formatList[i],vars,clone,clone)){clone=0;break}clone&&(lastClone&&clone.appendChild(lastClone),firstClone||(firstClone=clone),lastClone=clone)}!split||format.mixed&&isBlock(formatRoot)||(container=dom.split(formatRoot,container)),lastClone&&(target.parentNode.insertBefore(lastClone,target),firstClone.appendChild(target))}return container}function splitToFormatRoot(container){return wrapAndSplit(findFormatRoot(container),container,container,!0)}function unwrap(start){var node=dom.get(start?"_start":"_end"),out=node[start?"firstChild":"lastChild"];return isBookmarkNode(out)&&(out=out[start?"firstChild":"lastChild"]),3==out.nodeType&&0===out.data.length&&(out=start?node.previousSibling||node.nextSibling:node.nextSibling||node.previousSibling),dom.remove(node,!0),out}function removeRngStyle(rng){var startContainer,endContainer,commonAncestorContainer=rng.commonAncestorContainer;if(rng=expandRng(rng,formatList,TRUE),format.split){if(startContainer=getContainer(rng,TRUE),endContainer=getContainer(rng),startContainer!=endContainer){if(/^(TR|TH|TD)$/.test(startContainer.nodeName)&&startContainer.firstChild&&(startContainer="TR"==startContainer.nodeName?startContainer.firstChild.firstChild||startContainer:startContainer.firstChild||startContainer),commonAncestorContainer&&/^T(HEAD|BODY|FOOT|R)$/.test(commonAncestorContainer.nodeName)&&isTableCell(endContainer)&&endContainer.firstChild&&(endContainer=endContainer.firstChild||endContainer),dom.isChildOf(startContainer,endContainer)&&!isBlock(endContainer)&&!isTableCell(startContainer)&&!isTableCell(endContainer))return startContainer=wrap(startContainer,"span",{id:"_start","data-mce-type":"bookmark"}),splitToFormatRoot(startContainer),void(startContainer=unwrap(TRUE));startContainer=wrap(startContainer,"span",{id:"_start","data-mce-type":"bookmark"}),endContainer=wrap(endContainer,"span",{id:"_end","data-mce-type":"bookmark"}),splitToFormatRoot(startContainer),splitToFormatRoot(endContainer),startContainer=unwrap(TRUE),endContainer=unwrap()}else startContainer=endContainer=splitToFormatRoot(startContainer);rng.startContainer=startContainer.parentNode?startContainer.parentNode:startContainer,rng.startOffset=nodeIndex(startContainer),rng.endContainer=endContainer.parentNode?endContainer.parentNode:endContainer,rng.endOffset=nodeIndex(endContainer)+1}rangeUtils.walk(rng,function(nodes){each(nodes,function(node){process(node),1===node.nodeType&&"underline"===ed.dom.getStyle(node,"text-decoration")&&node.parentNode&&"underline"===getTextDecoration(node.parentNode)&&removeFormat({deep:!1,exact:!0,inline:"span",styles:{textDecoration:"underline"}},null,node)})})}var bookmark,rng,formatList=get(name),format=formatList[0],contentEditable=!0;if(node)return void(node.nodeType?(rng=dom.createRng(),rng.setStartBefore(node),rng.setEndAfter(node),removeRngStyle(rng)):removeRngStyle(node));if("false"!==getContentEditable(selection.getNode()))selection.isCollapsed()&&format.inline&&!dom.select("td[data-mce-selected],th[data-mce-selected]").length?performCaretAction("remove",name,vars,similar):(bookmark=selection.getBookmark(),removeRngStyle(selection.getRng(TRUE)),selection.moveToBookmark(bookmark),format.inline&&match(name,vars,selection.getStart())&&moveStart(selection.getRng(!0)),ed.nodeChanged());else{node=selection.getNode();for(var i=0,l=formatList.length;l>i&&(!formatList[i].ceFalseOverride||!removeFormat(formatList[i],vars,node,node));i++);}}function toggle(name,vars,node){var fmt=get(name);!match(name,vars,node)||"toggle"in fmt[0]&&!fmt[0].toggle?apply(name,vars,node):remove(name,vars,node)}function matchNode(node,name,vars,similar){function matchItems(node,format,item_name){var key,value,i,items=format[item_name];if(format.onmatch)return format.onmatch(node,format,item_name);if(items)if(items.length===undef){for(key in items)if(items.hasOwnProperty(key)){if(value="attributes"===item_name?dom.getAttrib(node,key):getStyle(node,key),similar&&!value&&!format.exact)return;if((!similar||format.exact)&&!isEq(value,normalizeStyleValue(replaceVars(items[key],vars),key)))return}}else for(i=0;i<items.length;i++)if("attributes"===item_name?dom.getAttrib(node,items[i]):getStyle(node,items[i]))return format;return format}var format,i,classes,formatList=get(name);if(formatList&&node)for(i=0;i<formatList.length;i++)if(format=formatList[i],matchName(node,format)&&matchItems(node,format,"attributes")&&matchItems(node,format,"styles")){if(classes=format.classes)for(i=0;i<classes.length;i++)if(!dom.hasClass(node,classes[i]))return;return format}}function match(name,vars,node){function matchParents(node){var root=dom.getRoot();return node===root?!1:(node=dom.getParent(node,function(node){return node.parentNode===root||!!matchNode(node,name,vars,!0)}),matchNode(node,name,vars))}var startNode;return node?matchParents(node):(node=selection.getNode(),matchParents(node)?TRUE:(startNode=selection.getStart(),startNode!=node&&matchParents(startNode)?TRUE:FALSE))}function matchAll(names,vars){var startElement,matchedFormatNames=[],checkedMap={};return startElement=selection.getStart(),dom.getParent(startElement,function(node){var i,name;for(i=0;i<names.length;i++)name=names[i],!checkedMap[name]&&matchNode(node,name,vars)&&(checkedMap[name]=!0,matchedFormatNames.push(name))},dom.getRoot()),matchedFormatNames}function canApply(name){var startNode,parents,i,x,selector,formatList=get(name);if(formatList)for(startNode=selection.getStart(),parents=getParents(startNode),x=formatList.length-1;x>=0;x--){if(selector=formatList[x].selector,!selector||formatList[x].defaultBlock)return TRUE;for(i=parents.length-1;i>=0;i--)if(dom.is(parents[i],selector))return TRUE}return FALSE}function formatChanged(formats,callback,similar){var currentFormats;return formatChangeData||(formatChangeData={},currentFormats={},ed.on("NodeChange",function(e){var parents=getParents(e.element),matchedFormats={};parents=Tools.grep(parents,function(node){return 1==node.nodeType&&!node.getAttribute("data-mce-bogus")}),each(formatChangeData,function(callbacks,format){each(parents,function(node){return matchNode(node,format,{},callbacks.similar)?(currentFormats[format]||(each(callbacks,function(callback){callback(!0,{node:node,format:format,parents:parents})}),currentFormats[format]=callbacks),matchedFormats[format]=callbacks,!1):void 0})}),each(currentFormats,function(callbacks,format){matchedFormats[format]||(delete currentFormats[format],each(callbacks,function(callback){callback(!1,{node:e.element,format:format,parents:parents})}))})})),each(formats.split(","),function(format){formatChangeData[format]||(formatChangeData[format]=[],formatChangeData[format].similar=similar),formatChangeData[format].push(callback)}),this}function getCssText(format){return Preview.getCssText(ed,format)}function matchName(node,format){return isEq(node,format.inline)?TRUE:isEq(node,format.block)?TRUE:format.selector?1==node.nodeType&&dom.is(node,format.selector):void 0}function isEq(str1,str2){return str1=str1||"",str2=str2||"",str1=""+(str1.nodeName||str1),str2=""+(str2.nodeName||str2),str1.toLowerCase()==str2.toLowerCase()}function getStyle(node,name){return normalizeStyleValue(dom.getStyle(node,name),name)}function normalizeStyleValue(value,name){return"color"!=name&&"backgroundColor"!=name||(value=dom.toHex(value)),"fontWeight"==name&&700==value&&(value="bold"),"fontFamily"==name&&(value=value.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+value}function replaceVars(value,vars){return"string"!=typeof value?value=value(vars):vars&&(value=value.replace(/%(\w+)/g,function(str,name){return vars[name]||str})),value}function isWhiteSpaceNode(node){return node&&3===node.nodeType&&/^([\t \r\n]+|)$/.test(node.nodeValue)}function wrap(node,name,attrs){var wrapper=dom.create(name,attrs);return node.parentNode.insertBefore(wrapper,node),wrapper.appendChild(node),wrapper}function expandRng(rng,format,remove){function findParentContainer(start){function isBogusBr(node){return"BR"==node.nodeName&&node.getAttribute("data-mce-bogus")&&!node.nextSibling}var container,parent,sibling,siblingName,root;if(container=parent=start?startContainer:endContainer,siblingName=start?"previousSibling":"nextSibling",root=dom.getRoot(),3==container.nodeType&&!isWhiteSpaceNode(container)&&(start?startOffset>0:endOffset<container.nodeValue.length))return container;for(;;){if(!format[0].block_expand&&isBlock(parent))return parent;for(sibling=parent[siblingName];sibling;sibling=sibling[siblingName])if(!isBookmarkNode(sibling)&&!isWhiteSpaceNode(sibling)&&!isBogusBr(sibling))return parent;if(parent==root||parent.parentNode==root){container=parent;break}parent=parent.parentNode}return container}function findLeaf(node,offset){for(offset===undef&&(offset=3===node.nodeType?node.length:node.childNodes.length);node&&node.hasChildNodes();)node=node.childNodes[offset],node&&(offset=3===node.nodeType?node.length:node.childNodes.length);return{node:node,offset:offset}}function findParentContentEditable(node){for(var parent=node;parent;){if(1===parent.nodeType&&getContentEditable(parent))return"false"===getContentEditable(parent)?parent:node;parent=parent.parentNode}return node}function findWordEndPoint(container,offset,start){function findSpace(node,offset){var pos,pos2,str=node.nodeValue;return"undefined"==typeof offset&&(offset=start?str.length:0),start?(pos=str.lastIndexOf(" ",offset),pos2=str.lastIndexOf(" ",offset),pos=pos>pos2?pos:pos2,-1===pos||remove||pos++):(pos=str.indexOf(" ",offset),pos2=str.indexOf(" ",offset),pos=-1!==pos&&(-1===pos2||pos2>pos)?pos:pos2),pos}var walker,node,pos,lastTextNode;if(3===container.nodeType){if(pos=findSpace(container,offset),-1!==pos)return{container:container,offset:pos};lastTextNode=container}for(walker=new TreeWalker(container,dom.getParent(container,isBlock)||ed.getBody());node=walker[start?"prev":"next"]();)if(3===node.nodeType){if(lastTextNode=node,pos=findSpace(node),-1!==pos)return{container:node,offset:pos}}else if(isBlock(node))break;return lastTextNode?(offset=start?0:lastTextNode.length,{container:lastTextNode,offset:offset}):void 0}function findSelectorEndPoint(container,sibling_name){var parents,i,y,curFormat;for(3==container.nodeType&&0===container.nodeValue.length&&container[sibling_name]&&(container=container[sibling_name]),parents=getParents(container),i=0;i<parents.length;i++)for(y=0;y<format.length;y++)if(curFormat=format[y],!("collapsed"in curFormat&&curFormat.collapsed!==rng.collapsed)&&dom.is(parents[i],curFormat.selector))return parents[i];return container}function findBlockEndPoint(container,sibling_name){var node,root=dom.getRoot();if(format[0].wrapper||(node=dom.getParent(container,format[0].block,root)),node||(node=dom.getParent(3==container.nodeType?container.parentNode:container,function(node){return node!=root&&isTextBlock(node)})),node&&format[0].wrapper&&(node=getParents(node,"ul,ol").reverse()[0]||node),!node)for(node=container;node[sibling_name]&&!isBlock(node[sibling_name])&&(node=node[sibling_name],!isEq(node,"br")););return node||container}var lastIdx,leaf,endPoint,startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;if(1==startContainer.nodeType&&startContainer.hasChildNodes()&&(lastIdx=startContainer.childNodes.length-1,startContainer=startContainer.childNodes[startOffset>lastIdx?lastIdx:startOffset],3==startContainer.nodeType&&(startOffset=0)),1==endContainer.nodeType&&endContainer.hasChildNodes()&&(lastIdx=endContainer.childNodes.length-1,endContainer=endContainer.childNodes[endOffset>lastIdx?lastIdx:endOffset-1],3==endContainer.nodeType&&(endOffset=endContainer.nodeValue.length)),startContainer=findParentContentEditable(startContainer),endContainer=findParentContentEditable(endContainer),(isBookmarkNode(startContainer.parentNode)||isBookmarkNode(startContainer))&&(startContainer=isBookmarkNode(startContainer)?startContainer:startContainer.parentNode,startContainer=startContainer.nextSibling||startContainer,3==startContainer.nodeType&&(startOffset=0)),(isBookmarkNode(endContainer.parentNode)||isBookmarkNode(endContainer))&&(endContainer=isBookmarkNode(endContainer)?endContainer:endContainer.parentNode,endContainer=endContainer.previousSibling||endContainer,3==endContainer.nodeType&&(endOffset=endContainer.length)),format[0].inline&&(rng.collapsed&&(endPoint=findWordEndPoint(startContainer,startOffset,!0),endPoint&&(startContainer=endPoint.container,startOffset=endPoint.offset),endPoint=findWordEndPoint(endContainer,endOffset),endPoint&&(endContainer=endPoint.container,endOffset=endPoint.offset)),leaf=findLeaf(endContainer,endOffset),leaf.node)){for(;leaf.node&&0===leaf.offset&&leaf.node.previousSibling;)leaf=findLeaf(leaf.node.previousSibling);leaf.node&&leaf.offset>0&&3===leaf.node.nodeType&&" "===leaf.node.nodeValue.charAt(leaf.offset-1)&&leaf.offset>1&&(endContainer=leaf.node,
endContainer.splitText(leaf.offset-1))}return(format[0].inline||format[0].block_expand)&&(format[0].inline&&3==startContainer.nodeType&&0!==startOffset||(startContainer=findParentContainer(!0)),format[0].inline&&3==endContainer.nodeType&&endOffset!==endContainer.nodeValue.length||(endContainer=findParentContainer())),format[0].selector&&format[0].expand!==FALSE&&!format[0].inline&&(startContainer=findSelectorEndPoint(startContainer,"previousSibling"),endContainer=findSelectorEndPoint(endContainer,"nextSibling")),(format[0].block||format[0].selector)&&(startContainer=findBlockEndPoint(startContainer,"previousSibling"),endContainer=findBlockEndPoint(endContainer,"nextSibling"),format[0].block&&(isBlock(startContainer)||(startContainer=findParentContainer(!0)),isBlock(endContainer)||(endContainer=findParentContainer()))),1==startContainer.nodeType&&(startOffset=nodeIndex(startContainer),startContainer=startContainer.parentNode),1==endContainer.nodeType&&(endOffset=nodeIndex(endContainer)+1,endContainer=endContainer.parentNode),{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}}function isColorFormatAndAnchor(node,format){return format.links&&"A"==node.tagName}function removeFormat(format,vars,node,compare_node){var i,attrs,stylesModified;if(!matchName(node,format)&&!isColorFormatAndAnchor(node,format))return FALSE;if("all"!=format.remove)for(each(format.styles,function(value,name){value=normalizeStyleValue(replaceVars(value,vars),name),"number"==typeof name&&(name=value,compare_node=0),(format.remove_similar||!compare_node||isEq(getStyle(compare_node,name),value))&&dom.setStyle(node,name,""),stylesModified=1}),stylesModified&&""===dom.getAttrib(node,"style")&&(node.removeAttribute("style"),node.removeAttribute("data-mce-style")),each(format.attributes,function(value,name){var valueOut;if(value=replaceVars(value,vars),"number"==typeof name&&(name=value,compare_node=0),!compare_node||isEq(dom.getAttrib(compare_node,name),value)){if("class"==name&&(value=dom.getAttrib(node,name),value&&(valueOut="",each(value.split(/\s+/),function(cls){/mce\-\w+/.test(cls)&&(valueOut+=(valueOut?" ":"")+cls)}),valueOut)))return void dom.setAttrib(node,name,valueOut);"class"==name&&node.removeAttribute("className"),MCE_ATTR_RE.test(name)&&node.removeAttribute("data-mce-"+name),node.removeAttribute(name)}}),each(format.classes,function(value){value=replaceVars(value,vars),compare_node&&!dom.hasClass(compare_node,value)||dom.removeClass(node,value)}),attrs=dom.getAttribs(node),i=0;i<attrs.length;i++)if(0!==attrs[i].nodeName.indexOf("_"))return FALSE;return"none"!=format.remove?(removeNode(node,format),TRUE):void 0}function removeNode(node,format){function find(node,next,inc){return node=getNonWhiteSpaceSibling(node,next,inc),!node||"BR"==node.nodeName||isBlock(node)}var rootBlockElm,parentNode=node.parentNode;format.block&&(forcedRootBlock?parentNode==dom.getRoot()&&(format.list_block&&isEq(node,format.list_block)||each(grep(node.childNodes),function(node){isValid(forcedRootBlock,node.nodeName.toLowerCase())?rootBlockElm?rootBlockElm.appendChild(node):(rootBlockElm=wrap(node,forcedRootBlock),dom.setAttribs(rootBlockElm,ed.settings.forced_root_block_attrs)):rootBlockElm=0})):isBlock(node)&&!isBlock(parentNode)&&(find(node,FALSE)||find(node.firstChild,TRUE,1)||node.insertBefore(dom.create("br"),node.firstChild),find(node,TRUE)||find(node.lastChild,FALSE,1)||node.appendChild(dom.create("br")))),format.selector&&format.inline&&!isEq(format.inline,node)||dom.remove(node,1)}function getNonWhiteSpaceSibling(node,next,inc){if(node)for(next=next?"nextSibling":"previousSibling",node=inc?node:node[next];node;node=node[next])if(1==node.nodeType||!isWhiteSpaceNode(node))return node}function mergeSiblings(prev,next){function findElementSibling(node,sibling_name){for(sibling=node;sibling;sibling=sibling[sibling_name]){if(3==sibling.nodeType&&0!==sibling.nodeValue.length)return node;if(1==sibling.nodeType&&!isBookmarkNode(sibling))return sibling}return node}var sibling,tmpSibling,elementUtils=new ElementUtils(dom);if(prev&&next&&(prev=findElementSibling(prev,"previousSibling"),next=findElementSibling(next,"nextSibling"),elementUtils.compare(prev,next))){for(sibling=prev.nextSibling;sibling&&sibling!=next;)tmpSibling=sibling,sibling=sibling.nextSibling,prev.appendChild(tmpSibling);return dom.remove(next),each(grep(next.childNodes),function(node){prev.appendChild(node)}),prev}return next}function getContainer(rng,start){var container,offset,lastIdx;return container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],1==container.nodeType&&(lastIdx=container.childNodes.length-1,!start&&offset&&offset--,container=container.childNodes[offset>lastIdx?lastIdx:offset]),3===container.nodeType&&start&&offset>=container.nodeValue.length&&(container=new TreeWalker(container,ed.getBody()).next()||container),3!==container.nodeType||start||0!==offset||(container=new TreeWalker(container,ed.getBody()).prev()||container),container}function performCaretAction(type,name,vars,similar){function createCaretContainer(fill){var caretContainer=dom.create("span",{id:caretContainerId,"data-mce-bogus":!0,style:debug?"color:red":""});return fill&&caretContainer.appendChild(ed.getDoc().createTextNode(INVISIBLE_CHAR)),caretContainer}function isCaretContainerEmpty(node,nodes){for(;node;){if(3===node.nodeType&&node.nodeValue!==INVISIBLE_CHAR||node.childNodes.length>1)return!1;nodes&&1===node.nodeType&&nodes.push(node),node=node.firstChild}return!0}function getParentCaretContainer(node){for(;node;){if(node.id===caretContainerId)return node;node=node.parentNode}}function findFirstTextNode(node){var walker;if(node)for(walker=new TreeWalker(node,node),node=walker.current();node;node=walker.next())if(3===node.nodeType)return node}function removeCaretContainer(node,move_caret){var child,rng;if(node)rng=selection.getRng(!0),isCaretContainerEmpty(node)?(move_caret!==!1&&(rng.setStartBefore(node),rng.setEndBefore(node)),dom.remove(node)):(child=findFirstTextNode(node),child.nodeValue.charAt(0)===INVISIBLE_CHAR&&(child.deleteData(0,1),rng.startContainer==child&&rng.startOffset>0&&rng.setStart(child,rng.startOffset-1),rng.endContainer==child&&rng.endOffset>0&&rng.setEnd(child,rng.endOffset-1)),dom.remove(node,1)),selection.setRng(rng);else if(node=getParentCaretContainer(selection.getStart()),!node)for(;node=dom.get(caretContainerId);)removeCaretContainer(node,!1)}function applyCaretFormat(){var rng,caretContainer,textNode,offset,bookmark,container,text;rng=selection.getRng(!0),offset=rng.startOffset,container=rng.startContainer,text=container.nodeValue,caretContainer=getParentCaretContainer(selection.getStart()),caretContainer&&(textNode=findFirstTextNode(caretContainer)),text&&offset>0&&offset<text.length&&/\w/.test(text.charAt(offset))&&/\w/.test(text.charAt(offset-1))?(bookmark=selection.getBookmark(),rng.collapse(!0),rng=expandRng(rng,get(name)),rng=rangeUtils.split(rng),apply(name,vars,rng),selection.moveToBookmark(bookmark)):(caretContainer&&textNode.nodeValue===INVISIBLE_CHAR?apply(name,vars,caretContainer):(caretContainer=createCaretContainer(!0),textNode=caretContainer.firstChild,rng.insertNode(caretContainer),offset=1,apply(name,vars,caretContainer)),selection.setCursorLocation(textNode,offset))}function removeCaretFormat(){var container,offset,bookmark,hasContentAfter,node,formatNode,i,caretContainer,rng=selection.getRng(!0),parents=[];for(container=rng.startContainer,offset=rng.startOffset,node=container,3==container.nodeType&&(offset!=container.nodeValue.length&&(hasContentAfter=!0),node=node.parentNode);node;){if(matchNode(node,name,vars,similar)){formatNode=node;break}node.nextSibling&&(hasContentAfter=!0),parents.push(node),node=node.parentNode}if(formatNode)if(hasContentAfter)bookmark=selection.getBookmark(),rng.collapse(!0),rng=expandRng(rng,get(name),!0),rng=rangeUtils.split(rng),remove(name,vars,rng),selection.moveToBookmark(bookmark);else{for(caretContainer=createCaretContainer(),node=caretContainer,i=parents.length-1;i>=0;i--)node.appendChild(dom.clone(parents[i],!1)),node=node.firstChild;node.appendChild(dom.doc.createTextNode(INVISIBLE_CHAR)),node=node.firstChild;var block=dom.getParent(formatNode,isTextBlock);block&&dom.isEmpty(block)?formatNode.parentNode.replaceChild(caretContainer,formatNode):dom.insertAfter(caretContainer,formatNode),selection.setCursorLocation(node,1),dom.isEmpty(formatNode)&&dom.remove(formatNode)}}function unmarkBogusCaretParents(){var caretContainer;caretContainer=getParentCaretContainer(selection.getStart()),caretContainer&&!dom.isEmpty(caretContainer)&&walk(caretContainer,function(node){1!=node.nodeType||node.id===caretContainerId||dom.isEmpty(node)||dom.setAttrib(node,"data-mce-bogus",null)},"childNodes")}var caretContainerId="_mce_caret",debug=ed.settings.caret_debug;ed._hasCaretEvents||(markCaretContainersBogus=function(){var i,nodes=[];if(isCaretContainerEmpty(getParentCaretContainer(selection.getStart()),nodes))for(i=nodes.length;i--;)dom.setAttrib(nodes[i],"data-mce-bogus","1")},disableCaretContainer=function(e){var keyCode=e.keyCode;removeCaretContainer(),8==keyCode&&selection.isCollapsed()&&selection.getStart().innerHTML==INVISIBLE_CHAR&&removeCaretContainer(getParentCaretContainer(selection.getStart())),37!=keyCode&&39!=keyCode||removeCaretContainer(getParentCaretContainer(selection.getStart())),unmarkBogusCaretParents()},ed.on("SetContent",function(e){e.selection&&unmarkBogusCaretParents()}),ed._hasCaretEvents=!0),"apply"==type?applyCaretFormat():removeCaretFormat()}function moveStart(rng){var isAtEndOfText,walker,node,nodes,tmpNode,container=rng.startContainer,offset=rng.startOffset;if((rng.startContainer!=rng.endContainer||!isInlineBlock(rng.startContainer.childNodes[rng.startOffset]))&&(3==container.nodeType&&offset>=container.nodeValue.length&&(offset=nodeIndex(container),container=container.parentNode,isAtEndOfText=!0),1==container.nodeType))for(nodes=container.childNodes,container=nodes[Math.min(offset,nodes.length-1)],walker=new TreeWalker(container,dom.getParent(container,dom.isBlock)),(offset>nodes.length-1||isAtEndOfText)&&walker.next(),node=walker.current();node;node=walker.next())if(3==node.nodeType&&!isWhiteSpaceNode(node))return tmpNode=dom.create("a",{"data-mce-bogus":"all"},INVISIBLE_CHAR),node.parentNode.insertBefore(tmpNode,node),rng.setStart(node,0),selection.setRng(rng),void dom.remove(tmpNode)}var formatChangeData,undef,disableCaretContainer,markCaretContainersBogus,formats={},dom=ed.dom,selection=ed.selection,rangeUtils=new RangeUtils(dom),isValid=ed.schema.isValidChild,isBlock=dom.isBlock,forcedRootBlock=ed.settings.forced_root_block,nodeIndex=dom.nodeIndex,INVISIBLE_CHAR="\ufeff",MCE_ATTR_RE=/^(src|href|style)$/,FALSE=!1,TRUE=!0,getContentEditable=dom.getContentEditable,isBookmarkNode=BookmarkManager.isBookmarkNode,each=Tools.each,grep=Tools.grep,walk=Tools.walk,extend=Tools.extend;extend(this,{get:get,register:register,unregister:unregister,apply:apply,remove:remove,toggle:toggle,match:match,matchAll:matchAll,matchNode:matchNode,canApply:canApply,formatChanged:formatChanged,getCssText:getCssText}),defaultFormats(),addKeyboardShortcuts(),ed.on("BeforeGetContent",function(e){markCaretContainersBogus&&"raw"!=e.format&&markCaretContainersBogus()}),ed.on("mouseup keydown",function(e){disableCaretContainer&&disableCaretContainer(e)})}}),define("tinymce/UndoManager",["tinymce/util/VK","tinymce/Env"],function(VK,Env){return function(editor){function getContent(){return editor.serializer.getTrimmedContent()}function setDirty(state){editor.setDirty(state)}function addNonTypingUndoLevel(e){self.typing=!1,self.add({},e)}var beforeBookmark,isFirstTypedCharacter,self=this,index=0,data=[],locks=0;return editor.on("init",function(){self.add()}),editor.on("BeforeExecCommand",function(e){var cmd=e.command;"Undo"!=cmd&&"Redo"!=cmd&&"mceRepaint"!=cmd&&self.beforeChange()}),editor.on("ExecCommand",function(e){var cmd=e.command;"Undo"!=cmd&&"Redo"!=cmd&&"mceRepaint"!=cmd&&addNonTypingUndoLevel(e)}),editor.on("ObjectResizeStart Cut",function(){self.beforeChange()}),editor.on("SaveContent ObjectResized blur",addNonTypingUndoLevel),editor.on("DragEnd",addNonTypingUndoLevel),editor.on("KeyUp",function(e){var keyCode=e.keyCode;e.isDefaultPrevented()||((keyCode>=33&&36>=keyCode||keyCode>=37&&40>=keyCode||45==keyCode||13==keyCode||e.ctrlKey)&&(addNonTypingUndoLevel(),editor.nodeChanged()),(46==keyCode||8==keyCode||Env.mac&&(91==keyCode||93==keyCode))&&editor.nodeChanged(),isFirstTypedCharacter&&self.typing&&(editor.isDirty()||(setDirty(data[0]&&getContent()!=data[0].content),editor.isDirty()&&editor.fire("change",{level:data[0],lastLevel:null})),editor.fire("TypingUndo"),isFirstTypedCharacter=!1,editor.nodeChanged()))}),editor.on("KeyDown",function(e){var keyCode=e.keyCode;if(!e.isDefaultPrevented()){if(keyCode>=33&&36>=keyCode||keyCode>=37&&40>=keyCode||45==keyCode)return void(self.typing&&addNonTypingUndoLevel(e));var modKey=e.ctrlKey&&!e.altKey||e.metaKey;!(16>keyCode||keyCode>20)||224==keyCode||91==keyCode||self.typing||modKey||(self.beforeChange(),self.typing=!0,self.add({},e),isFirstTypedCharacter=!0)}}),editor.on("MouseDown",function(e){self.typing&&addNonTypingUndoLevel(e)}),editor.addShortcut("meta+z","","Undo"),editor.addShortcut("meta+y,meta+shift+z","","Redo"),editor.on("AddUndo Undo Redo ClearUndos",function(e){e.isDefaultPrevented()||editor.nodeChanged()}),self={data:data,typing:!1,beforeChange:function(){locks||(beforeBookmark=editor.selection.getBookmark(2,!0))},add:function(level,event){var i,lastLevel,settings=editor.settings;if(level=level||{},level.content=getContent(),locks||editor.removed)return null;if(lastLevel=data[index],editor.fire("BeforeAddUndo",{level:level,lastLevel:lastLevel,originalEvent:event}).isDefaultPrevented())return null;if(lastLevel&&lastLevel.content==level.content)return null;if(data[index]&&(data[index].beforeBookmark=beforeBookmark),settings.custom_undo_redo_levels&&data.length>settings.custom_undo_redo_levels){for(i=0;i<data.length-1;i++)data[i]=data[i+1];data.length--,index=data.length}level.bookmark=editor.selection.getBookmark(2,!0),index<data.length-1&&(data.length=index+1),data.push(level),index=data.length-1;var args={level:level,lastLevel:lastLevel,originalEvent:event};return editor.fire("AddUndo",args),index>0&&(setDirty(!0),editor.fire("change",args)),level},undo:function(){var level;return self.typing&&(self.add(),self.typing=!1),index>0&&(level=data[--index],editor.setContent(level.content,{format:"raw"}),editor.selection.moveToBookmark(level.beforeBookmark),setDirty(!0),editor.fire("undo",{level:level})),level},redo:function(){var level;return index<data.length-1&&(level=data[++index],editor.setContent(level.content,{format:"raw"}),editor.selection.moveToBookmark(level.bookmark),setDirty(!0),editor.fire("redo",{level:level})),level},clear:function(){data=[],index=0,self.typing=!1,editor.fire("ClearUndos")},hasUndo:function(){return index>0||self.typing&&data[0]&&getContent()!=data[0].content},hasRedo:function(){return index<data.length-1&&!this.typing},transact:function(callback){self.beforeChange();try{locks++,callback()}finally{locks--}self.add()}}}}),define("tinymce/EnterKey",["tinymce/dom/TreeWalker","tinymce/dom/RangeUtils","tinymce/Env"],function(TreeWalker,RangeUtils,Env){var isIE=Env.ie&&Env.ie<11;return function(editor){function handleEnterKey(evt){function canSplitBlock(node){return node&&dom.isBlock(node)&&!/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName)&&!/^(fixed|absolute)/i.test(node.style.position)&&"true"!==dom.getContentEditable(node)}function isTableCell(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName)}function renderBlockOnIE(block){var oldRng;dom.isBlock(block)&&(oldRng=selection.getRng(),block.appendChild(dom.create("span",null," ")),selection.select(block),block.lastChild.outerHTML="",selection.setRng(oldRng))}function trimInlineElementsOnLeftSideOfBlock(block){var i,node=block,firstChilds=[];if(node){for(;node=node.firstChild;){if(dom.isBlock(node))return;1!=node.nodeType||nonEmptyElementsMap[node.nodeName.toLowerCase()]||firstChilds.push(node)}for(i=firstChilds.length;i--;)node=firstChilds[i],!node.hasChildNodes()||node.firstChild==node.lastChild&&""===node.firstChild.nodeValue?dom.remove(node):"A"==node.nodeName&&" "===(node.innerText||node.textContent)&&dom.remove(node)}}function moveToCaretPosition(root){function firstNonWhiteSpaceNodeSibling(node){for(;node;){if(1==node.nodeType||3==node.nodeType&&node.data&&/[\r\n\s]/.test(node.data))return node;node=node.nextSibling}}var walker,node,rng,tempElm,lastNode=root;if(root){if(Env.ie&&Env.ie<9&&parentBlock&&parentBlock.firstChild&&parentBlock.firstChild==parentBlock.lastChild&&"BR"==parentBlock.firstChild.tagName&&dom.remove(parentBlock.firstChild),/^(LI|DT|DD)$/.test(root.nodeName)){var firstChild=firstNonWhiteSpaceNodeSibling(root.firstChild);firstChild&&/^(UL|OL|DL)$/.test(firstChild.nodeName)&&root.insertBefore(dom.doc.createTextNode(" "),root.firstChild)}if(rng=dom.createRng(),Env.ie||root.normalize(),root.hasChildNodes()){for(walker=new TreeWalker(root,root);node=walker.current();){if(3==node.nodeType){rng.setStart(node,0),rng.setEnd(node,0);break}if(moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]){rng.setStartBefore(node),rng.setEndBefore(node);break}lastNode=node,node=walker.next()}node||(rng.setStart(lastNode,0),rng.setEnd(lastNode,0))}else"BR"==root.nodeName?root.nextSibling&&dom.isBlock(root.nextSibling)?((!documentMode||9>documentMode)&&(tempElm=dom.create("br"),root.parentNode.insertBefore(tempElm,root)),rng.setStartBefore(root),rng.setEndBefore(root)):(rng.setStartAfter(root),rng.setEndAfter(root)):(rng.setStart(root,0),rng.setEnd(root,0));selection.setRng(rng),dom.remove(tempElm),selection.scrollIntoView(root)}}function setForcedBlockAttrs(node){var forcedRootBlockName=settings.forced_root_block;forcedRootBlockName&&forcedRootBlockName.toLowerCase()===node.tagName.toLowerCase()&&dom.setAttribs(node,settings.forced_root_block_attrs)}function emptyBlock(elm){elm.innerHTML=isIE?"":'<br data-mce-bogus="1">'}function createNewBlock(name){var block,clonedNode,caretNode,node=container,textInlineElements=schema.getTextInlineElements();if(name||"TABLE"==parentBlockName?(block=dom.create(name||newBlockName),setForcedBlockAttrs(block)):block=parentBlock.cloneNode(!1),caretNode=block,settings.keep_styles!==!1)do if(textInlineElements[node.nodeName]){if("_mce_caret"==node.id)continue;clonedNode=node.cloneNode(!1),dom.setAttrib(clonedNode,"id",""),block.hasChildNodes()?(clonedNode.appendChild(block.firstChild),block.appendChild(clonedNode)):(caretNode=clonedNode,block.appendChild(clonedNode))}while(node=node.parentNode);return isIE||(caretNode.innerHTML='<br data-mce-bogus="1">'),block}function isCaretAtStartOrEndOfBlock(start){var walker,node,name;if(3==container.nodeType&&(start?offset>0:offset<container.nodeValue.length))return!1;if(container.parentNode==parentBlock&&isAfterLastNodeInContainer&&!start)return!0;if(start&&1==container.nodeType&&container==parentBlock.firstChild)return!0;if("TABLE"===container.nodeName||container.previousSibling&&"TABLE"==container.previousSibling.nodeName)return isAfterLastNodeInContainer&&!start||!isAfterLastNodeInContainer&&start;for(walker=new TreeWalker(container,parentBlock),3==container.nodeType&&(start&&0===offset?walker.prev():start||offset!=container.nodeValue.length||walker.next());node=walker.current();){if(1===node.nodeType){if(!node.getAttribute("data-mce-bogus")&&(name=node.nodeName.toLowerCase(),nonEmptyElementsMap[name]&&"br"!==name))return!1}else if(3===node.nodeType&&!/^[ \t\r\n]*$/.test(node.nodeValue))return!1;start?walker.prev():walker.next()}return!0}function wrapSelfAndSiblingsInDefaultBlock(container,offset){var newBlock,parentBlock,startNode,node,next,rootBlockName,blockName=newBlockName||"P";if(parentBlock=dom.getParent(container,dom.isBlock),!parentBlock||!canSplitBlock(parentBlock)){if(parentBlock=parentBlock||editableRoot,rootBlockName=parentBlock==editor.getBody()||isTableCell(parentBlock)?parentBlock.nodeName.toLowerCase():parentBlock.parentNode.nodeName.toLowerCase(),!parentBlock.hasChildNodes())return newBlock=dom.create(blockName),setForcedBlockAttrs(newBlock),parentBlock.appendChild(newBlock),rng.setStart(newBlock,0),rng.setEnd(newBlock,0),newBlock;for(node=container;node.parentNode!=parentBlock;)node=node.parentNode;for(;node&&!dom.isBlock(node);)startNode=node,node=node.previousSibling;if(startNode&&schema.isValidChild(rootBlockName,blockName.toLowerCase())){for(newBlock=dom.create(blockName),setForcedBlockAttrs(newBlock),startNode.parentNode.insertBefore(newBlock,startNode),node=startNode;node&&!dom.isBlock(node);)next=node.nextSibling,newBlock.appendChild(node),node=next;rng.setStart(container,offset),rng.setEnd(container,offset)}}return container}function handleEmptyListItem(){function isFirstOrLastLi(first){for(var node=containerBlock[first?"firstChild":"lastChild"];node&&1!=node.nodeType;)node=node[first?"nextSibling":"previousSibling"];return node===parentBlock}function getContainerBlock(){var containerBlockParent=containerBlock.parentNode;return/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)?containerBlockParent:containerBlock}if(containerBlock!=editor.getBody()){var containerBlockParentName=containerBlock.parentNode.nodeName;/^(OL|UL|LI)$/.test(containerBlockParentName)&&(newBlockName="LI"),newBlock=newBlockName?createNewBlock(newBlockName):dom.create("BR"),isFirstOrLastLi(!0)&&isFirstOrLastLi()?"LI"==containerBlockParentName?dom.insertAfter(newBlock,getContainerBlock()):dom.replace(newBlock,containerBlock):isFirstOrLastLi(!0)?"LI"==containerBlockParentName?(dom.insertAfter(newBlock,getContainerBlock()),newBlock.appendChild(dom.doc.createTextNode(" ")),newBlock.appendChild(containerBlock)):containerBlock.parentNode.insertBefore(newBlock,containerBlock):isFirstOrLastLi()?(dom.insertAfter(newBlock,getContainerBlock()),renderBlockOnIE(newBlock)):(containerBlock=getContainerBlock(),tmpRng=rng.cloneRange(),tmpRng.setStartAfter(parentBlock),tmpRng.setEndAfter(containerBlock),fragment=tmpRng.extractContents(),"LI"==newBlockName&&"LI"==fragment.firstChild.nodeName?(newBlock=fragment.firstChild,dom.insertAfter(fragment,containerBlock)):(dom.insertAfter(fragment,containerBlock),dom.insertAfter(newBlock,containerBlock))),dom.remove(parentBlock),moveToCaretPosition(newBlock),undoManager.add()}}function insertBr(){editor.execCommand("InsertLineBreak",!1,evt)}function trimLeadingLineBreaks(node){do 3===node.nodeType&&(node.nodeValue=node.nodeValue.replace(/^[\r\n]+/,"")),node=node.firstChild;while(node)}function getEditableRoot(node){var parent,editableRoot,root=dom.getRoot();for(parent=node;parent!==root&&"false"!==dom.getContentEditable(parent);)"true"===dom.getContentEditable(parent)&&(editableRoot=parent),parent=parent.parentNode;return parent!==root?editableRoot:root}function addBrToBlockIfNeeded(block){var lastChild;isIE||(block.normalize(),lastChild=block.lastChild,lastChild&&!/^(left|right)$/gi.test(dom.getStyle(lastChild,"float",!0))||dom.add(block,"br"))}function insertNewBlockAfter(){newBlock=/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName)&&"HGROUP"!=containerBlockName?createNewBlock(newBlockName):createNewBlock(),settings.end_container_on_empty_block&&canSplitBlock(containerBlock)&&dom.isEmpty(parentBlock)?newBlock=dom.split(containerBlock,parentBlock):dom.insertAfter(newBlock,parentBlock),moveToCaretPosition(newBlock)}var rng,tmpRng,editableRoot,container,offset,parentBlock,documentMode,shiftKey,newBlock,fragment,containerBlock,parentBlockName,containerBlockName,newBlockName,isAfterLastNodeInContainer;if(rng=selection.getRng(!0),!evt.isDefaultPrevented()){if(!rng.collapsed)return void editor.execCommand("Delete");if(new RangeUtils(dom).normalize(rng),container=rng.startContainer,offset=rng.startOffset,newBlockName=(settings.force_p_newlines?"p":"")||settings.forced_root_block,newBlockName=newBlockName?newBlockName.toUpperCase():"",documentMode=dom.doc.documentMode,shiftKey=evt.shiftKey,1==container.nodeType&&container.hasChildNodes()&&(isAfterLastNodeInContainer=offset>container.childNodes.length-1,container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container,offset=isAfterLastNodeInContainer&&3==container.nodeType?container.nodeValue.length:0),editableRoot=getEditableRoot(container)){if(undoManager.beforeChange(),!dom.isBlock(editableRoot)&&editableRoot!=dom.getRoot())return void(newBlockName&&!shiftKey||insertBr());if((newBlockName&&!shiftKey||!newBlockName&&shiftKey)&&(container=wrapSelfAndSiblingsInDefaultBlock(container,offset)),parentBlock=dom.getParent(container,dom.isBlock),containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null,parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():"",containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"","LI"!=containerBlockName||evt.ctrlKey||(parentBlock=containerBlock,parentBlockName=containerBlockName),/^(LI|DT|DD)$/.test(parentBlockName)){if(!newBlockName&&shiftKey)return void insertBr();if(dom.isEmpty(parentBlock))return void handleEmptyListItem()}if("PRE"==parentBlockName&&settings.br_in_pre!==!1){if(!shiftKey)return void insertBr()}else if(!newBlockName&&!shiftKey&&"LI"!=parentBlockName||newBlockName&&shiftKey)return void insertBr();newBlockName&&parentBlock===editor.getBody()||(newBlockName=newBlockName||"P",isCaretAtStartOrEndOfBlock()?insertNewBlockAfter():isCaretAtStartOrEndOfBlock(!0)?(newBlock=parentBlock.parentNode.insertBefore(createNewBlock(),parentBlock),renderBlockOnIE(newBlock),moveToCaretPosition(parentBlock)):(tmpRng=rng.cloneRange(),tmpRng.setEndAfter(parentBlock),fragment=tmpRng.extractContents(),trimLeadingLineBreaks(fragment),newBlock=fragment.firstChild,dom.insertAfter(fragment,parentBlock),trimInlineElementsOnLeftSideOfBlock(newBlock),addBrToBlockIfNeeded(parentBlock),dom.isEmpty(parentBlock)&&emptyBlock(parentBlock),newBlock.normalize(),dom.isEmpty(newBlock)?(dom.remove(newBlock),insertNewBlockAfter()):moveToCaretPosition(newBlock)),dom.setAttrib(newBlock,"id",""),editor.fire("NewBlock",{newBlock:newBlock}),undoManager.add())}}}var dom=editor.dom,selection=editor.selection,settings=editor.settings,undoManager=editor.undoManager,schema=editor.schema,nonEmptyElementsMap=schema.getNonEmptyElements(),moveCaretBeforeOnEnterElementsMap=schema.getMoveCaretBeforeOnEnterElements();editor.on("keydown",function(evt){13==evt.keyCode&&handleEnterKey(evt)!==!1&&evt.preventDefault()})}}),define("tinymce/ForceBlocks",[],function(){return function(editor){function addRootBlocks(){var rng,startContainer,startOffset,endContainer,endOffset,rootBlockNode,tempNode,wrapped,restoreSelection,tmpRng,rootNodeName,forcedRootBlock,node=selection.getStart(),rootNode=editor.getBody(),offset=-16777215;if(forcedRootBlock=settings.forced_root_block,node&&1===node.nodeType&&forcedRootBlock){for(;node&&node!=rootNode;){if(blockElements[node.nodeName])return;node=node.parentNode}if(rng=selection.getRng(),rng.setStart){startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;try{restoreSelection=editor.getDoc().activeElement===rootNode}catch(ex){}}else rng.item&&(node=rng.item(0),rng=editor.getDoc().body.createTextRange(),rng.moveToElementText(node)),restoreSelection=rng.parentElement().ownerDocument===editor.getDoc(),tmpRng=rng.duplicate(),tmpRng.collapse(!0),startOffset=-1*tmpRng.move("character",offset),tmpRng.collapsed||(tmpRng=rng.duplicate(),tmpRng.collapse(!1),endOffset=-1*tmpRng.move("character",offset)-startOffset);for(node=rootNode.firstChild,rootNodeName=rootNode.nodeName.toLowerCase();node;)if((3===node.nodeType||1==node.nodeType&&!blockElements[node.nodeName])&&schema.isValidChild(rootNodeName,forcedRootBlock.toLowerCase())){if(3===node.nodeType&&0===node.nodeValue.length){tempNode=node,node=node.nextSibling,dom.remove(tempNode);continue}rootBlockNode||(rootBlockNode=dom.create(forcedRootBlock,editor.settings.forced_root_block_attrs),node.parentNode.insertBefore(rootBlockNode,node),wrapped=!0),tempNode=node,node=node.nextSibling,rootBlockNode.appendChild(tempNode)}else rootBlockNode=null,node=node.nextSibling;if(wrapped&&restoreSelection){if(rng.setStart)rng.setStart(startContainer,startOffset),rng.setEnd(endContainer,endOffset),selection.setRng(rng);else try{rng=editor.getDoc().body.createTextRange(),rng.moveToElementText(rootNode),rng.collapse(!0),rng.moveStart("character",startOffset),endOffset>0&&rng.moveEnd("character",endOffset),rng.select()}catch(ex){}editor.nodeChanged()}}}var settings=editor.settings,dom=editor.dom,selection=editor.selection,schema=editor.schema,blockElements=schema.getBlockElements();settings.forced_root_block&&editor.on("NodeChange",addRootBlocks)}}),define("tinymce/EditorCommands",["tinymce/html/Serializer","tinymce/Env","tinymce/util/Tools","tinymce/dom/ElementUtils","tinymce/dom/RangeUtils","tinymce/dom/TreeWalker"],function(Serializer,Env,Tools,ElementUtils,RangeUtils,TreeWalker){var each=Tools.each,extend=Tools.extend,map=Tools.map,inArray=Tools.inArray,explode=Tools.explode,isIE=Env.ie,isOldIE=Env.ie&&Env.ie<11,TRUE=!0,FALSE=!1;return function(editor){function execCommand(command,ui,value,args){var func,customCommand,state=0;if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command)||args&&args.skip_focus||editor.focus(),args=editor.fire("BeforeExecCommand",{command:command,ui:ui,value:value}),args.isDefaultPrevented())return!1;if(customCommand=command.toLowerCase(),func=commands.exec[customCommand])return func(customCommand,ui,value),editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0;if(each(editor.plugins,function(p){return p.execCommand&&p.execCommand(command,ui,value)?(editor.fire("ExecCommand",{command:command,ui:ui,value:value}),state=!0,!1):void 0}),state)return state;if(editor.theme&&editor.theme.execCommand&&editor.theme.execCommand(command,ui,value))return editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0;try{state=editor.getDoc().execCommand(command,ui,value)}catch(ex){}return state?(editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0):!1}function queryCommandState(command){var func;if(!editor._isHidden()){if(command=command.toLowerCase(),func=commands.state[command])return func(command);try{return editor.getDoc().queryCommandState(command)}catch(ex){}return!1}}function queryCommandValue(command){var func;if(!editor._isHidden()){if(command=command.toLowerCase(),func=commands.value[command])return func(command);try{return editor.getDoc().queryCommandValue(command)}catch(ex){}}}function addCommands(command_list,type){type=type||"exec",each(command_list,function(callback,command){each(command.toLowerCase().split(","),function(command){commands[type][command]=callback})})}function addCommand(command,callback,scope){command=command.toLowerCase(),commands.exec[command]=function(command,ui,value,args){return callback.call(scope||editor,ui,value,args)}}function queryCommandSupported(command){if(command=command.toLowerCase(),commands.exec[command])return!0;try{return editor.getDoc().queryCommandSupported(command)}catch(ex){}return!1}function addQueryStateHandler(command,callback,scope){command=command.toLowerCase(),commands.state[command]=function(){return callback.call(scope||editor)}}function addQueryValueHandler(command,callback,scope){command=command.toLowerCase(),commands.value[command]=function(){return callback.call(scope||editor)}}function hasCustomCommand(command){return command=command.toLowerCase(),!!commands.exec[command]}function execNativeCommand(command,ui,value){return ui===undefined&&(ui=FALSE),value===undefined&&(value=null),editor.getDoc().execCommand(command,ui,value)}function isFormatMatch(name){return formatter.match(name)}function toggleFormat(name,value){formatter.toggle(name,value?{
value:value}:undefined),editor.nodeChanged()}function storeSelection(type){bookmark=selection.getBookmark(type)}function restoreSelection(){selection.moveToBookmark(bookmark)}var dom,selection,formatter,bookmark,commands={state:{},exec:{},value:{}},settings=editor.settings;editor.on("PreInit",function(){dom=editor.dom,selection=editor.selection,settings=editor.settings,formatter=editor.formatter}),extend(this,{execCommand:execCommand,queryCommandState:queryCommandState,queryCommandValue:queryCommandValue,queryCommandSupported:queryCommandSupported,addCommands:addCommands,addCommand:addCommand,addQueryStateHandler:addQueryStateHandler,addQueryValueHandler:addQueryValueHandler,hasCustomCommand:hasCustomCommand}),addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){editor.undoManager.add()},"Cut,Copy,Paste":function(command){var failed,doc=editor.getDoc();try{execNativeCommand(command)}catch(ex){failed=TRUE}if(failed||!doc.queryCommandSupported(command)){var msg=editor.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");Env.mac&&(msg=msg.replace(/Ctrl\+/g,"⌘+")),editor.notificationManager.open({text:msg,type:"error"})}},unlink:function(){if(selection.isCollapsed()){var elm=selection.getNode();return void("A"==elm.tagName&&editor.dom.remove(elm,!0))}formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(command){var align=command.substring(7);"full"==align&&(align="justify"),each("left,center,right,justify".split(","),function(name){align!=name&&formatter.remove("align"+name)}),"none"!=align&&toggleFormat("align"+align)},"InsertUnorderedList,InsertOrderedList":function(command){var listElm,listParent;execNativeCommand(command),listElm=dom.getParent(selection.getNode(),"ol,ul"),listElm&&(listParent=listElm.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)&&(storeSelection(),dom.split(listParent,listElm),restoreSelection()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){toggleFormat(command)},"ForeColor,HiliteColor,FontName":function(command,ui,value){toggleFormat(command,value)},FontSize:function(command,ui,value){var fontClasses,fontSizes;value>=1&&7>=value&&(fontSizes=explode(settings.font_size_style_values),fontClasses=explode(settings.font_size_classes),value=fontClasses?fontClasses[value-1]||value:fontSizes[value-1]||value),toggleFormat(command,value)},RemoveFormat:function(command){formatter.remove(command)},mceBlockQuote:function(){toggleFormat("blockquote")},FormatBlock:function(command,ui,value){return toggleFormat(value||"p")},mceCleanup:function(){var bookmark=selection.getBookmark();editor.setContent(editor.getContent({cleanup:TRUE}),{cleanup:TRUE}),selection.moveToBookmark(bookmark)},mceRemoveNode:function(command,ui,value){var node=value||selection.getNode();node!=editor.getBody()&&(storeSelection(),editor.dom.remove(node,TRUE),restoreSelection())},mceSelectNodeDepth:function(command,ui,value){var counter=0;dom.getParent(selection.getNode(),function(node){return 1==node.nodeType&&counter++==value?(selection.select(node),FALSE):void 0},editor.getBody())},mceSelectNode:function(command,ui,value){selection.select(value)},mceInsertContent:function(command,ui,value){function trimOrPaddLeftRight(html){function hasSiblingText(siblingName){return container[siblingName]&&3==container[siblingName].nodeType}var rng,container,offset;return rng=selection.getRng(!0),container=rng.startContainer,offset=rng.startOffset,3==container.nodeType&&(offset>0?html=html.replace(/^&nbsp;/," "):hasSiblingText("previousSibling")||(html=html.replace(/^ /,"&nbsp;")),offset<container.length?html=html.replace(/&nbsp;(<br>|)$/," "):hasSiblingText("nextSibling")||(html=html.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;"))),html}function trimNbspAfterDeleteAndPaddValue(){var rng,container,offset;rng=selection.getRng(!0),container=rng.startContainer,offset=rng.startOffset,3==container.nodeType&&rng.collapsed&&(" "===container.data[offset]?(container.deleteData(offset,1),/[\u00a0| ]$/.test(value)||(value+=" ")):" "===container.data[offset-1]&&(container.deleteData(offset-1,1),/[\u00a0| ]$/.test(value)||(value=" "+value)))}function markInlineFormatElements(fragment){if(merge)for(node=fragment.firstChild;node;node=node.walk(!0))textInlineElements[node.name]&&node.attr("data-mce-new","true")}function reduceInlineTextElements(){if(merge){var root=editor.getBody(),elementUtils=new ElementUtils(dom);each(dom.select("*[data-mce-new]"),function(node){node.removeAttribute("data-mce-new");for(var testNode=node.parentNode;testNode&&testNode!=root;testNode=testNode.parentNode)elementUtils.compare(testNode,node)&&dom.remove(node,!0)})}}function moveSelectionToMarker(marker){function getContentEditableFalseParent(node){for(var root=editor.getBody();node&&node!==root;node=node.parentNode)if("false"===editor.dom.getContentEditable(node))return node;return null}var parentEditableFalseElm;if(marker){if(selection.scrollIntoView(marker),parentEditableFalseElm=getContentEditableFalseParent(marker))return dom.remove(marker),void selection.select(parentEditableFalseElm);rng=dom.createRng(),node=marker.previousSibling,node&&3==node.nodeType?(rng.setStart(node,node.nodeValue.length),isIE||(node2=marker.nextSibling,node2&&3==node2.nodeType&&(node.appendData(node2.data),node2.parentNode.removeChild(node2)))):(rng.setStartBefore(marker),rng.setEndBefore(marker)),dom.remove(marker),selection.setRng(rng)}}var parser,serializer,parentNode,rootNode,fragment,args,marker,rng,node,node2,bookmarkHtml,merge,data,textInlineElements=editor.schema.getTextInlineElements();"string"!=typeof value&&(merge=value.merge,data=value.data,value=value.content),/^ | $/.test(value)&&(value=trimOrPaddLeftRight(value)),parser=editor.parser,serializer=new Serializer({validate:settings.validate},editor.schema),bookmarkHtml='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>',args={content:value,format:"html",selection:!0},editor.fire("BeforeSetContent",args),value=args.content,-1==value.indexOf("{$caret}")&&(value+="{$caret}"),value=value.replace(/\{\$caret\}/,bookmarkHtml),rng=selection.getRng();var caretElement=rng.startContainer||(rng.parentElement?rng.parentElement():null),body=editor.getBody();caretElement===body&&selection.isCollapsed()&&dom.isBlock(body.firstChild)&&dom.isEmpty(body.firstChild)&&(rng=dom.createRng(),rng.setStart(body.firstChild,0),rng.setEnd(body.firstChild,0),selection.setRng(rng)),selection.isCollapsed()||(editor.selection.setRng(editor.selection.getRng()),editor.getDoc().execCommand("Delete",!1,null),trimNbspAfterDeleteAndPaddValue()),parentNode=selection.getNode();var parserArgs={context:parentNode.nodeName.toLowerCase(),data:data};if(fragment=parser.parse(value,parserArgs),markInlineFormatElements(fragment),node=fragment.lastChild,"mce_marker"==node.attr("id"))for(marker=node,node=node.prev;node;node=node.walk(!0))if(3==node.type||!dom.isBlock(node.name)){editor.schema.isValidChild(node.parent.name,"span")&&node.parent.insert(marker,node,"br"===node.name);break}if(editor._selectionOverrides.showBlockCaretContainer(parentNode),parserArgs.invalid){for(selection.setContent(bookmarkHtml),parentNode=selection.getNode(),rootNode=editor.getBody(),9==parentNode.nodeType?parentNode=node=rootNode:node=parentNode;node!==rootNode;)parentNode=node,node=node.parentNode;value=parentNode==rootNode?rootNode.innerHTML:dom.getOuterHTML(parentNode),value=serializer.serialize(parser.parse(value.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return serializer.serialize(fragment)}))),parentNode==rootNode?dom.setHTML(rootNode,value):dom.setOuterHTML(parentNode,value)}else value=serializer.serialize(fragment),node=parentNode.firstChild,node2=parentNode.lastChild,!node||node===node2&&"BR"===node.nodeName?dom.setHTML(parentNode,value):selection.setContent(value);reduceInlineTextElements(),moveSelectionToMarker(dom.get("mce_marker")),editor.fire("SetContent",args),editor.addVisual()},mceInsertRawHTML:function(command,ui,value){selection.setContent("tiny_mce_marker"),editor.setContent(editor.getContent().replace(/tiny_mce_marker/g,function(){return value}))},mceToggleFormat:function(command,ui,value){toggleFormat(value)},mceSetContent:function(command,ui,value){editor.setContent(value)},"Indent,Outdent":function(command){var intentValue,indentUnit,value;intentValue=settings.indentation,indentUnit=/[a-z%]+$/i.exec(intentValue),intentValue=parseInt(intentValue,10),queryCommandState("InsertUnorderedList")||queryCommandState("InsertOrderedList")?execNativeCommand(command):(settings.forced_root_block||dom.getParent(selection.getNode(),dom.isBlock)||formatter.apply("div"),each(selection.getSelectedBlocks(),function(element){if("false"!==dom.getContentEditable(element)&&"LI"!=element.nodeName){var indentStyleName=editor.getParam("indent_use_margin",!1)?"margin":"padding";indentStyleName+="rtl"==dom.getStyle(element,"direction",!0)?"Right":"Left","outdent"==command?(value=Math.max(0,parseInt(element.style[indentStyleName]||0,10)-intentValue),dom.setStyle(element,indentStyleName,value?value+indentUnit:"")):(value=parseInt(element.style[indentStyleName]||0,10)+intentValue+indentUnit,dom.setStyle(element,indentStyleName,value))}}))},mceRepaint:function(){},InsertHorizontalRule:function(){editor.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){editor.hasVisual=!editor.hasVisual,editor.addVisual()},mceReplaceContent:function(command,ui,value){editor.execCommand("mceInsertContent",!1,value.replace(/\{\$selection\}/g,selection.getContent({format:"text"})))},mceInsertLink:function(command,ui,value){var anchor;"string"==typeof value&&(value={href:value}),anchor=dom.getParent(selection.getNode(),"a"),value.href=value.href.replace(" ","%20"),anchor&&value.href||formatter.remove("link"),value.href&&formatter.apply("link",value,anchor)},selectAll:function(){var rng,root=dom.getRoot();selection.getRng().setStart?(rng=dom.createRng(),rng.setStart(root,0),rng.setEnd(root,root.childNodes.length),selection.setRng(rng)):(rng=selection.getRng(),rng.item||(rng.moveToElementText(root),rng.select()))},"delete":function(){execNativeCommand("Delete");var body=editor.getBody();dom.isEmpty(body)&&(editor.setContent(""),body.firstChild&&dom.isBlock(body.firstChild)?editor.selection.setCursorLocation(body.firstChild,0):editor.selection.setCursorLocation(body,0))},mceNewDocument:function(){editor.setContent("")},InsertLineBreak:function(command,ui,value){function hasRightSideContent(){for(var node,walker=new TreeWalker(container,parentBlock),nonEmptyElementsMap=editor.schema.getNonEmptyElements();node=walker.next();)if(nonEmptyElementsMap[node.nodeName.toLowerCase()]||node.length>0)return!0}var brElm,extraBr,marker,evt=value,rng=selection.getRng(!0);new RangeUtils(dom).normalize(rng);var offset=rng.startOffset,container=rng.startContainer;if(1==container.nodeType&&container.hasChildNodes()){var isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container,offset=isAfterLastNodeInContainer&&3==container.nodeType?container.nodeValue.length:0}var parentBlock=dom.getParent(container,dom.isBlock),parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():"",containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null,containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"",isControlKey=evt&&evt.ctrlKey;"LI"!=containerBlockName||isControlKey||(parentBlock=containerBlock,parentBlockName=containerBlockName),container&&3==container.nodeType&&offset>=container.nodeValue.length&&(isOldIE||hasRightSideContent()||(brElm=dom.create("br"),rng.insertNode(brElm),rng.setStartAfter(brElm),rng.setEndAfter(brElm),extraBr=!0)),brElm=dom.create("br"),rng.insertNode(brElm);var documentMode=dom.doc.documentMode;return isOldIE&&"PRE"==parentBlockName&&(!documentMode||8>documentMode)&&brElm.parentNode.insertBefore(dom.doc.createTextNode("\r"),brElm),marker=dom.create("span",{},"&nbsp;"),brElm.parentNode.insertBefore(marker,brElm),selection.scrollIntoView(marker),dom.remove(marker),extraBr?(rng.setStartBefore(brElm),rng.setEndBefore(brElm)):(rng.setStartAfter(brElm),rng.setEndAfter(brElm)),selection.setRng(rng),editor.undoManager.add(),TRUE}}),addCommands({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(command){var name="align"+command.substring(7),nodes=selection.isCollapsed()?[dom.getParent(selection.getNode(),dom.isBlock)]:selection.getSelectedBlocks(),matches=map(nodes,function(node){return!!formatter.matchNode(node,name)});return-1!==inArray(matches,TRUE)},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){return isFormatMatch(command)},mceBlockQuote:function(){return isFormatMatch("blockquote")},Outdent:function(){var node;if(settings.inline_styles){if((node=dom.getParent(selection.getStart(),dom.isBlock))&&parseInt(node.style.paddingLeft,10)>0)return TRUE;if((node=dom.getParent(selection.getEnd(),dom.isBlock))&&parseInt(node.style.paddingLeft,10)>0)return TRUE}return queryCommandState("InsertUnorderedList")||queryCommandState("InsertOrderedList")||!settings.inline_styles&&!!dom.getParent(selection.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(command){var list=dom.getParent(selection.getNode(),"ul,ol");return list&&("insertunorderedlist"===command&&"UL"===list.tagName||"insertorderedlist"===command&&"OL"===list.tagName)}},"state"),addCommands({"FontSize,FontName":function(command){var parent,value=0;return(parent=dom.getParent(selection.getNode(),"span"))&&(value="fontsize"==command?parent.style.fontSize:parent.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase()),value}},"value"),addCommands({Undo:function(){editor.undoManager.undo()},Redo:function(){editor.undoManager.redo()}})}}),define("tinymce/util/URI",["tinymce/util/Tools"],function(Tools){function URI(url,settings){var baseUri,base_url,self=this;if(url=trim(url),settings=self.settings=settings||{},baseUri=settings.base_uri,/^([\w\-]+):([^\/]{2})/i.test(url)||/^\s*#/.test(url))return void(self.source=url);var isProtocolRelative=0===url.indexOf("//");0!==url.indexOf("/")||isProtocolRelative||(url=(baseUri?baseUri.protocol||"http":"http")+"://mce_host"+url),/^[\w\-]*:?\/\//.test(url)||(base_url=settings.base_uri?settings.base_uri.path:new URI(location.href).directory,""===settings.base_uri.protocol?url="//mce_host"+self.toAbsPath(base_url,url):(url=/([^#?]*)([#?]?.*)/.exec(url),url=(baseUri&&baseUri.protocol||"http")+"://mce_host"+self.toAbsPath(base_url,url[1])+url[2])),url=url.replace(/@@/g,"(mce_at)"),url=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(url),each(queryParts,function(v,i){var part=url[i];part&&(part=part.replace(/\(mce_at\)/g,"@@")),self[v]=part}),baseUri&&(self.protocol||(self.protocol=baseUri.protocol),self.userInfo||(self.userInfo=baseUri.userInfo),self.port||"mce_host"!==self.host||(self.port=baseUri.port),self.host&&"mce_host"!==self.host||(self.host=baseUri.host),self.source=""),isProtocolRelative&&(self.protocol="")}var each=Tools.each,trim=Tools.trim,queryParts="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),DEFAULT_PORTS={ftp:21,http:80,https:443,mailto:25};return URI.prototype={setPath:function(path){var self=this;path=/^(.*?)\/?(\w+)?$/.exec(path),self.path=path[0],self.directory=path[1],self.file=path[2],self.source="",self.getURI()},toRelative:function(uri){var output,self=this;if("./"===uri)return uri;if(uri=new URI(uri,{base_uri:self}),"mce_host"!=uri.host&&self.host!=uri.host&&uri.host||self.port!=uri.port||self.protocol!=uri.protocol&&""!==uri.protocol)return uri.getURI();var tu=self.getURI(),uu=uri.getURI();return tu==uu||"/"==tu.charAt(tu.length-1)&&tu.substr(0,tu.length-1)==uu?tu:(output=self.toRelPath(self.path,uri.path),uri.query&&(output+="?"+uri.query),uri.anchor&&(output+="#"+uri.anchor),output)},toAbsolute:function(uri,noHost){return uri=new URI(uri,{base_uri:this}),uri.getURI(noHost&&this.isSameOrigin(uri))},isSameOrigin:function(uri){if(this.host==uri.host&&this.protocol==uri.protocol){if(this.port==uri.port)return!0;var defaultPort=DEFAULT_PORTS[this.protocol];if(defaultPort&&(this.port||defaultPort)==(uri.port||defaultPort))return!0}return!1},toRelPath:function(base,path){var items,i,l,breakPoint=0,out="";if(base=base.substring(0,base.lastIndexOf("/")),base=base.split("/"),items=path.split("/"),base.length>=items.length)for(i=0,l=base.length;l>i;i++)if(i>=items.length||base[i]!=items[i]){breakPoint=i+1;break}if(base.length<items.length)for(i=0,l=items.length;l>i;i++)if(i>=base.length||base[i]!=items[i]){breakPoint=i+1;break}if(1===breakPoint)return path;for(i=0,l=base.length-(breakPoint-1);l>i;i++)out+="../";for(i=breakPoint-1,l=items.length;l>i;i++)out+=i!=breakPoint-1?"/"+items[i]:items[i];return out},toAbsPath:function(base,path){var i,tr,outPath,nb=0,o=[];for(tr=/\/$/.test(path)?"/":"",base=base.split("/"),path=path.split("/"),each(base,function(k){k&&o.push(k)}),base=o,i=path.length-1,o=[];i>=0;i--)0!==path[i].length&&"."!==path[i]&&(".."!==path[i]?nb>0?nb--:o.push(path[i]):nb++);return i=base.length-nb,outPath=0>=i?o.reverse().join("/"):base.slice(0,i).join("/")+"/"+o.reverse().join("/"),0!==outPath.indexOf("/")&&(outPath="/"+outPath),tr&&outPath.lastIndexOf("/")!==outPath.length-1&&(outPath+=tr),outPath},getURI:function(noProtoHost){var s,self=this;return self.source&&!noProtoHost||(s="",noProtoHost||(s+=self.protocol?self.protocol+"://":"//",self.userInfo&&(s+=self.userInfo+"@"),self.host&&(s+=self.host),self.port&&(s+=":"+self.port)),self.path&&(s+=self.path),self.query&&(s+="?"+self.query),self.anchor&&(s+="#"+self.anchor),self.source=s),self.source}},URI.parseDataUri=function(uri){var type,matches;return uri=decodeURIComponent(uri).split(","),matches=/data:([^;]+)/.exec(uri[0]),matches&&(type=matches[1]),{type:type,data:uri[1]}},URI}),define("tinymce/util/Class",["tinymce/util/Tools"],function(Tools){function Class(){}var extendClass,initializing,each=Tools.each,extend=Tools.extend;return Class.extend=extendClass=function(prop){function Class(){var i,mixins,mixin,self=this;if(!initializing&&(self.init&&self.init.apply(self,arguments),mixins=self.Mixins))for(i=mixins.length;i--;)mixin=mixins[i],mixin.init&&mixin.init.apply(self,arguments)}function dummy(){return this}function createMethod(name,fn){return function(){var ret,self=this,tmp=self._super;return self._super=_super[name],ret=fn.apply(self,arguments),self._super=tmp,ret}}var prototype,name,member,self=this,_super=self.prototype;initializing=!0,prototype=new self,initializing=!1,prop.Mixins&&(each(prop.Mixins,function(mixin){mixin=mixin;for(var name in mixin)"init"!==name&&(prop[name]=mixin[name])}),_super.Mixins&&(prop.Mixins=_super.Mixins.concat(prop.Mixins))),prop.Methods&&each(prop.Methods.split(","),function(name){prop[name]=dummy}),prop.Properties&&each(prop.Properties.split(","),function(name){var fieldName="_"+name;prop[name]=function(value){var undef,self=this;return value!==undef?(self[fieldName]=value,self):self[fieldName]}}),prop.Statics&&each(prop.Statics,function(func,name){Class[name]=func}),prop.Defaults&&_super.Defaults&&(prop.Defaults=extend({},_super.Defaults,prop.Defaults));for(name in prop)member=prop[name],"function"==typeof member&&_super[name]?prototype[name]=createMethod(name,member):prototype[name]=member;return Class.prototype=prototype,Class.constructor=Class,Class.extend=extendClass,Class},Class}),define("tinymce/util/EventDispatcher",["tinymce/util/Tools"],function(Tools){function Dispatcher(settings){function returnFalse(){return!1}function returnTrue(){return!0}function fire(name,args){var handlers,i,l,callback;if(name=name.toLowerCase(),args=args||{},args.type=name,args.target||(args.target=scope),args.preventDefault||(args.preventDefault=function(){args.isDefaultPrevented=returnTrue},args.stopPropagation=function(){args.isPropagationStopped=returnTrue},args.stopImmediatePropagation=function(){args.isImmediatePropagationStopped=returnTrue},args.isDefaultPrevented=returnFalse,args.isPropagationStopped=returnFalse,args.isImmediatePropagationStopped=returnFalse),settings.beforeFire&&settings.beforeFire(args),handlers=bindings[name])for(i=0,l=handlers.length;l>i;i++){if(callback=handlers[i],callback.once&&off(name,callback.func),args.isImmediatePropagationStopped())return args.stopPropagation(),args;if(callback.func.call(scope,args)===!1)return args.preventDefault(),args}return args}function on(name,callback,prepend,extra){var handlers,names,i;if(callback===!1&&(callback=returnFalse),callback)for(callback={func:callback},extra&&Tools.extend(callback,extra),names=name.toLowerCase().split(" "),i=names.length;i--;)name=names[i],handlers=bindings[name],handlers||(handlers=bindings[name]=[],toggleEvent(name,!0)),prepend?handlers.unshift(callback):handlers.push(callback);return self}function off(name,callback){var i,handlers,bindingName,names,hi;if(name)for(names=name.toLowerCase().split(" "),i=names.length;i--;){if(name=names[i],handlers=bindings[name],!name){for(bindingName in bindings)toggleEvent(bindingName,!1),delete bindings[bindingName];return self}if(handlers){if(callback)for(hi=handlers.length;hi--;)handlers[hi].func===callback&&(handlers=handlers.slice(0,hi).concat(handlers.slice(hi+1)),bindings[name]=handlers);else handlers.length=0;handlers.length||(toggleEvent(name,!1),delete bindings[name])}}else{for(name in bindings)toggleEvent(name,!1);bindings={}}return self}function once(name,callback,prepend){return on(name,callback,prepend,{once:!0})}function has(name){return name=name.toLowerCase(),!(!bindings[name]||0===bindings[name].length)}var scope,toggleEvent,self=this,bindings={};settings=settings||{},scope=settings.scope||self,toggleEvent=settings.toggleEvent||returnFalse,self.fire=fire,self.on=on,self.off=off,self.once=once,self.has=has}var nativeEvents=Tools.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchend"," ");return Dispatcher.isNative=function(name){return!!nativeEvents[name.toLowerCase()]},Dispatcher}),define("tinymce/data/Binding",[],function(){function Binding(settings){this.create=settings.create}return Binding.create=function(model,name){return new Binding({create:function(otherModel,otherName){function fromSelfToOther(e){otherModel.set(otherName,e.value)}function fromOtherToSelf(e){model.set(name,e.value)}var bindings;return otherModel.on("change:"+otherName,fromOtherToSelf),model.on("change:"+name,fromSelfToOther),bindings=otherModel._bindings,bindings||(bindings=otherModel._bindings=[],otherModel.on("destroy",function(){for(var i=bindings.length;i--;)bindings[i]()})),bindings.push(function(){model.off("change:"+name,fromSelfToOther)}),model.get(name)}})},Binding}),define("tinymce/util/Observable",["tinymce/util/EventDispatcher"],function(EventDispatcher){function getEventDispatcher(obj){return obj._eventDispatcher||(obj._eventDispatcher=new EventDispatcher({scope:obj,toggleEvent:function(name,state){EventDispatcher.isNative(name)&&obj.toggleNativeEvent&&obj.toggleNativeEvent(name,state)}})),obj._eventDispatcher}return{fire:function(name,args,bubble){var self=this;if(self.removed&&"remove"!==name)return args;if(args=getEventDispatcher(self).fire(name,args,bubble),bubble!==!1&&self.parent)for(var parent=self.parent();parent&&!args.isPropagationStopped();)parent.fire(name,args,!1),parent=parent.parent();return args},on:function(name,callback,prepend){return getEventDispatcher(this).on(name,callback,prepend)},off:function(name,callback){return getEventDispatcher(this).off(name,callback)},once:function(name,callback){return getEventDispatcher(this).once(name,callback)},hasEventListeners:function(name){return getEventDispatcher(this).has(name)}}}),define("tinymce/data/ObservableObject",["tinymce/data/Binding","tinymce/util/Observable","tinymce/util/Class","tinymce/util/Tools"],function(Binding,Observable,Class,Tools){function isNode(node){return node.nodeType>0}function isEqual(a,b){var k,checked;if(a===b)return!0;if(null===a||null===b)return a===b;if("object"!=typeof a||"object"!=typeof b)return a===b;if(Tools.isArray(b)){if(a.length!==b.length)return!1;for(k=a.length;k--;)if(!isEqual(a[k],b[k]))return!1}if(isNode(a)||isNode(b))return a===b;checked={};for(k in b){if(!isEqual(a[k],b[k]))return!1;checked[k]=!0}for(k in a)if(!checked[k]&&!isEqual(a[k],b[k]))return!1;return!0}return Class.extend({Mixins:[Observable],init:function(data){var name,value;data=data||{};for(name in data)value=data[name],value instanceof Binding&&(data[name]=value.create(this,name));this.data=data},set:function(name,value){var key,args,oldValue=this.data[name];if(value instanceof Binding&&(value=value.create(this,name)),"object"==typeof name){for(key in name)this.set(key,name[key]);return this}return isEqual(oldValue,value)||(this.data[name]=value,args={target:this,name:name,value:value,oldValue:oldValue},this.fire("change:"+name,args),this.fire("change",args)),this},get:function(name){return this.data[name]},has:function(name){return name in this.data},bind:function(name){return Binding.create(this,name)},destroy:function(){this.fire("destroy")}})}),define("tinymce/ui/Selector",["tinymce/util/Class"],function(Class){function unique(array){for(var item,uniqueItems=[],i=array.length;i--;)item=array[i],item.__checked||(uniqueItems.push(item),item.__checked=1);for(i=uniqueItems.length;i--;)delete uniqueItems[i].__checked;return uniqueItems}var Collection,expression=/^([\w\\*]+)?(?:#([\w\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i,chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,whiteSpace=/^\s*|\s*$/g,Selector=Class.extend({init:function(selector){function compileNameFilter(name){return name?(name=name.toLowerCase(),function(item){return"*"===name||item.type===name}):void 0}function compileIdFilter(id){return id?function(item){return item._name===id}:void 0}function compileClassesFilter(classes){return classes?(classes=classes.split("."),function(item){for(var i=classes.length;i--;)if(!item.classes.contains(classes[i]))return!1;return!0}):void 0}function compileAttrFilter(name,cmp,check){return name?function(item){var value=item[name]?item[name]():"";return cmp?"="===cmp?value===check:"*="===cmp?value.indexOf(check)>=0:"~="===cmp?(" "+value+" ").indexOf(" "+check+" ")>=0:"!="===cmp?value!=check:"^="===cmp?0===value.indexOf(check):"$="===cmp?value.substr(value.length-check.length)===check:!1:!!check}:void 0}function compilePsuedoFilter(name){var notSelectors;return name?(name=/(?:not\((.+)\))|(.+)/i.exec(name),name[1]?(notSelectors=parseChunks(name[1],[]),function(item){return!match(item,notSelectors)}):(name=name[2],function(item,index,length){return"first"===name?0===index:"last"===name?index===length-1:"even"===name?index%2===0:"odd"===name?index%2===1:item[name]?item[name]():!1})):void 0}function compile(selector,filters,direct){function add(filter){filter&&filters.push(filter)}var parts;return parts=expression.exec(selector.replace(whiteSpace,"")),add(compileNameFilter(parts[1])),add(compileIdFilter(parts[2])),add(compileClassesFilter(parts[3])),add(compileAttrFilter(parts[4],parts[5],parts[6])),add(compilePsuedoFilter(parts[7])),filters.pseudo=!!parts[7],filters.direct=direct,filters}function parseChunks(selector,selectors){var extra,matches,i,parts=[];do if(chunker.exec(""),matches=chunker.exec(selector),matches&&(selector=matches[3],parts.push(matches[1]),matches[2])){extra=matches[3];break}while(matches);for(extra&&parseChunks(extra,selectors),selector=[],i=0;i<parts.length;i++)">"!=parts[i]&&selector.push(compile(parts[i],[],">"===parts[i-1]));return selectors.push(selector),selectors}var match=this.match;this._selectors=parseChunks(selector,[])},match:function(control,selectors){var i,l,si,sl,selector,fi,fl,filters,index,length,siblings,count,item;for(selectors=selectors||this._selectors,i=0,l=selectors.length;l>i;i++){for(selector=selectors[i],sl=selector.length,item=control,count=0,si=sl-1;si>=0;si--)for(filters=selector[si];item;){if(filters.pseudo)for(siblings=item.parent().items(),index=length=siblings.length;index--&&siblings[index]!==item;);for(fi=0,fl=filters.length;fl>fi;fi++)if(!filters[fi](item,index,length)){fi=fl+1;break}if(fi===fl){count++;break}if(si===sl-1)break;item=item.parent()}if(count===sl)return!0}return!1},find:function(container){function collect(items,selector,index){var i,l,fi,fl,item,filters=selector[index];for(i=0,l=items.length;l>i;i++){for(item=items[i],fi=0,fl=filters.length;fl>fi;fi++)if(!filters[fi](item,i,l)){fi=fl+1;break}if(fi===fl)index==selector.length-1?matches.push(item):item.items&&collect(item.items(),selector,index+1);else if(filters.direct)return;item.items&&collect(item.items(),selector,index)}}var i,l,matches=[],selectors=this._selectors;if(container.items){for(i=0,l=selectors.length;l>i;i++)collect(container.items(),selectors[i],0);l>1&&(matches=unique(matches))}return Collection||(Collection=Selector.Collection),new Collection(matches)}});return Selector}),define("tinymce/ui/Collection",["tinymce/util/Tools","tinymce/ui/Selector","tinymce/util/Class"],function(Tools,Selector,Class){var Collection,proto,push=Array.prototype.push,slice=Array.prototype.slice;return proto={length:0,init:function(items){items&&this.add(items)},add:function(items){var self=this;return Tools.isArray(items)?push.apply(self,items):items instanceof Collection?self.add(items.toArray()):push.call(self,items),self},set:function(items){var i,self=this,len=self.length;for(self.length=0,self.add(items),i=self.length;len>i;i++)delete self[i];return self},filter:function(selector){var i,l,item,match,self=this,matches=[];for("string"==typeof selector?(selector=new Selector(selector),match=function(item){return selector.match(item)}):match=selector,i=0,l=self.length;l>i;i++)item=self[i],match(item)&&matches.push(item);return new Collection(matches)},slice:function(){return new Collection(slice.apply(this,arguments))},eq:function(index){return-1===index?this.slice(index):this.slice(index,+index+1)},each:function(callback){return Tools.each(this,callback),this},toArray:function(){return Tools.toArray(this)},indexOf:function(ctrl){for(var self=this,i=self.length;i--&&self[i]!==ctrl;);return i},reverse:function(){return new Collection(Tools.toArray(this).reverse())},hasClass:function(cls){return this[0]?this[0].classes.contains(cls):!1},prop:function(name,value){var undef,item,self=this;return value!==undef?(self.each(function(item){item[name]&&item[name](value)}),self):(item=self[0],item&&item[name]?item[name]():void 0)},exec:function(name){var self=this,args=Tools.toArray(arguments).slice(1);return self.each(function(item){item[name]&&item[name].apply(item,args)}),self},remove:function(){for(var i=this.length;i--;)this[i].remove();return this},addClass:function(cls){return this.each(function(item){item.classes.add(cls)})},removeClass:function(cls){return this.each(function(item){item.classes.remove(cls)})}},Tools.each("fire on off show hide append prepend before after reflow".split(" "),function(name){proto[name]=function(){var args=Tools.toArray(arguments);return this.each(function(ctrl){name in ctrl&&ctrl[name].apply(ctrl,args)}),this}}),Tools.each("text name disabled active selected checked visible parent value data".split(" "),function(name){
proto[name]=function(value){return this.prop(name,value)}}),Collection=Class.extend(proto),Selector.Collection=Collection,Collection}),define("tinymce/ui/DomUtils",["tinymce/util/Tools","tinymce/dom/DOMUtils"],function(Tools,DOMUtils){var count=0;return{id:function(){return"mceu_"+count++},createFragment:function(html){return DOMUtils.DOM.createFragment(html)},getWindowSize:function(){return DOMUtils.DOM.getViewPort()},getSize:function(elm){var width,height;if(elm.getBoundingClientRect){var rect=elm.getBoundingClientRect();width=Math.max(rect.width||rect.right-rect.left,elm.offsetWidth),height=Math.max(rect.height||rect.bottom-rect.bottom,elm.offsetHeight)}else width=elm.offsetWidth,height=elm.offsetHeight;return{width:width,height:height}},getPos:function(elm,root){return DOMUtils.DOM.getPos(elm,root)},getViewPort:function(win){return DOMUtils.DOM.getViewPort(win)},get:function(id){return document.getElementById(id)},addClass:function(elm,cls){return DOMUtils.DOM.addClass(elm,cls)},removeClass:function(elm,cls){return DOMUtils.DOM.removeClass(elm,cls)},hasClass:function(elm,cls){return DOMUtils.DOM.hasClass(elm,cls)},toggleClass:function(elm,cls,state){return DOMUtils.DOM.toggleClass(elm,cls,state)},css:function(elm,name,value){return DOMUtils.DOM.setStyle(elm,name,value)},getRuntimeStyle:function(elm,name){return DOMUtils.DOM.getStyle(elm,name,!0)},on:function(target,name,callback,scope){return DOMUtils.DOM.bind(target,name,callback,scope)},off:function(target,name,callback){return DOMUtils.DOM.unbind(target,name,callback)},fire:function(target,name,args){return DOMUtils.DOM.fire(target,name,args)},innerHtml:function(elm,html){DOMUtils.DOM.setHTML(elm,html)}}}),define("tinymce/ui/BoxUtils",[],function(){return{parseBox:function(value){var len,radix=10;return value?"number"==typeof value?(value=value||0,{top:value,left:value,bottom:value,right:value}):(value=value.split(" "),len=value.length,1===len?value[1]=value[2]=value[3]=value[0]:2===len?(value[2]=value[0],value[3]=value[1]):3===len&&(value[3]=value[1]),{top:parseInt(value[0],radix)||0,right:parseInt(value[1],radix)||0,bottom:parseInt(value[2],radix)||0,left:parseInt(value[3],radix)||0}):void 0},measureBox:function(elm,prefix){function getStyle(name){var defaultView=document.defaultView;return defaultView?(name=name.replace(/[A-Z]/g,function(a){return"-"+a}),defaultView.getComputedStyle(elm,null).getPropertyValue(name)):elm.currentStyle[name]}function getSide(name){var val=parseFloat(getStyle(name),10);return isNaN(val)?0:val}return{top:getSide(prefix+"TopWidth"),right:getSide(prefix+"RightWidth"),bottom:getSide(prefix+"BottomWidth"),left:getSide(prefix+"LeftWidth")}}}}),define("tinymce/ui/ClassList",["tinymce/util/Tools"],function(Tools){function noop(){}function ClassList(onchange){this.cls=[],this.cls._map={},this.onchange=onchange||noop,this.prefix=""}return Tools.extend(ClassList.prototype,{add:function(cls){return cls&&!this.contains(cls)&&(this.cls._map[cls]=!0,this.cls.push(cls),this._change()),this},remove:function(cls){if(this.contains(cls)){for(var i=0;i<this.cls.length&&this.cls[i]!==cls;i++);this.cls.splice(i,1),delete this.cls._map[cls],this._change()}return this},toggle:function(cls,state){var curState=this.contains(cls);return curState!==state&&(curState?this.remove(cls):this.add(cls),this._change()),this},contains:function(cls){return!!this.cls._map[cls]},_change:function(){delete this.clsValue,this.onchange.call(this)}}),ClassList.prototype.toString=function(){var value;if(this.clsValue)return this.clsValue;value="";for(var i=0;i<this.cls.length;i++)i>0&&(value+=" "),value+=this.prefix+this.cls[i];return value},ClassList}),define("tinymce/ui/ReflowQueue",["tinymce/util/Delay"],function(Delay){var animationFrameRequested,dirtyCtrls={};return{add:function(ctrl){var parent=ctrl.parent();if(parent){if(!parent._layout||parent._layout.isNative())return;dirtyCtrls[parent._id]||(dirtyCtrls[parent._id]=parent),animationFrameRequested||(animationFrameRequested=!0,Delay.requestAnimationFrame(function(){var id,ctrl;animationFrameRequested=!1;for(id in dirtyCtrls)ctrl=dirtyCtrls[id],ctrl.state.get("rendered")&&ctrl.reflow();dirtyCtrls={}},document.body))}},remove:function(ctrl){dirtyCtrls[ctrl._id]&&delete dirtyCtrls[ctrl._id]}}}),define("tinymce/ui/Control",["tinymce/util/Class","tinymce/util/Tools","tinymce/util/EventDispatcher","tinymce/data/ObservableObject","tinymce/ui/Collection","tinymce/ui/DomUtils","tinymce/dom/DomQuery","tinymce/ui/BoxUtils","tinymce/ui/ClassList","tinymce/ui/ReflowQueue"],function(Class,Tools,EventDispatcher,ObservableObject,Collection,DomUtils,$,BoxUtils,ClassList,ReflowQueue){function getEventDispatcher(obj){return obj._eventDispatcher||(obj._eventDispatcher=new EventDispatcher({scope:obj,toggleEvent:function(name,state){state&&EventDispatcher.isNative(name)&&(obj._nativeEvents||(obj._nativeEvents={}),obj._nativeEvents[name]=!0,obj.state.get("rendered")&&bindPendingEvents(obj))}})),obj._eventDispatcher}function bindPendingEvents(eventCtrl){function delegate(e){var control=eventCtrl.getParentCtrl(e.target);control&&control.fire(e.type,e)}function mouseLeaveHandler(){var ctrl=eventRootCtrl._lastHoverCtrl;ctrl&&(ctrl.fire("mouseleave",{target:ctrl.getEl()}),ctrl.parents().each(function(ctrl){ctrl.fire("mouseleave",{target:ctrl.getEl()})}),eventRootCtrl._lastHoverCtrl=null)}function mouseEnterHandler(e){var i,parents,lastParents,ctrl=eventCtrl.getParentCtrl(e.target),lastCtrl=eventRootCtrl._lastHoverCtrl,idx=0;if(ctrl!==lastCtrl){if(eventRootCtrl._lastHoverCtrl=ctrl,parents=ctrl.parents().toArray().reverse(),parents.push(ctrl),lastCtrl){for(lastParents=lastCtrl.parents().toArray().reverse(),lastParents.push(lastCtrl),idx=0;idx<lastParents.length&&parents[idx]===lastParents[idx];idx++);for(i=lastParents.length-1;i>=idx;i--)lastCtrl=lastParents[i],lastCtrl.fire("mouseleave",{target:lastCtrl.getEl()})}for(i=idx;i<parents.length;i++)ctrl=parents[i],ctrl.fire("mouseenter",{target:ctrl.getEl()})}}function fixWheelEvent(e){e.preventDefault(),"mousewheel"==e.type?(e.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(e.deltaX=-1/40*e.wheelDeltaX)):(e.deltaX=0,e.deltaY=e.detail),e=eventCtrl.fire("wheel",e)}var i,l,parents,eventRootCtrl,nativeEvents,name;if(nativeEvents=eventCtrl._nativeEvents){for(parents=eventCtrl.parents().toArray(),parents.unshift(eventCtrl),i=0,l=parents.length;!eventRootCtrl&&l>i;i++)eventRootCtrl=parents[i]._eventsRoot;for(eventRootCtrl||(eventRootCtrl=parents[parents.length-1]||eventCtrl),eventCtrl._eventsRoot=eventRootCtrl,l=i,i=0;l>i;i++)parents[i]._eventsRoot=eventRootCtrl;var eventRootDelegates=eventRootCtrl._delegates;eventRootDelegates||(eventRootDelegates=eventRootCtrl._delegates={});for(name in nativeEvents){if(!nativeEvents)return!1;"wheel"!==name||hasWheelEventSupport?("mouseenter"===name||"mouseleave"===name?eventRootCtrl._hasMouseEnter||($(eventRootCtrl.getEl()).on("mouseleave",mouseLeaveHandler).on("mouseover",mouseEnterHandler),eventRootCtrl._hasMouseEnter=1):eventRootDelegates[name]||($(eventRootCtrl.getEl()).on(name,delegate),eventRootDelegates[name]=!0),nativeEvents[name]=!1):hasMouseWheelEventSupport?$(eventCtrl.getEl()).on("mousewheel",fixWheelEvent):$(eventCtrl.getEl()).on("DOMMouseScroll",fixWheelEvent)}}}var Control,hasMouseWheelEventSupport="onmousewheel"in document,hasWheelEventSupport=!1,classPrefix="mce-",idCounter=0,proto={Statics:{classPrefix:classPrefix},isRtl:function(){return Control.rtl},classPrefix:classPrefix,init:function(settings){function applyClasses(classes){var i;for(classes=classes.split(" "),i=0;i<classes.length;i++)self.classes.add(classes[i])}var classes,defaultClasses,self=this;self.settings=settings=Tools.extend({},self.Defaults,settings),self._id=settings.id||"mceu_"+idCounter++,self._aria={role:settings.role},self._elmCache={},self.$=$,self.state=new ObservableObject({visible:!0,active:!1,disabled:!1,value:""}),self.data=new ObservableObject(settings.data),self.classes=new ClassList(function(){self.state.get("rendered")&&(self.getEl().className=this.toString())}),self.classes.prefix=self.classPrefix,classes=settings.classes,classes&&(self.Defaults&&(defaultClasses=self.Defaults.classes,defaultClasses&&classes!=defaultClasses&&applyClasses(defaultClasses)),applyClasses(classes)),Tools.each("title text name visible disabled active value".split(" "),function(name){name in settings&&self[name](settings[name])}),self.on("click",function(){return self.disabled()?!1:void 0}),self.settings=settings,self.borderBox=BoxUtils.parseBox(settings.border),self.paddingBox=BoxUtils.parseBox(settings.padding),self.marginBox=BoxUtils.parseBox(settings.margin),settings.hidden&&self.hide()},Properties:"parent,name",getContainerElm:function(){return document.body},getParentCtrl:function(elm){for(var ctrl,lookup=this.getRoot().controlIdLookup;elm&&lookup&&!(ctrl=lookup[elm.id]);)elm=elm.parentNode;return ctrl},initLayoutRect:function(){var borderBox,layoutRect,width,height,minWidth,minHeight,autoResize,startMinWidth,startMinHeight,initialSize,self=this,settings=self.settings,elm=self.getEl();borderBox=self.borderBox=self.borderBox||BoxUtils.measureBox(elm,"border"),self.paddingBox=self.paddingBox||BoxUtils.measureBox(elm,"padding"),self.marginBox=self.marginBox||BoxUtils.measureBox(elm,"margin"),initialSize=DomUtils.getSize(elm),startMinWidth=settings.minWidth,startMinHeight=settings.minHeight,minWidth=startMinWidth||initialSize.width,minHeight=startMinHeight||initialSize.height,width=settings.width,height=settings.height,autoResize=settings.autoResize,autoResize="undefined"!=typeof autoResize?autoResize:!width&&!height,width=width||minWidth,height=height||minHeight;var deltaW=borderBox.left+borderBox.right,deltaH=borderBox.top+borderBox.bottom,maxW=settings.maxWidth||65535,maxH=settings.maxHeight||65535;return self._layoutRect=layoutRect={x:settings.x||0,y:settings.y||0,w:width,h:height,deltaW:deltaW,deltaH:deltaH,contentW:width-deltaW,contentH:height-deltaH,innerW:width-deltaW,innerH:height-deltaH,startMinWidth:startMinWidth||0,startMinHeight:startMinHeight||0,minW:Math.min(minWidth,maxW),minH:Math.min(minHeight,maxH),maxW:maxW,maxH:maxH,autoResize:autoResize,scrollW:0},self._lastLayoutRect={},layoutRect},layoutRect:function(newRect){var lastLayoutRect,size,deltaWidth,deltaHeight,undef,repaintControls,self=this,curRect=self._layoutRect;return curRect||(curRect=self.initLayoutRect()),newRect?(deltaWidth=curRect.deltaW,deltaHeight=curRect.deltaH,newRect.x!==undef&&(curRect.x=newRect.x),newRect.y!==undef&&(curRect.y=newRect.y),newRect.minW!==undef&&(curRect.minW=newRect.minW),newRect.minH!==undef&&(curRect.minH=newRect.minH),size=newRect.w,size!==undef&&(size=size<curRect.minW?curRect.minW:size,size=size>curRect.maxW?curRect.maxW:size,curRect.w=size,curRect.innerW=size-deltaWidth),size=newRect.h,size!==undef&&(size=size<curRect.minH?curRect.minH:size,size=size>curRect.maxH?curRect.maxH:size,curRect.h=size,curRect.innerH=size-deltaHeight),size=newRect.innerW,size!==undef&&(size=size<curRect.minW-deltaWidth?curRect.minW-deltaWidth:size,size=size>curRect.maxW-deltaWidth?curRect.maxW-deltaWidth:size,curRect.innerW=size,curRect.w=size+deltaWidth),size=newRect.innerH,size!==undef&&(size=size<curRect.minH-deltaHeight?curRect.minH-deltaHeight:size,size=size>curRect.maxH-deltaHeight?curRect.maxH-deltaHeight:size,curRect.innerH=size,curRect.h=size+deltaHeight),newRect.contentW!==undef&&(curRect.contentW=newRect.contentW),newRect.contentH!==undef&&(curRect.contentH=newRect.contentH),lastLayoutRect=self._lastLayoutRect,lastLayoutRect.x===curRect.x&&lastLayoutRect.y===curRect.y&&lastLayoutRect.w===curRect.w&&lastLayoutRect.h===curRect.h||(repaintControls=Control.repaintControls,repaintControls&&repaintControls.map&&!repaintControls.map[self._id]&&(repaintControls.push(self),repaintControls.map[self._id]=!0),lastLayoutRect.x=curRect.x,lastLayoutRect.y=curRect.y,lastLayoutRect.w=curRect.w,lastLayoutRect.h=curRect.h),self):curRect},repaint:function(){var style,bodyStyle,bodyElm,rect,borderBox,borderW,borderH,lastRepaintRect,round,value,self=this;round=document.createRange?function(value){return value}:Math.round,style=self.getEl().style,rect=self._layoutRect,lastRepaintRect=self._lastRepaintRect||{},borderBox=self.borderBox,borderW=borderBox.left+borderBox.right,borderH=borderBox.top+borderBox.bottom,rect.x!==lastRepaintRect.x&&(style.left=round(rect.x)+"px",lastRepaintRect.x=rect.x),rect.y!==lastRepaintRect.y&&(style.top=round(rect.y)+"px",lastRepaintRect.y=rect.y),rect.w!==lastRepaintRect.w&&(value=round(rect.w-borderW),style.width=(value>=0?value:0)+"px",lastRepaintRect.w=rect.w),rect.h!==lastRepaintRect.h&&(value=round(rect.h-borderH),style.height=(value>=0?value:0)+"px",lastRepaintRect.h=rect.h),self._hasBody&&rect.innerW!==lastRepaintRect.innerW&&(value=round(rect.innerW),bodyElm=self.getEl("body"),bodyElm&&(bodyStyle=bodyElm.style,bodyStyle.width=(value>=0?value:0)+"px"),lastRepaintRect.innerW=rect.innerW),self._hasBody&&rect.innerH!==lastRepaintRect.innerH&&(value=round(rect.innerH),bodyElm=bodyElm||self.getEl("body"),bodyElm&&(bodyStyle=bodyStyle||bodyElm.style,bodyStyle.height=(value>=0?value:0)+"px"),lastRepaintRect.innerH=rect.innerH),self._lastRepaintRect=lastRepaintRect,self.fire("repaint",{},!1)},on:function(name,callback){function resolveCallbackName(name){var callback,scope;return"string"!=typeof name?name:function(e){return callback||self.parentsAndSelf().each(function(ctrl){var callbacks=ctrl.settings.callbacks;return callbacks&&(callback=callbacks[name])?(scope=ctrl,!1):void 0}),callback?callback.call(scope,e):(e.action=name,void this.fire("execute",e))}}var self=this;return getEventDispatcher(self).on(name,resolveCallbackName(callback)),self},off:function(name,callback){return getEventDispatcher(this).off(name,callback),this},fire:function(name,args,bubble){var self=this;if(args=args||{},args.control||(args.control=self),args=getEventDispatcher(self).fire(name,args),bubble!==!1&&self.parent)for(var parent=self.parent();parent&&!args.isPropagationStopped();)parent.fire(name,args,!1),parent=parent.parent();return args},hasEventListeners:function(name){return getEventDispatcher(this).has(name)},parents:function(selector){var ctrl,self=this,parents=new Collection;for(ctrl=self.parent();ctrl;ctrl=ctrl.parent())parents.add(ctrl);return selector&&(parents=parents.filter(selector)),parents},parentsAndSelf:function(selector){return new Collection(this).add(this.parents(selector))},next:function(){var parentControls=this.parent().items();return parentControls[parentControls.indexOf(this)+1]},prev:function(){var parentControls=this.parent().items();return parentControls[parentControls.indexOf(this)-1]},innerHtml:function(html){return this.$el.html(html),this},getEl:function(suffix){var id=suffix?this._id+"-"+suffix:this._id;return this._elmCache[id]||(this._elmCache[id]=$("#"+id)[0]),this._elmCache[id]},show:function(){return this.visible(!0)},hide:function(){return this.visible(!1)},focus:function(){try{this.getEl().focus()}catch(ex){}return this},blur:function(){return this.getEl().blur(),this},aria:function(name,value){var self=this,elm=self.getEl(self.ariaTarget);return"undefined"==typeof value?self._aria[name]:(self._aria[name]=value,self.state.get("rendered")&&elm.setAttribute("role"==name?name:"aria-"+name,value),self)},encode:function(text,translate){return translate!==!1&&(text=this.translate(text)),(text||"").replace(/[&<>"]/g,function(match){return"&#"+match.charCodeAt(0)+";"})},translate:function(text){return Control.translate?Control.translate(text):text},before:function(items){var self=this,parent=self.parent();return parent&&parent.insert(items,parent.items().indexOf(self),!0),self},after:function(items){var self=this,parent=self.parent();return parent&&parent.insert(items,parent.items().indexOf(self)),self},remove:function(){var newItems,i,self=this,elm=self.getEl(),parent=self.parent();if(self.items){var controls=self.items().toArray();for(i=controls.length;i--;)controls[i].remove()}parent&&parent.items&&(newItems=[],parent.items().each(function(item){item!==self&&newItems.push(item)}),parent.items().set(newItems),parent._lastRect=null),self._eventsRoot&&self._eventsRoot==self&&$(elm).off();var lookup=self.getRoot().controlIdLookup;return lookup&&delete lookup[self._id],elm&&elm.parentNode&&elm.parentNode.removeChild(elm),self.state.set("rendered",!1),self.state.destroy(),self.fire("remove"),self},renderBefore:function(elm){return $(elm).before(this.renderHtml()),this.postRender(),this},renderTo:function(elm){return $(elm||this.getContainerElm()).append(this.renderHtml()),this.postRender(),this},preRender:function(){},render:function(){},renderHtml:function(){return'<div id="'+this._id+'" class="'+this.classes+'"></div>'},postRender:function(){var elm,box,parent,name,parentEventsRoot,self=this,settings=self.settings;self.$el=$(self.getEl()),self.state.set("rendered",!0);for(name in settings)0===name.indexOf("on")&&self.on(name.substr(2),settings[name]);if(self._eventsRoot){for(parent=self.parent();!parentEventsRoot&&parent;parent=parent.parent())parentEventsRoot=parent._eventsRoot;if(parentEventsRoot)for(name in parentEventsRoot._nativeEvents)self._nativeEvents[name]=!0}bindPendingEvents(self),settings.style&&(elm=self.getEl(),elm&&(elm.setAttribute("style",settings.style),elm.style.cssText=settings.style)),self.settings.border&&(box=self.borderBox,self.$el.css({"border-top-width":box.top,"border-right-width":box.right,"border-bottom-width":box.bottom,"border-left-width":box.left}));var root=self.getRoot();root.controlIdLookup||(root.controlIdLookup={}),root.controlIdLookup[self._id]=self;for(var key in self._aria)self.aria(key,self._aria[key]);self.state.get("visible")===!1&&(self.getEl().style.display="none"),self.bindStates(),self.state.on("change:visible",function(e){var parentCtrl,state=e.value;self.state.get("rendered")&&(self.getEl().style.display=state===!1?"none":"",self.getEl().getBoundingClientRect()),parentCtrl=self.parent(),parentCtrl&&(parentCtrl._lastRect=null),self.fire(state?"show":"hide"),ReflowQueue.add(self)}),self.fire("postrender",{},!1)},bindStates:function(){},scrollIntoView:function(align){function getOffset(elm,rootElm){var x,y,parent=elm;for(x=y=0;parent&&parent!=rootElm&&parent.nodeType;)x+=parent.offsetLeft||0,y+=parent.offsetTop||0,parent=parent.offsetParent;return{x:x,y:y}}var x,y,width,height,parentWidth,parentHeight,elm=this.getEl(),parentElm=elm.parentNode,pos=getOffset(elm,parentElm);return x=pos.x,y=pos.y,width=elm.offsetWidth,height=elm.offsetHeight,parentWidth=parentElm.clientWidth,parentHeight=parentElm.clientHeight,"end"==align?(x-=parentWidth-width,y-=parentHeight-height):"center"==align&&(x-=parentWidth/2-width/2,y-=parentHeight/2-height/2),parentElm.scrollLeft=x,parentElm.scrollTop=y,this},getRoot:function(){for(var rootControl,ctrl=this,parents=[];ctrl;){if(ctrl.rootControl){rootControl=ctrl.rootControl;break}parents.push(ctrl),rootControl=ctrl,ctrl=ctrl.parent()}rootControl||(rootControl=this);for(var i=parents.length;i--;)parents[i].rootControl=rootControl;return rootControl},reflow:function(){ReflowQueue.remove(this);var parent=this.parent();return parent._layout&&!parent._layout.isNative()&&parent.reflow(),this}};return Tools.each("text title visible disabled active value".split(" "),function(name){proto[name]=function(value){return 0===arguments.length?this.state.get(name):("undefined"!=typeof value&&this.state.set(name,value),this)}}),Control=Class.extend(proto)}),define("tinymce/ui/Factory",[],function(){var namespaceInit,types={};return{add:function(type,typeClass){types[type.toLowerCase()]=typeClass},has:function(type){return!!types[type.toLowerCase()]},create:function(type,settings){var ControlType,name,namespace;if(!namespaceInit){namespace=tinymce.ui;for(name in namespace)types[name.toLowerCase()]=namespace[name];namespaceInit=!0}if("string"==typeof type?(settings=settings||{},settings.type=type):(settings=type,type=settings.type),type=type.toLowerCase(),ControlType=types[type],!ControlType)throw new Error("Could not find control by type: "+type);return ControlType=new ControlType(settings),ControlType.type=type,ControlType}}}),define("tinymce/ui/KeyboardNavigation",[],function(){return function(settings){function isElement(node){return node&&1===node.nodeType}function getRole(elm){return elm=elm||focusedElement,isElement(elm)?elm.getAttribute("role"):null}function getParentRole(elm){for(var role,parent=elm||focusedElement;parent=parent.parentNode;)if(role=getRole(parent))return role}function getAriaProp(name){var elm=focusedElement;return isElement(elm)?elm.getAttribute("aria-"+name):void 0}function isTextInputElement(elm){var tagName=elm.tagName.toUpperCase();return"INPUT"==tagName||"TEXTAREA"==tagName}function canFocus(elm){return isTextInputElement(elm)&&!elm.hidden?!0:!!/^(button|menuitem|checkbox|tab|menuitemcheckbox|option|gridcell)$/.test(getRole(elm))}function getFocusElements(elm){function collect(elm){if(1==elm.nodeType&&"none"!=elm.style.display){canFocus(elm)&&elements.push(elm);for(var i=0;i<elm.childNodes.length;i++)collect(elm.childNodes[i])}}var elements=[];return collect(elm||root.getEl()),elements}function getNavigationRoot(targetControl){var navigationRoot,controls;targetControl=targetControl||focusedControl,controls=targetControl.parents().toArray(),controls.unshift(targetControl);for(var i=0;i<controls.length&&(navigationRoot=controls[i],!navigationRoot.settings.ariaRoot);i++);return navigationRoot}function focusFirst(targetControl){var navigationRoot=getNavigationRoot(targetControl),focusElements=getFocusElements(navigationRoot.getEl());navigationRoot.settings.ariaRemember&&"lastAriaIndex"in navigationRoot?moveFocusToIndex(navigationRoot.lastAriaIndex,focusElements):moveFocusToIndex(0,focusElements)}function moveFocusToIndex(idx,elements){return 0>idx?idx=elements.length-1:idx>=elements.length&&(idx=0),elements[idx]&&elements[idx].focus(),idx}function moveFocus(dir,elements){var idx=-1,navigationRoot=getNavigationRoot();elements=elements||getFocusElements(navigationRoot.getEl());for(var i=0;i<elements.length;i++)elements[i]===focusedElement&&(idx=i);idx+=dir,navigationRoot.lastAriaIndex=moveFocusToIndex(idx,elements)}function left(){var parentRole=getParentRole();"tablist"==parentRole?moveFocus(-1,getFocusElements(focusedElement.parentNode)):focusedControl.parent().submenu?cancel():moveFocus(-1)}function right(){var role=getRole(),parentRole=getParentRole();"tablist"==parentRole?moveFocus(1,getFocusElements(focusedElement.parentNode)):"menuitem"==role&&"menu"==parentRole&&getAriaProp("haspopup")?enter():moveFocus(1)}function up(){moveFocus(-1)}function down(){var role=getRole(),parentRole=getParentRole();"menuitem"==role&&"menubar"==parentRole?enter():"button"==role&&getAriaProp("haspopup")?enter({key:"down"}):moveFocus(1)}function tab(e){var parentRole=getParentRole();if("tablist"==parentRole){var elm=getFocusElements(focusedControl.getEl("body"))[0];elm&&elm.focus()}else moveFocus(e.shiftKey?-1:1)}function cancel(){focusedControl.fire("cancel")}function enter(aria){aria=aria||{},focusedControl.fire("click",{target:focusedElement,aria:aria})}var focusedElement,focusedControl,root=settings.root;try{focusedElement=document.activeElement}catch(ex){focusedElement=document.body}return focusedControl=root.getParentCtrl(focusedElement),root.on("keydown",function(e){function handleNonTabOrEscEvent(e,handler){isTextInputElement(focusedElement)||handler(e)!==!1&&e.preventDefault()}if(!e.isDefaultPrevented())switch(e.keyCode){case 37:handleNonTabOrEscEvent(e,left);break;case 39:handleNonTabOrEscEvent(e,right);break;case 38:handleNonTabOrEscEvent(e,up);break;case 40:handleNonTabOrEscEvent(e,down);break;case 27:cancel();break;case 14:case 13:case 32:handleNonTabOrEscEvent(e,enter);break;case 9:tab(e)!==!1&&e.preventDefault()}}),root.on("focusin",function(e){focusedElement=e.target,focusedControl=e.control}),{focusFirst:focusFirst}}}),define("tinymce/ui/Container",["tinymce/ui/Control","tinymce/ui/Collection","tinymce/ui/Selector","tinymce/ui/Factory","tinymce/ui/KeyboardNavigation","tinymce/util/Tools","tinymce/dom/DomQuery","tinymce/ui/ClassList","tinymce/ui/ReflowQueue"],function(Control,Collection,Selector,Factory,KeyboardNavigation,Tools,$,ClassList,ReflowQueue){var selectorCache={};return Control.extend({init:function(settings){var self=this;self._super(settings),settings=self.settings,settings.fixed&&self.state.set("fixed",!0),self._items=new Collection,self.isRtl()&&self.classes.add("rtl"),self.bodyClasses=new ClassList(function(){self.state.get("rendered")&&(self.getEl("body").className=this.toString())}),self.bodyClasses.prefix=self.classPrefix,self.classes.add("container"),self.bodyClasses.add("container-body"),settings.containerCls&&self.classes.add(settings.containerCls),self._layout=Factory.create((settings.layout||"")+"layout"),self.settings.items?self.add(self.settings.items):self.add(self.render()),self._hasBody=!0},items:function(){return this._items},find:function(selector){return selector=selectorCache[selector]=selectorCache[selector]||new Selector(selector),selector.find(this)},add:function(items){var self=this;return self.items().add(self.create(items)).parent(self),self},focus:function(keyboard){var focusCtrl,keyboardNav,items,self=this;return keyboard&&(keyboardNav=self.keyboardNav||self.parents().eq(-1)[0].keyboardNav)?void keyboardNav.focusFirst(self):(items=self.find("*"),self.statusbar&&items.add(self.statusbar.items()),items.each(function(ctrl){return ctrl.settings.autofocus?(focusCtrl=null,!1):void(ctrl.canFocus&&(focusCtrl=focusCtrl||ctrl))}),focusCtrl&&focusCtrl.focus(),self)},replace:function(oldItem,newItem){for(var ctrlElm,items=this.items(),i=items.length;i--;)if(items[i]===oldItem){items[i]=newItem;break}i>=0&&(ctrlElm=newItem.getEl(),ctrlElm&&ctrlElm.parentNode.removeChild(ctrlElm),ctrlElm=oldItem.getEl(),ctrlElm&&ctrlElm.parentNode.removeChild(ctrlElm)),newItem.parent(this)},create:function(items){var settings,self=this,ctrlItems=[];return Tools.isArray(items)||(items=[items]),Tools.each(items,function(item){item&&(item instanceof Control||("string"==typeof item&&(item={type:item}),settings=Tools.extend({},self.settings.defaults,item),item.type=settings.type=settings.type||item.type||self.settings.defaultType||(settings.defaults?settings.defaults.type:null),item=Factory.create(settings)),ctrlItems.push(item))}),ctrlItems},renderNew:function(){var self=this;return self.items().each(function(ctrl,index){var containerElm;ctrl.parent(self),ctrl.state.get("rendered")||(containerElm=self.getEl("body"),containerElm.hasChildNodes()&&index<=containerElm.childNodes.length-1?$(containerElm.childNodes[index]).before(ctrl.renderHtml()):$(containerElm).append(ctrl.renderHtml()),ctrl.postRender(),ReflowQueue.add(ctrl))}),self._layout.applyClasses(self.items().filter(":visible")),self._lastRect=null,self},append:function(items){return this.add(items).renderNew()},prepend:function(items){var self=this;return self.items().set(self.create(items).concat(self.items().toArray())),self.renderNew()},insert:function(items,index,before){var curItems,beforeItems,afterItems,self=this;return items=self.create(items),curItems=self.items(),!before&&index<curItems.length-1&&(index+=1),index>=0&&index<curItems.length&&(beforeItems=curItems.slice(0,index).toArray(),afterItems=curItems.slice(index).toArray(),curItems.set(beforeItems.concat(items,afterItems))),self.renderNew()},fromJSON:function(data){var self=this;for(var name in data)self.find("#"+name).value(data[name]);return self},toJSON:function(){var self=this,data={};return self.find("*").each(function(ctrl){var name=ctrl.name(),value=ctrl.value();name&&"undefined"!=typeof value&&(data[name]=value)}),data},renderHtml:function(){var self=this,layout=self._layout,role=this.settings.role;return self.preRender(),layout.preRender(self),'<div id="'+self._id+'" class="'+self.classes+'"'+(role?' role="'+this.settings.role+'"':"")+'><div id="'+self._id+'-body" class="'+self.bodyClasses+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></div>"},postRender:function(){var box,self=this;return self.items().exec("postRender"),self._super(),self._layout.postRender(self),self.state.set("rendered",!0),self.settings.style&&self.$el.css(self.settings.style),self.settings.border&&(box=self.borderBox,self.$el.css({"border-top-width":box.top,"border-right-width":box.right,"border-bottom-width":box.bottom,"border-left-width":box.left})),self.parent()||(self.keyboardNav=new KeyboardNavigation({root:self})),self},initLayoutRect:function(){var self=this,layoutRect=self._super();return self._layout.recalc(self),layoutRect},recalc:function(){var self=this,rect=self._layoutRect,lastRect=self._lastRect;return lastRect&&lastRect.w==rect.w&&lastRect.h==rect.h?void 0:(self._layout.recalc(self),rect=self.layoutRect(),self._lastRect={x:rect.x,y:rect.y,w:rect.w,h:rect.h},!0)},reflow:function(){var i;if(ReflowQueue.remove(this),this.visible()){for(Control.repaintControls=[],Control.repaintControls.map={},this.recalc(),i=Control.repaintControls.length;i--;)Control.repaintControls[i].repaint();"flow"!==this.settings.layout&&"stack"!==this.settings.layout&&this.repaint(),Control.repaintControls=[]}return this}})}),define("tinymce/ui/DragHelper",["tinymce/dom/DomQuery"],function($){function getDocumentSize(doc){var documentElement,body,scrollWidth,clientWidth,offsetWidth,scrollHeight,clientHeight,offsetHeight,max=Math.max;return documentElement=doc.documentElement,body=doc.body,scrollWidth=max(documentElement.scrollWidth,body.scrollWidth),clientWidth=max(documentElement.clientWidth,body.clientWidth),offsetWidth=max(documentElement.offsetWidth,body.offsetWidth),scrollHeight=max(documentElement.scrollHeight,body.scrollHeight),clientHeight=max(documentElement.clientHeight,body.clientHeight),offsetHeight=max(documentElement.offsetHeight,body.offsetHeight),{width:offsetWidth>scrollWidth?clientWidth:scrollWidth,height:offsetHeight>scrollHeight?clientHeight:scrollHeight}}function updateWithTouchData(e){var keys,i;if(e.changedTouches)for(keys="screenX screenY pageX pageY clientX clientY".split(" "),i=0;i<keys.length;i++)e[keys[i]]=e.changedTouches[0][keys[i]]}return function(id,settings){function getHandleElm(){return doc.getElementById(settings.handle||id)}var $eventOverlay,downButton,start,stop,drag,startX,startY,doc=settings.document||document;settings=settings||{},start=function(e){var handleElm,cursor,docSize=getDocumentSize(doc);updateWithTouchData(e),e.preventDefault(),downButton=e.button,handleElm=getHandleElm(),startX=e.screenX,startY=e.screenY,cursor=window.getComputedStyle?window.getComputedStyle(handleElm,null).getPropertyValue("cursor"):handleElm.runtimeStyle.cursor,$eventOverlay=$("<div>").css({position:"absolute",top:0,left:0,width:docSize.width,height:docSize.height,zIndex:2147483647,opacity:1e-4,cursor:cursor}).appendTo(doc.body),$(doc).on("mousemove touchmove",drag).on("mouseup touchend",stop),settings.start(e)},drag=function(e){return updateWithTouchData(e),e.button!==downButton?stop(e):(e.deltaX=e.screenX-startX,e.deltaY=e.screenY-startY,e.preventDefault(),void settings.drag(e))},stop=function(e){updateWithTouchData(e),$(doc).off("mousemove touchmove",drag).off("mouseup touchend",stop),$eventOverlay.remove(),settings.stop&&settings.stop(e)},this.destroy=function(){$(getHandleElm()).off()},$(getHandleElm()).on("mousedown touchstart",start)}}),define("tinymce/ui/Scrollable",["tinymce/dom/DomQuery","tinymce/ui/DragHelper"],function($,DragHelper){return{init:function(){var self=this;self.on("repaint",self.renderScroll)},renderScroll:function(){function repaintScroll(){function repaintAxis(axisName,posName,sizeName,contentSizeName,hasScroll,ax){var containerElm,scrollBarElm,scrollThumbElm,containerSize,scrollSize,ratio,rect,posNameLower,sizeNameLower;if(scrollBarElm=self.getEl("scroll"+axisName)){if(posNameLower=posName.toLowerCase(),sizeNameLower=sizeName.toLowerCase(),
$(self.getEl("absend")).css(posNameLower,self.layoutRect()[contentSizeName]-1),!hasScroll)return void $(scrollBarElm).css("display","none");$(scrollBarElm).css("display","block"),containerElm=self.getEl("body"),scrollThumbElm=self.getEl("scroll"+axisName+"t"),containerSize=containerElm["client"+sizeName]-2*margin,containerSize-=hasScrollH&&hasScrollV?scrollBarElm["client"+ax]:0,scrollSize=containerElm["scroll"+sizeName],ratio=containerSize/scrollSize,rect={},rect[posNameLower]=containerElm["offset"+posName]+margin,rect[sizeNameLower]=containerSize,$(scrollBarElm).css(rect),rect={},rect[posNameLower]=containerElm["scroll"+posName]*ratio,rect[sizeNameLower]=containerSize*ratio,$(scrollThumbElm).css(rect)}}var hasScrollH,hasScrollV,bodyElm;bodyElm=self.getEl("body"),hasScrollH=bodyElm.scrollWidth>bodyElm.clientWidth,hasScrollV=bodyElm.scrollHeight>bodyElm.clientHeight,repaintAxis("h","Left","Width","contentW",hasScrollH,"Height"),repaintAxis("v","Top","Height","contentH",hasScrollV,"Width")}function addScroll(){function addScrollAxis(axisName,posName,sizeName,deltaPosName,ax){var scrollStart,axisId=self._id+"-scroll"+axisName,prefix=self.classPrefix;$(self.getEl()).append('<div id="'+axisId+'" class="'+prefix+"scrollbar "+prefix+"scrollbar-"+axisName+'"><div id="'+axisId+'t" class="'+prefix+'scrollbar-thumb"></div></div>'),self.draghelper=new DragHelper(axisId+"t",{start:function(){scrollStart=self.getEl("body")["scroll"+posName],$("#"+axisId).addClass(prefix+"active")},drag:function(e){var ratio,hasScrollH,hasScrollV,containerSize,layoutRect=self.layoutRect();hasScrollH=layoutRect.contentW>layoutRect.innerW,hasScrollV=layoutRect.contentH>layoutRect.innerH,containerSize=self.getEl("body")["client"+sizeName]-2*margin,containerSize-=hasScrollH&&hasScrollV?self.getEl("scroll"+axisName)["client"+ax]:0,ratio=containerSize/self.getEl("body")["scroll"+sizeName],self.getEl("body")["scroll"+posName]=scrollStart+e["delta"+deltaPosName]/ratio},stop:function(){$("#"+axisId).removeClass(prefix+"active")}})}self.classes.add("scroll"),addScrollAxis("v","Top","Height","Y","Width"),addScrollAxis("h","Left","Width","X","Height")}var self=this,margin=2;self.settings.autoScroll&&(self._hasScroll||(self._hasScroll=!0,addScroll(),self.on("wheel",function(e){var bodyEl=self.getEl("body");bodyEl.scrollLeft+=10*(e.deltaX||0),bodyEl.scrollTop+=10*e.deltaY,repaintScroll()}),$(self.getEl("body")).on("scroll",repaintScroll)),repaintScroll())}}}),define("tinymce/ui/Panel",["tinymce/ui/Container","tinymce/ui/Scrollable"],function(Container,Scrollable){return Container.extend({Defaults:{layout:"fit",containerCls:"panel"},Mixins:[Scrollable],renderHtml:function(){var self=this,layout=self._layout,innerHtml=self.settings.html;return self.preRender(),layout.preRender(self),"undefined"==typeof innerHtml?innerHtml='<div id="'+self._id+'-body" class="'+self.bodyClasses+'">'+layout.renderHtml(self)+"</div>":("function"==typeof innerHtml&&(innerHtml=innerHtml.call(self)),self._hasBody=!1),'<div id="'+self._id+'" class="'+self.classes+'" hidefocus="1" tabindex="-1" role="group">'+(self._preBodyHtml||"")+innerHtml+"</div>"}})}),define("tinymce/ui/Movable",["tinymce/ui/DomUtils"],function(DomUtils){function calculateRelativePosition(ctrl,targetElm,rel){var ctrlElm,pos,x,y,selfW,selfH,targetW,targetH,viewport,size;return viewport=DomUtils.getViewPort(),pos=DomUtils.getPos(targetElm),x=pos.x,y=pos.y,ctrl.state.get("fixed")&&"static"==DomUtils.getRuntimeStyle(document.body,"position")&&(x-=viewport.x,y-=viewport.y),ctrlElm=ctrl.getEl(),size=DomUtils.getSize(ctrlElm),selfW=size.width,selfH=size.height,size=DomUtils.getSize(targetElm),targetW=size.width,targetH=size.height,rel=(rel||"").split(""),"b"===rel[0]&&(y+=targetH),"r"===rel[1]&&(x+=targetW),"c"===rel[0]&&(y+=Math.round(targetH/2)),"c"===rel[1]&&(x+=Math.round(targetW/2)),"b"===rel[3]&&(y-=selfH),"r"===rel[4]&&(x-=selfW),"c"===rel[3]&&(y-=Math.round(selfH/2)),"c"===rel[4]&&(x-=Math.round(selfW/2)),{x:x,y:y,w:selfW,h:selfH}}return{testMoveRel:function(elm,rels){for(var viewPortRect=DomUtils.getViewPort(),i=0;i<rels.length;i++){var pos=calculateRelativePosition(this,elm,rels[i]);if(this.state.get("fixed")){if(pos.x>0&&pos.x+pos.w<viewPortRect.w&&pos.y>0&&pos.y+pos.h<viewPortRect.h)return rels[i]}else if(pos.x>viewPortRect.x&&pos.x+pos.w<viewPortRect.w+viewPortRect.x&&pos.y>viewPortRect.y&&pos.y+pos.h<viewPortRect.h+viewPortRect.y)return rels[i]}return rels[0]},moveRel:function(elm,rel){"string"!=typeof rel&&(rel=this.testMoveRel(elm,rel));var pos=calculateRelativePosition(this,elm,rel);return this.moveTo(pos.x,pos.y)},moveBy:function(dx,dy){var self=this,rect=self.layoutRect();return self.moveTo(rect.x+dx,rect.y+dy),self},moveTo:function(x,y){function constrain(value,max,size){return 0>value?0:value+size>max?(value=max-size,0>value?0:value):value}var self=this;if(self.settings.constrainToViewport){var viewPortRect=DomUtils.getViewPort(window),layoutRect=self.layoutRect();x=constrain(x,viewPortRect.w+viewPortRect.x,layoutRect.w),y=constrain(y,viewPortRect.h+viewPortRect.y,layoutRect.h)}return self.state.get("rendered")?self.layoutRect({x:x,y:y}).repaint():(self.settings.x=x,self.settings.y=y),self.fire("move",{x:x,y:y}),self}}}),define("tinymce/ui/Resizable",["tinymce/ui/DomUtils"],function(DomUtils){return{resizeToContent:function(){this._layoutRect.autoResize=!0,this._lastRect=null,this.reflow()},resizeTo:function(w,h){if(1>=w||1>=h){var rect=DomUtils.getWindowSize();w=1>=w?w*rect.w:w,h=1>=h?h*rect.h:h}return this._layoutRect.autoResize=!1,this.layoutRect({minW:w,minH:h,w:w,h:h}).reflow()},resizeBy:function(dw,dh){var self=this,rect=self.layoutRect();return self.resizeTo(rect.w+dw,rect.h+dh)}}}),define("tinymce/ui/FloatPanel",["tinymce/ui/Panel","tinymce/ui/Movable","tinymce/ui/Resizable","tinymce/ui/DomUtils","tinymce/dom/DomQuery","tinymce/util/Delay"],function(Panel,Movable,Resizable,DomUtils,$,Delay){function isChildOf(ctrl,parent){for(;ctrl;){if(ctrl==parent)return!0;ctrl=ctrl.parent()}}function skipOrHidePanels(e){for(var i=visiblePanels.length;i--;){var panel=visiblePanels[i],clickCtrl=panel.getParentCtrl(e.target);if(panel.settings.autohide){if(clickCtrl&&(isChildOf(clickCtrl,panel)||panel.parent()===clickCtrl))continue;e=panel.fire("autohide",{target:e.target}),e.isDefaultPrevented()||panel.hide()}}}function bindDocumentClickHandler(){documentClickHandler||(documentClickHandler=function(e){2!=e.button&&skipOrHidePanels(e)},$(document).on("click touchstart",documentClickHandler))}function bindDocumentScrollHandler(){documentScrollHandler||(documentScrollHandler=function(){var i;for(i=visiblePanels.length;i--;)repositionPanel(visiblePanels[i])},$(window).on("scroll",documentScrollHandler))}function bindWindowResizeHandler(){if(!windowResizeHandler){var docElm=document.documentElement,clientWidth=docElm.clientWidth,clientHeight=docElm.clientHeight;windowResizeHandler=function(){document.all&&clientWidth==docElm.clientWidth&&clientHeight==docElm.clientHeight||(clientWidth=docElm.clientWidth,clientHeight=docElm.clientHeight,FloatPanel.hideAll())},$(window).on("resize",windowResizeHandler)}}function repositionPanel(panel){function toggleFixedChildPanels(fixed,deltaY){for(var parent,i=0;i<visiblePanels.length;i++)if(visiblePanels[i]!=panel)for(parent=visiblePanels[i].parent();parent&&(parent=parent.parent());)parent==panel&&visiblePanels[i].fixed(fixed).moveBy(0,deltaY).repaint()}var scrollY=DomUtils.getViewPort().y;panel.settings.autofix&&(panel.state.get("fixed")?panel._autoFixY>scrollY&&(panel.fixed(!1).layoutRect({y:panel._autoFixY}).repaint(),toggleFixedChildPanels(!1,panel._autoFixY-scrollY)):(panel._autoFixY=panel.layoutRect().y,panel._autoFixY<scrollY&&(panel.fixed(!0).layoutRect({y:0}).repaint(),toggleFixedChildPanels(!0,scrollY-panel._autoFixY))))}function addRemove(add,ctrl){var i,topModal,zIndex=FloatPanel.zIndex||65535;if(add)zOrder.push(ctrl);else for(i=zOrder.length;i--;)zOrder[i]===ctrl&&zOrder.splice(i,1);if(zOrder.length)for(i=0;i<zOrder.length;i++)zOrder[i].modal&&(zIndex++,topModal=zOrder[i]),zOrder[i].getEl().style.zIndex=zIndex,zOrder[i].zIndex=zIndex,zIndex++;var modalBlockEl=$("#"+ctrl.classPrefix+"modal-block",ctrl.getContainerElm())[0];topModal?$(modalBlockEl).css("z-index",topModal.zIndex-1):modalBlockEl&&(modalBlockEl.parentNode.removeChild(modalBlockEl),hasModal=!1),FloatPanel.currentZIndex=zIndex}function removeVisiblePanel(panel){var i;for(i=visiblePanels.length;i--;)visiblePanels[i]===panel&&visiblePanels.splice(i,1);for(i=zOrder.length;i--;)zOrder[i]===panel&&zOrder.splice(i,1)}var documentClickHandler,documentScrollHandler,windowResizeHandler,hasModal,visiblePanels=[],zOrder=[],FloatPanel=Panel.extend({Mixins:[Movable,Resizable],init:function(settings){var self=this;self._super(settings),self._eventsRoot=self,self.classes.add("floatpanel"),settings.autohide&&(bindDocumentClickHandler(),bindWindowResizeHandler(),visiblePanels.push(self)),settings.autofix&&(bindDocumentScrollHandler(),self.on("move",function(){repositionPanel(this)})),self.on("postrender show",function(e){if(e.control==self){var $modalBlockEl,prefix=self.classPrefix;self.modal&&!hasModal&&($modalBlockEl=$("#"+prefix+"modal-block",self.getContainerElm()),$modalBlockEl[0]||($modalBlockEl=$('<div id="'+prefix+'modal-block" class="'+prefix+"reset "+prefix+'fade"></div>').appendTo(self.getContainerElm())),Delay.setTimeout(function(){$modalBlockEl.addClass(prefix+"in"),$(self.getEl()).addClass(prefix+"in")}),hasModal=!0),addRemove(!0,self)}}),self.on("show",function(){self.parents().each(function(ctrl){return ctrl.state.get("fixed")?(self.fixed(!0),!1):void 0})}),settings.popover&&(self._preBodyHtml='<div class="'+self.classPrefix+'arrow"></div>',self.classes.add("popover").add("bottom").add(self.isRtl()?"end":"start"))},fixed:function(state){var self=this;if(self.state.get("fixed")!=state){if(self.state.get("rendered")){var viewport=DomUtils.getViewPort();state?self.layoutRect().y-=viewport.y:self.layoutRect().y+=viewport.y}self.classes.toggle("fixed",state),self.state.set("fixed",state)}return self},show:function(){var i,self=this,state=self._super();for(i=visiblePanels.length;i--&&visiblePanels[i]!==self;);return-1===i&&visiblePanels.push(self),state},hide:function(){return removeVisiblePanel(this),addRemove(!1,this),this._super()},hideAll:function(){FloatPanel.hideAll()},close:function(){var self=this;return self.fire("close").isDefaultPrevented()||(self.remove(),addRemove(!1,self)),self},remove:function(){removeVisiblePanel(this),this._super()},postRender:function(){var self=this;return self.settings.bodyRole&&this.getEl("body").setAttribute("role",self.settings.bodyRole),self._super()}});return FloatPanel.hideAll=function(){for(var i=visiblePanels.length;i--;){var panel=visiblePanels[i];panel&&panel.settings.autohide&&(panel.hide(),visiblePanels.splice(i,1))}},FloatPanel}),define("tinymce/ui/Window",["tinymce/ui/FloatPanel","tinymce/ui/Panel","tinymce/ui/DomUtils","tinymce/dom/DomQuery","tinymce/ui/DragHelper","tinymce/ui/BoxUtils","tinymce/Env","tinymce/util/Delay"],function(FloatPanel,Panel,DomUtils,$,DragHelper,BoxUtils,Env,Delay){function toggleFullScreenState(state){var contentValue,noScaleMetaValue="width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0",viewport=$("meta[name=viewport]")[0];Env.overrideViewPort!==!1&&(viewport||(viewport=document.createElement("meta"),viewport.setAttribute("name","viewport"),document.getElementsByTagName("head")[0].appendChild(viewport)),contentValue=viewport.getAttribute("content"),contentValue&&"undefined"!=typeof oldMetaValue&&(oldMetaValue=contentValue),viewport.setAttribute("content",state?noScaleMetaValue:oldMetaValue))}function toggleBodyFullScreenClasses(classPrefix){for(var i=0;i<windows.length;i++)if(windows[i]._fullscreen)return;$([document.documentElement,document.body]).removeClass(classPrefix+"fullscreen")}function handleWindowResize(){function reposition(){var i,layoutRect,rect=DomUtils.getWindowSize();for(i=0;i<windows.length;i++)layoutRect=windows[i].layoutRect(),windows[i].moveTo(windows[i].settings.x||Math.max(0,rect.w/2-layoutRect.w/2),windows[i].settings.y||Math.max(0,rect.h/2-layoutRect.h/2))}var lastSize={w:window.innerWidth,h:window.innerHeight};Delay.setInterval(function(){var w=window.innerWidth,h=window.innerHeight;lastSize.w==w&&lastSize.h==h||(lastSize={w:w,h:h},$(window).trigger("resize"))},100),$(window).on("resize",reposition)}var windows=[],oldMetaValue="",Window=FloatPanel.extend({modal:!0,Defaults:{border:1,layout:"flex",containerCls:"panel",role:"dialog",callbacks:{submit:function(){this.fire("submit",{data:this.toJSON()})},close:function(){this.close()}}},init:function(settings){var self=this;self._super(settings),self.isRtl()&&self.classes.add("rtl"),self.classes.add("window"),self.bodyClasses.add("window-body"),self.state.set("fixed",!0),settings.buttons&&(self.statusbar=new Panel({layout:"flex",border:"1 0 0 0",spacing:3,padding:10,align:"center",pack:self.isRtl()?"start":"end",defaults:{type:"button"},items:settings.buttons}),self.statusbar.classes.add("foot"),self.statusbar.parent(self)),self.on("click",function(e){-1!=e.target.className.indexOf(self.classPrefix+"close")&&self.close()}),self.on("cancel",function(){self.close()}),self.aria("describedby",self.describedBy||self._id+"-none"),self.aria("label",settings.title),self._fullscreen=!1},recalc:function(){var layoutRect,width,x,needsRecalc,self=this,statusbar=self.statusbar;self._fullscreen&&(self.layoutRect(DomUtils.getWindowSize()),self.layoutRect().contentH=self.layoutRect().innerH),self._super(),layoutRect=self.layoutRect(),self.settings.title&&!self._fullscreen&&(width=layoutRect.headerW,width>layoutRect.w&&(x=layoutRect.x-Math.max(0,width/2),self.layoutRect({w:width,x:x}),needsRecalc=!0)),statusbar&&(statusbar.layoutRect({w:self.layoutRect().innerW}).recalc(),width=statusbar.layoutRect().minW+layoutRect.deltaW,width>layoutRect.w&&(x=layoutRect.x-Math.max(0,width-layoutRect.w),self.layoutRect({w:width,x:x}),needsRecalc=!0)),needsRecalc&&self.recalc()},initLayoutRect:function(){var headEl,self=this,layoutRect=self._super(),deltaH=0;if(self.settings.title&&!self._fullscreen){headEl=self.getEl("head");var size=DomUtils.getSize(headEl);layoutRect.headerW=size.width,layoutRect.headerH=size.height,deltaH+=layoutRect.headerH}self.statusbar&&(deltaH+=self.statusbar.layoutRect().h),layoutRect.deltaH+=deltaH,layoutRect.minH+=deltaH,layoutRect.h+=deltaH;var rect=DomUtils.getWindowSize();return layoutRect.x=self.settings.x||Math.max(0,rect.w/2-layoutRect.w/2),layoutRect.y=self.settings.y||Math.max(0,rect.h/2-layoutRect.h/2),layoutRect},renderHtml:function(){var self=this,layout=self._layout,id=self._id,prefix=self.classPrefix,settings=self.settings,headerHtml="",footerHtml="",html=settings.html;return self.preRender(),layout.preRender(self),settings.title&&(headerHtml='<div id="'+id+'-head" class="'+prefix+'window-head"><div id="'+id+'-title" class="'+prefix+'title">'+self.encode(settings.title)+'</div><button type="button" class="'+prefix+'close" aria-hidden="true">×</button><div id="'+id+'-dragh" class="'+prefix+'dragh"></div></div>'),settings.url&&(html='<iframe src="'+settings.url+'" tabindex="-1"></iframe>'),"undefined"==typeof html&&(html=layout.renderHtml(self)),self.statusbar&&(footerHtml=self.statusbar.renderHtml()),'<div id="'+id+'" class="'+self.classes+'" hidefocus="1"><div class="'+self.classPrefix+'reset" role="application">'+headerHtml+'<div id="'+id+'-body" class="'+self.bodyClasses+'">'+html+"</div>"+footerHtml+"</div></div>"},fullscreen:function(state){var slowRendering,layoutRect,self=this,documentElement=document.documentElement,prefix=self.classPrefix;if(state!=self._fullscreen)if($(window).on("resize",function(){var time;if(self._fullscreen)if(slowRendering)self._timer||(self._timer=Delay.setTimeout(function(){var rect=DomUtils.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h),self._timer=0},50));else{time=(new Date).getTime();var rect=DomUtils.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h),(new Date).getTime()-time>50&&(slowRendering=!0)}}),layoutRect=self.layoutRect(),self._fullscreen=state,state){self._initial={x:layoutRect.x,y:layoutRect.y,w:layoutRect.w,h:layoutRect.h},self.borderBox=BoxUtils.parseBox("0"),self.getEl("head").style.display="none",layoutRect.deltaH-=layoutRect.headerH+2,$([documentElement,document.body]).addClass(prefix+"fullscreen"),self.classes.add("fullscreen");var rect=DomUtils.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h)}else self.borderBox=BoxUtils.parseBox(self.settings.border),self.getEl("head").style.display="",layoutRect.deltaH+=layoutRect.headerH,$([documentElement,document.body]).removeClass(prefix+"fullscreen"),self.classes.remove("fullscreen"),self.moveTo(self._initial.x,self._initial.y).resizeTo(self._initial.w,self._initial.h);return self.reflow()},postRender:function(){var startPos,self=this;setTimeout(function(){self.classes.add("in")},0),self._super(),self.statusbar&&self.statusbar.postRender(),self.focus(),this.dragHelper=new DragHelper(self._id+"-dragh",{start:function(){startPos={x:self.layoutRect().x,y:self.layoutRect().y}},drag:function(e){self.moveTo(startPos.x+e.deltaX,startPos.y+e.deltaY)}}),self.on("submit",function(e){e.isDefaultPrevented()||self.close()}),windows.push(self),toggleFullScreenState(!0)},submit:function(){return this.fire("submit",{data:this.toJSON()})},remove:function(){var i,self=this;for(self.dragHelper.destroy(),self._super(),self.statusbar&&this.statusbar.remove(),i=windows.length;i--;)windows[i]===self&&windows.splice(i,1);toggleFullScreenState(windows.length>0),toggleBodyFullScreenClasses(self.classPrefix)},getContentWindow:function(){var ifr=this.getEl().getElementsByTagName("iframe")[0];return ifr?ifr.contentWindow:null}});return Env.desktop||handleWindowResize(),Window}),define("tinymce/ui/MessageBox",["tinymce/ui/Window"],function(Window){var MessageBox=Window.extend({init:function(settings){settings={border:1,padding:20,layout:"flex",pack:"center",align:"center",containerCls:"panel",autoScroll:!0,buttons:{type:"button",text:"Ok",action:"ok"},items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200}},this._super(settings)},Statics:{OK:1,OK_CANCEL:2,YES_NO:3,YES_NO_CANCEL:4,msgBox:function(settings){function createButton(text,status,primary){return{type:"button",text:text,subtype:primary?"primary":"",onClick:function(e){e.control.parents()[1].close(),callback(status)}}}var buttons,callback=settings.callback||function(){};switch(settings.buttons){case MessageBox.OK_CANCEL:buttons=[createButton("Ok",!0,!0),createButton("Cancel",!1)];break;case MessageBox.YES_NO:case MessageBox.YES_NO_CANCEL:buttons=[createButton("Yes",1,!0),createButton("No",0)],settings.buttons==MessageBox.YES_NO_CANCEL&&buttons.push(createButton("Cancel",-1));break;default:buttons=[createButton("Ok",!0,!0)]}return new Window({padding:20,x:settings.x,y:settings.y,minWidth:300,minHeight:100,layout:"flex",pack:"center",align:"center",buttons:buttons,title:settings.title,role:"alertdialog",items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200,text:settings.text},onPostRender:function(){this.aria("describedby",this.items()[0]._id)},onClose:settings.onClose,onCancel:function(){callback(!1)}}).renderTo(document.body).reflow()},alert:function(settings,callback){return"string"==typeof settings&&(settings={text:settings}),settings.callback=callback,MessageBox.msgBox(settings)},confirm:function(settings,callback){return"string"==typeof settings&&(settings={text:settings}),settings.callback=callback,settings.buttons=MessageBox.OK_CANCEL,MessageBox.msgBox(settings)}}});return MessageBox}),define("tinymce/WindowManager",["tinymce/ui/Window","tinymce/ui/MessageBox"],function(Window,MessageBox){return function(editor){function getTopMostWindow(){return windows.length?windows[windows.length-1]:void 0}function fireOpenEvent(win){editor.fire("OpenWindow",{win:win})}function fireCloseEvent(win){editor.fire("CloseWindow",{win:win})}var self=this,windows=[];self.windows=windows,editor.on("remove",function(){for(var i=windows.length;i--;)windows[i].close()}),self.open=function(args,params){var win;return editor.editorManager.setActive(editor),args.title=args.title||" ",args.url=args.url||args.file,args.url&&(args.width=parseInt(args.width||320,10),args.height=parseInt(args.height||240,10)),args.body&&(args.items={defaults:args.defaults,type:args.bodyType||"form",items:args.body}),args.url||args.buttons||(args.buttons=[{text:"Ok",subtype:"primary",onclick:function(){win.find("form")[0].submit()}},{text:"Cancel",onclick:function(){win.close()}}]),win=new Window(args),windows.push(win),win.on("close",function(){for(var i=windows.length;i--;)windows[i]===win&&windows.splice(i,1);windows.length||editor.focus(),fireCloseEvent(win)}),args.data&&win.on("postRender",function(){this.find("*").each(function(ctrl){var name=ctrl.name();name in args.data&&ctrl.value(args.data[name])})}),win.features=args||{},win.params=params||{},1===windows.length&&editor.nodeChanged(),win=win.renderTo().reflow(),fireOpenEvent(win),win},self.alert=function(message,callback,scope){var win;win=MessageBox.alert(message,function(){callback?callback.call(scope||this):editor.focus()}),win.on("close",function(){fireCloseEvent(win)}),fireOpenEvent(win)},self.confirm=function(message,callback,scope){var win;win=MessageBox.confirm(message,function(state){callback.call(scope||this,state)}),win.on("close",function(){fireCloseEvent(win)}),fireOpenEvent(win)},self.close=function(){getTopMostWindow()&&getTopMostWindow().close()},self.getParams=function(){return getTopMostWindow()?getTopMostWindow().params:null},self.setParams=function(params){getTopMostWindow()&&(getTopMostWindow().params=params)},self.getWindows=function(){return windows}}}),define("tinymce/ui/Tooltip",["tinymce/ui/Control","tinymce/ui/Movable"],function(Control,Movable){return Control.extend({Mixins:[Movable],Defaults:{classes:"widget tooltip tooltip-n"},renderHtml:function(){var self=this,prefix=self.classPrefix;return'<div id="'+self._id+'" class="'+self.classes+'" role="presentation"><div class="'+prefix+'tooltip-arrow"></div><div class="'+prefix+'tooltip-inner">'+self.encode(self.state.get("text"))+"</div></div>"},bindStates:function(){var self=this;return self.state.on("change:text",function(e){self.getEl().lastChild.innerHTML=self.encode(e.value)}),self._super()},repaint:function(){var style,rect,self=this;style=self.getEl().style,rect=self._layoutRect,style.left=rect.x+"px",style.top=rect.y+"px",style.zIndex=131070}})}),define("tinymce/ui/Widget",["tinymce/ui/Control","tinymce/ui/Tooltip"],function(Control,Tooltip){var tooltip,Widget=Control.extend({init:function(settings){var self=this;self._super(settings),settings=self.settings,self.canFocus=!0,settings.tooltip&&Widget.tooltips!==!1&&(self.on("mouseenter",function(e){var tooltip=self.tooltip().moveTo(-65535);if(e.control==self){var rel=tooltip.text(settings.tooltip).show().testMoveRel(self.getEl(),["bc-tc","bc-tl","bc-tr"]);tooltip.classes.toggle("tooltip-n","bc-tc"==rel),tooltip.classes.toggle("tooltip-nw","bc-tl"==rel),tooltip.classes.toggle("tooltip-ne","bc-tr"==rel),tooltip.moveRel(self.getEl(),rel)}else tooltip.hide()}),self.on("mouseleave mousedown click",function(){self.tooltip().hide()})),self.aria("label",settings.ariaLabel||settings.tooltip)},tooltip:function(){return tooltip||(tooltip=new Tooltip({type:"tooltip"}),tooltip.renderTo()),tooltip},postRender:function(){var self=this,settings=self.settings;self._super(),self.parent()||!settings.width&&!settings.height||(self.initLayoutRect(),self.repaint()),settings.autofocus&&self.focus()},bindStates:function(){function disable(state){self.aria("disabled",state),self.classes.toggle("disabled",state)}function active(state){self.aria("pressed",state),self.classes.toggle("active",state)}var self=this;return self.state.on("change:disabled",function(e){disable(e.value)}),self.state.on("change:active",function(e){active(e.value)}),self.state.get("disabled")&&disable(!0),self.state.get("active")&&active(!0),self._super()},remove:function(){this._super(),tooltip&&(tooltip.remove(),tooltip=null)}});return Widget}),define("tinymce/ui/Progress",["tinymce/ui/Widget"],function(Widget){return Widget.extend({Defaults:{value:0},init:function(settings){var self=this;self._super(settings),self.classes.add("progress"),self.settings.filter||(self.settings.filter=function(value){return Math.round(value)})},renderHtml:function(){var self=this,id=self._id,prefix=this.classPrefix;return'<div id="'+id+'" class="'+self.classes+'"><div class="'+prefix+'bar-container"><div class="'+prefix+'bar"></div></div><div class="'+prefix+'text">0%</div></div>'},postRender:function(){var self=this;return self._super(),self.value(self.settings.value),self},bindStates:function(){function setValue(value){value=self.settings.filter(value),self.getEl().lastChild.innerHTML=value+"%",self.getEl().firstChild.firstChild.style.width=value+"%"}var self=this;return self.state.on("change:value",function(e){setValue(e.value)}),setValue(self.state.get("value")),self._super()}})}),define("tinymce/ui/Notification",["tinymce/ui/Control","tinymce/ui/Movable","tinymce/ui/Progress"],function(Control,Movable,Progress){return Control.extend({Mixins:[Movable],Defaults:{classes:"widget notification"},init:function(settings){var self=this;self._super(settings),settings.text&&self.text(settings.text),settings.icon&&(self.icon=settings.icon),settings.color&&(self.color=settings.color),settings.type&&self.classes.add("notification-"+settings.type),settings.timeout&&(settings.timeout<0||settings.timeout>0)&&!settings.closeButton?self.closeButton=!1:(self.classes.add("has-close"),self.closeButton=!0),settings.progressBar&&(self.progressBar=new Progress),self.on("click",function(e){-1!=e.target.className.indexOf(self.classPrefix+"close")&&self.close()})},renderHtml:function(){var self=this,prefix=self.classPrefix,icon="",closeButton="",progressBar="",notificationStyle="";return self.icon&&(icon='<i class="'+prefix+"ico "+prefix+"i-"+self.icon+'"></i>'),self.color&&(notificationStyle=' style="background-color: '+self.color+'"'),self.closeButton&&(closeButton='<button type="button" class="'+prefix+'close" aria-hidden="true">×</button>'),self.progressBar&&(progressBar=self.progressBar.renderHtml()),'<div id="'+self._id+'" class="'+self.classes+'"'+notificationStyle+' role="presentation">'+icon+'<div class="'+prefix+'notification-inner">'+self.state.get("text")+"</div>"+progressBar+closeButton+"</div>"},bindStates:function(){var self=this;return self.state.on("change:text",function(e){self.getEl().childNodes[1].innerHTML=e.value}),self.progressBar&&self.progressBar.bindStates(),self._super()},close:function(){var self=this;return self.fire("close").isDefaultPrevented()||self.remove(),self},repaint:function(){var style,rect,self=this;style=self.getEl().style,rect=self._layoutRect,style.left=rect.x+"px",style.top=rect.y+"px",style.zIndex=131070}})}),define("tinymce/NotificationManager",["tinymce/ui/Notification","tinymce/util/Delay"],function(Notification,Delay){return function(editor){function getLastNotification(){return notifications.length?notifications[notifications.length-1]:void 0}function resizeWindowEvent(){Delay.requestAnimationFrame(function(){prePositionNotifications(),positionNotifications()})}function prePositionNotifications(){for(var i=0;i<notifications.length;i++)notifications[i].moveTo(0,0)}function positionNotifications(){if(notifications.length>0){var firstItem=notifications.slice(0,1)[0],container=editor.inline?editor.getElement():editor.getContentAreaContainer();if(firstItem.moveRel(container,"tc-tc"),notifications.length>1)for(var i=1;i<notifications.length;i++)notifications[i].moveRel(notifications[i-1].getEl(),"bc-tc")}}var self=this,notifications=[];self.notifications=notifications,editor.on("remove",function(){for(var i=notifications.length;i--;)notifications[i].close()}),editor.on("ResizeEditor",positionNotifications),editor.on("ResizeWindow",resizeWindowEvent),self.open=function(args){var notif;return editor.editorManager.setActive(editor),notif=new Notification(args),notifications.push(notif),args.timeout>0&&(notif.timer=setTimeout(function(){notif.close()},args.timeout)),notif.on("close",function(){var i=notifications.length;for(notif.timer&&editor.getWin().clearTimeout(notif.timer);i--;)notifications[i]===notif&&notifications.splice(i,1);positionNotifications()}),notif.renderTo(),positionNotifications(),notif},self.close=function(){getLastNotification()&&getLastNotification().close()},self.getNotifications=function(){return notifications},editor.on("SkinLoaded",function(){var serviceMessage=editor.settings.service_message;serviceMessage&&editor.notificationManager.open({text:serviceMessage,type:"warning",timeout:0,icon:""})})}}),define("tinymce/dom/NodePath",["tinymce/dom/DOMUtils"],function(DOMUtils){function create(rootNode,targetNode,normalized){for(var path=[];targetNode&&targetNode!=rootNode;targetNode=targetNode.parentNode)path.push(DOMUtils.nodeIndex(targetNode,normalized));return path}function resolve(rootNode,path){var i,node,children;for(node=rootNode,i=path.length-1;i>=0;i--){if(children=node.childNodes,path[i]>children.length-1)return null;node=children[path[i]]}return node}return{create:create,resolve:resolve}}),define("tinymce/util/Quirks",["tinymce/util/VK","tinymce/dom/RangeUtils","tinymce/dom/TreeWalker","tinymce/dom/NodePath","tinymce/html/Node","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools","tinymce/util/Delay","tinymce/caret/CaretContainer"],function(VK,RangeUtils,TreeWalker,NodePath,Node,Entities,Env,Tools,Delay,CaretContainer){return function(editor){function setEditorCommandState(cmd,state){try{editor.getDoc().execCommand(cmd,!1,state)}catch(ex){}}function getDocumentMode(){var documentMode=editor.getDoc().documentMode;return documentMode?documentMode:6}function isDefaultPrevented(e){return e.isDefaultPrevented()}function setMceInteralContent(e){var selectionHtml,internalContent;e.dataTransfer&&(editor.selection.isCollapsed()&&"IMG"==e.target.tagName&&selection.select(e.target),selectionHtml=editor.selection.getContent(),selectionHtml.length>0&&(internalContent=mceInternalUrlPrefix+escape(editor.id)+","+escape(selectionHtml),e.dataTransfer.setData(mceInternalDataType,internalContent)))}function getMceInternalContent(e){var internalContent;return e.dataTransfer&&(internalContent=e.dataTransfer.getData(mceInternalDataType),internalContent&&internalContent.indexOf(mceInternalUrlPrefix)>=0)?(internalContent=internalContent.substr(mceInternalUrlPrefix.length).split(","),{id:unescape(internalContent[0]),html:unescape(internalContent[1])}):null}function insertClipboardContents(content){editor.queryCommandSupported("mceInsertClipboardContent")?editor.execCommand("mceInsertClipboardContent",!1,{content:content}):editor.execCommand("mceInsertContent",!1,content)}function cleanupStylesWhenDeleting(){function isTrailingBr(node){var blockElements=dom.schema.getBlockElements(),rootNode=editor.getBody();if("BR"!=node.nodeName)return!1;for(node=node;node!=rootNode&&!blockElements[node.nodeName];node=node.parentNode)if(node.nextSibling)return!1;return!0}function isSiblingsIgnoreWhiteSpace(node1,node2){var node;for(node=node1.nextSibling;node&&node!=node2;node=node.nextSibling)if((3!=node.nodeType||0!==$.trim(node.data).length)&&node!==node2)return!1;return node===node2}function findCaretNode(node,forward,startNode){var walker,current,nonEmptyElements;for(nonEmptyElements=dom.schema.getNonEmptyElements(),walker=new TreeWalker(startNode||node,node);current=walker[forward?"next":"prev"]();){if(nonEmptyElements[current.nodeName]&&!isTrailingBr(current))return current;if(3==current.nodeType&&current.data.length>0)return current}}function deleteRangeBetweenTextBlocks(rng){var startBlock,endBlock,caretNodeBefore,caretNodeAfter,textBlockElements;
return!rng.collapsed&&(startBlock=dom.getParent(RangeUtils.getNode(rng.startContainer,rng.startOffset),dom.isBlock),endBlock=dom.getParent(RangeUtils.getNode(rng.endContainer,rng.endOffset),dom.isBlock),textBlockElements=editor.schema.getTextBlockElements(),startBlock!=endBlock&&textBlockElements[startBlock.nodeName]&&textBlockElements[endBlock.nodeName]&&"false"!==dom.getContentEditable(startBlock)&&"false"!==dom.getContentEditable(endBlock))?(rng.deleteContents(),caretNodeBefore=findCaretNode(startBlock,!1),caretNodeAfter=findCaretNode(endBlock,!0),dom.isEmpty(endBlock)||$(startBlock).append(endBlock.childNodes),$(endBlock).remove(),caretNodeBefore?1==caretNodeBefore.nodeType?"BR"==caretNodeBefore.nodeName?(rng.setStartBefore(caretNodeBefore),rng.setEndBefore(caretNodeBefore)):(rng.setStartAfter(caretNodeBefore),rng.setEndAfter(caretNodeBefore)):(rng.setStart(caretNodeBefore,caretNodeBefore.data.length),rng.setEnd(caretNodeBefore,caretNodeBefore.data.length)):caretNodeAfter&&(1==caretNodeAfter.nodeType?(rng.setStartBefore(caretNodeAfter),rng.setEndBefore(caretNodeAfter)):(rng.setStart(caretNodeAfter,0),rng.setEnd(caretNodeAfter,0))),selection.setRng(rng),!0):void 0}function expandBetweenBlocks(rng,isForward){var caretNode,targetCaretNode,textBlock,targetTextBlock,container,offset;if(!rng.collapsed)return rng;if(container=rng.startContainer,offset=rng.startOffset,3==container.nodeType)if(isForward){if(offset<container.data.length)return rng}else if(offset>0)return rng;if(caretNode=RangeUtils.getNode(rng.startContainer,rng.startOffset),textBlock=dom.getParent(caretNode,dom.isBlock),targetCaretNode=findCaretNode(editor.getBody(),isForward,caretNode),targetTextBlock=dom.getParent(targetCaretNode,dom.isBlock),!caretNode||!targetCaretNode)return rng;if(targetTextBlock&&textBlock!=targetTextBlock)if(isForward){if(!isSiblingsIgnoreWhiteSpace(textBlock,targetTextBlock))return rng;1==caretNode.nodeType?"BR"==caretNode.nodeName?rng.setStartBefore(caretNode):rng.setStartAfter(caretNode):rng.setStart(caretNode,caretNode.data.length),1==targetCaretNode.nodeType?rng.setEnd(targetCaretNode,0):rng.setEndBefore(targetCaretNode)}else{if(!isSiblingsIgnoreWhiteSpace(targetTextBlock,textBlock))return rng;1==targetCaretNode.nodeType?"BR"==targetCaretNode.nodeName?rng.setStartBefore(targetCaretNode):rng.setStartAfter(targetCaretNode):rng.setStart(targetCaretNode,targetCaretNode.data.length),1==caretNode.nodeType?rng.setEnd(caretNode,0):rng.setEndBefore(caretNode)}return rng}function handleTextBlockMergeDelete(isForward){var rng=selection.getRng();return rng=expandBetweenBlocks(rng,isForward),deleteRangeBetweenTextBlocks(rng)?!0:void 0}function handleLastBlockCharacterDelete(isForward,rng){function cloneTextBlockWithFormats(blockElm,node){return currentFormatNodes=$(node).parents().filter(function(idx,node){return!!editor.schema.getTextInlineElements()[node.nodeName]}),newBlockElm=blockElm.cloneNode(!1),currentFormatNodes=Tools.map(currentFormatNodes,function(formatNode){return formatNode=formatNode.cloneNode(!1),newBlockElm.hasChildNodes()?(formatNode.appendChild(newBlockElm.firstChild),newBlockElm.appendChild(formatNode)):newBlockElm.appendChild(formatNode),newBlockElm.appendChild(formatNode),formatNode}),currentFormatNodes.length?(br=dom.create("br"),currentFormatNodes[0].appendChild(br),dom.replace(newBlockElm,blockElm),rng.setStartBefore(br),rng.setEndBefore(br),editor.selection.setRng(rng),br):null}function isTextBlock(node){return node&&editor.schema.getTextBlockElements()[node.tagName]}var path,blockElm,newBlockElm,clonedBlockElm,sibling,container,offset,br,currentFormatNodes;if(rng.collapsed&&(container=rng.startContainer,offset=rng.startOffset,blockElm=dom.getParent(container,dom.isBlock),isTextBlock(blockElm)))if(1==container.nodeType){if(container=container.childNodes[offset],container&&"BR"!=container.tagName)return;if(sibling=isForward?blockElm.nextSibling:blockElm.previousSibling,dom.isEmpty(blockElm)&&isTextBlock(sibling)&&dom.isEmpty(sibling)&&cloneTextBlockWithFormats(blockElm,container))return dom.remove(sibling),!0}else if(3==container.nodeType){if(path=NodePath.create(blockElm,container),clonedBlockElm=blockElm.cloneNode(!0),container=NodePath.resolve(clonedBlockElm,path),isForward){if(offset>=container.data.length)return;container.deleteData(offset,1)}else{if(0>=offset)return;container.deleteData(offset-1,1)}if(dom.isEmpty(clonedBlockElm))return cloneTextBlockWithFormats(blockElm,container)}}function customDelete(isForward){var mutationObserver,rng,caretElement;handleTextBlockMergeDelete(isForward)||(Tools.each(editor.getBody().getElementsByTagName("*"),function(elm){"SPAN"==elm.tagName&&elm.setAttribute("mce-data-marked",1),!elm.hasAttribute("data-mce-style")&&elm.hasAttribute("style")&&editor.dom.setAttrib(elm,"style",editor.dom.getAttrib(elm,"style"))}),mutationObserver=new MutationObserver(function(){}),mutationObserver.observe(editor.getDoc(),{childList:!0,attributes:!0,subtree:!0,attributeFilter:["style"]}),editor.getDoc().execCommand(isForward?"ForwardDelete":"Delete",!1,null),rng=editor.selection.getRng(),caretElement=rng.startContainer.parentNode,Tools.each(mutationObserver.takeRecords(),function(record){if(dom.isChildOf(record.target,editor.getBody())){if("style"==record.attributeName){var oldValue=record.target.getAttribute("data-mce-style");oldValue?record.target.setAttribute("style",oldValue):record.target.removeAttribute("style")}Tools.each(record.addedNodes,function(node){if("SPAN"==node.nodeName&&!node.getAttribute("mce-data-marked")){var offset,container;node==caretElement&&(offset=rng.startOffset,container=node.firstChild),dom.remove(node,!0),container&&(rng.setStart(container,offset),rng.setEnd(container,offset),editor.selection.setRng(rng))}})}}),mutationObserver.disconnect(),Tools.each(editor.dom.select("span[mce-data-marked]"),function(span){span.removeAttribute("mce-data-marked")}))}var olderWebKit,dragStartRng,doc=editor.getDoc(),dom=editor.dom,selection=editor.selection,MutationObserver=window.MutationObserver;MutationObserver||(olderWebKit=!0,MutationObserver=function(){function nodeInsert(e){var target=e.relatedNode||e.target;records.push({target:target,addedNodes:[target]})}function attrModified(e){var target=e.relatedNode||e.target;records.push({target:target,attributeName:e.attrName})}var target,records=[];this.observe=function(node){target=node,target.addEventListener("DOMSubtreeModified",nodeInsert,!1),target.addEventListener("DOMNodeInsertedIntoDocument",nodeInsert,!1),target.addEventListener("DOMNodeInserted",nodeInsert,!1),target.addEventListener("DOMAttrModified",attrModified,!1)},this.disconnect=function(){target.removeEventListener("DOMSubtreeModified",nodeInsert,!1),target.removeEventListener("DOMNodeInsertedIntoDocument",nodeInsert,!1),target.removeEventListener("DOMNodeInserted",nodeInsert,!1),target.removeEventListener("DOMAttrModified",attrModified,!1)},this.takeRecords=function(){return records}}),editor.on("keydown",function(e){var isForward=e.keyCode==DELETE,isMetaOrCtrl=e.ctrlKey||e.metaKey;if(!isDefaultPrevented(e)&&(isForward||e.keyCode==BACKSPACE)){var rng=editor.selection.getRng(),container=rng.startContainer,offset=rng.startOffset;if(isForward&&e.shiftKey)return;if(handleLastBlockCharacterDelete(isForward,rng))return void e.preventDefault();if(!isMetaOrCtrl&&rng.collapsed&&3==container.nodeType&&(isForward?offset<container.data.length:offset>0))return;e.preventDefault(),isMetaOrCtrl&&editor.selection.getSel().modify("extend",isForward?"forward":"backward",e.metaKey?"lineboundary":"word"),customDelete(isForward)}}),editor.on("keypress",function(e){if(!isDefaultPrevented(e)&&!selection.isCollapsed()&&e.charCode>31&&!VK.metaKeyPressed(e)){var rng,currentFormatNodes,fragmentNode,blockParent,caretNode,charText;rng=editor.selection.getRng(),charText=String.fromCharCode(e.charCode),e.preventDefault(),currentFormatNodes=$(rng.startContainer).parents().filter(function(idx,node){return!!editor.schema.getTextInlineElements()[node.nodeName]}),customDelete(!0),currentFormatNodes=currentFormatNodes.filter(function(idx,node){return!$.contains(editor.getBody(),node)}),currentFormatNodes.length?(fragmentNode=dom.createFragment(),currentFormatNodes.each(function(idx,formatNode){formatNode=formatNode.cloneNode(!1),fragmentNode.hasChildNodes()?(formatNode.appendChild(fragmentNode.firstChild),fragmentNode.appendChild(formatNode)):(caretNode=formatNode,fragmentNode.appendChild(formatNode)),fragmentNode.appendChild(formatNode)}),caretNode.appendChild(editor.getDoc().createTextNode(charText)),blockParent=dom.getParent(rng.startContainer,dom.isBlock),dom.isEmpty(blockParent)?$(blockParent).empty().append(fragmentNode):rng.insertNode(fragmentNode),rng.setStart(caretNode.firstChild,1),rng.setEnd(caretNode.firstChild,1),editor.selection.setRng(rng)):editor.selection.setContent(charText)}}),editor.addCommand("Delete",function(){customDelete()}),editor.addCommand("ForwardDelete",function(){customDelete(!0)}),olderWebKit||(editor.on("dragstart",function(e){dragStartRng=selection.getRng(),setMceInteralContent(e)}),editor.on("drop",function(e){if(!isDefaultPrevented(e)){var internalContent=getMceInternalContent(e);internalContent&&(e.preventDefault(),Delay.setEditorTimeout(editor,function(){var pointRng=RangeUtils.getCaretRangeFromPoint(e.x,e.y,doc);dragStartRng&&(selection.setRng(dragStartRng),dragStartRng=null),customDelete(),selection.setRng(pointRng),insertClipboardContents(internalContent.html)}))}}),editor.on("cut",function(e){isDefaultPrevented(e)||!e.clipboardData||editor.selection.isCollapsed()||(e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/html",editor.selection.getContent()),e.clipboardData.setData("text/plain",editor.selection.getContent({format:"text"})),Delay.setEditorTimeout(editor,function(){customDelete(!0)}))}))}function emptyEditorWhenDeleting(){function serializeRng(rng){var body=dom.create("body"),contents=rng.cloneContents();return body.appendChild(contents),selection.serializer.serialize(body,{format:"html"})}function allContentsSelected(rng){if(!rng.setStart){if(rng.item)return!1;var bodyRng=rng.duplicate();return bodyRng.moveToElementText(editor.getBody()),RangeUtils.compareRanges(rng,bodyRng)}var selection=serializeRng(rng),allRng=dom.createRng();allRng.selectNode(editor.getBody());var allSelection=serializeRng(allRng);return selection===allSelection}editor.on("keydown",function(e){var isCollapsed,body,keyCode=e.keyCode;if(!isDefaultPrevented(e)&&(keyCode==DELETE||keyCode==BACKSPACE)){if(isCollapsed=editor.selection.isCollapsed(),body=editor.getBody(),isCollapsed&&!dom.isEmpty(body))return;if(!isCollapsed&&!allContentsSelected(editor.selection.getRng()))return;e.preventDefault(),editor.setContent(""),body.firstChild&&dom.isBlock(body.firstChild)?editor.selection.setCursorLocation(body.firstChild,0):editor.selection.setCursorLocation(body,0),editor.nodeChanged()}})}function selectAll(){editor.shortcuts.add("meta+a",null,"SelectAll")}function inputMethodFocus(){editor.settings.content_editable||dom.bind(editor.getDoc(),"mousedown mouseup",function(e){var rng;if(e.target==editor.getDoc().documentElement)if(rng=selection.getRng(),editor.getBody().focus(),"mousedown"==e.type){if(CaretContainer.isCaretContainer(rng.startContainer))return;selection.placeCaretAt(e.clientX,e.clientY)}else selection.setRng(rng)})}function removeHrOnBackspace(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE){if(!editor.getBody().getElementsByTagName("hr").length)return;if(selection.isCollapsed()&&0===selection.getRng(!0).startOffset){var node=selection.getNode(),previousSibling=node.previousSibling;if("HR"==node.nodeName)return dom.remove(node),void e.preventDefault();previousSibling&&previousSibling.nodeName&&"hr"===previousSibling.nodeName.toLowerCase()&&(dom.remove(previousSibling),e.preventDefault())}}})}function focusBody(){window.Range.prototype.getClientRects||editor.on("mousedown",function(e){if(!isDefaultPrevented(e)&&"HTML"===e.target.nodeName){var body=editor.getBody();body.blur(),Delay.setEditorTimeout(editor,function(){body.focus()})}})}function selectControlElements(){editor.on("click",function(e){var target=e.target;/^(IMG|HR)$/.test(target.nodeName)&&"false"!==dom.getContentEditableParent(target)&&(e.preventDefault(),selection.getSel().setBaseAndExtent(target,0,target,1),editor.nodeChanged()),"A"==target.nodeName&&dom.hasClass(target,"mce-item-anchor")&&(e.preventDefault(),selection.select(target))})}function removeStylesWhenDeletingAcrossBlockElements(){function getAttributeApplyFunction(){var template=dom.getAttribs(selection.getStart().cloneNode(!1));return function(){var target=selection.getStart();target!==editor.getBody()&&(dom.setAttrib(target,"style",null),each(template,function(attr){target.setAttributeNode(attr.cloneNode(!0))}))}}function isSelectionAcrossElements(){return!selection.isCollapsed()&&dom.getParent(selection.getStart(),dom.isBlock)!=dom.getParent(selection.getEnd(),dom.isBlock)}editor.on("keypress",function(e){var applyAttributes;return isDefaultPrevented(e)||8!=e.keyCode&&46!=e.keyCode||!isSelectionAcrossElements()?void 0:(applyAttributes=getAttributeApplyFunction(),editor.getDoc().execCommand("delete",!1,null),applyAttributes(),e.preventDefault(),!1)}),dom.bind(editor.getDoc(),"cut",function(e){var applyAttributes;!isDefaultPrevented(e)&&isSelectionAcrossElements()&&(applyAttributes=getAttributeApplyFunction(),Delay.setEditorTimeout(editor,function(){applyAttributes()}))})}function ensureBodyHasRoleApplication(){document.body.setAttribute("role","application")}function disableBackspaceIntoATable(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE&&selection.isCollapsed()&&0===selection.getRng(!0).startOffset){var previousSibling=selection.getNode().previousSibling;if(previousSibling&&previousSibling.nodeName&&"table"===previousSibling.nodeName.toLowerCase())return e.preventDefault(),!1}})}function addNewLinesBeforeBrInPre(){getDocumentMode()>7||(setEditorCommandState("RespectVisibilityInDesign",!0),editor.contentStyles.push(".mceHideBrInPre pre br {display: none}"),dom.addClass(editor.getBody(),"mceHideBrInPre"),parser.addNodeFilter("pre",function(nodes){for(var brNodes,j,brElm,sibling,i=nodes.length;i--;)for(brNodes=nodes[i].getAll("br"),j=brNodes.length;j--;)brElm=brNodes[j],sibling=brElm.prev,sibling&&3===sibling.type&&"\n"!=sibling.value.charAt(sibling.value-1)?sibling.value+="\n":brElm.parent.insert(new Node("#text",3),brElm,!0).value="\n"}),serializer.addNodeFilter("pre",function(nodes){for(var brNodes,j,brElm,sibling,i=nodes.length;i--;)for(brNodes=nodes[i].getAll("br"),j=brNodes.length;j--;)brElm=brNodes[j],sibling=brElm.prev,sibling&&3==sibling.type&&(sibling.value=sibling.value.replace(/\r?\n$/,""))}))}function removePreSerializedStylesWhenSelectingControls(){dom.bind(editor.getBody(),"mouseup",function(){var value,node=selection.getNode();"IMG"==node.nodeName&&((value=dom.getStyle(node,"width"))&&(dom.setAttrib(node,"width",value.replace(/[^0-9%]+/g,"")),dom.setStyle(node,"width","")),(value=dom.getStyle(node,"height"))&&(dom.setAttrib(node,"height",value.replace(/[^0-9%]+/g,"")),dom.setStyle(node,"height","")))})}function removeBlockQuoteOnBackSpace(){editor.on("keydown",function(e){var rng,container,offset,root,parent;if(!isDefaultPrevented(e)&&e.keyCode==VK.BACKSPACE&&(rng=selection.getRng(),container=rng.startContainer,offset=rng.startOffset,root=dom.getRoot(),parent=container,rng.collapsed&&0===offset)){for(;parent&&parent.parentNode&&parent.parentNode.firstChild==parent&&parent.parentNode!=root;)parent=parent.parentNode;"BLOCKQUOTE"===parent.tagName&&(editor.formatter.toggle("blockquote",null,parent),rng=dom.createRng(),rng.setStart(container,0),rng.setEnd(container,0),selection.setRng(rng))}})}function setGeckoEditingOptions(){function setOpts(){editor._refreshContentEditable(),setEditorCommandState("StyleWithCSS",!1),setEditorCommandState("enableInlineTableEditing",!1),settings.object_resizing||setEditorCommandState("enableObjectResizing",!1)}settings.readonly||editor.on("BeforeExecCommand MouseDown",setOpts)}function addBrAfterLastLinks(){function fixLinks(){each(dom.select("a"),function(node){var parentNode=node.parentNode,root=dom.getRoot();if(parentNode.lastChild===node){for(;parentNode&&!dom.isBlock(parentNode);){if(parentNode.parentNode.lastChild!==parentNode||parentNode===root)return;parentNode=parentNode.parentNode}dom.add(parentNode,"br",{"data-mce-bogus":1})}})}editor.on("SetContent ExecCommand",function(e){"setcontent"!=e.type&&"mceInsertLink"!==e.command||fixLinks()})}function setDefaultBlockType(){settings.forced_root_block&&editor.on("init",function(){setEditorCommandState("DefaultParagraphSeparator",settings.forced_root_block)})}function deleteControlItemOnBackSpace(){editor.on("keydown",function(e){var rng;isDefaultPrevented(e)||e.keyCode!=BACKSPACE||(rng=editor.getDoc().selection.createRange(),rng&&rng.item&&(e.preventDefault(),editor.undoManager.beforeChange(),dom.remove(rng.item(0)),editor.undoManager.add()))})}function renderEmptyBlocksFix(){var emptyBlocksCSS;getDocumentMode()>=10&&(emptyBlocksCSS="",each("p div h1 h2 h3 h4 h5 h6".split(" "),function(name,i){emptyBlocksCSS+=(i>0?",":"")+name+":empty"}),editor.contentStyles.push(emptyBlocksCSS+"{padding-right: 1px !important}"))}function keepNoScriptContents(){getDocumentMode()<9&&(parser.addNodeFilter("noscript",function(nodes){for(var node,textNode,i=nodes.length;i--;)node=nodes[i],textNode=node.firstChild,textNode&&node.attr("data-mce-innertext",textNode.value)}),serializer.addNodeFilter("noscript",function(nodes){for(var node,textNode,value,i=nodes.length;i--;)node=nodes[i],textNode=nodes[i].firstChild,textNode?textNode.value=Entities.decode(textNode.value):(value=node.attributes.map["data-mce-innertext"],value&&(node.attr("data-mce-innertext",null),textNode=new Node("#text",3),textNode.value=value,textNode.raw=!0,node.append(textNode)))}))}function fixCaretSelectionOfDocumentElementOnIe(){function rngFromPoint(x,y){var rng=body.createTextRange();try{rng.moveToPoint(x,y)}catch(ex){rng=null}return rng}function selectionChange(e){var pointRng;e.button?(pointRng=rngFromPoint(e.x,e.y),pointRng&&(pointRng.compareEndPoints("StartToStart",startRng)>0?pointRng.setEndPoint("StartToStart",startRng):pointRng.setEndPoint("EndToEnd",startRng),pointRng.select())):endSelection()}function endSelection(){var rng=doc.selection.createRange();startRng&&!rng.item&&0===rng.compareEndPoints("StartToEnd",rng)&&startRng.select(),dom.unbind(doc,"mouseup",endSelection),dom.unbind(doc,"mousemove",selectionChange),startRng=started=0}var started,startRng,htmlElm,doc=dom.doc,body=doc.body;doc.documentElement.unselectable=!0,dom.bind(doc,"mousedown contextmenu",function(e){if("HTML"===e.target.nodeName){if(started&&endSelection(),htmlElm=doc.documentElement,htmlElm.scrollHeight>htmlElm.clientHeight)return;started=1,startRng=rngFromPoint(e.x,e.y),startRng&&(dom.bind(doc,"mouseup",endSelection),dom.bind(doc,"mousemove",selectionChange),dom.getRoot().focus(),startRng.select())}})}function normalizeSelection(){editor.on("keyup focusin mouseup",function(e){65==e.keyCode&&VK.metaKeyPressed(e)||selection.normalize()},!0)}function showBrokenImageIcon(){editor.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")}function restoreFocusOnKeyDown(){editor.inline||editor.on("keydown",function(){document.activeElement==document.body&&editor.getWin().focus()})}function bodyHeight(){editor.inline||(editor.contentStyles.push("body {min-height: 150px}"),editor.on("click",function(e){var rng;if("HTML"==e.target.nodeName){if(Env.ie>11)return void editor.getBody().focus();rng=editor.selection.getRng(),editor.getBody().focus(),editor.selection.setRng(rng),editor.selection.normalize(),editor.nodeChanged()}}))}function blockCmdArrowNavigation(){Env.mac&&editor.on("keydown",function(e){!VK.metaKeyPressed(e)||e.shiftKey||37!=e.keyCode&&39!=e.keyCode||(e.preventDefault(),editor.selection.getSel().modify("move",37==e.keyCode?"backward":"forward","lineboundary"))})}function disableAutoUrlDetect(){setEditorCommandState("AutoUrlDetect",!1)}function tapLinksAndImages(){editor.on("click",function(e){var elm=e.target;do if("A"===elm.tagName)return void e.preventDefault();while(elm=elm.parentNode)}),editor.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")}function blockFormSubmitInsideEditor(){editor.on("init",function(){editor.dom.bind(editor.getBody(),"submit",function(e){e.preventDefault()})})}function removeAppleInterchangeBrs(){parser.addNodeFilter("br",function(nodes){for(var i=nodes.length;i--;)"Apple-interchange-newline"==nodes[i].attr("class")&&nodes[i].remove()})}function ieInternalDragAndDrop(){editor.on("dragstart",function(e){setMceInteralContent(e)}),editor.on("drop",function(e){if(!isDefaultPrevented(e)){var internalContent=getMceInternalContent(e);if(internalContent&&internalContent.id!=editor.id){e.preventDefault();var rng=RangeUtils.getCaretRangeFromPoint(e.x,e.y,editor.getDoc());selection.setRng(rng),insertClipboardContents(internalContent.html)}}})}var each=Tools.each,$=editor.$,BACKSPACE=VK.BACKSPACE,DELETE=VK.DELETE,dom=editor.dom,selection=editor.selection,settings=editor.settings,parser=editor.parser,serializer=editor.serializer,isGecko=Env.gecko,isIE=Env.ie,isWebKit=Env.webkit,mceInternalUrlPrefix="data:text/mce-internal,",mceInternalDataType=isIE?"Text":"URL";removeBlockQuoteOnBackSpace(),emptyEditorWhenDeleting(),Env.windowsPhone||normalizeSelection(),isWebKit&&(cleanupStylesWhenDeleting(),inputMethodFocus(),selectControlElements(),setDefaultBlockType(),blockFormSubmitInsideEditor(),disableBackspaceIntoATable(),removeAppleInterchangeBrs(),Env.iOS?(restoreFocusOnKeyDown(),bodyHeight(),tapLinksAndImages()):selectAll()),isIE&&Env.ie<11&&(removeHrOnBackspace(),ensureBodyHasRoleApplication(),addNewLinesBeforeBrInPre(),removePreSerializedStylesWhenSelectingControls(),deleteControlItemOnBackSpace(),renderEmptyBlocksFix(),keepNoScriptContents(),fixCaretSelectionOfDocumentElementOnIe()),Env.ie>=11&&(bodyHeight(),disableBackspaceIntoATable()),Env.ie&&(selectAll(),disableAutoUrlDetect(),ieInternalDragAndDrop()),isGecko&&(removeHrOnBackspace(),focusBody(),removeStylesWhenDeletingAcrossBlockElements(),setGeckoEditingOptions(),addBrAfterLastLinks(),showBrokenImageIcon(),blockCmdArrowNavigation(),disableBackspaceIntoATable())}}),define("tinymce/EditorObservable",["tinymce/util/Observable","tinymce/dom/DOMUtils","tinymce/util/Tools"],function(Observable,DOMUtils,Tools){function getEventTarget(editor,eventName){return"selectionchange"==eventName?editor.getDoc():!editor.inline&&/^mouse|click|contextmenu|drop|dragover|dragend/.test(eventName)?editor.getDoc().documentElement:editor.settings.event_root?(editor.eventRoot||(editor.eventRoot=DOM.select(editor.settings.event_root)[0]),editor.eventRoot):editor.getBody()}function bindEventDelegate(editor,eventName){function isListening(editor){return!editor.hidden&&!editor.readonly}var delegate,eventRootElm=getEventTarget(editor,eventName);if(editor.delegates||(editor.delegates={}),!editor.delegates[eventName])if(editor.settings.event_root){if(customEventRootDelegates||(customEventRootDelegates={},editor.editorManager.on("removeEditor",function(){var name;if(!editor.editorManager.activeEditor&&customEventRootDelegates){for(name in customEventRootDelegates)editor.dom.unbind(getEventTarget(editor,name));customEventRootDelegates=null}})),customEventRootDelegates[eventName])return;delegate=function(e){for(var target=e.target,editors=editor.editorManager.editors,i=editors.length;i--;){var body=editors[i].getBody();(body===target||DOM.isChildOf(target,body))&&isListening(editors[i])&&editors[i].fire(eventName,e)}},customEventRootDelegates[eventName]=delegate,DOM.bind(eventRootElm,eventName,delegate)}else delegate=function(e){isListening(editor)&&editor.fire(eventName,e)},DOM.bind(eventRootElm,eventName,delegate),editor.delegates[eventName]=delegate}var customEventRootDelegates,DOM=DOMUtils.DOM,EditorObservable={bindPendingEventDelegates:function(){var self=this;Tools.each(self._pendingNativeEvents,function(name){bindEventDelegate(self,name)})},toggleNativeEvent:function(name,state){var self=this;"focus"!=name&&"blur"!=name&&(state?self.initialized?bindEventDelegate(self,name):self._pendingNativeEvents?self._pendingNativeEvents.push(name):self._pendingNativeEvents=[name]:self.initialized&&(self.dom.unbind(getEventTarget(self,name),name,self.delegates[name]),delete self.delegates[name]))},unbindAllNativeEvents:function(){var name,self=this;if(self.delegates){for(name in self.delegates)self.dom.unbind(getEventTarget(self,name),name,self.delegates[name]);delete self.delegates}self.inline||(self.getBody().onload=null,self.dom.unbind(self.getWin()),self.dom.unbind(self.getDoc())),self.dom.unbind(self.getBody()),self.dom.unbind(self.getContainer())}};return EditorObservable=Tools.extend({},Observable,EditorObservable)}),define("tinymce/Mode",[],function(){function setEditorCommandState(editor,cmd,state){try{editor.getDoc().execCommand(cmd,!1,state)}catch(ex){}}function setMode(editor,mode){var currentMode=editor.readonly?"readonly":"design";mode!=currentMode&&("readonly"==mode?(editor.selection.controlSelection.hideResizeRect(),editor.readonly=!0,editor.getBody().contentEditable=!1):(editor.readonly=!1,editor.getBody().contentEditable=!0,setEditorCommandState(editor,"StyleWithCSS",!1),setEditorCommandState(editor,"enableInlineTableEditing",!1),setEditorCommandState(editor,"enableObjectResizing",!1),editor.focus(),editor.nodeChanged()),editor.fire("SwitchMode",{mode:mode}))}return{setMode:setMode}}),define("tinymce/Shortcuts",["tinymce/util/Tools","tinymce/Env"],function(Tools,Env){var each=Tools.each,explode=Tools.explode,keyCodeLookup={f9:120,f10:121,f11:122},modifierNames=Tools.makeMap("alt,ctrl,shift,meta,access");return function(editor){function createShortcut(pattern,desc,cmdFunc,scope){var id,key,shortcut;shortcut={func:cmdFunc,scope:scope||editor,desc:editor.translate(desc)},each(explode(pattern,"+"),function(value){value in modifierNames?shortcut[value]=!0:/^[0-9]{2,}$/.test(value)?shortcut.keyCode=parseInt(value,10):(shortcut.charCode=value.charCodeAt(0),shortcut.keyCode=keyCodeLookup[value]||value.toUpperCase().charCodeAt(0))}),id=[shortcut.keyCode];for(key in modifierNames)shortcut[key]?id.push(key):shortcut[key]=!1;return shortcut.id=id.join(","),shortcut.access&&(shortcut.alt=!0,Env.mac?shortcut.ctrl=!0:shortcut.shift=!0),shortcut.meta&&(Env.mac?shortcut.meta=!0:(shortcut.ctrl=!0,shortcut.meta=!1)),shortcut}var self=this,shortcuts={};editor.on("keyup keypress keydown",function(e){(e.altKey||e.ctrlKey||e.metaKey)&&!e.isDefaultPrevented()&&each(shortcuts,function(shortcut){return shortcut.ctrl==e.ctrlKey&&shortcut.meta==e.metaKey&&shortcut.alt==e.altKey&&shortcut.shift==e.shiftKey&&(e.keyCode==shortcut.keyCode||e.charCode&&e.charCode==shortcut.charCode)?(e.preventDefault(),"keydown"==e.type&&shortcut.func.call(shortcut.scope),!0):void 0})}),self.add=function(pattern,desc,cmdFunc,scope){var cmd;return cmd=cmdFunc,"string"==typeof cmdFunc?cmdFunc=function(){editor.execCommand(cmd,!1,null)}:Tools.isArray(cmd)&&(cmdFunc=function(){editor.execCommand(cmd[0],cmd[1],cmd[2])}),each(explode(pattern.toLowerCase()),function(pattern){var shortcut=createShortcut(pattern,desc,cmdFunc,scope);shortcuts[shortcut.id]=shortcut}),!0},self.remove=function(pattern){var shortcut=createShortcut(pattern);return shortcuts[shortcut.id]?(delete shortcuts[shortcut.id],!0):!1}}}),define("tinymce/file/Uploader",["tinymce/util/Promise","tinymce/util/Tools","tinymce/util/Fun"],function(Promise,Tools,Fun){return function(settings){function fileName(blobInfo){var ext,extensions;return extensions={"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png"},ext=extensions[blobInfo.blob().type.toLowerCase()]||"dat",blobInfo.id()+"."+ext}function pathJoin(path1,path2){return path1?path1.replace(/\/$/,"")+"/"+path2.replace(/^\//,""):path2}function blobInfoToData(blobInfo){return{id:blobInfo.id,blob:blobInfo.blob,base64:blobInfo.base64,filename:Fun.constant(fileName(blobInfo))}}function defaultHandler(blobInfo,success,failure,openNotification){var xhr,formData,notification;xhr=new XMLHttpRequest,xhr.open("POST",settings.url),xhr.withCredentials=settings.credentials,notification=openNotification(),xhr.upload.onprogress=function(e){var percentLoaded=Math.round(e.loaded/e.total*100);notification.progressBar.value(percentLoaded)},xhr.onload=function(){var json;return notification.close(),200!=xhr.status?void failure("HTTP Error: "+xhr.status):(json=JSON.parse(xhr.responseText),json&&"string"==typeof json.location?void success(pathJoin(settings.basePath,json.location)):void failure("Invalid JSON: "+xhr.responseText))},formData=new FormData,formData.append("file",blobInfo.blob(),fileName(blobInfo)),xhr.send(formData)}function noUpload(){return new Promise(function(resolve){resolve([])})}function interpretResult(promise){return promise.then(function(result){return result})["catch"](function(error){return error})}function registerPromise(handler,id,blobInfo){var response=handler(blobInfo),promise=interpretResult(response);return delete cachedPromises[id],cachedPromises[id]=promise,promise}function collectUploads(blobInfos,uploadBlobInfo){return Tools.map(blobInfos,function(blobInfo){var id=blobInfo.id();return cachedPromises[id]?cachedPromises[id]:registerPromise(uploadBlobInfo,id,blobInfo)})}function uploadBlobs(blobInfos,openNotification){function uploadBlobInfo(blobInfo){return new Promise(function(resolve){var handler=settings.handler;handler(blobInfoToData(blobInfo),function(url){resolve({url:url,blobInfo:blobInfo,status:!0})},function(failure){resolve({url:"",blobInfo:blobInfo,status:!1,error:failure})},openNotification)})}var promises=collectUploads(blobInfos,uploadBlobInfo);return Promise.all(promises)}function upload(blobInfos,openNotification){return settings.url||settings.handler!==defaultHandler?uploadBlobs(blobInfos,openNotification):noUpload()}var cachedPromises={};return settings=Tools.extend({credentials:!1,handler:defaultHandler},settings),{upload:upload}}}),define("tinymce/file/Conversions",["tinymce/util/Promise"],function(Promise){function blobUriToBlob(url){return new Promise(function(resolve){var xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="blob",xhr.onload=function(){200==this.status&&resolve(this.response)},xhr.send()})}function parseDataUri(uri){var type,matches;return uri=decodeURIComponent(uri).split(","),matches=/data:([^;]+)/.exec(uri[0]),matches&&(type=matches[1]),{type:type,data:uri[1]}}function dataUriToBlob(uri){return new Promise(function(resolve){var str,arr,i;uri=parseDataUri(uri);try{str=atob(uri.data)}catch(e){return void resolve(new Blob([]))}for(arr=new Uint8Array(str.length),i=0;i<arr.length;i++)arr[i]=str.charCodeAt(i);resolve(new Blob([arr],{type:uri.type}))})}function uriToBlob(url){return 0===url.indexOf("blob:")?blobUriToBlob(url):0===url.indexOf("data:")?dataUriToBlob(url):null}function blobToDataUri(blob){return new Promise(function(resolve){var reader=new FileReader;reader.onloadend=function(){resolve(reader.result)},reader.readAsDataURL(blob)})}return{uriToBlob:uriToBlob,blobToDataUri:blobToDataUri,parseDataUri:parseDataUri}}),define("tinymce/file/ImageScanner",["tinymce/util/Promise","tinymce/util/Arr","tinymce/util/Fun","tinymce/file/Conversions","tinymce/Env"],function(Promise,Arr,Fun,Conversions,Env){var count=0;return function(blobCache){function findAll(elm,predicate){function imageToBlobInfo(img,resolve){var base64,blobInfo;return 0===img.src.indexOf("blob:")?(blobInfo=blobCache.getByUri(img.src),void(blobInfo&&resolve({image:img,blobInfo:blobInfo}))):(base64=Conversions.parseDataUri(img.src).data,blobInfo=blobCache.findFirst(function(cachedBlobInfo){
return cachedBlobInfo.base64()===base64}),void(blobInfo?resolve({image:img,blobInfo:blobInfo}):Conversions.uriToBlob(img.src).then(function(blob){var blobInfoId="blobid"+count++,blobInfo=blobCache.create(blobInfoId,blob,base64);blobCache.add(blobInfo),resolve({image:img,blobInfo:blobInfo})})))}var images,promises;return predicate||(predicate=Fun.constant(!0)),images=Arr.filter(elm.getElementsByTagName("img"),function(img){var src=img.src;return Env.fileApi?img.hasAttribute("data-mce-bogus")?!1:img.hasAttribute("data-mce-placeholder")?!1:src&&src!=Env.transparentSrc?0===src.indexOf("blob:")?!0:0===src.indexOf("data:")?predicate(img):!1:!1:!1}),promises=Arr.map(images,function(img){var newPromise;return cachedPromises[img.src]?new Promise(function(resolve){cachedPromises[img.src].then(function(imageInfo){resolve({image:img,blobInfo:imageInfo.blobInfo})})}):(newPromise=new Promise(function(resolve){imageToBlobInfo(img,resolve)}).then(function(result){return delete cachedPromises[result.image.src],result})["catch"](function(error){return delete cachedPromises[img.src],error}),cachedPromises[img.src]=newPromise,newPromise)}),Promise.all(promises)}var cachedPromises={};return{findAll:findAll}}}),define("tinymce/file/BlobCache",["tinymce/util/Arr","tinymce/util/Fun"],function(Arr,Fun){return function(){function create(id,blob,base64){return{id:constant(id),blob:constant(blob),base64:constant(base64),blobUri:constant(URL.createObjectURL(blob))}}function add(blobInfo){get(blobInfo.id())||cache.push(blobInfo)}function get(id){return findFirst(function(cachedBlobInfo){return cachedBlobInfo.id()===id})}function findFirst(predicate){return Arr.filter(cache,predicate)[0]}function getByUri(blobUri){return findFirst(function(blobInfo){return blobInfo.blobUri()==blobUri})}function destroy(){Arr.each(cache,function(cachedBlobInfo){URL.revokeObjectURL(cachedBlobInfo.blobUri())}),cache=[]}var cache=[],constant=Fun.constant;return{create:create,add:add,get:get,getByUri:getByUri,findFirst:findFirst,destroy:destroy}}}),define("tinymce/EditorUpload",["tinymce/util/Arr","tinymce/file/Uploader","tinymce/file/ImageScanner","tinymce/file/BlobCache"],function(Arr,Uploader,ImageScanner,BlobCache){return function(editor){function aliveGuard(callback){return function(result){return editor.selection?callback(result):[]}}function replaceString(content,search,replace){var index=0;do index=content.indexOf(search,index),-1!==index&&(content=content.substring(0,index)+replace+content.substr(index+search.length),index+=replace.length-search.length+1);while(-1!==index);return content}function replaceImageUrl(content,targetUrl,replacementUrl){return content=replaceString(content,'src="'+targetUrl+'"','src="'+replacementUrl+'"'),content=replaceString(content,'data-mce-src="'+targetUrl+'"','data-mce-src="'+replacementUrl+'"')}function replaceUrlInUndoStack(targetUrl,replacementUrl){Arr.each(editor.undoManager.data,function(level){level.content=replaceImageUrl(level.content,targetUrl,replacementUrl)})}function openNotification(){return editor.notificationManager.open({text:editor.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})}function uploadImages(callback){return uploader||(uploader=new Uploader({url:settings.images_upload_url,basePath:settings.images_upload_base_path,credentials:settings.images_upload_credentials,handler:settings.images_upload_handler})),scanForImages().then(aliveGuard(function(imageInfos){var blobInfos;return blobInfos=Arr.map(imageInfos,function(imageInfo){return imageInfo.blobInfo}),uploader.upload(blobInfos,openNotification).then(aliveGuard(function(result){return result=Arr.map(result,function(uploadInfo,index){var image=imageInfos[index].image;return replaceUrlInUndoStack(image.src,uploadInfo.url),editor.$(image).attr({src:uploadInfo.url,"data-mce-src":editor.convertURL(uploadInfo.url,"src")}),{element:image,status:uploadInfo.status}}),callback&&callback(result),result}))}))}function uploadImagesAuto(callback){return settings.automatic_uploads!==!1?uploadImages(callback):void 0}function scanForImages(){return imageScanner||(imageScanner=new ImageScanner(blobCache)),imageScanner.findAll(editor.getBody(),settings.images_dataimg_filter).then(aliveGuard(function(result){return Arr.each(result,function(resultItem){replaceUrlInUndoStack(resultItem.image.src,resultItem.blobInfo.blobUri()),resultItem.image.src=resultItem.blobInfo.blobUri()}),result}))}function destroy(){blobCache.destroy(),imageScanner=uploader=null}function replaceBlobWithBase64(content){return content.replace(/src="(blob:[^"]+)"/g,function(match,blobUri){var blobInfo=blobCache.getByUri(blobUri);return blobInfo||(blobInfo=Arr.reduce(editor.editorManager.editors,function(result,editor){return result||editor.editorUpload.blobCache.getByUri(blobUri)},null)),blobInfo?'src="data:'+blobInfo.blob().type+";base64,"+blobInfo.base64()+'"':match})}var uploader,imageScanner,blobCache=new BlobCache,settings=editor.settings;return editor.on("setContent",function(){editor.settings.automatic_uploads!==!1?uploadImagesAuto():scanForImages()}),editor.on("RawSaveContent",function(e){e.content=replaceBlobWithBase64(e.content)}),editor.on("getContent",function(e){e.source_view||"raw"==e.format||(e.content=replaceBlobWithBase64(e.content))}),{blobCache:blobCache,uploadImages:uploadImages,uploadImagesAuto:uploadImagesAuto,scanForImages:scanForImages,destroy:destroy}}}),define("tinymce/caret/CaretUtils",["tinymce/util/Fun","tinymce/dom/TreeWalker","tinymce/dom/NodeType","tinymce/caret/CaretPosition","tinymce/caret/CaretContainer","tinymce/caret/CaretCandidate"],function(Fun,TreeWalker,NodeType,CaretPosition,CaretContainer,CaretCandidate){function isForwards(direction){return direction>0}function isBackwards(direction){return 0>direction}function findNode(node,direction,predicateFn,rootNode,shallow){var walker=new TreeWalker(node,rootNode);if(isBackwards(direction)){if(isContentEditableFalse(node)&&(node=walker.prev(!0),predicateFn(node)))return node;for(;node=walker.prev(shallow);)if(predicateFn(node))return node}if(isForwards(direction)){if(isContentEditableFalse(node)&&(node=walker.next(!0),predicateFn(node)))return node;for(;node=walker.next(shallow);)if(predicateFn(node))return node}return null}function getEditingHost(node,rootNode){for(node=node.parentNode;node&&node!=rootNode;node=node.parentNode)if(isContentEditableTrue(node))return node;return rootNode}function getParentBlock(node,rootNode){for(;node&&node!=rootNode;){if(isBlockLike(node))return node;node=node.parentNode}return null}function isInSameBlock(caretPosition1,caretPosition2,rootNode){return getParentBlock(caretPosition1.container(),rootNode)==getParentBlock(caretPosition2.container(),rootNode)}function isInSameEditingHost(caretPosition1,caretPosition2,rootNode){return getEditingHost(caretPosition1.container(),rootNode)==getEditingHost(caretPosition2.container(),rootNode)}function getChildNodeAtRelativeOffset(relativeOffset,caretPosition){var container,offset;return caretPosition?(container=caretPosition.container(),offset=caretPosition.offset(),isElement(container)?container.childNodes[offset+relativeOffset]:null):null}function beforeAfter(before,node){var range=node.ownerDocument.createRange();return before?(range.setStartBefore(node),range.setEndBefore(node)):(range.setStartAfter(node),range.setEndAfter(node)),range}function isNodesInSameBlock(rootNode,node1,node2){return getParentBlock(node1,rootNode)==getParentBlock(node2,rootNode)}function lean(left,rootNode,node){var sibling,siblingName;for(siblingName=left?"previousSibling":"nextSibling";node&&node!=rootNode;){if(sibling=node[siblingName],isCaretContainer(sibling)&&(sibling=sibling[siblingName]),isContentEditableFalse(sibling)){if(isNodesInSameBlock(rootNode,sibling,node))return sibling;break}if(isCaretCandidate(sibling))break;node=node.parentNode}return null}function normalizeRange(direction,rootNode,range){var node,container,offset,location,leanLeft=curry(lean,!0,rootNode),leanRight=curry(lean,!1,rootNode);if(container=range.startContainer,offset=range.startOffset,CaretContainer.isCaretContainerBlock(container)){if(isElement(container)||(container=container.parentNode),location=container.getAttribute("data-mce-caret"),"before"==location&&(node=container.nextSibling,isContentEditableFalse(node)))return before(node);if("after"==location&&(node=container.previousSibling,isContentEditableFalse(node)))return after(node)}if(!range.collapsed)return range;if(NodeType.isText(container)){if(isCaretContainer(container)){if(1===direction){if(node=leanRight(container))return before(node);if(node=leanLeft(container))return after(node)}if(-1===direction){if(node=leanLeft(container))return after(node);if(node=leanRight(container))return before(node)}return range}if(CaretContainer.endsWithCaretContainer(container)&&offset>=container.data.length-1)return 1===direction&&(node=leanRight(container))?before(node):range;if(CaretContainer.startsWithCaretContainer(container)&&1>=offset)return-1===direction&&(node=leanLeft(container))?after(node):range;if(offset===container.data.length)return node=leanRight(container),node?before(node):range;if(0===offset)return node=leanLeft(container),node?after(node):range}return range}function isNextToContentEditableFalse(relativeOffset,caretPosition){return isContentEditableFalse(getChildNodeAtRelativeOffset(relativeOffset,caretPosition))}var isContentEditableTrue=NodeType.isContentEditableTrue,isContentEditableFalse=NodeType.isContentEditableFalse,isBlockLike=NodeType.matchStyleValues("display","block table table-cell table-caption"),isCaretContainer=CaretContainer.isCaretContainer,curry=Fun.curry,isElement=NodeType.isElement,isCaretCandidate=CaretCandidate.isCaretCandidate,before=curry(beforeAfter,!0),after=curry(beforeAfter,!1);return{isForwards:isForwards,isBackwards:isBackwards,findNode:findNode,getEditingHost:getEditingHost,getParentBlock:getParentBlock,isInSameBlock:isInSameBlock,isInSameEditingHost:isInSameEditingHost,isBeforeContentEditableFalse:curry(isNextToContentEditableFalse,0),isAfterContentEditableFalse:curry(isNextToContentEditableFalse,-1),normalizeRange:normalizeRange}}),define("tinymce/caret/CaretWalker",["tinymce/dom/NodeType","tinymce/caret/CaretCandidate","tinymce/caret/CaretPosition","tinymce/caret/CaretUtils","tinymce/util/Arr","tinymce/util/Fun"],function(NodeType,CaretCandidate,CaretPosition,CaretUtils,Arr,Fun){function getParents(node,rootNode){for(var parents=[];node&&node!=rootNode;)parents.push(node),node=node.parentNode;return parents}function nodeAtIndex(container,offset){return container.hasChildNodes()&&offset<container.childNodes.length?container.childNodes[offset]:null}function getCaretCandidatePosition(direction,node){if(isForwards(direction)){if(isCaretCandidate(node.previousSibling)&&!isText(node.previousSibling))return CaretPosition.before(node);if(isText(node))return CaretPosition(node,0)}if(isBackwards(direction)){if(isCaretCandidate(node.nextSibling)&&!isText(node.nextSibling))return CaretPosition.after(node);if(isText(node))return CaretPosition(node,node.data.length)}return isBackwards(direction)?CaretPosition.after(node):CaretPosition.before(node)}function findCaretPosition(direction,startCaretPosition,rootNode){var container,offset,node,nextNode,innerNode,rootContentEditableFalseElm,caretPosition;if(!isElement(rootNode)||!startCaretPosition)return null;if(caretPosition=startCaretPosition,container=caretPosition.container(),offset=caretPosition.offset(),isText(container)){if(isBackwards(direction)&&offset>0)return CaretPosition(container,--offset);if(isForwards(direction)&&offset<container.length)return CaretPosition(container,++offset);node=container}else{if(isBackwards(direction)&&offset>0&&(nextNode=nodeAtIndex(container,offset-1),isCaretCandidate(nextNode)))return!isAtomic(nextNode)&&(innerNode=CaretUtils.findNode(nextNode,direction,isEditableCaretCandidate,nextNode))?isText(innerNode)?CaretPosition(innerNode,innerNode.data.length):CaretPosition.after(innerNode):isText(nextNode)?CaretPosition(nextNode,nextNode.data.length):CaretPosition.before(nextNode);if(isForwards(direction)&&offset<container.childNodes.length&&(nextNode=nodeAtIndex(container,offset),isCaretCandidate(nextNode)))return!isAtomic(nextNode)&&(innerNode=CaretUtils.findNode(nextNode,direction,isEditableCaretCandidate,nextNode))?isText(innerNode)?CaretPosition(innerNode,0):CaretPosition.before(innerNode):isText(nextNode)?CaretPosition(nextNode,0):CaretPosition.after(nextNode);node=caretPosition.getNode()}return(isForwards(direction)&&caretPosition.isAtEnd()||isBackwards(direction)&&caretPosition.isAtStart())&&(node=CaretUtils.findNode(node,direction,Fun.constant(!0),rootNode,!0),isEditableCaretCandidate(node))?getCaretCandidatePosition(direction,node):(nextNode=CaretUtils.findNode(node,direction,isEditableCaretCandidate,rootNode),rootContentEditableFalseElm=Arr.last(Arr.filter(getParents(container,rootNode),isContentEditableFalse)),!rootContentEditableFalseElm||nextNode&&rootContentEditableFalseElm.contains(nextNode)?nextNode?getCaretCandidatePosition(direction,nextNode):null:caretPosition=isForwards(direction)?CaretPosition.after(rootContentEditableFalseElm):CaretPosition.before(rootContentEditableFalseElm))}var isContentEditableFalse=NodeType.isContentEditableFalse,isText=NodeType.isText,isElement=NodeType.isElement,isForwards=CaretUtils.isForwards,isBackwards=CaretUtils.isBackwards,isCaretCandidate=CaretCandidate.isCaretCandidate,isAtomic=CaretCandidate.isAtomic,isEditableCaretCandidate=CaretCandidate.isEditableCaretCandidate;return function(rootNode){return{next:function(caretPosition){return findCaretPosition(1,caretPosition,rootNode)},prev:function(caretPosition){return findCaretPosition(-1,caretPosition,rootNode)}}}}),define("tinymce/caret/FakeCaret",["tinymce/caret/CaretContainer","tinymce/caret/CaretPosition","tinymce/dom/NodeType","tinymce/dom/RangeUtils","tinymce/dom/DomQuery","tinymce/geom/ClientRect","tinymce/util/Delay"],function(CaretContainer,CaretPosition,NodeType,RangeUtils,$,ClientRect,Delay){var isContentEditableFalse=NodeType.isContentEditableFalse;return function(rootNode,isBlock){function getAbsoluteClientRect(node,before){var docElm,scrollX,scrollY,margin,rootRect,clientRect=ClientRect.collapse(node.getBoundingClientRect(),before);return"BODY"==rootNode.tagName?(docElm=rootNode.ownerDocument.documentElement,scrollX=rootNode.scrollLeft||docElm.scrollLeft,scrollY=rootNode.scrollTop||docElm.scrollTop):(rootRect=rootNode.getBoundingClientRect(),scrollX=rootNode.scrollLeft-rootRect.left,scrollY=rootNode.scrollTop-rootRect.top),clientRect.left+=scrollX,clientRect.right+=scrollX,clientRect.top+=scrollY,clientRect.bottom+=scrollY,clientRect.width=1,margin=node.offsetWidth-node.clientWidth,margin>0&&(before&&(margin*=-1),clientRect.left+=margin,clientRect.right+=margin),clientRect}function trimInlineCaretContainers(){var contentEditableFalseNodes,node,sibling,i,data;for(contentEditableFalseNodes=$("*[contentEditable=false]",rootNode),i=0;i<contentEditableFalseNodes.length;i++)node=contentEditableFalseNodes[i],sibling=node.previousSibling,CaretContainer.endsWithCaretContainer(sibling)&&(data=sibling.data,1==data.length?sibling.parentNode.removeChild(sibling):sibling.deleteData(data.length-1,1)),sibling=node.nextSibling,CaretContainer.startsWithCaretContainer(sibling)&&(data=sibling.data,1==data.length?sibling.parentNode.removeChild(sibling):sibling.deleteData(0,1));return null}function show(before,node){var clientRect,rng,container;return hide(),isBlock(node)?(caretContainerNode=CaretContainer.insertBlock("p",node,before),clientRect=getAbsoluteClientRect(node,before),$(caretContainerNode).css("top",clientRect.top),$lastVisualCaret=$('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(clientRect).appendTo(rootNode),before&&$lastVisualCaret.addClass("mce-visual-caret-before"),startBlink(),rng=node.ownerDocument.createRange(),container=caretContainerNode.firstChild,rng.setStart(container,0),rng.setEnd(container,1),rng):(caretContainerNode=CaretContainer.insertInline(node,before),rng=node.ownerDocument.createRange(),isContentEditableFalse(caretContainerNode.nextSibling)?(rng.setStart(caretContainerNode,0),rng.setEnd(caretContainerNode,0)):(rng.setStart(caretContainerNode,1),rng.setEnd(caretContainerNode,1)),rng)}function hide(){trimInlineCaretContainers(),caretContainerNode&&(CaretContainer.remove(caretContainerNode),caretContainerNode=null),$lastVisualCaret&&($lastVisualCaret.remove(),$lastVisualCaret=null),clearInterval(cursorInterval)}function startBlink(){cursorInterval=Delay.setInterval(function(){$("div.mce-visual-caret",rootNode).toggleClass("mce-visual-caret-hidden")},500)}function destroy(){Delay.clearInterval(cursorInterval)}function getCss(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"}var cursorInterval,$lastVisualCaret,caretContainerNode;return{show:show,hide:hide,getCss:getCss,destroy:destroy}}}),define("tinymce/dom/Dimensions",["tinymce/util/Arr","tinymce/dom/NodeType","tinymce/geom/ClientRect"],function(Arr,NodeType,ClientRect){function getClientRects(node){function toArrayWithNode(clientRects){return Arr.map(clientRects,function(clientRect){return clientRect=ClientRect.clone(clientRect),clientRect.node=node,clientRect})}if(Arr.isArray(node))return Arr.reduce(node,function(result,node){return result.concat(getClientRects(node))},[]);if(NodeType.isElement(node))return toArrayWithNode(node.getClientRects());if(NodeType.isText(node)){var rng=node.ownerDocument.createRange();return rng.setStart(node,0),rng.setEnd(node,node.data.length),toArrayWithNode(rng.getClientRects())}}return{getClientRects:getClientRects}}),define("tinymce/caret/LineWalker",["tinymce/util/Fun","tinymce/util/Arr","tinymce/dom/Dimensions","tinymce/caret/CaretCandidate","tinymce/caret/CaretUtils","tinymce/caret/CaretWalker","tinymce/caret/CaretPosition","tinymce/geom/ClientRect"],function(Fun,Arr,Dimensions,CaretCandidate,CaretUtils,CaretWalker,CaretPosition,ClientRect){function findUntil(direction,rootNode,predicateFn,node){for(;node=CaretUtils.findNode(node,direction,CaretCandidate.isEditableCaretCandidate,rootNode);)if(predicateFn(node))return}function walkUntil(direction,isAboveFn,isBeflowFn,rootNode,predicateFn,caretPosition){function add(node){var i,clientRect,clientRects;for(clientRects=Dimensions.getClientRects(node),-1==direction&&(clientRects=clientRects.reverse()),i=0;i<clientRects.length;i++)if(clientRect=clientRects[i],!isBeflowFn(clientRect,targetClientRect)){if(result.length>0&&isAboveFn(clientRect,Arr.last(result))&&line++,clientRect.line=line,predicateFn(clientRect))return!0;result.push(clientRect)}}var node,targetClientRect,line=0,result=[];return(targetClientRect=Arr.last(caretPosition.getClientRects()))?(node=caretPosition.getNode(),add(node),findUntil(direction,rootNode,add,node),result):result}function aboveLineNumber(lineNumber,clientRect){return clientRect.line>lineNumber}function isLine(lineNumber,clientRect){return clientRect.line===lineNumber}function positionsUntil(direction,rootNode,predicateFn,node){function getClientRect(caretPosition){return 1==direction?Arr.last(caretPosition.getClientRects()):Arr.last(caretPosition.getClientRects())}var walkFn,isBelowFn,isAboveFn,caretPosition,clientRect,targetClientRect,caretWalker=new CaretWalker(rootNode),result=[],line=0;1==direction?(walkFn=caretWalker.next,isBelowFn=ClientRect.isBelow,isAboveFn=ClientRect.isAbove,caretPosition=CaretPosition.after(node)):(walkFn=caretWalker.prev,isBelowFn=ClientRect.isAbove,isAboveFn=ClientRect.isBelow,caretPosition=CaretPosition.before(node)),targetClientRect=getClientRect(caretPosition);do if(caretPosition.isVisible()&&(clientRect=getClientRect(caretPosition),!isAboveFn(clientRect,targetClientRect))){if(result.length>0&&isBelowFn(clientRect,Arr.last(result))&&line++,clientRect=ClientRect.clone(clientRect),clientRect.position=caretPosition,clientRect.line=line,predicateFn(clientRect))return result;result.push(clientRect)}while(caretPosition=walkFn(caretPosition));return result}var curry=Fun.curry,upUntil=curry(walkUntil,-1,ClientRect.isAbove,ClientRect.isBelow),downUntil=curry(walkUntil,1,ClientRect.isBelow,ClientRect.isAbove);return{upUntil:upUntil,downUntil:downUntil,positionsUntil:positionsUntil,isAboveLine:curry(aboveLineNumber),isLine:curry(isLine)}}),define("tinymce/caret/LineUtils",["tinymce/util/Fun","tinymce/util/Arr","tinymce/dom/NodeType","tinymce/dom/Dimensions","tinymce/geom/ClientRect","tinymce/caret/CaretUtils","tinymce/caret/CaretCandidate"],function(Fun,Arr,NodeType,Dimensions,ClientRect,CaretUtils,CaretCandidate){function distanceToRectLeft(clientRect,clientX){return Math.abs(clientRect.left-clientX)}function distanceToRectRight(clientRect,clientX){return Math.abs(clientRect.right-clientX)}function findClosestClientRect(clientRects,clientX){function isInside(clientX,clientRect){return clientX>=clientRect.left&&clientX<=clientRect.right}return Arr.reduce(clientRects,function(oldClientRect,clientRect){var oldDistance,newDistance;return oldDistance=Math.min(distanceToRectLeft(oldClientRect,clientX),distanceToRectRight(oldClientRect,clientX)),newDistance=Math.min(distanceToRectLeft(clientRect,clientX),distanceToRectRight(clientRect,clientX)),isInside(clientX,clientRect)?clientRect:isInside(clientX,oldClientRect)?oldClientRect:newDistance==oldDistance&&isContentEditableFalse(clientRect.node)?clientRect:oldDistance>newDistance?clientRect:oldClientRect})}function walkUntil(direction,rootNode,predicateFn,node){for(;node=findNode(node,direction,CaretCandidate.isEditableCaretCandidate,rootNode);)if(predicateFn(node))return}function findLineNodeRects(rootNode,targetNodeRect){function collect(checkPosFn,node){var lineRects;return lineRects=Arr.filter(Dimensions.getClientRects(node),function(clientRect){return!checkPosFn(clientRect,targetNodeRect)}),clientRects=clientRects.concat(lineRects),0===lineRects.length}var clientRects=[];return clientRects.push(targetNodeRect),walkUntil(-1,rootNode,curry(collect,ClientRect.isAbove),targetNodeRect.node),walkUntil(1,rootNode,curry(collect,ClientRect.isBelow),targetNodeRect.node),clientRects}function getContentEditableFalseChildren(rootNode){return Arr.filter(Arr.toArray(rootNode.getElementsByTagName("*")),isContentEditableFalse)}function caretInfo(clientRect,clientX){return{node:clientRect.node,before:distanceToRectLeft(clientRect,clientX)<distanceToRectRight(clientRect,clientX)}}function closestCaret(rootNode,clientX,clientY){var contentEditableFalseNodeRects,closestNodeRect;return contentEditableFalseNodeRects=Dimensions.getClientRects(getContentEditableFalseChildren(rootNode)),contentEditableFalseNodeRects=Arr.filter(contentEditableFalseNodeRects,function(clientRect){return clientY>=clientRect.top&&clientY<=clientRect.bottom}),closestNodeRect=findClosestClientRect(contentEditableFalseNodeRects,clientX),closestNodeRect&&(closestNodeRect=findClosestClientRect(findLineNodeRects(rootNode,closestNodeRect),clientX),closestNodeRect&&isContentEditableFalse(closestNodeRect.node))?caretInfo(closestNodeRect,clientX):null}var isContentEditableFalse=NodeType.isContentEditableFalse,findNode=CaretUtils.findNode,curry=Fun.curry;return{findClosestClientRect:findClosestClientRect,findLineNodeRects:findLineNodeRects,closestCaret:closestCaret}}),define("tinymce/DragDropOverrides",["tinymce/dom/NodeType","tinymce/util/Arr","tinymce/util/Fun"],function(NodeType,Arr,Fun){function init(editor){function isDraggable(elm){return isContentEditableFalse(elm)}function setBodyCursor(cursor){$(editor.getBody()).css("cursor",cursor)}function isValidDropTarget(elm){return elm==state.element||editor.dom.isChildOf(elm,state.element)?!1:!isContentEditableFalse(elm)}function move(e){var deltaX,deltaY,pos,viewPort,movement,clientX,clientY,rootClientRect,overflowX=0,overflowY=0;0===e.button&&(deltaX=e.screenX-state.screenX,deltaY=e.screenY-state.screenY,movement=Math.max(Math.abs(deltaX),Math.abs(deltaY)),!state.dragging&&movement>10&&(state.dragging=!0,setBodyCursor("default"),state.clone=state.element.cloneNode(!0),pos=dom.getPos(state.element),state.relX=state.clientX-pos.x,state.relY=state.clientY-pos.y,state.width=state.element.offsetWidth,state.height=state.element.offsetHeight,$(state.clone).css({width:state.width,height:state.height}).removeAttr("data-mce-selected"),state.ghost=$("<div>").css({position:"absolute",opacity:.5,overflow:"hidden",width:state.width,height:state.height}).attr({"data-mce-bogus":"all",unselectable:"on",contenteditable:"false"}).addClass("mce-drag-container mce-reset").append(state.clone).appendTo(editor.getBody())[0],viewPort=editor.dom.getViewPort(editor.getWin()),state.maxX=viewPort.w,state.maxY=viewPort.h),state.dragging&&(editor.selection.placeCaretAt(e.clientX,e.clientY),clientX=state.clientX+deltaX-state.relX,clientY=state.clientY+deltaY+5,clientX+state.width>state.maxX&&(overflowX=clientX+state.width-state.maxX),clientY+state.height>state.maxY&&(overflowY=clientY+state.height-state.maxY),rootClientRect="BODY"!=editor.getBody().nodeName?editor.getBody().getBoundingClientRect():{left:0,top:0},$(state.ghost).css({left:clientX-rootClientRect.left,top:clientY-rootClientRect.top,width:state.width-overflowX,height:state.height-overflowY})))}function drop(){state.dragging&&(editor.selection.setRng(editor.selection.getSel().getRangeAt(0)),isValidDropTarget(editor.selection.getNode())&&editor.undoManager.transact(function(){editor.insertContent(dom.getOuterHTML(state.element)),$(state.element).remove()})),stop()}function start(e){var ceElm;if(stop(),0===e.button&&(ceElm=Arr.find(editor.dom.getParents(e.target),Fun.or(isContentEditableFalse,isContentEditableTrue)),isDraggable(ceElm))){if(editor.fire("dragstart",{target:ceElm}).isDefaultPrevented())return;editor.on("mousemove",move),editor.on("mouseup",drop),rootDocument!=editableDoc&&(dom.bind(rootDocument,"mousemove",move),dom.bind(rootDocument,"mouseup",drop)),state={screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY,element:ceElm}}}function stop(){$(state.ghost).remove(),setBodyCursor(null),editor.off("mousemove",move),editor.off("mouseup",stop),rootDocument!=editableDoc&&(dom.unbind(rootDocument,"mousemove",move),dom.unbind(rootDocument,"mouseup",stop)),state={}}var $=editor.$,rootDocument=document,editableDoc=editor.getDoc(),dom=editor.dom,state={};editor.on("mousedown",start),editor.on("drop",function(e){var realTarget=editor.getDoc().elementFromPoint(e.clientX,e.clientY);(isContentEditableFalse(realTarget)||isContentEditableFalse(editor.dom.getContentEditableParent(realTarget)))&&e.preventDefault()})}var isContentEditableFalse=NodeType.isContentEditableFalse,isContentEditableTrue=NodeType.isContentEditableTrue;return{init:init}}),define("tinymce/SelectionOverrides",["tinymce/Env","tinymce/caret/CaretWalker","tinymce/caret/CaretPosition","tinymce/caret/CaretContainer","tinymce/caret/CaretUtils","tinymce/caret/FakeCaret","tinymce/caret/LineWalker","tinymce/caret/LineUtils","tinymce/dom/NodeType","tinymce/dom/RangeUtils","tinymce/geom/ClientRect","tinymce/util/VK","tinymce/util/Fun","tinymce/util/Arr","tinymce/util/Delay","tinymce/DragDropOverrides"],function(Env,CaretWalker,CaretPosition,CaretContainer,CaretUtils,FakeCaret,LineWalker,LineUtils,NodeType,RangeUtils,ClientRect,VK,Fun,Arr,Delay,DragDropOverrides){function getVisualCaretPosition(walkFn,caretPosition){for(;caretPosition=walkFn(caretPosition);)if(caretPosition.isVisible())return caretPosition;return caretPosition}function SelectionOverrides(editor){function isBlock(node){return editor.dom.isBlock(node)}function setRange(range){range&&editor.selection.setRng(range)}function getRange(){return editor.selection.getRng()}function scrollIntoView(node,alignToTop){editor.selection.scrollIntoView(node,alignToTop)}function showCaret(direction,node,before){var e;return e=editor.fire("ShowCaret",{target:node,direction:direction,before:before}),e.isDefaultPrevented()?null:(scrollIntoView(node,-1===direction),fakeCaret.show(before,node))}function selectNode(node){var e;return e=editor.fire("ObjectSelected",{target:node}),e.isDefaultPrevented()?null:(fakeCaret.hide(),getNodeRange(node))}function getNodeRange(node){var rng=node.ownerDocument.createRange();return rng.selectNode(node),rng}function isMoveInsideSameBlock(fromCaretPosition,toCaretPosition){var inSameBlock=CaretUtils.isInSameBlock(fromCaretPosition,toCaretPosition);return!inSameBlock&&NodeType.isBr(fromCaretPosition.getNode())?!0:inSameBlock}function getNormalizedRangeEndPoint(direction,range){return range=CaretUtils.normalizeRange(direction,rootNode,range),-1==direction?CaretPosition.fromRangeStart(range):CaretPosition.fromRangeEnd(range)}function isRangeInCaretContainerBlock(range){return CaretContainer.isCaretContainerBlock(range.startContainer)}function moveToCeFalseHorizontally(direction,getNextPosFn,isBeforeContentEditableFalseFn,range){var node,caretPosition,peekCaretPosition,rangeIsInContainerBlock;return!range.collapsed&&(node=getSelectedNode(range),isContentEditableFalse(node))?showCaret(direction,node,-1==direction):(rangeIsInContainerBlock=isRangeInCaretContainerBlock(range),caretPosition=getNormalizedRangeEndPoint(direction,range),isBeforeContentEditableFalseFn(caretPosition)?selectNode(caretPosition.getNode(-1==direction)):(caretPosition=getNextPosFn(caretPosition))?isBeforeContentEditableFalseFn(caretPosition)?showCaret(direction,caretPosition.getNode(-1==direction),1==direction):(peekCaretPosition=getNextPosFn(caretPosition),isBeforeContentEditableFalseFn(peekCaretPosition)&&isMoveInsideSameBlock(caretPosition,peekCaretPosition)?showCaret(direction,peekCaretPosition.getNode(-1==direction),1==direction):rangeIsInContainerBlock?renderRangeCaret(caretPosition.toRange()):null):rangeIsInContainerBlock?range:null)}function moveToCeFalseVertically(direction,walkerFn,range){var caretPosition,linePositions,nextLinePositions,closestNextLineRect,caretClientRect,clientX,dist1,dist2,contentEditableFalseNode;if(contentEditableFalseNode=getSelectedNode(range),caretPosition=getNormalizedRangeEndPoint(direction,range),linePositions=walkerFn(rootNode,LineWalker.isAboveLine(1),caretPosition),nextLinePositions=Arr.filter(linePositions,LineWalker.isLine(1)),caretClientRect=Arr.last(caretPosition.getClientRects()),isBeforeContentEditableFalse(caretPosition)&&(contentEditableFalseNode=caretPosition.getNode()),isAfterContentEditableFalse(caretPosition)&&(contentEditableFalseNode=caretPosition.getNode(!0)),!caretClientRect)return null;if(clientX=caretClientRect.left,closestNextLineRect=LineUtils.findClosestClientRect(nextLinePositions,clientX),closestNextLineRect&&isContentEditableFalse(closestNextLineRect.node))return dist1=Math.abs(clientX-closestNextLineRect.left),dist2=Math.abs(clientX-closestNextLineRect.right),showCaret(direction,closestNextLineRect.node,dist2>dist1);if(contentEditableFalseNode){var caretPositions=LineWalker.positionsUntil(direction,rootNode,LineWalker.isAboveLine(1),contentEditableFalseNode);if(closestNextLineRect=LineUtils.findClosestClientRect(Arr.filter(caretPositions,LineWalker.isLine(1)),clientX))return renderRangeCaret(closestNextLineRect.position.toRange());if(closestNextLineRect=Arr.last(Arr.filter(caretPositions,LineWalker.isLine(0))))return renderRangeCaret(closestNextLineRect.position.toRange())}}function exitPreBlock(direction,range){function createTextBlock(){var textBlock=editor.dom.create(editor.settings.forced_root_block);return(!Env.ie||Env.ie>=11)&&(textBlock.innerHTML='<br data-mce-bogus="1">'),textBlock}var pre,caretPos,newBlock;if(range.collapsed&&editor.settings.forced_root_block){if(pre=editor.dom.getParent(range.startContainer,"PRE"),!pre)return;caretPos=1==direction?getNextVisualCaretPosition(CaretPosition.fromRangeStart(range)):getPrevVisualCaretPosition(CaretPosition.fromRangeStart(range)),
caretPos||(newBlock=createTextBlock(),1==direction?editor.$(pre).after(newBlock):editor.$(pre).before(newBlock),editor.selection.select(newBlock,!0),editor.selection.collapse())}}function moveH(direction,getNextPosFn,isBeforeContentEditableFalseFn,range){var newRange;return(newRange=moveToCeFalseHorizontally(direction,getNextPosFn,isBeforeContentEditableFalseFn,range))?newRange:(newRange=exitPreBlock(direction,range),newRange?newRange:null)}function moveV(direction,walkerFn,range){var newRange;return(newRange=moveToCeFalseVertically(direction,walkerFn,range))?newRange:(newRange=exitPreBlock(direction,range),newRange?newRange:null)}function getBlockCaretContainer(){return $("*[data-mce-caret]")[0]}function showBlockCaretContainer(blockCaretContainer){blockCaretContainer=$(blockCaretContainer),blockCaretContainer.attr("data-mce-caret")&&(fakeCaret.hide(),blockCaretContainer.removeAttr("data-mce-caret"),blockCaretContainer.removeAttr("data-mce-bogus"),blockCaretContainer.removeAttr("style"),setRange(getRange()),scrollIntoView(blockCaretContainer[0]))}function renderCaretAtRange(range){var caretPosition;return range=CaretUtils.normalizeRange(1,rootNode,range),caretPosition=CaretPosition.fromRangeStart(range),isContentEditableFalse(caretPosition.getNode())?showCaret(1,caretPosition.getNode(),!caretPosition.isAtEnd()):isContentEditableFalse(caretPosition.getNode(!0))?showCaret(1,caretPosition.getNode(!0),!1):(fakeCaret.hide(),null)}function renderRangeCaret(range){var caretRange;return range&&range.collapsed?(caretRange=renderCaretAtRange(range),caretRange?caretRange:range):range}function deleteContentEditableNode(node){var nextCaretPosition,prevCaretPosition,prevCeFalseElm,nextElement;return isContentEditableFalse(node)?(isContentEditableFalse(node.previousSibling)&&(prevCeFalseElm=node.previousSibling),prevCaretPosition=getPrevVisualCaretPosition(CaretPosition.before(node)),prevCaretPosition||(nextCaretPosition=getNextVisualCaretPosition(CaretPosition.after(node))),nextCaretPosition&&isElement(nextCaretPosition.getNode())&&(nextElement=nextCaretPosition.getNode()),CaretContainer.remove(node.previousSibling),CaretContainer.remove(node.nextSibling),editor.dom.remove(node),clearContentEditableSelection(),editor.dom.isEmpty(editor.getBody())?(editor.setContent(""),void editor.focus()):prevCeFalseElm?CaretPosition.after(prevCeFalseElm).toRange():nextElement?CaretPosition.before(nextElement).toRange():prevCaretPosition?prevCaretPosition.toRange():nextCaretPosition?nextCaretPosition.toRange():null):null}function backspaceDelete(direction,beforeFn,range){var node,caretPosition;return!range.collapsed&&(node=getSelectedNode(range),isContentEditableFalse(node))?renderRangeCaret(deleteContentEditableNode(node)):(caretPosition=getNormalizedRangeEndPoint(direction,range),beforeFn(caretPosition)?renderRangeCaret(deleteContentEditableNode(caretPosition.getNode(-1==direction))):void 0)}function registerEvents(){function override(evt,moveFn){var range=moveFn(getRange());range&&!evt.isDefaultPrevented()&&(evt.preventDefault(),setRange(range))}function getContentEditableRoot(node){for(var root=editor.getBody();node&&node!=root;){if(isContentEditableTrue(node)||isContentEditableFalse(node))return node;node=node.parentNode}return null}function isXYWithinRange(clientX,clientY,range){return range.collapsed?!1:Arr.reduce(range.getClientRects(),function(state,rect){return state||ClientRect.containsXY(rect,clientX,clientY)},!1)}function paddEmptyContentEditableArea(){var br,ceRoot=getContentEditableRoot(editor.selection.getNode());isContentEditableTrue(ceRoot)&&isBlock(ceRoot)&&editor.dom.isEmpty(ceRoot)&&(br=editor.dom.create("br",{"data-mce-bogus":"1"}),editor.$(ceRoot).empty().append(br),editor.selection.setRng(CaretPosition.before(br).toRange()))}function handleBlockContainer(e){var blockCaretContainer=getBlockCaretContainer();return blockCaretContainer?"compositionstart"==e.type?(e.preventDefault(),e.stopPropagation(),void showBlockCaretContainer(blockCaretContainer)):void("&nbsp;"!=blockCaretContainer.innerHTML&&showBlockCaretContainer(blockCaretContainer)):void 0}function handleEmptyBackspaceDelete(e){var prevent;switch(e.keyCode){case VK.DELETE:prevent=paddEmptyContentEditableArea();break;case VK.BACKSPACE:prevent=paddEmptyContentEditableArea()}prevent&&e.preventDefault()}var right=curry(moveH,1,getNextVisualCaretPosition,isBeforeContentEditableFalse),left=curry(moveH,-1,getPrevVisualCaretPosition,isAfterContentEditableFalse),deleteForward=curry(backspaceDelete,1,isBeforeContentEditableFalse),backspace=curry(backspaceDelete,-1,isAfterContentEditableFalse),up=curry(moveV,-1,LineWalker.upUntil),down=curry(moveV,1,LineWalker.downUntil);editor.on("mouseup",function(){var range=getRange();range.collapsed&&setRange(renderCaretAtRange(range))}),editor.on("mousedown",function(e){var contentEditableRoot;if(contentEditableRoot=getContentEditableRoot(e.target))isContentEditableFalse(contentEditableRoot)?(e.preventDefault(),setContentEditableSelection(selectNode(contentEditableRoot),!1)):isXYWithinRange(e.clientX,e.clientY,editor.selection.getRng())||editor.selection.placeCaretAt(e.clientX,e.clientY);else{clearContentEditableSelection(),fakeCaret.hide();var caretInfo=LineUtils.closestCaret(rootNode,e.clientX,e.clientY);caretInfo&&(e.preventDefault(),editor.getBody().focus(),setRange(showCaret(1,caretInfo.node,caretInfo.before)))}}),editor.on("keydown",function(e){if(!VK.modifierPressed(e))switch(e.keyCode){case VK.RIGHT:override(e,right);break;case VK.DOWN:override(e,down);break;case VK.LEFT:override(e,left);break;case VK.UP:override(e,up);break;case VK.DELETE:override(e,deleteForward);break;case VK.BACKSPACE:override(e,backspace);break;default:isContentEditableFalse(editor.selection.getNode())&&e.preventDefault()}}),editor.on("keyup compositionstart",function(e){handleBlockContainer(e),handleEmptyBackspaceDelete(e)},!0),editor.on("cut",function(){var node=editor.selection.getNode();isContentEditableFalse(node)&&Delay.setEditorTimeout(editor,function(){setRange(renderRangeCaret(deleteContentEditableNode(node)))})}),editor.on("getSelectionRange",function(e){var rng=e.range;if(selectedContentEditableNode){if(!selectedContentEditableNode.parentNode)return void(selectedContentEditableNode=null);rng=rng.cloneRange(),rng.selectNode(selectedContentEditableNode),e.range=rng}}),editor.on("setSelectionRange",function(e){var rng;rng=setContentEditableSelection(e.range),rng&&(e.range=rng)}),editor.on("focus",function(){Delay.setEditorTimeout(editor,function(){editor.selection.setRng(renderRangeCaret(editor.selection.getRng()))})}),DragDropOverrides.init(editor)}function addCss(){var styles=editor.contentStyles,rootClass=".mce-content-body";styles.push(fakeCaret.getCss()),styles.push(rootClass+" .mce-offscreen-selection {position: absolute;left: -9999999999px;width: 100pxheight: 100px}"+rootClass+" *[contentEditable=false] {cursor: default;}"+rootClass+" *[contentEditable=true] {cursor: text;}")}function isRangeInCaretContainer(rng){return CaretContainer.isCaretContainer(rng.startContainer)||CaretContainer.isCaretContainer(rng.endContainer)}function setContentEditableSelection(range,fireEvent){var node,sel,startContainer,startOffset,endOffset,e,caretPosition,dom=(editor.$,editor.dom);if(!range)return clearContentEditableSelection(),null;if(range.collapsed){if(clearContentEditableSelection(),!isRangeInCaretContainer(range)){if(caretPosition=getNormalizedRangeEndPoint(1,range),isContentEditableFalse(caretPosition.getNode()))return showCaret(1,caretPosition.getNode(),!caretPosition.isAtEnd());if(isContentEditableFalse(caretPosition.getNode(!0)))return showCaret(1,caretPosition.getNode(!0),!1)}return null}return startContainer=range.startContainer,startOffset=range.startOffset,endOffset=range.endOffset,3==startContainer.nodeType&&0==startOffset&&isContentEditableFalse(startContainer.parentNode)&&(startContainer=startContainer.parentNode,startOffset=dom.nodeIndex(startContainer),startContainer=startContainer.parentNode),1!=startContainer.nodeType?(clearContentEditableSelection(),null):(endOffset==startOffset+1&&(node=startContainer.childNodes[startOffset]),isContentEditableFalse(node)?fireEvent!==!1&&(e=editor.fire("ObjectSelected",{target:node}),e.isDefaultPrevented())?(clearContentEditableSelection(),null):(range=editor.dom.createRng(),range.setStart(node.firstChild,0),range.setEnd(node.lastChild,0),editor.getBody().focus(),sel=editor.selection.getSel(),sel.removeAllRanges(),sel.addRange(range),editor.$("*[data-mce-selected]").removeAttr("data-mce-selected"),selectedContentEditableNode=null,range):(clearContentEditableSelection(),null))}function clearContentEditableSelection(){selectedContentEditableNode&&(selectedContentEditableNode.removeAttribute("data-mce-selected"),editor.$("#"+realSelectionId).remove(),selectedContentEditableNode=null)}function destroy(){fakeCaret.destroy(),selectedContentEditableNode=null}var selectedContentEditableNode,rootNode=editor.getBody(),caretWalker=new CaretWalker(rootNode),getNextVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.next),getPrevVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.prev),fakeCaret=new FakeCaret(editor.getBody(),isBlock),realSelectionId="sel-"+editor.dom.uniqueId(),$=editor.$;return Env.ceFalse&&(registerEvents(),addCss()),{showBlockCaretContainer:showBlockCaretContainer,destroy:destroy}}var curry=Fun.curry,isContentEditableTrue=NodeType.isContentEditableTrue,isContentEditableFalse=NodeType.isContentEditableFalse,isElement=NodeType.isElement,isAfterContentEditableFalse=CaretUtils.isAfterContentEditableFalse,isBeforeContentEditableFalse=CaretUtils.isBeforeContentEditableFalse,getSelectedNode=RangeUtils.getSelectedNode;return SelectionOverrides}),define("tinymce/Editor",["tinymce/dom/DOMUtils","tinymce/dom/DomQuery","tinymce/AddOnManager","tinymce/NodeChange","tinymce/html/Node","tinymce/dom/Serializer","tinymce/html/Serializer","tinymce/dom/Selection","tinymce/Formatter","tinymce/UndoManager","tinymce/EnterKey","tinymce/ForceBlocks","tinymce/EditorCommands","tinymce/util/URI","tinymce/dom/ScriptLoader","tinymce/dom/EventUtils","tinymce/WindowManager","tinymce/NotificationManager","tinymce/html/Schema","tinymce/html/DomParser","tinymce/util/Quirks","tinymce/Env","tinymce/util/Tools","tinymce/util/Delay","tinymce/EditorObservable","tinymce/Mode","tinymce/Shortcuts","tinymce/EditorUpload","tinymce/SelectionOverrides"],function(DOMUtils,DomQuery,AddOnManager,NodeChange,Node,DomSerializer,Serializer,Selection,Formatter,UndoManager,EnterKey,ForceBlocks,EditorCommands,URI,ScriptLoader,EventUtils,WindowManager,NotificationManager,Schema,DomParser,Quirks,Env,Tools,Delay,EditorObservable,Mode,Shortcuts,EditorUpload,SelectionOverrides){function Editor(id,settings,editorManager){var documentBaseUrl,baseUri,self=this;documentBaseUrl=self.documentBaseUrl=editorManager.documentBaseURL,baseUri=editorManager.baseURI,self.settings=settings=extend({id:id,theme:"modern",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:documentBaseUrl,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,padd_empty_editor:!0,render_ui:!0,indentation:"30px",inline_styles:!0,convert_fonts_to_spans:!0,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",validate:!0,entity_encoding:"named",url_converter:self.convertURL,url_converter_scope:self,ie7_compat:!0},editorManager.defaultSettings,settings),AddOnManager.language=settings.language||"en",AddOnManager.languageLoad=settings.language_load,AddOnManager.baseURL=editorManager.baseURL,self.id=settings.id=id,self.setDirty(!1),self.plugins={},self.documentBaseURI=new URI(settings.document_base_url||documentBaseUrl,{base_uri:baseUri}),self.baseURI=baseUri,self.contentCSS=[],self.contentStyles=[],self.shortcuts=new Shortcuts(self),self.loadedCSS={},self.editorCommands=new EditorCommands(self),settings.target&&(self.targetElm=settings.target),self.suffix=editorManager.suffix,self.editorManager=editorManager,self.inline=settings.inline,settings.cache_suffix&&(Env.cacheSuffix=settings.cache_suffix.replace(/^[\?\&]+/,"")),settings.override_viewport===!1&&(Env.overrideViewPort=!1),editorManager.fire("SetupEditor",self),self.execCallback("setup",self),self.$=DomQuery.overrideDefaults(function(){return{context:self.inline?self.getBody():self.getDoc(),element:self.getBody()}})}var DOM=DOMUtils.DOM,ThemeManager=AddOnManager.ThemeManager,PluginManager=AddOnManager.PluginManager,extend=Tools.extend,each=Tools.each,explode=Tools.explode,inArray=Tools.inArray,trim=Tools.trim,resolve=Tools.resolve,Event=EventUtils.Event,isGecko=Env.gecko,ie=Env.ie;return Editor.prototype={render:function(){function readyHandler(){DOM.unbind(window,"ready",readyHandler),self.render()}function loadScripts(){var scriptLoader=ScriptLoader.ScriptLoader;if(settings.language&&"en"!=settings.language&&!settings.language_url&&(settings.language_url=self.editorManager.baseURL+"/langs/"+settings.language+".js"),settings.language_url&&scriptLoader.add(settings.language_url),settings.theme&&"function"!=typeof settings.theme&&"-"!=settings.theme.charAt(0)&&!ThemeManager.urls[settings.theme]){var themeUrl=settings.theme_url;themeUrl=themeUrl?self.documentBaseURI.toAbsolute(themeUrl):"themes/"+settings.theme+"/theme"+suffix+".js",ThemeManager.load(settings.theme,themeUrl)}Tools.isArray(settings.plugins)&&(settings.plugins=settings.plugins.join(" ")),each(settings.external_plugins,function(url,name){PluginManager.load(name,url),settings.plugins+=" "+name}),each(settings.plugins.split(/[ ,]/),function(plugin){if(plugin=trim(plugin),plugin&&!PluginManager.urls[plugin])if("-"==plugin.charAt(0)){plugin=plugin.substr(1,plugin.length);var dependencies=PluginManager.dependencies(plugin);each(dependencies,function(dep){var defaultSettings={prefix:"plugins/",resource:dep,suffix:"/plugin"+suffix+".js"};dep=PluginManager.createUrl(defaultSettings,dep),PluginManager.load(dep.resource,dep)})}else PluginManager.load(plugin,{prefix:"plugins/",resource:plugin,suffix:"/plugin"+suffix+".js"})}),scriptLoader.loadQueue(function(){self.removed||self.init()})}var self=this,settings=self.settings,id=self.id,suffix=self.suffix;if(!Event.domLoaded)return void DOM.bind(window,"ready",readyHandler);if(self.getElement()&&Env.contentEditable){settings.inline?self.inline=!0:(self.orgVisibility=self.getElement().style.visibility,self.getElement().style.visibility="hidden");var form=self.getElement().form||DOM.getParent(id,"form");form&&(self.formElement=form,settings.hidden_input&&!/TEXTAREA|INPUT/i.test(self.getElement().nodeName)&&(DOM.insertAfter(DOM.create("input",{type:"hidden",name:id}),id),self.hasHiddenInput=!0),self.formEventDelegate=function(e){self.fire(e.type,e)},DOM.bind(form,"submit reset",self.formEventDelegate),self.on("reset",function(){self.setContent(self.startContent,{format:"raw"})}),!settings.submit_patch||form.submit.nodeType||form.submit.length||form._mceOldSubmit||(form._mceOldSubmit=form.submit,form.submit=function(){return self.editorManager.triggerSave(),self.setDirty(!1),form._mceOldSubmit(form)})),self.windowManager=new WindowManager(self),self.notificationManager=new NotificationManager(self),"xml"==settings.encoding&&self.on("GetContent",function(e){e.save&&(e.content=DOM.encode(e.content))}),settings.add_form_submit_trigger&&self.on("submit",function(){self.initialized&&self.save()}),settings.add_unload_trigger&&(self._beforeUnload=function(){!self.initialized||self.destroyed||self.isHidden()||self.save({format:"raw",no_events:!0,set_dirty:!1})},self.editorManager.on("BeforeUnload",self._beforeUnload)),loadScripts()}},init:function(){function initPlugin(plugin){var pluginUrl,pluginInstance,Plugin=PluginManager.get(plugin);if(pluginUrl=PluginManager.urls[plugin]||self.documentBaseUrl.replace(/\/$/,""),plugin=trim(plugin),Plugin&&-1===inArray(initializedPlugins,plugin)){if(each(PluginManager.dependencies(plugin),function(dep){initPlugin(dep)}),self.plugins[plugin])return;pluginInstance=new Plugin(self,pluginUrl,self.$),self.plugins[plugin]=pluginInstance,pluginInstance.init&&(pluginInstance.init(self,pluginUrl),initializedPlugins.push(plugin))}}var w,h,minHeight,n,o,Theme,url,bodyId,bodyClass,re,i,self=this,settings=self.settings,elm=self.getElement(),initializedPlugins=[];if(this.editorManager.i18n.setCode(settings.language),self.rtl=settings.rtl_ui||this.editorManager.i18n.rtl,self.editorManager.add(self),settings.aria_label=settings.aria_label||DOM.getAttrib(elm,"aria-label",self.getLang("aria.rich_text_area")),settings.theme&&("function"!=typeof settings.theme?(settings.theme=settings.theme.replace(/-/,""),Theme=ThemeManager.get(settings.theme),self.theme=new Theme(self,ThemeManager.urls[settings.theme]),self.theme.init&&self.theme.init(self,ThemeManager.urls[settings.theme]||self.documentBaseUrl.replace(/\/$/,""),self.$)):self.theme=settings.theme),each(settings.plugins.replace(/\-/g,"").split(/[ ,]/),initPlugin),settings.render_ui&&self.theme&&(self.orgDisplay=elm.style.display,"function"!=typeof settings.theme?(w=settings.width||elm.style.width||elm.offsetWidth,h=settings.height||elm.style.height||elm.offsetHeight,minHeight=settings.min_height||100,re=/^[0-9\.]+(|px)$/i,re.test(""+w)&&(w=Math.max(parseInt(w,10),100)),re.test(""+h)&&(h=Math.max(parseInt(h,10),minHeight)),o=self.theme.renderUI({targetNode:elm,width:w,height:h,deltaWidth:settings.delta_width,deltaHeight:settings.delta_height}),settings.content_editable||(h=(o.iframeHeight||h)+("number"==typeof h?o.deltaHeight||0:""),minHeight>h&&(h=minHeight))):(o=settings.theme(self,elm),o.editorContainer.nodeType&&(o.editorContainer=o.editorContainer.id=o.editorContainer.id||self.id+"_parent"),o.iframeContainer.nodeType&&(o.iframeContainer=o.iframeContainer.id=o.iframeContainer.id||self.id+"_iframecontainer"),h=o.iframeHeight||elm.offsetHeight),self.editorContainer=o.editorContainer),settings.content_css&&each(explode(settings.content_css),function(u){self.contentCSS.push(self.documentBaseURI.toAbsolute(u))}),settings.content_style&&self.contentStyles.push(settings.content_style),settings.content_editable)return elm=n=o=null,self.initContentBody();if(self.iframeHTML=settings.doctype+"<html><head>",settings.document_base_url!=self.documentBaseUrl&&(self.iframeHTML+='<base href="'+self.documentBaseURI.getURI()+'" />'),!Env.caretAfter&&settings.ie7_compat&&(self.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />'),self.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',!/#$/.test(document.location.href))for(i=0;i<self.contentCSS.length;i++){var cssUrl=self.contentCSS[i];self.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+Tools._addCacheSuffix(cssUrl)+'" />',self.loadedCSS[cssUrl]=!0}bodyId=settings.body_id||"tinymce",-1!=bodyId.indexOf("=")&&(bodyId=self.getParam("body_id","","hash"),bodyId=bodyId[self.id]||bodyId),bodyClass=settings.body_class||"",-1!=bodyClass.indexOf("=")&&(bodyClass=self.getParam("body_class","","hash"),bodyClass=bodyClass[self.id]||""),settings.content_security_policy&&(self.iframeHTML+='<meta http-equiv="Content-Security-Policy" content="'+settings.content_security_policy+'" />'),self.iframeHTML+='</head><body id="'+bodyId+'" class="mce-content-body '+bodyClass+'" data-id="'+self.id+'"><br></body></html>';var domainRelaxUrl='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+self.id+'");document.write(ed.iframeHTML);document.close();ed.initContentBody(true);})()';document.domain!=location.hostname&&Env.ie&&Env.ie<12&&(url=domainRelaxUrl);var ifr=DOM.create("iframe",{id:self.id+"_ifr",frameBorder:"0",allowTransparency:"true",title:self.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"),style:{width:"100%",height:h,display:"block"}});if(ifr.onload=function(){ifr.onload=null,self.fire("load")},DOM.setAttrib(ifr,"src",url||'javascript:""'),self.contentAreaContainer=o.iframeContainer,self.iframeElement=ifr,n=DOM.add(o.iframeContainer,ifr),ie)try{self.getDoc()}catch(e){n.src=url=domainRelaxUrl}o.editorContainer&&(DOM.get(o.editorContainer).style.display=self.orgDisplay,self.hidden=DOM.isHidden(o.editorContainer)),self.getElement().style.display="none",DOM.setAttrib(self.id,"aria-hidden",!0),url||self.initContentBody(),elm=n=o=null},initContentBody:function(skipWrite){var body,contentCssText,self=this,settings=self.settings,targetElm=self.getElement(),doc=self.getDoc();settings.inline||(self.getElement().style.visibility=self.orgVisibility),skipWrite||settings.content_editable||(doc.open(),doc.write(self.iframeHTML),doc.close()),settings.content_editable&&(self.on("remove",function(){var bodyEl=this.getBody();DOM.removeClass(bodyEl,"mce-content-body"),DOM.removeClass(bodyEl,"mce-edit-focus"),DOM.setAttrib(bodyEl,"contentEditable",null)}),DOM.addClass(targetElm,"mce-content-body"),self.contentDocument=doc=settings.content_document||document,self.contentWindow=settings.content_window||window,self.bodyElement=targetElm,settings.content_document=settings.content_window=null,settings.root_name=targetElm.nodeName.toLowerCase()),body=self.getBody(),body.disabled=!0,self.readonly=settings.readonly,self.readonly||(self.inline&&"static"==DOM.getStyle(body,"position",!0)&&(body.style.position="relative"),body.contentEditable=self.getParam("content_editable_state",!0)),body.disabled=!1,self.editorUpload=new EditorUpload(self),self.schema=new Schema(settings),self.dom=new DOMUtils(doc,{keep_values:!0,url_converter:self.convertURL,url_converter_scope:self,hex_colors:settings.force_hex_style_colors,class_filter:settings.class_filter,update_styles:!0,root_element:self.inline?self.getBody():null,collect:settings.content_editable,schema:self.schema,onSetAttrib:function(e){self.fire("SetAttrib",e)}}),self.parser=new DomParser(settings,self.schema),self.parser.addAttributeFilter("src,href,style,tabindex",function(nodes,name){for(var node,value,internalName,i=nodes.length,dom=self.dom;i--;)if(node=nodes[i],value=node.attr(name),internalName="data-mce-"+name,!node.attributes.map[internalName]){if(0===value.indexOf("data:")||0===value.indexOf("blob:"))continue;"style"===name?(value=dom.serializeStyle(dom.parseStyle(value),node.name),value.length||(value=null),node.attr(internalName,value),node.attr(name,value)):"tabindex"===name?(node.attr(internalName,value),node.attr(name,null)):node.attr(internalName,self.convertURL(value,name,node.name))}}),self.parser.addNodeFilter("script",function(nodes){for(var node,type,i=nodes.length;i--;)node=nodes[i],type=node.attr("type")||"no/type",0!==type.indexOf("mce-")&&node.attr("type","mce-"+type)}),self.parser.addNodeFilter("#cdata",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],node.type=8,node.name="#comment",node.value="[CDATA["+node.value+"]]"}),self.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(nodes){for(var node,i=nodes.length,nonEmptyElements=self.schema.getNonEmptyElements();i--;)node=nodes[i],node.isEmpty(nonEmptyElements)&&(node.append(new Node("br",1)).shortEnded=!0)}),self.serializer=new DomSerializer(settings,self),self.selection=new Selection(self.dom,self.getWin(),self.serializer,self),self.formatter=new Formatter(self),self.undoManager=new UndoManager(self),self.forceBlocks=new ForceBlocks(self),self.enterKey=new EnterKey(self),self._nodeChangeDispatcher=new NodeChange(self),self._selectionOverrides=new SelectionOverrides(self),self.fire("PreInit"),settings.browser_spellcheck||settings.gecko_spellcheck||(doc.body.spellcheck=!1,DOM.setAttrib(body,"spellcheck","false")),self.fire("PostRender"),self.quirks=new Quirks(self),settings.directionality&&(body.dir=settings.directionality),settings.nowrap&&(body.style.whiteSpace="nowrap"),settings.protect&&self.on("BeforeSetContent",function(e){each(settings.protect,function(pattern){e.content=e.content.replace(pattern,function(str){return"<!--mce:protected "+escape(str)+"-->"})})}),self.on("SetContent",function(){self.addVisual(self.getBody())}),settings.padd_empty_editor&&self.on("PostProcess",function(e){e.content=e.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")}),self.load({initial:!0,format:"html"}),self.startContent=self.getContent({format:"raw"}),self.initialized=!0,self.bindPendingEventDelegates(),self.fire("init"),self.focus(!0),self.nodeChanged({initial:!0}),self.execCallback("init_instance_callback",self),self.contentStyles.length>0&&(contentCssText="",each(self.contentStyles,function(style){contentCssText+=style+"\r\n"}),self.dom.addStyle(contentCssText)),each(self.contentCSS,function(cssUrl){self.loadedCSS[cssUrl]||(self.dom.loadCSS(cssUrl),self.loadedCSS[cssUrl]=!0)}),settings.auto_focus&&Delay.setEditorTimeout(self,function(){var editor;editor=settings.auto_focus===!0?self:self.editorManager.get(settings.auto_focus),editor.destroyed||editor.focus()},100),targetElm=doc=body=null},focus:function(skipFocus){function getContentEditableHost(node){return self.dom.getParent(node,function(node){return"true"===self.dom.getContentEditable(node)})}var rng,controlElm,contentEditableHost,self=this,selection=self.selection,contentEditable=self.settings.content_editable,doc=self.getDoc(),body=self.getBody();if(!skipFocus){if(rng=selection.getRng(),rng.item&&(controlElm=rng.item(0)),self._refreshContentEditable(),contentEditableHost=getContentEditableHost(selection.getNode()),self.$.contains(body,contentEditableHost))return contentEditableHost.focus(),selection.normalize(),void self.editorManager.setActive(self);if(contentEditable||(Env.opera||self.getBody().focus(),self.getWin().focus()),isGecko||contentEditable){if(body.setActive)try{body.setActive()}catch(ex){body.focus()}else body.focus();contentEditable&&selection.normalize()}controlElm&&controlElm.ownerDocument==doc&&(rng=doc.body.createControlRange(),rng.addElement(controlElm),rng.select())}self.editorManager.setActive(self)},execCallback:function(name){var scope,self=this,callback=self.settings[name];return callback?(self.callbackLookup&&(scope=self.callbackLookup[name])&&(callback=scope.func,scope=scope.scope),"string"==typeof callback&&(scope=callback.replace(/\.\w+$/,""),scope=scope?resolve(scope):0,callback=resolve(callback),self.callbackLookup=self.callbackLookup||{},self.callbackLookup[name]={func:callback,scope:scope}),callback.apply(scope||self,Array.prototype.slice.call(arguments,1))):void 0},translate:function(text){var lang=this.settings.language||"en",i18n=this.editorManager.i18n;return text?i18n.data[lang+"."+text]||text.replace(/\{\#([^\}]+)\}/g,function(a,b){return i18n.data[lang+"."+b]||"{#"+b+"}"}):""},getLang:function(name,defaultVal){return this.editorManager.i18n.data[(this.settings.language||"en")+"."+name]||(defaultVal!==undefined?defaultVal:"{#"+name+"}")},getParam:function(name,defaultVal,type){var output,value=name in this.settings?this.settings[name]:defaultVal;return"hash"===type?(output={},"string"==typeof value?each(value.indexOf("=")>0?value.split(/[;,](?![^=;,]*(?:[;,]|$))/):value.split(","),function(value){value=value.split("="),value.length>1?output[trim(value[0])]=trim(value[1]):output[trim(value[0])]=trim(value)}):output=value,output):value},nodeChanged:function(args){this._nodeChangeDispatcher.nodeChanged(args)},addButton:function(name,settings){var self=this;settings.cmd&&(settings.onclick=function(){self.execCommand(settings.cmd)}),settings.text||settings.icon||(settings.icon=name),self.buttons=self.buttons||{},settings.tooltip=settings.tooltip||settings.title,self.buttons[name]=settings},addMenuItem:function(name,settings){var self=this;settings.cmd&&(settings.onclick=function(){self.execCommand(settings.cmd)}),self.menuItems=self.menuItems||{},self.menuItems[name]=settings},addContextToolbar:function(predicate,items){var selector,self=this;self.contextToolbars=self.contextToolbars||[],"string"==typeof predicate&&(selector=predicate,predicate=function(elm){return self.dom.is(elm,selector)}),self.contextToolbars.push({predicate:predicate,items:items})},addCommand:function(name,callback,scope){this.editorCommands.addCommand(name,callback,scope)},addQueryStateHandler:function(name,callback,scope){this.editorCommands.addQueryStateHandler(name,callback,scope)},addQueryValueHandler:function(name,callback,scope){this.editorCommands.addQueryValueHandler(name,callback,scope)},addShortcut:function(pattern,desc,cmdFunc,scope){this.shortcuts.add(pattern,desc,cmdFunc,scope)},execCommand:function(cmd,ui,value,args){return this.editorCommands.execCommand(cmd,ui,value,args)},queryCommandState:function(cmd){return this.editorCommands.queryCommandState(cmd)},queryCommandValue:function(cmd){return this.editorCommands.queryCommandValue(cmd)},queryCommandSupported:function(cmd){return this.editorCommands.queryCommandSupported(cmd)},show:function(){var self=this;self.hidden&&(self.hidden=!1,self.inline?self.getBody().contentEditable=!0:(DOM.show(self.getContainer()),DOM.hide(self.id)),self.load(),self.fire("show"))},hide:function(){var self=this,doc=self.getDoc();self.hidden||(ie&&doc&&!self.inline&&doc.execCommand("SelectAll"),self.save(),self.inline?(self.getBody().contentEditable=!1,self==self.editorManager.focusedEditor&&(self.editorManager.focusedEditor=null)):(DOM.hide(self.getContainer()),DOM.setStyle(self.id,"display",self.orgDisplay)),self.hidden=!0,self.fire("hide"))},isHidden:function(){return!!this.hidden},setProgressState:function(state,time){this.fire("ProgressState",{state:state,time:time})},load:function(args){var html,self=this,elm=self.getElement();return elm?(args=args||{},args.load=!0,html=self.setContent(elm.value!==undefined?elm.value:elm.innerHTML,args),args.element=elm,args.no_events||self.fire("LoadContent",args),args.element=elm=null,html):void 0},save:function(args){var html,form,self=this,elm=self.getElement();return elm&&self.initialized?(args=args||{},args.save=!0,args.element=elm,html=args.content=self.getContent(args),args.no_events||self.fire("SaveContent",args),"raw"==args.format&&self.fire("RawSaveContent",args),html=args.content,/TEXTAREA|INPUT/i.test(elm.nodeName)?elm.value=html:(self.inline||(elm.innerHTML=html),(form=DOM.getParent(self.id,"form"))&&each(form.elements,function(elm){return elm.name==self.id?(elm.value=html,!1):void 0})),args.element=elm=null,args.set_dirty!==!1&&self.setDirty(!1),html):void 0},setContent:function(content,args){var forcedRootBlockName,padd,self=this,body=self.getBody();return args=args||{},args.format=args.format||"html",args.set=!0,args.content=content,args.no_events||self.fire("BeforeSetContent",args),content=args.content,0===content.length||/^\s+$/.test(content)?(padd=ie&&11>ie?"":'<br data-mce-bogus="1">',"TABLE"==body.nodeName?content="<tr><td>"+padd+"</td></tr>":/^(UL|OL)$/.test(body.nodeName)&&(content="<li>"+padd+"</li>"),forcedRootBlockName=self.settings.forced_root_block,forcedRootBlockName&&self.schema.isValidChild(body.nodeName.toLowerCase(),forcedRootBlockName.toLowerCase())?(content=padd,content=self.dom.createHTML(forcedRootBlockName,self.settings.forced_root_block_attrs,content)):ie||content||(content='<br data-mce-bogus="1">'),self.dom.setHTML(body,content),self.fire("SetContent",args)):("raw"!==args.format&&(content=new Serializer({validate:self.validate},self.schema).serialize(self.parser.parse(content,{
isRootContent:!0}))),args.content=trim(content),self.dom.setHTML(body,args.content),args.no_events||self.fire("SetContent",args)),args.content},getContent:function(args){var content,self=this,body=self.getBody();return args=args||{},args.format=args.format||"html",args.get=!0,args.getInner=!0,args.no_events||self.fire("BeforeGetContent",args),content="raw"==args.format?self.serializer.getTrimmedContent():"text"==args.format?body.innerText||body.textContent:self.serializer.serialize(body,args),"text"!=args.format?args.content=trim(content):args.content=content,args.no_events||self.fire("GetContent",args),args.content},insertContent:function(content,args){args&&(content=extend({content:content},args)),this.execCommand("mceInsertContent",!1,content)},isDirty:function(){return!this.isNotDirty},setDirty:function(state){var oldState=!this.isNotDirty;this.isNotDirty=!state,state&&state!=oldState&&this.fire("dirty")},setMode:function(mode){Mode.setMode(this,mode)},getContainer:function(){var self=this;return self.container||(self.container=DOM.get(self.editorContainer||self.id+"_parent")),self.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return this.targetElm||(this.targetElm=DOM.get(this.id)),this.targetElm},getWin:function(){var elm,self=this;return self.contentWindow||(elm=self.iframeElement,elm&&(self.contentWindow=elm.contentWindow)),self.contentWindow},getDoc:function(){var win,self=this;return self.contentDocument||(win=self.getWin(),win&&(self.contentDocument=win.document)),self.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(url,name,elm){var self=this,settings=self.settings;return settings.urlconverter_callback?self.execCallback("urlconverter_callback",url,elm,!0,name):!settings.convert_urls||elm&&"LINK"==elm.nodeName||0===url.indexOf("file:")||0===url.length?url:settings.relative_urls?self.documentBaseURI.toRelative(url):url=self.documentBaseURI.toAbsolute(url,settings.remove_script_host)},addVisual:function(elm){var cls,self=this,settings=self.settings,dom=self.dom;elm=elm||self.getBody(),self.hasVisual===undefined&&(self.hasVisual=settings.visual),each(dom.select("table,a",elm),function(elm){var value;switch(elm.nodeName){case"TABLE":return cls=settings.visual_table_class||"mce-item-table",value=dom.getAttrib(elm,"border"),void(value&&"0"!=value||!self.hasVisual?dom.removeClass(elm,cls):dom.addClass(elm,cls));case"A":return void(dom.getAttrib(elm,"href",!1)||(value=dom.getAttrib(elm,"name")||elm.id,cls=settings.visual_anchor_class||"mce-item-anchor",value&&self.hasVisual?dom.addClass(elm,cls):dom.removeClass(elm,cls)))}}),self.fire("VisualAid",{element:elm,hasVisual:self.hasVisual})},remove:function(){var self=this;self.removed||(self.save(),self.removed=1,self.unbindAllNativeEvents(),self.hasHiddenInput&&DOM.remove(self.getElement().nextSibling),self.inline||(ie&&10>ie&&self.getDoc().execCommand("SelectAll",!1,null),DOM.setStyle(self.id,"display",self.orgDisplay),self.getBody().onload=null),self.fire("remove"),self.editorManager.remove(self),DOM.remove(self.getContainer()),self._selectionOverrides.destroy(),self.editorUpload.destroy(),self.destroy())},destroy:function(automatic){var form,self=this;if(!self.destroyed){if(!automatic&&!self.removed)return void self.remove();automatic||(self.editorManager.off("beforeunload",self._beforeUnload),self.theme&&self.theme.destroy&&self.theme.destroy(),self.selection.destroy(),self.dom.destroy()),form=self.formElement,form&&(form._mceOldSubmit&&(form.submit=form._mceOldSubmit,form._mceOldSubmit=null),DOM.unbind(form,"submit reset",self.formEventDelegate)),self.contentAreaContainer=self.formElement=self.container=self.editorContainer=null,self.bodyElement=self.contentDocument=self.contentWindow=null,self.iframeElement=self.targetElm=null,self.selection&&(self.selection=self.selection.win=self.selection.dom=self.selection.dom.doc=null),self.destroyed=1}},uploadImages:function(callback){return this.editorUpload.uploadImages(callback)},_scanForImages:function(){return this.editorUpload.scanForImages()},_refreshContentEditable:function(){var body,parent,self=this;self._isHidden()&&(body=self.getBody(),parent=body.parentNode,parent.removeChild(body),parent.appendChild(body),body.focus())},_isHidden:function(){var sel;return isGecko?(sel=this.selection.getSel(),!sel||!sel.rangeCount||0===sel.rangeCount):0}},extend(Editor.prototype,EditorObservable),Editor}),define("tinymce/util/I18n",[],function(){var data={},code="en";return{setCode:function(newCode){newCode&&(code=newCode,this.rtl=this.data[newCode]?"rtl"===this.data[newCode]._dir:!1)},getCode:function(){return code},rtl:!1,add:function(code,items){var langData=data[code];langData||(data[code]=langData={});for(var name in items)langData[name]=items[name];this.setCode(code)},translate:function(text){var langData;if(langData=data[code],langData||(langData={}),"undefined"==typeof text)return text;if("string"!=typeof text&&text.raw)return text.raw;if(text.push){var values=text.slice(1);text=(langData[text[0]]||text[0]).replace(/\{([0-9]+)\}/g,function(match1,match2){return values[match2]})}return(langData[text]||text).replace(/{context:\w+}$/,"")},data:data}}),define("tinymce/FocusManager",["tinymce/dom/DOMUtils","tinymce/util/Delay","tinymce/Env"],function(DOMUtils,Delay,Env){function FocusManager(editorManager){function getActiveElement(){try{return document.activeElement}catch(ex){return document.body}}function createBookmark(dom,rng){if(rng&&rng.startContainer){if(!dom.isChildOf(rng.startContainer,dom.getRoot())||!dom.isChildOf(rng.endContainer,dom.getRoot()))return;return{startContainer:rng.startContainer,startOffset:rng.startOffset,endContainer:rng.endContainer,endOffset:rng.endOffset}}return rng}function bookmarkToRng(editor,bookmark){var rng;return bookmark.startContainer?(rng=editor.getDoc().createRange(),rng.setStart(bookmark.startContainer,bookmark.startOffset),rng.setEnd(bookmark.endContainer,bookmark.endOffset)):rng=bookmark,rng}function isUIElement(elm){return!!DOM.getParent(elm,FocusManager.isEditorUIElement)}function registerEvents(e){var editor=e.editor;editor.on("init",function(){(editor.inline||Env.ie)&&("onbeforedeactivate"in document&&Env.ie<9?editor.dom.bind(editor.getBody(),"beforedeactivate",function(e){if(e.target==editor.getBody())try{editor.lastRng=editor.selection.getRng()}catch(ex){}}):editor.on("nodechange mouseup keyup",function(e){var node=getActiveElement();"nodechange"==e.type&&e.selectionChange||(node&&node.id==editor.id+"_ifr"&&(node=editor.getBody()),editor.dom.isChildOf(node,editor.getBody())&&(editor.lastRng=editor.selection.getRng()))}),Env.webkit&&!selectionChangeHandler&&(selectionChangeHandler=function(){var activeEditor=editorManager.activeEditor;if(activeEditor&&activeEditor.selection){var rng=activeEditor.selection.getRng();rng&&!rng.collapsed&&(editor.lastRng=rng)}},DOM.bind(document,"selectionchange",selectionChangeHandler)))}),editor.on("setcontent",function(){editor.lastRng=null}),editor.on("mousedown",function(){editor.selection.lastFocusBookmark=null}),editor.on("focusin",function(){var lastRng,focusedEditor=editorManager.focusedEditor;editor.selection.lastFocusBookmark&&(lastRng=bookmarkToRng(editor,editor.selection.lastFocusBookmark),editor.selection.lastFocusBookmark=null,editor.selection.setRng(lastRng)),focusedEditor!=editor&&(focusedEditor&&focusedEditor.fire("blur",{focusedEditor:editor}),editorManager.setActive(editor),editorManager.focusedEditor=editor,editor.fire("focus",{blurredEditor:focusedEditor}),editor.focus(!0)),editor.lastRng=null}),editor.on("focusout",function(){Delay.setEditorTimeout(editor,function(){var focusedEditor=editorManager.focusedEditor;isUIElement(getActiveElement())||focusedEditor!=editor||(editor.fire("blur",{focusedEditor:null}),editorManager.focusedEditor=null,editor.selection&&(editor.selection.lastFocusBookmark=null))})}),documentFocusInHandler||(documentFocusInHandler=function(e){var activeEditor=editorManager.activeEditor;activeEditor&&e.target.ownerDocument==document&&(activeEditor.selection&&e.target!=activeEditor.getBody()&&(activeEditor.selection.lastFocusBookmark=createBookmark(activeEditor.dom,activeEditor.lastRng)),e.target==document.body||isUIElement(e.target)||editorManager.focusedEditor!=activeEditor||(activeEditor.fire("blur",{focusedEditor:null}),editorManager.focusedEditor=null))},DOM.bind(document,"focusin",documentFocusInHandler)),editor.inline&&!documentMouseUpHandler&&(documentMouseUpHandler=function(e){var activeEditor=editorManager.activeEditor;if(activeEditor.inline&&!activeEditor.dom.isChildOf(e.target,activeEditor.getBody())){var rng=activeEditor.selection.getRng();rng.collapsed||(activeEditor.lastRng=rng)}},DOM.bind(document,"mouseup",documentMouseUpHandler))}function unregisterDocumentEvents(e){editorManager.focusedEditor==e.editor&&(editorManager.focusedEditor=null),editorManager.activeEditor||(DOM.unbind(document,"selectionchange",selectionChangeHandler),DOM.unbind(document,"focusin",documentFocusInHandler),DOM.unbind(document,"mouseup",documentMouseUpHandler),selectionChangeHandler=documentFocusInHandler=documentMouseUpHandler=null)}editorManager.on("AddEditor",registerEvents),editorManager.on("RemoveEditor",unregisterDocumentEvents)}var selectionChangeHandler,documentFocusInHandler,documentMouseUpHandler,DOM=DOMUtils.DOM;return FocusManager.isEditorUIElement=function(elm){return-1!==elm.className.toString().indexOf("mce-")},FocusManager}),define("tinymce/EditorManager",["tinymce/Editor","tinymce/dom/DomQuery","tinymce/dom/DOMUtils","tinymce/util/URI","tinymce/Env","tinymce/util/Tools","tinymce/util/Promise","tinymce/util/Observable","tinymce/util/I18n","tinymce/FocusManager"],function(Editor,$,DOMUtils,URI,Env,Tools,Promise,Observable,I18n,FocusManager){function globalEventDelegate(e){each(EditorManager.editors,function(editor){editor.fire("ResizeWindow",e)})}function toggleGlobalEvents(editors,state){state!==boundGlobalEvents&&(state?$(window).on("resize",globalEventDelegate):$(window).off("resize",globalEventDelegate),boundGlobalEvents=state)}function removeEditorFromList(editor){var removedFromList,editors=EditorManager.editors;delete editors[editor.id];for(var i=0;i<editors.length;i++)if(editors[i]==editor){editors.splice(i,1),removedFromList=!0;break}return EditorManager.activeEditor==editor&&(EditorManager.activeEditor=editors[0]),EditorManager.focusedEditor==editor&&(EditorManager.focusedEditor=null),removedFromList}function purgeDestroyedEditor(editor){return editor&&!(editor.getContainer()||editor.getBody()).parentNode&&(removeEditorFromList(editor),editor.unbindAllNativeEvents(),editor.destroy(!0),editor=null),editor}var beforeUnloadDelegate,EditorManager,DOM=DOMUtils.DOM,explode=Tools.explode,each=Tools.each,extend=Tools.extend,instanceCounter=0,boundGlobalEvents=!1;return EditorManager={$:$,majorVersion:"4",minorVersion:"3.4",releaseDate:"2016-02-11",editors:[],i18n:I18n,activeEditor:null,setup:function(){var baseURL,documentBaseURL,preInit,src,self=this,suffix="";if(documentBaseURL=document.location.href,/^[^:]+:\/\/\/?[^\/]+\//.test(documentBaseURL)&&(documentBaseURL=documentBaseURL.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(documentBaseURL)||(documentBaseURL+="/")),preInit=window.tinymce||window.tinyMCEPreInit)baseURL=preInit.base||preInit.baseURL,suffix=preInit.suffix;else{for(var scripts=document.getElementsByTagName("script"),i=0;i<scripts.length;i++){src=scripts[i].src;var srcScript=src.substring(src.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(src)){-1!=srcScript.indexOf(".min")&&(suffix=".min"),baseURL=src.substring(0,src.lastIndexOf("/"));break}}!baseURL&&document.currentScript&&(src=document.currentScript.src,-1!=src.indexOf(".min")&&(suffix=".min"),baseURL=src.substring(0,src.lastIndexOf("/")))}self.baseURL=new URI(documentBaseURL).toAbsolute(baseURL),self.documentBaseURL=documentBaseURL,self.baseURI=new URI(self.baseURL),self.suffix=suffix,self.focusManager=new FocusManager(self)},overrideDefaults:function(defaultSettings){var baseUrl,suffix;baseUrl=defaultSettings.base_url,baseUrl&&(this.baseURL=new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\/+$/,"")),this.baseURI=new URI(this.baseURL)),suffix=defaultSettings.suffix,defaultSettings.suffix&&(this.suffix=suffix),this.defaultSettings=defaultSettings},init:function(settings){function createId(elm){var id=elm.id;return id||(id=elm.name,id=id&&!DOM.get(id)?elm.name:DOM.uniqueId(),elm.setAttribute("id",id)),id}function execCallback(name){var callback=settings[name];return callback?callback.apply(self,Array.prototype.slice.call(arguments,2)):void 0}function hasClass(elm,className){return className.constructor===RegExp?className.test(elm.className):DOM.hasClass(elm,className)}function findTargets(settings){var l,targets=[];switch(settings.types?each(settings.types,function(type){targets=targets.concat(DOM.select(type.selector))}):settings.selector?targets=DOM.select(settings.selector):settings.target&&(targets=[settings.target]),settings.mode){case"exact":l=settings.elements||"",l.length>0&&each(explode(l),function(id){var elm;(elm=DOM.get(id))?targets.push(elm):each(document.forms,function(f){each(f.elements,function(e){e.name===id&&(id="mce_editor_"+instanceCounter++,DOM.setAttrib(e,"id",id),targets.push(e))})})});break;case"textareas":case"specific_textareas":each(DOM.select("textarea"),function(elm){settings.editor_deselector&&hasClass(elm,settings.editor_deselector)||settings.editor_selector&&!hasClass(elm,settings.editor_selector)||targets.push(elm)})}return targets}function initEditors(resolve,readyHandler){function createEditor(id,settings,targetElm){if(!purgeDestroyedEditor(self.get(id))){var editor=new Editor(id,settings,self);editors.push(editor),editor.on("init",function(){++initCount===targets.length&&resolve(editors)}),editor.targetElm=editor.targetElm||targetElm,editor.render()}}var targets,initCount=0,editors=[];return DOM.unbind(window,"ready",readyHandler),execCallback("onpageload"),targets=findTargets(settings),settings.types?void each(settings.types,function(type){Tools.each(targets,function(elm){return DOM.is(elm,type.selector)?(createEditor(createId(elm),extend({},settings,type),elm),!1):!0})}):void each(targets,function(elm){createEditor(createId(elm),settings,elm)})}var self=this;return self.settings=settings,new Promise(function(resolve){var readyHandler=function(){initEditors(resolve,readyHandler)};DOM.bind(window,"ready",readyHandler)})},get:function(id){return arguments.length?id in this.editors?this.editors[id]:null:this.editors},add:function(editor){var self=this,editors=self.editors;return editors[editor.id]=editor,editors.push(editor),toggleGlobalEvents(editors,!0),self.activeEditor=editor,self.fire("AddEditor",{editor:editor}),beforeUnloadDelegate||(beforeUnloadDelegate=function(){self.fire("BeforeUnload")},DOM.bind(window,"beforeunload",beforeUnloadDelegate)),editor},createEditor:function(id,settings){return this.add(new Editor(id,settings,this))},remove:function(selector){var i,editor,self=this,editors=self.editors;if(selector)return"string"==typeof selector?(selector=selector.selector||selector,void each(DOM.select(selector),function(elm){editor=editors[elm.id],editor&&self.remove(editor)})):(editor=selector,editors[editor.id]?(removeEditorFromList(editor)&&self.fire("RemoveEditor",{editor:editor}),editors.length||DOM.unbind(window,"beforeunload",beforeUnloadDelegate),editor.remove(),toggleGlobalEvents(editors,editors.length>0),editor):null);for(i=editors.length-1;i>=0;i--)self.remove(editors[i])},execCommand:function(cmd,ui,value){var self=this,editor=self.get(value);switch(cmd){case"mceAddEditor":return self.get(value)||new Editor(value,self.settings,self).render(),!0;case"mceRemoveEditor":return editor&&editor.remove(),!0;case"mceToggleEditor":return editor?(editor.isHidden()?editor.show():editor.hide(),!0):(self.execCommand("mceAddEditor",0,value),!0)}return self.activeEditor?self.activeEditor.execCommand(cmd,ui,value):!1},triggerSave:function(){each(this.editors,function(editor){editor.save()})},addI18n:function(code,items){I18n.add(code,items)},translate:function(text){return I18n.translate(text)},setActive:function(editor){var activeEditor=this.activeEditor;this.activeEditor!=editor&&(activeEditor&&activeEditor.fire("deactivate",{relatedTarget:editor}),editor.fire("activate",{relatedTarget:activeEditor})),this.activeEditor=editor}},extend(EditorManager,Observable),EditorManager.setup(),window.tinymce=window.tinyMCE=EditorManager,EditorManager}),define("tinymce/LegacyInput",["tinymce/EditorManager","tinymce/util/Tools"],function(EditorManager,Tools){var each=Tools.each,explode=Tools.explode;EditorManager.on("AddEditor",function(e){var editor=e.editor;editor.on("preInit",function(){function replaceWithSpan(node,styles){each(styles,function(value,name){value&&dom.setStyle(node,name,value)}),dom.rename(node,"span")}function convert(e){dom=editor.dom,settings.convert_fonts_to_spans&&each(dom.select("font,u,strike",e.node),function(node){filters[node.nodeName.toLowerCase()](dom,node)})}var filters,fontSizes,dom,settings=editor.settings;settings.inline_styles&&(fontSizes=explode(settings.font_size_legacy_values),filters={font:function(dom,node){replaceWithSpan(node,{backgroundColor:node.style.backgroundColor,color:node.color,fontFamily:node.face,fontSize:fontSizes[parseInt(node.size,10)-1]})},u:function(dom,node){"html4"===editor.settings.schema&&replaceWithSpan(node,{textDecoration:"underline"})},strike:function(dom,node){replaceWithSpan(node,{textDecoration:"line-through"})}},editor.on("PreProcess SetContent",convert))})})}),define("tinymce/util/XHR",["tinymce/util/Observable","tinymce/util/Tools"],function(Observable,Tools){var XHR={send:function(settings){function ready(){!settings.async||4==xhr.readyState||count++>1e4?(settings.success&&1e4>count&&200==xhr.status?settings.success.call(settings.success_scope,""+xhr.responseText,xhr,settings):settings.error&&settings.error.call(settings.error_scope,count>1e4?"TIMED_OUT":"GENERAL",xhr,settings),xhr=null):setTimeout(ready,10)}var xhr,count=0;if(settings.scope=settings.scope||this,settings.success_scope=settings.success_scope||settings.scope,settings.error_scope=settings.error_scope||settings.scope,settings.async=settings.async!==!1,settings.data=settings.data||"",XHR.fire("beforeInitialize",{settings:settings}),xhr=new XMLHttpRequest){if(xhr.overrideMimeType&&xhr.overrideMimeType(settings.content_type),xhr.open(settings.type||(settings.data?"POST":"GET"),settings.url,settings.async),settings.crossDomain&&(xhr.withCredentials=!0),settings.content_type&&xhr.setRequestHeader("Content-Type",settings.content_type),settings.requestheaders&&Tools.each(settings.requestheaders,function(header){xhr.setRequestHeader(header.key,header.value)}),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr=XHR.fire("beforeSend",{xhr:xhr,settings:settings}).xhr,xhr.send(settings.data),!settings.async)return ready();setTimeout(ready,10)}}};return Tools.extend(XHR,Observable),XHR}),define("tinymce/util/JSON",[],function(){function serialize(o,quote){var i,v,t,name;if(quote=quote||'"',null===o)return"null";if(t=typeof o,"string"==t)return v="\bb	t\nn\ff\rr\"\"''\\\\",quote+o.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,b){return'"'===quote&&"'"===a?a:(i=v.indexOf(b),i+1?"\\"+v.charAt(i+1):(a=b.charCodeAt().toString(16),"\\u"+"0000".substring(a.length)+a))})+quote;if("object"==t){if(o.hasOwnProperty&&"[object Array]"===Object.prototype.toString.call(o)){for(i=0,v="[";i<o.length;i++)v+=(i>0?",":"")+serialize(o[i],quote);return v+"]"}v="{";for(name in o)o.hasOwnProperty(name)&&(v+="function"!=typeof o[name]?(v.length>1?","+quote:quote)+name+quote+":"+serialize(o[name],quote):"");return v+"}"}return""+o}return{serialize:serialize,parse:function(text){try{return window[String.fromCharCode(101)+"val"]("("+text+")")}catch(ex){}}}}),define("tinymce/util/JSONRequest",["tinymce/util/JSON","tinymce/util/XHR","tinymce/util/Tools"],function(JSON,XHR,Tools){function JSONRequest(settings){this.settings=extend({},settings),this.count=0}var extend=Tools.extend;return JSONRequest.sendRPC=function(o){return(new JSONRequest).send(o)},JSONRequest.prototype={send:function(args){var ecb=args.error,scb=args.success;args=extend(this.settings,args),args.success=function(c,x){c=JSON.parse(c),"undefined"==typeof c&&(c={error:"JSON Parse error."}),c.error?ecb.call(args.error_scope||args.scope,c.error,x):scb.call(args.success_scope||args.scope,c.result)},args.error=function(ty,x){ecb&&ecb.call(args.error_scope||args.scope,ty,x)},args.data=JSON.serialize({id:args.id||"c"+this.count++,method:args.method,params:args.params}),args.content_type="application/json",XHR.send(args)}},JSONRequest}),define("tinymce/util/JSONP",["tinymce/dom/DOMUtils"],function(DOMUtils){return{callbacks:{},count:0,send:function(settings){var self=this,dom=DOMUtils.DOM,count=settings.count!==undefined?settings.count:self.count,id="tinymce_jsonp_"+count;self.callbacks[count]=function(json){dom.remove(id),delete self.callbacks[count],settings.callback(json)},dom.add(dom.doc.body,"script",{id:id,src:settings.url,type:"text/javascript"}),self.count++}}}),define("tinymce/util/LocalStorage",[],function(){function updateKeys(){keys=[];for(var key in items)keys.push(key);LocalStorage.length=keys.length}function load(){function next(end){var value,nextPos;return nextPos=end!==undefined?pos+end:data.indexOf(",",pos),-1===nextPos||nextPos>data.length?null:(value=data.substring(pos,nextPos),pos=nextPos+1,value)}var key,data,value,pos=0;if(items={},hasOldIEDataSupport){storageElm.load(userDataKey),data=storageElm.getAttribute(userDataKey)||"";do{var offset=next();if(null===offset)break;if(key=next(parseInt(offset,32)||0),null!==key){if(offset=next(),null===offset)break;value=next(parseInt(offset,32)||0),key&&(items[key]=value)}}while(null!==key);updateKeys()}}function save(){var value,data="";if(hasOldIEDataSupport){for(var key in items)value=items[key],data+=(data?",":"")+key.length.toString(32)+","+key+","+value.length.toString(32)+","+value;storageElm.setAttribute(userDataKey,data);try{storageElm.save(userDataKey)}catch(ex){}updateKeys()}}var LocalStorage,storageElm,items,keys,userDataKey,hasOldIEDataSupport;try{if(window.localStorage)return localStorage}catch(ex){}return userDataKey="tinymce",storageElm=document.documentElement,hasOldIEDataSupport=!!storageElm.addBehavior,hasOldIEDataSupport&&storageElm.addBehavior("#default#userData"),LocalStorage={key:function(index){return keys[index]},getItem:function(key){return key in items?items[key]:null},setItem:function(key,value){items[key]=""+value,save()},removeItem:function(key){delete items[key],save()},clear:function(){items={},save()}},load(),LocalStorage}),define("tinymce/Compat",["tinymce/dom/DOMUtils","tinymce/dom/EventUtils","tinymce/dom/ScriptLoader","tinymce/AddOnManager","tinymce/util/Tools","tinymce/Env"],function(DOMUtils,EventUtils,ScriptLoader,AddOnManager,Tools,Env){var tinymce=window.tinymce;return tinymce.DOM=DOMUtils.DOM,tinymce.ScriptLoader=ScriptLoader.ScriptLoader,tinymce.PluginManager=AddOnManager.PluginManager,tinymce.ThemeManager=AddOnManager.ThemeManager,tinymce.dom=tinymce.dom||{},tinymce.dom.Event=EventUtils.Event,Tools.each(Tools,function(func,key){tinymce[key]=func}),Tools.each("isOpera isWebKit isIE isGecko isMac".split(" "),function(name){tinymce[name]=Env[name.substr(2).toLowerCase()]}),{}}),define("tinymce/ui/Layout",["tinymce/util/Class","tinymce/util/Tools"],function(Class,Tools){return Class.extend({Defaults:{firstControlClass:"first",lastControlClass:"last"},init:function(settings){this.settings=Tools.extend({},this.Defaults,settings)},preRender:function(container){container.bodyClasses.add(this.settings.containerClass)},applyClasses:function(items){var firstClass,lastClass,firstItem,lastItem,self=this,settings=self.settings;firstClass=settings.firstControlClass,lastClass=settings.lastControlClass,items.each(function(item){item.classes.remove(firstClass).remove(lastClass).add(settings.controlClass),item.visible()&&(firstItem||(firstItem=item),lastItem=item)}),firstItem&&firstItem.classes.add(firstClass),lastItem&&lastItem.classes.add(lastClass)},renderHtml:function(container){var self=this,html="";return self.applyClasses(container.items()),container.items().each(function(item){html+=item.renderHtml()}),html},recalc:function(){},postRender:function(){},isNative:function(){return!1}})}),define("tinymce/ui/AbsoluteLayout",["tinymce/ui/Layout"],function(Layout){return Layout.extend({Defaults:{containerClass:"abs-layout",controlClass:"abs-layout-item"},recalc:function(container){container.items().filter(":visible").each(function(ctrl){var settings=ctrl.settings;ctrl.layoutRect({x:settings.x,y:settings.y,w:settings.w,h:settings.h}),ctrl.recalc&&ctrl.recalc()})},renderHtml:function(container){return'<div id="'+container._id+'-absend" class="'+container.classPrefix+'abs-end"></div>'+this._super(container)}})}),define("tinymce/ui/Button",["tinymce/ui/Widget"],function(Widget){return Widget.extend({Defaults:{classes:"widget btn",role:"button"},init:function(settings){var size,self=this;self._super(settings),settings=self.settings,size=self.settings.size,self.on("click mousedown",function(e){e.preventDefault()}),self.on("touchstart",function(e){self.fire("click",e),e.preventDefault()}),settings.subtype&&self.classes.add(settings.subtype),size&&self.classes.add("btn-"+size),settings.icon&&self.icon(settings.icon)},icon:function(icon){return arguments.length?(this.state.set("icon",icon),this):this.state.get("icon")},repaint:function(){var btnStyle,btnElm=this.getEl().firstChild;btnElm&&(btnStyle=btnElm.style,btnStyle.width=btnStyle.height="100%"),this._super()},renderHtml:function(){var image,self=this,id=self._id,prefix=self.classPrefix,icon=self.state.get("icon"),text=self.state.get("text"),textHtml="";return image=self.settings.image,image?(icon="none","string"!=typeof image&&(image=window.getSelection?image[0]:image[1]),image=" style=\"background-image: url('"+image+"')\""):image="",text&&(self.classes.add("btn-has-text"),textHtml='<span class="'+prefix+'txt">'+self.encode(text)+"</span>"),icon=self.settings.icon?prefix+"ico "+prefix+"i-"+icon:"",'<div id="'+id+'" class="'+self.classes+'" tabindex="-1" aria-labelledby="'+id+'"><button role="presentation" type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+textHtml+"</button></div>"},bindStates:function(){function setButtonText(text){var $span=$("span."+textCls,self.getEl());text?($span[0]||($("button:first",self.getEl()).append('<span class="'+textCls+'"></span>'),$span=$("span."+textCls,self.getEl())),$span.html(self.encode(text))):$span.remove(),self.classes.toggle("btn-has-text",!!text)}var self=this,$=self.$,textCls=self.classPrefix+"txt";return self.state.on("change:text",function(e){setButtonText(e.value)}),self.state.on("change:icon",function(e){var icon=e.value,prefix=self.classPrefix;self.settings.icon=icon,icon=icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"";var btnElm=self.getEl().firstChild,iconElm=btnElm.getElementsByTagName("i")[0];icon?(iconElm&&iconElm==btnElm.firstChild||(iconElm=document.createElement("i"),btnElm.insertBefore(iconElm,btnElm.firstChild)),iconElm.className=icon):iconElm&&btnElm.removeChild(iconElm),setButtonText(self.state.get("text"))}),self._super()}})}),define("tinymce/ui/ButtonGroup",["tinymce/ui/Container"],function(Container){return Container.extend({Defaults:{defaultType:"button",role:"group"},renderHtml:function(){var self=this,layout=self._layout;return self.classes.add("btn-group"),self.preRender(),layout.preRender(self),'<div id="'+self._id+'" class="'+self.classes+'"><div id="'+self._id+'-body">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></div>"}})}),define("tinymce/ui/Checkbox",["tinymce/ui/Widget"],function(Widget){return Widget.extend({Defaults:{classes:"checkbox",role:"checkbox",checked:!1},init:function(settings){var self=this;self._super(settings),self.on("click mousedown",function(e){e.preventDefault()}),self.on("click",function(e){e.preventDefault(),self.disabled()||self.checked(!self.checked())}),self.checked(self.settings.checked)},checked:function(state){return arguments.length?(this.state.set("checked",state),this):this.state.get("checked")},value:function(state){return arguments.length?this.checked(state):this.checked()},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix;return'<div id="'+id+'" class="'+self.classes+'" unselectable="on" aria-labelledby="'+id+'-al" tabindex="-1"><i class="'+prefix+"ico "+prefix+'i-checkbox"></i><span id="'+id+'-al" class="'+prefix+'label">'+self.encode(self.state.get("text"))+"</span></div>"},bindStates:function(){function checked(state){self.classes.toggle("checked",state),self.aria("checked",state)}var self=this;return self.state.on("change:text",function(e){self.getEl("al").firstChild.data=self.translate(e.value)}),self.state.on("change:checked change:value",function(e){self.fire("change"),checked(e.value)}),self.state.on("change:icon",function(e){var icon=e.value,prefix=self.classPrefix;if("undefined"==typeof icon)return self.settings.icon;self.settings.icon=icon,icon=icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"";var btnElm=self.getEl().firstChild,iconElm=btnElm.getElementsByTagName("i")[0];icon?(iconElm&&iconElm==btnElm.firstChild||(iconElm=document.createElement("i"),btnElm.insertBefore(iconElm,btnElm.firstChild)),iconElm.className=icon):iconElm&&btnElm.removeChild(iconElm)}),self.state.get("checked")&&checked(!0),self._super()}})}),define("tinymce/ui/ComboBox",["tinymce/ui/Widget","tinymce/ui/Factory","tinymce/ui/DomUtils","tinymce/dom/DomQuery"],function(Widget,Factory,DomUtils,$){return Widget.extend({init:function(settings){var self=this;self._super(settings),settings=self.settings,self.classes.add("combobox"),self.subinput=!0,self.ariaTarget="inp",settings.menu=settings.menu||settings.values,settings.menu&&(settings.icon="caret"),self.on("click",function(e){var elm=e.target,root=self.getEl();if($.contains(root,elm)||elm==root)for(;elm&&elm!=root;)elm.id&&-1!=elm.id.indexOf("-open")&&(self.fire("action"),settings.menu&&(self.showMenu(),e.aria&&self.menu.items()[0].focus())),elm=elm.parentNode}),self.on("keydown",function(e){"INPUT"==e.target.nodeName&&13==e.keyCode&&self.parents().reverse().each(function(ctrl){var stateValue=self.state.get("value"),inputValue=self.getEl("inp").value;return e.preventDefault(),self.state.set("value",inputValue),stateValue!=inputValue&&self.fire("change"),ctrl.hasEventListeners("submit")&&ctrl.toJSON?(ctrl.fire("submit",{data:ctrl.toJSON()}),!1):void 0})}),self.on("keyup",function(e){"INPUT"==e.target.nodeName&&self.state.set("value",e.target.value)})},showMenu:function(){var menu,self=this,settings=self.settings;self.menu||(menu=settings.menu||[],menu.length?menu={type:"menu",items:menu}:menu.type=menu.type||"menu",self.menu=Factory.create(menu).parent(self).renderTo(self.getContainerElm()),self.fire("createmenu"),self.menu.reflow(),self.menu.on("cancel",function(e){e.control===self.menu&&self.focus()}),self.menu.on("show hide",function(e){e.control.items().each(function(ctrl){ctrl.active(ctrl.value()==self.value())})}).fire("show"),self.menu.on("select",function(e){self.value(e.control.value())}),self.on("focusin",function(e){"INPUT"==e.target.tagName.toUpperCase()&&self.menu.hide()}),self.aria("expanded",!0)),self.menu.show(),self.menu.layoutRect({w:self.layoutRect().w}),self.menu.moveRel(self.getEl(),self.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])},focus:function(){this.getEl("inp").focus()},repaint:function(){var width,lineHeight,self=this,elm=self.getEl(),openElm=self.getEl("open"),rect=self.layoutRect();width=openElm?rect.w-DomUtils.getSize(openElm).width-10:rect.w-10;var doc=document;return doc.all&&(!doc.documentMode||doc.documentMode<=8)&&(lineHeight=self.layoutRect().h-2+"px"),
$(elm.firstChild).css({width:width,lineHeight:lineHeight}),self._super(),self},postRender:function(){var self=this;return $(this.getEl("inp")).on("change",function(e){self.state.set("value",e.target.value),self.fire("change",e)}),self._super()},renderHtml:function(){var icon,text,self=this,id=self._id,settings=self.settings,prefix=self.classPrefix,value=self.state.get("value")||"",openBtnHtml="",extraAttrs="";return"spellcheck"in settings&&(extraAttrs+=' spellcheck="'+settings.spellcheck+'"'),settings.maxLength&&(extraAttrs+=' maxlength="'+settings.maxLength+'"'),settings.size&&(extraAttrs+=' size="'+settings.size+'"'),settings.subtype&&(extraAttrs+=' type="'+settings.subtype+'"'),self.disabled()&&(extraAttrs+=' disabled="disabled"'),icon=settings.icon,icon&&"caret"!=icon&&(icon=prefix+"ico "+prefix+"i-"+settings.icon),text=self.state.get("text"),(icon||text)&&(openBtnHtml='<div id="'+id+'-open" class="'+prefix+"btn "+prefix+'open" tabIndex="-1" role="button"><button id="'+id+'-action" type="button" hidefocus="1" tabindex="-1">'+("caret"!=icon?'<i class="'+icon+'"></i>':'<i class="'+prefix+'caret"></i>')+(text?(icon?" ":"")+text:"")+"</button></div>",self.classes.add("has-open")),'<div id="'+id+'" class="'+self.classes+'"><input id="'+id+'-inp" class="'+prefix+'textbox" value="'+self.encode(value,!1)+'" hidefocus="1"'+extraAttrs+' placeholder="'+self.encode(settings.placeholder)+'" />'+openBtnHtml+"</div>"},value:function(value){return arguments.length?(this.state.set("value",value),this):(this.state.get("rendered")&&this.state.set("value",this.getEl("inp").value),this.state.get("value"))},bindStates:function(){var self=this;return self.state.on("change:value",function(e){self.getEl("inp").value!=e.value&&(self.getEl("inp").value=e.value)}),self.state.on("change:disabled",function(e){self.getEl("inp").disabled=e.value}),self._super()},remove:function(){$(this.getEl("inp")).off(),this._super()}})}),define("tinymce/ui/ColorBox",["tinymce/ui/ComboBox"],function(ComboBox){return ComboBox.extend({init:function(settings){var self=this;settings.spellcheck=!1,settings.onaction&&(settings.icon="none"),self._super(settings),self.classes.add("colorbox"),self.on("change keyup postrender",function(){self.repaintColor(self.value())})},repaintColor:function(value){var elm=this.getEl().getElementsByTagName("i")[0];if(elm)try{elm.style.background=value}catch(ex){}},bindStates:function(){var self=this;return self.state.on("change:value",function(e){self._rendered&&self.repaintColor(e.value)}),self._super()}})}),define("tinymce/ui/PanelButton",["tinymce/ui/Button","tinymce/ui/FloatPanel"],function(Button,FloatPanel){return Button.extend({showPanel:function(){var self=this,settings=self.settings;if(self.active(!0),self.panel)self.panel.show();else{var panelSettings=settings.panel;panelSettings.type&&(panelSettings={layout:"grid",items:panelSettings}),panelSettings.role=panelSettings.role||"dialog",panelSettings.popover=!0,panelSettings.autohide=!0,panelSettings.ariaRoot=!0,self.panel=new FloatPanel(panelSettings).on("hide",function(){self.active(!1)}).on("cancel",function(e){e.stopPropagation(),self.focus(),self.hidePanel()}).parent(self).renderTo(self.getContainerElm()),self.panel.fire("show"),self.panel.reflow()}self.panel.moveRel(self.getEl(),settings.popoverAlign||(self.isRtl()?["bc-tr","bc-tc"]:["bc-tl","bc-tc"]))},hidePanel:function(){var self=this;self.panel&&self.panel.hide()},postRender:function(){var self=this;return self.aria("haspopup",!0),self.on("click",function(e){e.control===self&&(self.panel&&self.panel.visible()?self.hidePanel():(self.showPanel(),self.panel.focus(!!e.aria)))}),self._super()},remove:function(){return this.panel&&(this.panel.remove(),this.panel=null),this._super()}})}),define("tinymce/ui/ColorButton",["tinymce/ui/PanelButton","tinymce/dom/DOMUtils"],function(PanelButton,DomUtils){var DOM=DomUtils.DOM;return PanelButton.extend({init:function(settings){this._super(settings),this.classes.add("colorbutton")},color:function(color){return color?(this._color=color,this.getEl("preview").style.backgroundColor=color,this):this._color},resetColor:function(){return this._color=null,this.getEl("preview").style.backgroundColor=null,this},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix,text=self.state.get("text"),icon=self.settings.icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"",image=self.settings.image?" style=\"background-image: url('"+self.settings.image+"')\"":"",textHtml="";return text&&(self.classes.add("btn-has-text"),textHtml='<span class="'+prefix+'txt">'+self.encode(text)+"</span>"),'<div id="'+id+'" class="'+self.classes+'" role="button" tabindex="-1" aria-haspopup="true"><button role="presentation" hidefocus="1" type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+'<span id="'+id+'-preview" class="'+prefix+'preview"></span>'+textHtml+'</button><button type="button" class="'+prefix+'open" hidefocus="1" tabindex="-1"> <i class="'+prefix+'caret"></i></button></div>'},postRender:function(){var self=this,onClickHandler=self.settings.onclick;return self.on("click",function(e){e.aria&&"down"==e.aria.key||e.control!=self||DOM.getParent(e.target,"."+self.classPrefix+"open")||(e.stopImmediatePropagation(),onClickHandler.call(self,e))}),delete self.settings.onclick,self._super()}})}),define("tinymce/util/Color",[],function(){function Color(value){function rgb2hsv(r,g,b){var h,s,v,d,minRGB,maxRGB;return h=0,s=0,v=0,r/=255,g/=255,b/=255,minRGB=min(r,min(g,b)),maxRGB=max(r,max(g,b)),minRGB==maxRGB?(v=minRGB,{h:0,s:0,v:100*v}):(d=r==minRGB?g-b:b==minRGB?r-g:b-r,h=r==minRGB?3:b==minRGB?1:5,h=60*(h-d/(maxRGB-minRGB)),s=(maxRGB-minRGB)/maxRGB,v=maxRGB,{h:round(h),s:round(100*s),v:round(100*v)})}function hsvToRgb(hue,saturation,brightness){var side,chroma,x,match;if(hue=(parseInt(hue,10)||0)%360,saturation=parseInt(saturation,10)/100,brightness=parseInt(brightness,10)/100,saturation=max(0,min(saturation,1)),brightness=max(0,min(brightness,1)),0===saturation)return void(r=g=b=round(255*brightness));switch(side=hue/60,chroma=brightness*saturation,x=chroma*(1-Math.abs(side%2-1)),match=brightness-chroma,Math.floor(side)){case 0:r=chroma,g=x,b=0;break;case 1:r=x,g=chroma,b=0;break;case 2:r=0,g=chroma,b=x;break;case 3:r=0,g=x,b=chroma;break;case 4:r=x,g=0,b=chroma;break;case 5:r=chroma,g=0,b=x;break;default:r=g=b=0}r=round(255*(r+match)),g=round(255*(g+match)),b=round(255*(b+match))}function toHex(){function hex(val){return val=parseInt(val,10).toString(16),val.length>1?val:"0"+val}return"#"+hex(r)+hex(g)+hex(b)}function toRgb(){return{r:r,g:g,b:b}}function toHsv(){return rgb2hsv(r,g,b)}function parse(value){var matches;return"object"==typeof value?"r"in value?(r=value.r,g=value.g,b=value.b):"v"in value&&hsvToRgb(value.h,value.s,value.v):(matches=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(value))?(r=parseInt(matches[1],10),g=parseInt(matches[2],10),b=parseInt(matches[3],10)):(matches=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value))?(r=parseInt(matches[1],16),g=parseInt(matches[2],16),b=parseInt(matches[3],16)):(matches=/#([0-F])([0-F])([0-F])/gi.exec(value))&&(r=parseInt(matches[1]+matches[1],16),g=parseInt(matches[2]+matches[2],16),b=parseInt(matches[3]+matches[3],16)),r=0>r?0:r>255?255:r,g=0>g?0:g>255?255:g,b=0>b?0:b>255?255:b,self}var self=this,r=0,g=0,b=0;value&&parse(value),self.toRgb=toRgb,self.toHsv=toHsv,self.toHex=toHex,self.parse=parse}var min=Math.min,max=Math.max,round=Math.round;return Color}),define("tinymce/ui/ColorPicker",["tinymce/ui/Widget","tinymce/ui/DragHelper","tinymce/ui/DomUtils","tinymce/util/Color"],function(Widget,DragHelper,DomUtils,Color){return Widget.extend({Defaults:{classes:"widget colorpicker"},init:function(settings){this._super(settings)},postRender:function(){function getPos(elm,event){var x,y,pos=DomUtils.getPos(elm);return x=event.pageX-pos.x,y=event.pageY-pos.y,x=Math.max(0,Math.min(x/elm.clientWidth,1)),y=Math.max(0,Math.min(y/elm.clientHeight,1)),{x:x,y:y}}function updateColor(hsv,hueUpdate){var hue=(360-hsv.h)/360;DomUtils.css(huePointElm,{top:100*hue+"%"}),hueUpdate||DomUtils.css(svPointElm,{left:hsv.s+"%",top:100-hsv.v+"%"}),svRootElm.style.background=new Color({s:100,v:100,h:hsv.h}).toHex(),self.color().parse({s:hsv.s,v:hsv.v,h:hsv.h})}function updateSaturationAndValue(e){var pos;pos=getPos(svRootElm,e),hsv.s=100*pos.x,hsv.v=100*(1-pos.y),updateColor(hsv),self.fire("change")}function updateHue(e){var pos;pos=getPos(hueRootElm,e),hsv=color.toHsv(),hsv.h=360*(1-pos.y),updateColor(hsv,!0),self.fire("change")}var hsv,hueRootElm,huePointElm,svRootElm,svPointElm,self=this,color=self.color();hueRootElm=self.getEl("h"),huePointElm=self.getEl("hp"),svRootElm=self.getEl("sv"),svPointElm=self.getEl("svp"),self._repaint=function(){hsv=color.toHsv(),updateColor(hsv)},self._super(),self._svdraghelper=new DragHelper(self._id+"-sv",{start:updateSaturationAndValue,drag:updateSaturationAndValue}),self._hdraghelper=new DragHelper(self._id+"-h",{start:updateHue,drag:updateHue}),self._repaint()},rgb:function(){return this.color().toRgb()},value:function(value){var self=this;return arguments.length?(self.color().parse(value),void(self._rendered&&self._repaint())):self.color().toHex()},color:function(){return this._color||(this._color=new Color),this._color},renderHtml:function(){function getOldIeFallbackHtml(){var i,l,gradientPrefix,stopsList,html="";for(gradientPrefix="filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=",stopsList=stops.split(","),i=0,l=stopsList.length-1;l>i;i++)html+='<div class="'+prefix+'colorpicker-h-chunk" style="height:'+100/l+"%;"+gradientPrefix+stopsList[i]+",endColorstr="+stopsList[i+1]+");-ms-"+gradientPrefix+stopsList[i]+",endColorstr="+stopsList[i+1]+')"></div>';return html}var hueHtml,self=this,id=self._id,prefix=self.classPrefix,stops="#ff0000,#ff0080,#ff00ff,#8000ff,#0000ff,#0080ff,#00ffff,#00ff80,#00ff00,#80ff00,#ffff00,#ff8000,#ff0000",gradientCssText="background: -ms-linear-gradient(top,"+stops+");background: linear-gradient(to bottom,"+stops+");";return hueHtml='<div id="'+id+'-h" class="'+prefix+'colorpicker-h" style="'+gradientCssText+'">'+getOldIeFallbackHtml()+'<div id="'+id+'-hp" class="'+prefix+'colorpicker-h-marker"></div></div>','<div id="'+id+'" class="'+self.classes+'"><div id="'+id+'-sv" class="'+prefix+'colorpicker-sv"><div class="'+prefix+'colorpicker-overlay1"><div class="'+prefix+'colorpicker-overlay2"><div id="'+id+'-svp" class="'+prefix+'colorpicker-selector1"><div class="'+prefix+'colorpicker-selector2"></div></div></div></div></div>'+hueHtml+"</div>"}})}),define("tinymce/ui/Path",["tinymce/ui/Widget"],function(Widget){return Widget.extend({init:function(settings){var self=this;settings.delimiter||(settings.delimiter="»"),self._super(settings),self.classes.add("path"),self.canFocus=!0,self.on("click",function(e){var index,target=e.target;(index=target.getAttribute("data-index"))&&self.fire("select",{value:self.row()[index],index:index})}),self.row(self.settings.row)},focus:function(){var self=this;return self.getEl().firstChild.focus(),self},row:function(row){return arguments.length?(this.state.set("row",row),this):this.state.get("row")},renderHtml:function(){var self=this;return'<div id="'+self._id+'" class="'+self.classes+'">'+self._getDataPathHtml(self.state.get("row"))+"</div>"},bindStates:function(){var self=this;return self.state.on("change:row",function(e){self.innerHtml(self._getDataPathHtml(e.value))}),self._super()},_getDataPathHtml:function(data){var i,l,self=this,parts=data||[],html="",prefix=self.classPrefix;for(i=0,l=parts.length;l>i;i++)html+=(i>0?'<div class="'+prefix+'divider" aria-hidden="true"> '+self.settings.delimiter+" </div>":"")+'<div role="button" class="'+prefix+"path-item"+(i==l-1?" "+prefix+"last":"")+'" data-index="'+i+'" tabindex="-1" id="'+self._id+"-"+i+'" aria-level="'+i+'">'+parts[i].name+"</div>";return html||(html='<div class="'+prefix+'path-item"> </div>'),html}})}),define("tinymce/ui/ElementPath",["tinymce/ui/Path","tinymce/EditorManager"],function(Path,EditorManager){return Path.extend({postRender:function(){function isHidden(elm){if(1===elm.nodeType){if("BR"==elm.nodeName||elm.getAttribute("data-mce-bogus"))return!0;if("bookmark"===elm.getAttribute("data-mce-type"))return!0}return!1}var self=this,editor=EditorManager.activeEditor;return editor.settings.elementpath!==!1&&(self.on("select",function(e){editor.focus(),editor.selection.select(this.row()[e.index].element),editor.nodeChanged()}),editor.on("nodeChange",function(e){for(var outParents=[],parents=e.parents,i=parents.length;i--;)if(1==parents[i].nodeType&&!isHidden(parents[i])){var args=editor.fire("ResolveName",{name:parents[i].nodeName.toLowerCase(),target:parents[i]});if(args.isDefaultPrevented()||outParents.push({name:args.name,element:parents[i]}),args.isPropagationStopped())break}self.row(outParents)})),self._super()}})}),define("tinymce/ui/FormItem",["tinymce/ui/Container"],function(Container){return Container.extend({Defaults:{layout:"flex",align:"center",defaults:{flex:1}},renderHtml:function(){var self=this,layout=self._layout,prefix=self.classPrefix;return self.classes.add("formitem"),layout.preRender(self),'<div id="'+self._id+'" class="'+self.classes+'" hidefocus="1" tabindex="-1">'+(self.settings.title?'<div id="'+self._id+'-title" class="'+prefix+'title">'+self.settings.title+"</div>":"")+'<div id="'+self._id+'-body" class="'+self.bodyClasses+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></div>"}})}),define("tinymce/ui/Form",["tinymce/ui/Container","tinymce/ui/FormItem","tinymce/util/Tools"],function(Container,FormItem,Tools){return Container.extend({Defaults:{containerCls:"form",layout:"flex",direction:"column",align:"stretch",flex:1,padding:20,labelGap:30,spacing:10,callbacks:{submit:function(){this.submit()}}},preRender:function(){var self=this,items=self.items();self.settings.formItemDefaults||(self.settings.formItemDefaults={layout:"flex",autoResize:"overflow",defaults:{flex:1}}),items.each(function(ctrl){var formItem,label=ctrl.settings.label;label&&(formItem=new FormItem(Tools.extend({items:{type:"label",id:ctrl._id+"-l",text:label,flex:0,forId:ctrl._id,disabled:ctrl.disabled()}},self.settings.formItemDefaults)),formItem.type="formitem",ctrl.aria("labelledby",ctrl._id+"-l"),"undefined"==typeof ctrl.settings.flex&&(ctrl.settings.flex=1),self.replace(ctrl,formItem),formItem.add(ctrl))})},submit:function(){return this.fire("submit",{data:this.toJSON()})},postRender:function(){var self=this;self._super(),self.fromJSON(self.settings.data)},bindStates:function(){function recalcLabels(){var i,labelGap,items,maxLabelWidth=0,labels=[];if(self.settings.labelGapCalc!==!1)for(items="children"==self.settings.labelGapCalc?self.find("formitem"):self.items(),items.filter("formitem").each(function(item){var labelCtrl=item.items()[0],labelWidth=labelCtrl.getEl().clientWidth;maxLabelWidth=labelWidth>maxLabelWidth?labelWidth:maxLabelWidth,labels.push(labelCtrl)}),labelGap=self.settings.labelGap||0,i=labels.length;i--;)labels[i].settings.minWidth=maxLabelWidth+labelGap}var self=this;self._super(),self.on("show",recalcLabels),recalcLabels()}})}),define("tinymce/ui/FieldSet",["tinymce/ui/Form"],function(Form){return Form.extend({Defaults:{containerCls:"fieldset",layout:"flex",direction:"column",align:"stretch",flex:1,padding:"25 15 5 15",labelGap:30,spacing:10,border:1},renderHtml:function(){var self=this,layout=self._layout,prefix=self.classPrefix;return self.preRender(),layout.preRender(self),'<fieldset id="'+self._id+'" class="'+self.classes+'" hidefocus="1" tabindex="-1">'+(self.settings.title?'<legend id="'+self._id+'-title" class="'+prefix+'fieldset-title">'+self.settings.title+"</legend>":"")+'<div id="'+self._id+'-body" class="'+self.bodyClasses+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></fieldset>"}})}),define("tinymce/ui/FilePicker",["tinymce/ui/ComboBox","tinymce/util/Tools"],function(ComboBox,Tools){return ComboBox.extend({init:function(settings){var actionCallback,fileBrowserCallback,fileBrowserCallbackTypes,self=this,editor=tinymce.activeEditor,editorSettings=editor.settings;settings.spellcheck=!1,fileBrowserCallbackTypes=editorSettings.file_picker_types||editorSettings.file_browser_callback_types,fileBrowserCallbackTypes&&(fileBrowserCallbackTypes=Tools.makeMap(fileBrowserCallbackTypes,/[, ]/)),fileBrowserCallbackTypes&&!fileBrowserCallbackTypes[settings.filetype]||(fileBrowserCallback=editorSettings.file_picker_callback,!fileBrowserCallback||fileBrowserCallbackTypes&&!fileBrowserCallbackTypes[settings.filetype]?(fileBrowserCallback=editorSettings.file_browser_callback,!fileBrowserCallback||fileBrowserCallbackTypes&&!fileBrowserCallbackTypes[settings.filetype]||(actionCallback=function(){fileBrowserCallback(self.getEl("inp").id,self.value(),settings.filetype,window)})):actionCallback=function(){var meta=self.fire("beforecall").meta;meta=Tools.extend({filetype:settings.filetype},meta),fileBrowserCallback.call(editor,function(value,meta){self.value(value).fire("change",{meta:meta})},self.value(),meta)}),actionCallback&&(settings.icon="browse",settings.onaction=actionCallback),self._super(settings)}})}),define("tinymce/ui/FitLayout",["tinymce/ui/AbsoluteLayout"],function(AbsoluteLayout){return AbsoluteLayout.extend({recalc:function(container){var contLayoutRect=container.layoutRect(),paddingBox=container.paddingBox;container.items().filter(":visible").each(function(ctrl){ctrl.layoutRect({x:paddingBox.left,y:paddingBox.top,w:contLayoutRect.innerW-paddingBox.right-paddingBox.left,h:contLayoutRect.innerH-paddingBox.top-paddingBox.bottom}),ctrl.recalc&&ctrl.recalc()})}})}),define("tinymce/ui/FlexLayout",["tinymce/ui/AbsoluteLayout"],function(AbsoluteLayout){return AbsoluteLayout.extend({recalc:function(container){var i,l,items,contLayoutRect,contPaddingBox,contSettings,align,pack,spacing,totalFlex,availableSpace,direction,ctrl,ctrlLayoutRect,ctrlSettings,flex,size,maxSize,ratio,rect,pos,maxAlignEndPos,sizeName,minSizeName,posName,maxSizeName,beforeName,innerSizeName,deltaSizeName,contentSizeName,alignAxisName,alignInnerSizeName,alignSizeName,alignMinSizeName,alignBeforeName,alignAfterName,alignDeltaSizeName,alignContentSizeName,maxSizeItems=[],max=Math.max,min=Math.min;for(items=container.items().filter(":visible"),contLayoutRect=container.layoutRect(),contPaddingBox=container.paddingBox,contSettings=container.settings,direction=container.isRtl()?contSettings.direction||"row-reversed":contSettings.direction,align=contSettings.align,pack=container.isRtl()?contSettings.pack||"end":contSettings.pack,spacing=contSettings.spacing||0,"row-reversed"!=direction&&"column-reverse"!=direction||(items=items.set(items.toArray().reverse()),direction=direction.split("-")[0]),"column"==direction?(posName="y",sizeName="h",minSizeName="minH",maxSizeName="maxH",innerSizeName="innerH",beforeName="top",deltaSizeName="deltaH",contentSizeName="contentH",alignBeforeName="left",alignSizeName="w",alignAxisName="x",alignInnerSizeName="innerW",alignMinSizeName="minW",alignAfterName="right",alignDeltaSizeName="deltaW",alignContentSizeName="contentW"):(posName="x",sizeName="w",minSizeName="minW",maxSizeName="maxW",innerSizeName="innerW",beforeName="left",deltaSizeName="deltaW",contentSizeName="contentW",alignBeforeName="top",alignSizeName="h",alignAxisName="y",alignInnerSizeName="innerH",alignMinSizeName="minH",alignAfterName="bottom",alignDeltaSizeName="deltaH",alignContentSizeName="contentH"),availableSpace=contLayoutRect[innerSizeName]-contPaddingBox[beforeName]-contPaddingBox[beforeName],maxAlignEndPos=totalFlex=0,i=0,l=items.length;l>i;i++)ctrl=items[i],ctrlLayoutRect=ctrl.layoutRect(),ctrlSettings=ctrl.settings,flex=ctrlSettings.flex,availableSpace-=l-1>i?spacing:0,flex>0&&(totalFlex+=flex,ctrlLayoutRect[maxSizeName]&&maxSizeItems.push(ctrl),ctrlLayoutRect.flex=flex),availableSpace-=ctrlLayoutRect[minSizeName],size=contPaddingBox[alignBeforeName]+ctrlLayoutRect[alignMinSizeName]+contPaddingBox[alignAfterName],size>maxAlignEndPos&&(maxAlignEndPos=size);if(rect={},0>availableSpace?rect[minSizeName]=contLayoutRect[minSizeName]-availableSpace+contLayoutRect[deltaSizeName]:rect[minSizeName]=contLayoutRect[innerSizeName]-availableSpace+contLayoutRect[deltaSizeName],rect[alignMinSizeName]=maxAlignEndPos+contLayoutRect[alignDeltaSizeName],rect[contentSizeName]=contLayoutRect[innerSizeName]-availableSpace,rect[alignContentSizeName]=maxAlignEndPos,rect.minW=min(rect.minW,contLayoutRect.maxW),rect.minH=min(rect.minH,contLayoutRect.maxH),rect.minW=max(rect.minW,contLayoutRect.startMinWidth),rect.minH=max(rect.minH,contLayoutRect.startMinHeight),!contLayoutRect.autoResize||rect.minW==contLayoutRect.minW&&rect.minH==contLayoutRect.minH){for(ratio=availableSpace/totalFlex,i=0,l=maxSizeItems.length;l>i;i++)ctrl=maxSizeItems[i],ctrlLayoutRect=ctrl.layoutRect(),maxSize=ctrlLayoutRect[maxSizeName],size=ctrlLayoutRect[minSizeName]+ctrlLayoutRect.flex*ratio,size>maxSize?(availableSpace-=ctrlLayoutRect[maxSizeName]-ctrlLayoutRect[minSizeName],totalFlex-=ctrlLayoutRect.flex,ctrlLayoutRect.flex=0,ctrlLayoutRect.maxFlexSize=maxSize):ctrlLayoutRect.maxFlexSize=0;for(ratio=availableSpace/totalFlex,pos=contPaddingBox[beforeName],rect={},0===totalFlex&&("end"==pack?pos=availableSpace+contPaddingBox[beforeName]:"center"==pack?(pos=Math.round(contLayoutRect[innerSizeName]/2-(contLayoutRect[innerSizeName]-availableSpace)/2)+contPaddingBox[beforeName],0>pos&&(pos=contPaddingBox[beforeName])):"justify"==pack&&(pos=contPaddingBox[beforeName],spacing=Math.floor(availableSpace/(items.length-1)))),rect[alignAxisName]=contPaddingBox[alignBeforeName],i=0,l=items.length;l>i;i++)ctrl=items[i],ctrlLayoutRect=ctrl.layoutRect(),size=ctrlLayoutRect.maxFlexSize||ctrlLayoutRect[minSizeName],"center"===align?rect[alignAxisName]=Math.round(contLayoutRect[alignInnerSizeName]/2-ctrlLayoutRect[alignSizeName]/2):"stretch"===align?(rect[alignSizeName]=max(ctrlLayoutRect[alignMinSizeName]||0,contLayoutRect[alignInnerSizeName]-contPaddingBox[alignBeforeName]-contPaddingBox[alignAfterName]),rect[alignAxisName]=contPaddingBox[alignBeforeName]):"end"===align&&(rect[alignAxisName]=contLayoutRect[alignInnerSizeName]-ctrlLayoutRect[alignSizeName]-contPaddingBox.top),ctrlLayoutRect.flex>0&&(size+=ctrlLayoutRect.flex*ratio),rect[sizeName]=size,rect[posName]=pos,ctrl.layoutRect(rect),ctrl.recalc&&ctrl.recalc(),pos+=size+spacing}else if(rect.w=rect.minW,rect.h=rect.minH,container.layoutRect(rect),this.recalc(container),null===container._lastRect){var parentCtrl=container.parent();parentCtrl&&(parentCtrl._lastRect=null,parentCtrl.recalc())}}})}),define("tinymce/ui/FlowLayout",["tinymce/ui/Layout"],function(Layout){return Layout.extend({Defaults:{containerClass:"flow-layout",controlClass:"flow-layout-item",endClass:"break"},recalc:function(container){container.items().filter(":visible").each(function(ctrl){ctrl.recalc&&ctrl.recalc()})},isNative:function(){return!0}})}),define("tinymce/ui/FormatControls",["tinymce/ui/Control","tinymce/ui/Widget","tinymce/ui/FloatPanel","tinymce/util/Tools","tinymce/EditorManager","tinymce/Env"],function(Control,Widget,FloatPanel,Tools,EditorManager,Env){function registerControls(editor){function createListBoxChangeHandler(items,formatName){return function(){var self=this;editor.on("nodeChange",function(e){var formatter=editor.formatter,value=null;each(e.parents,function(node){return each(items,function(item){return formatName?formatter.matchNode(node,formatName,{value:item.value})&&(value=item.value):formatter.matchNode(node,item.value)&&(value=item.value),value?!1:void 0}),value?!1:void 0}),self.value(value)})}}function createFormats(formats){formats=formats.replace(/;$/,"").split(";");for(var i=formats.length;i--;)formats[i]=formats[i].split("=");return formats}function createFormatMenu(){function createMenu(formats){var menu=[];return formats?(each(formats,function(format){var menuItem={text:format.title,icon:format.icon};if(format.items)menuItem.menu=createMenu(format.items);else{var formatName=format.format||"custom"+count++;format.format||(format.name=formatName,newFormats.push(format)),menuItem.format=formatName,menuItem.cmd=format.cmd}menu.push(menuItem)}),menu):void 0}function createStylesMenu(){var menu;return menu=createMenu(editor.settings.style_formats_merge?editor.settings.style_formats?defaultStyleFormats.concat(editor.settings.style_formats):defaultStyleFormats:editor.settings.style_formats||defaultStyleFormats)}var count=0,newFormats=[],defaultStyleFormats=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}];return editor.on("init",function(){each(newFormats,function(format){editor.formatter.register(format.name,format)})}),{type:"menu",items:createStylesMenu(),onPostRender:function(e){editor.fire("renderFormatsMenu",{control:e.control})},itemDefaults:{preview:!0,textStyle:function(){return this.settings.format?editor.formatter.getCssText(this.settings.format):void 0},onPostRender:function(){var self=this;self.parent().on("show",function(){var formatName,command;formatName=self.settings.format,formatName&&(self.disabled(!editor.formatter.canApply(formatName)),self.active(editor.formatter.match(formatName))),command=self.settings.cmd,command&&self.active(editor.queryCommandState(command))})},onclick:function(){this.settings.format&&toggleFormat(this.settings.format),this.settings.cmd&&editor.execCommand(this.settings.cmd)}}}}function initOnPostRender(name){return function(){var self=this;editor.formatter?editor.formatter.formatChanged(name,function(state){self.active(state)}):editor.on("init",function(){editor.formatter.formatChanged(name,function(state){self.active(state)})})}}function toggleUndoRedoState(type){return function(){function checkState(){return editor.undoManager?editor.undoManager[type]():!1}var self=this;type="redo"==type?"hasRedo":"hasUndo",self.disabled(!checkState()),editor.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",function(){self.disabled(editor.readonly||!checkState())})}}function toggleVisualAidState(){var self=this;editor.on("VisualAid",function(e){self.active(e.hasVisual)}),self.active(editor.hasVisual)}function toggleFormat(fmt){fmt.control&&(fmt=fmt.control.value()),fmt&&editor.execCommand("mceToggleFormat",!1,fmt)}var formatMenu;formatMenu=createFormatMenu(),each({bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript"},function(text,name){editor.addButton(name,{tooltip:text,onPostRender:initOnPostRender(name),onclick:function(){toggleFormat(name)}})}),each({outdent:["Decrease indent","Outdent"],indent:["Increase indent","Indent"],cut:["Cut","Cut"],copy:["Copy","Copy"],paste:["Paste","Paste"],help:["Help","mceHelp"],selectall:["Select all","SelectAll"],removeformat:["Clear formatting","RemoveFormat"],visualaid:["Visual aids","mceToggleVisualAid"],newdocument:["New document","mceNewDocument"]},function(item,name){editor.addButton(name,{tooltip:item[0],cmd:item[1]})}),each({blockquote:["Blockquote","mceBlockQuote"],numlist:["Numbered list","InsertOrderedList"],bullist:["Bullet list","InsertUnorderedList"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],alignleft:["Align left","JustifyLeft"],aligncenter:["Align center","JustifyCenter"],alignright:["Align right","JustifyRight"],alignjustify:["Justify","JustifyFull"],alignnone:["No alignment","JustifyNone"]},function(item,name){editor.addButton(name,{tooltip:item[0],cmd:item[1],onPostRender:initOnPostRender(name)})}),editor.addButton("undo",{tooltip:"Undo",onPostRender:toggleUndoRedoState("undo"),cmd:"undo"}),editor.addButton("redo",{tooltip:"Redo",onPostRender:toggleUndoRedoState("redo"),cmd:"redo"}),editor.addMenuItem("newdocument",{text:"New document",icon:"newdocument",cmd:"mceNewDocument"}),editor.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onPostRender:toggleUndoRedoState("undo"),cmd:"undo"}),editor.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onPostRender:toggleUndoRedoState("redo"),cmd:"redo"}),editor.addMenuItem("visualaid",{text:"Visual aids",selectable:!0,onPostRender:toggleVisualAidState,cmd:"mceToggleVisualAid"}),editor.addButton("remove",{tooltip:"Remove",icon:"remove",cmd:"Delete"}),each({cut:["Cut","Cut","Meta+X"],copy:["Copy","Copy","Meta+C"],paste:["Paste","Paste","Meta+V"],selectall:["Select all","SelectAll","Meta+A"],bold:["Bold","Bold","Meta+B"],italic:["Italic","Italic","Meta+I"],underline:["Underline","Underline"],strikethrough:["Strikethrough","Strikethrough"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],removeformat:["Clear formatting","RemoveFormat"]},function(item,name){editor.addMenuItem(name,{text:item[0],icon:name,shortcut:item[2],cmd:item[1]})}),editor.on("mousedown",function(){FloatPanel.hideAll()}),editor.addButton("styleselect",{type:"menubutton",text:"Formats",menu:formatMenu}),editor.addButton("formatselect",function(){var items=[],blocks=createFormats(editor.settings.block_formats||"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre");return each(blocks,function(block){items.push({text:block[0],value:block[1],textStyle:function(){return editor.formatter.getCssText(block[1])}})}),{type:"listbox",text:blocks[0][0],values:items,fixedWidth:!0,onselect:toggleFormat,onPostRender:createListBoxChangeHandler(items)}}),editor.addButton("fontselect",function(){var defaultFontsFormats="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",items=[],fonts=createFormats(editor.settings.font_formats||defaultFontsFormats);return each(fonts,function(font){items.push({text:{raw:font[0]},value:font[1],textStyle:-1==font[1].indexOf("dings")?"font-family:"+font[1]:""})}),{type:"listbox",text:"Font Family",tooltip:"Font Family",values:items,fixedWidth:!0,onPostRender:createListBoxChangeHandler(items,"fontname"),onselect:function(e){e.control.settings.value&&editor.execCommand("FontName",!1,e.control.settings.value)}}}),editor.addButton("fontsizeselect",function(){var items=[],defaultFontsizeFormats="8pt 10pt 12pt 14pt 18pt 24pt 36pt",fontsize_formats=editor.settings.fontsize_formats||defaultFontsizeFormats;return each(fontsize_formats.split(" "),function(item){var text=item,value=item,values=item.split("=");values.length>1&&(text=values[0],value=values[1]),items.push({text:text,value:value})}),{type:"listbox",text:"Font Sizes",tooltip:"Font Sizes",
values:items,fixedWidth:!0,onPostRender:createListBoxChangeHandler(items,"fontsize"),onclick:function(e){e.control.settings.value&&editor.execCommand("FontSize",!1,e.control.settings.value)}}}),editor.addMenuItem("formats",{text:"Formats",menu:formatMenu})}var each=Tools.each;EditorManager.on("AddEditor",function(e){e.editor.rtl&&(Control.rtl=!0),registerControls(e.editor)}),Control.translate=function(text){return EditorManager.translate(text)},Widget.tooltips=!Env.iOS}),define("tinymce/ui/GridLayout",["tinymce/ui/AbsoluteLayout"],function(AbsoluteLayout){return AbsoluteLayout.extend({recalc:function(container){var settings,rows,cols,items,contLayoutRect,width,height,rect,ctrlLayoutRect,ctrl,x,y,posX,posY,ctrlSettings,contPaddingBox,align,spacingH,spacingV,alignH,alignV,maxX,maxY,ctrlMinWidth,ctrlMinHeight,availableWidth,availableHeight,reverseRows,idx,colWidths=[],rowHeights=[];settings=container.settings,items=container.items().filter(":visible"),contLayoutRect=container.layoutRect(),cols=settings.columns||Math.ceil(Math.sqrt(items.length)),rows=Math.ceil(items.length/cols),spacingH=settings.spacingH||settings.spacing||0,spacingV=settings.spacingV||settings.spacing||0,alignH=settings.alignH||settings.align,alignV=settings.alignV||settings.align,contPaddingBox=container.paddingBox,reverseRows="reverseRows"in settings?settings.reverseRows:container.isRtl(),alignH&&"string"==typeof alignH&&(alignH=[alignH]),alignV&&"string"==typeof alignV&&(alignV=[alignV]);for(x=0;cols>x;x++)colWidths.push(0);for(y=0;rows>y;y++)rowHeights.push(0);for(y=0;rows>y;y++)for(x=0;cols>x&&(ctrl=items[y*cols+x]);x++)ctrlLayoutRect=ctrl.layoutRect(),ctrlMinWidth=ctrlLayoutRect.minW,ctrlMinHeight=ctrlLayoutRect.minH,colWidths[x]=ctrlMinWidth>colWidths[x]?ctrlMinWidth:colWidths[x],rowHeights[y]=ctrlMinHeight>rowHeights[y]?ctrlMinHeight:rowHeights[y];for(availableWidth=contLayoutRect.innerW-contPaddingBox.left-contPaddingBox.right,maxX=0,x=0;cols>x;x++)maxX+=colWidths[x]+(x>0?spacingH:0),availableWidth-=(x>0?spacingH:0)+colWidths[x];for(availableHeight=contLayoutRect.innerH-contPaddingBox.top-contPaddingBox.bottom,maxY=0,y=0;rows>y;y++)maxY+=rowHeights[y]+(y>0?spacingV:0),availableHeight-=(y>0?spacingV:0)+rowHeights[y];if(maxX+=contPaddingBox.left+contPaddingBox.right,maxY+=contPaddingBox.top+contPaddingBox.bottom,rect={},rect.minW=maxX+(contLayoutRect.w-contLayoutRect.innerW),rect.minH=maxY+(contLayoutRect.h-contLayoutRect.innerH),rect.contentW=rect.minW-contLayoutRect.deltaW,rect.contentH=rect.minH-contLayoutRect.deltaH,rect.minW=Math.min(rect.minW,contLayoutRect.maxW),rect.minH=Math.min(rect.minH,contLayoutRect.maxH),rect.minW=Math.max(rect.minW,contLayoutRect.startMinWidth),rect.minH=Math.max(rect.minH,contLayoutRect.startMinHeight),!contLayoutRect.autoResize||rect.minW==contLayoutRect.minW&&rect.minH==contLayoutRect.minH){contLayoutRect.autoResize&&(rect=container.layoutRect(rect),rect.contentW=rect.minW-contLayoutRect.deltaW,rect.contentH=rect.minH-contLayoutRect.deltaH);var flexV;flexV="start"==settings.packV?0:availableHeight>0?Math.floor(availableHeight/rows):0;var totalFlex=0,flexWidths=settings.flexWidths;if(flexWidths)for(x=0;x<flexWidths.length;x++)totalFlex+=flexWidths[x];else totalFlex=cols;var ratio=availableWidth/totalFlex;for(x=0;cols>x;x++)colWidths[x]+=flexWidths?flexWidths[x]*ratio:ratio;for(posY=contPaddingBox.top,y=0;rows>y;y++){for(posX=contPaddingBox.left,height=rowHeights[y]+flexV,x=0;cols>x&&(idx=reverseRows?y*cols+cols-1-x:y*cols+x,ctrl=items[idx]);x++)ctrlSettings=ctrl.settings,ctrlLayoutRect=ctrl.layoutRect(),width=Math.max(colWidths[x],ctrlLayoutRect.startMinWidth),ctrlLayoutRect.x=posX,ctrlLayoutRect.y=posY,align=ctrlSettings.alignH||(alignH?alignH[x]||alignH[0]:null),"center"==align?ctrlLayoutRect.x=posX+width/2-ctrlLayoutRect.w/2:"right"==align?ctrlLayoutRect.x=posX+width-ctrlLayoutRect.w:"stretch"==align&&(ctrlLayoutRect.w=width),align=ctrlSettings.alignV||(alignV?alignV[x]||alignV[0]:null),"center"==align?ctrlLayoutRect.y=posY+height/2-ctrlLayoutRect.h/2:"bottom"==align?ctrlLayoutRect.y=posY+height-ctrlLayoutRect.h:"stretch"==align&&(ctrlLayoutRect.h=height),ctrl.layoutRect(ctrlLayoutRect),posX+=width+spacingH,ctrl.recalc&&ctrl.recalc();posY+=height+spacingV}}else if(rect.w=rect.minW,rect.h=rect.minH,container.layoutRect(rect),this.recalc(container),null===container._lastRect){var parentCtrl=container.parent();parentCtrl&&(parentCtrl._lastRect=null,parentCtrl.recalc())}}})}),define("tinymce/ui/Iframe",["tinymce/ui/Widget","tinymce/util/Delay"],function(Widget,Delay){return Widget.extend({renderHtml:function(){var self=this;return self.classes.add("iframe"),self.canFocus=!1,'<iframe id="'+self._id+'" class="'+self.classes+'" tabindex="-1" src="'+(self.settings.url||"javascript:''")+'" frameborder="0"></iframe>'},src:function(src){this.getEl().src=src},html:function(html,callback){var self=this,body=this.getEl().contentWindow.document.body;return body?(body.innerHTML=html,callback&&callback()):Delay.setTimeout(function(){self.html(html)}),this}})}),define("tinymce/ui/Label",["tinymce/ui/Widget","tinymce/ui/DomUtils"],function(Widget,DomUtils){return Widget.extend({init:function(settings){var self=this;self._super(settings),self.classes.add("widget").add("label"),self.canFocus=!1,settings.multiline&&self.classes.add("autoscroll"),settings.strong&&self.classes.add("strong")},initLayoutRect:function(){var self=this,layoutRect=self._super();if(self.settings.multiline){var size=DomUtils.getSize(self.getEl());size.width>layoutRect.maxW&&(layoutRect.minW=layoutRect.maxW,self.classes.add("multiline")),self.getEl().style.width=layoutRect.minW+"px",layoutRect.startMinH=layoutRect.h=layoutRect.minH=Math.min(layoutRect.maxH,DomUtils.getSize(self.getEl()).height)}return layoutRect},repaint:function(){var self=this;return self.settings.multiline||(self.getEl().style.lineHeight=self.layoutRect().h+"px"),self._super()},renderHtml:function(){var self=this,forId=self.settings.forId;return'<label id="'+self._id+'" class="'+self.classes+'"'+(forId?' for="'+forId+'"':"")+">"+self.encode(self.state.get("text"))+"</label>"},bindStates:function(){var self=this;return self.state.on("change:text",function(e){self.innerHtml(self.encode(e.value))}),self._super()}})}),define("tinymce/ui/Toolbar",["tinymce/ui/Container"],function(Container){return Container.extend({Defaults:{role:"toolbar",layout:"flow"},init:function(settings){var self=this;self._super(settings),self.classes.add("toolbar")},postRender:function(){var self=this;return self.items().each(function(ctrl){ctrl.classes.add("toolbar-item")}),self._super()}})}),define("tinymce/ui/MenuBar",["tinymce/ui/Toolbar"],function(Toolbar){return Toolbar.extend({Defaults:{role:"menubar",containerCls:"menubar",ariaRoot:!0,defaults:{type:"menubutton"}}})}),define("tinymce/ui/MenuButton",["tinymce/ui/Button","tinymce/ui/Factory","tinymce/ui/MenuBar"],function(Button,Factory,MenuBar){function isChildOf(node,parent){for(;node;){if(parent===node)return!0;node=node.parentNode}return!1}var MenuButton=Button.extend({init:function(settings){var self=this;self._renderOpen=!0,self._super(settings),settings=self.settings,self.classes.add("menubtn"),settings.fixedWidth&&self.classes.add("fixed-width"),self.aria("haspopup",!0),self.state.set("menu",settings.menu||self.render())},showMenu:function(){var menu,self=this;return self.menu&&self.menu.visible()?self.hideMenu():(self.menu||(menu=self.state.get("menu")||[],menu.length?menu={type:"menu",items:menu}:menu.type=menu.type||"menu",menu.renderTo?self.menu=menu.parent(self).show().renderTo():self.menu=Factory.create(menu).parent(self).renderTo(),self.fire("createmenu"),self.menu.reflow(),self.menu.on("cancel",function(e){e.control.parent()===self.menu&&(e.stopPropagation(),self.focus(),self.hideMenu())}),self.menu.on("select",function(){self.focus()}),self.menu.on("show hide",function(e){e.control==self.menu&&self.activeMenu("show"==e.type),self.aria("expanded","show"==e.type)}).fire("show")),self.menu.show(),self.menu.layoutRect({w:self.layoutRect().w}),void self.menu.moveRel(self.getEl(),self.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"]))},hideMenu:function(){var self=this;self.menu&&(self.menu.items().each(function(item){item.hideMenu&&item.hideMenu()}),self.menu.hide())},activeMenu:function(state){this.classes.toggle("active",state)},renderHtml:function(){var image,self=this,id=self._id,prefix=self.classPrefix,icon=self.settings.icon,text=self.state.get("text"),textHtml="";return image=self.settings.image,image?(icon="none","string"!=typeof image&&(image=window.getSelection?image[0]:image[1]),image=" style=\"background-image: url('"+image+"')\""):image="",text&&(self.classes.add("btn-has-text"),textHtml='<span class="'+prefix+'txt">'+self.encode(text)+"</span>"),icon=self.settings.icon?prefix+"ico "+prefix+"i-"+icon:"",self.aria("role",self.parent()instanceof MenuBar?"menuitem":"button"),'<div id="'+id+'" class="'+self.classes+'" tabindex="-1" aria-labelledby="'+id+'"><button id="'+id+'-open" role="presentation" type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+textHtml+' <i class="'+prefix+'caret"></i></button></div>'},postRender:function(){var self=this;return self.on("click",function(e){e.control===self&&isChildOf(e.target,self.getEl())&&(self.showMenu(),e.aria&&self.menu.items()[0].focus())}),self.on("mouseenter",function(e){var hasVisibleSiblingMenu,overCtrl=e.control,parent=self.parent();overCtrl&&parent&&overCtrl instanceof MenuButton&&overCtrl.parent()==parent&&(parent.items().filter("MenuButton").each(function(ctrl){ctrl.hideMenu&&ctrl!=overCtrl&&(ctrl.menu&&ctrl.menu.visible()&&(hasVisibleSiblingMenu=!0),ctrl.hideMenu())}),hasVisibleSiblingMenu&&(overCtrl.focus(),overCtrl.showMenu()))}),self._super()},bindStates:function(){var self=this;return self.state.on("change:menu",function(){self.menu&&self.menu.remove(),self.menu=null}),self._super()},remove:function(){this._super(),this.menu&&this.menu.remove()}});return MenuButton}),define("tinymce/ui/MenuItem",["tinymce/ui/Widget","tinymce/ui/Factory","tinymce/Env","tinymce/util/Delay"],function(Widget,Factory,Env,Delay){return Widget.extend({Defaults:{border:0,role:"menuitem"},init:function(settings){var text,self=this;self._super(settings),settings=self.settings,self.classes.add("menu-item"),settings.menu&&self.classes.add("menu-item-expand"),settings.preview&&self.classes.add("menu-item-preview"),text=self.state.get("text"),"-"!==text&&"|"!==text||(self.classes.add("menu-item-sep"),self.aria("role","separator"),self.state.set("text","-")),settings.selectable&&(self.aria("role","menuitemcheckbox"),self.classes.add("menu-item-checkbox"),settings.icon="selected"),settings.preview||settings.selectable||self.classes.add("menu-item-normal"),self.on("mousedown",function(e){e.preventDefault()}),settings.menu&&!settings.ariaHideMenu&&self.aria("haspopup",!0)},hasMenus:function(){return!!this.settings.menu},showMenu:function(){var menu,self=this,settings=self.settings,parent=self.parent();if(parent.items().each(function(ctrl){ctrl!==self&&ctrl.hideMenu()}),settings.menu){menu=self.menu,menu?menu.show():(menu=settings.menu,menu.length?menu={type:"menu",items:menu}:menu.type=menu.type||"menu",parent.settings.itemDefaults&&(menu.itemDefaults=parent.settings.itemDefaults),menu=self.menu=Factory.create(menu).parent(self).renderTo(),menu.reflow(),menu.on("cancel",function(e){e.stopPropagation(),self.focus(),menu.hide()}),menu.on("show hide",function(e){e.control.items().each(function(ctrl){ctrl.active(ctrl.settings.selected)})}).fire("show"),menu.on("hide",function(e){e.control===menu&&self.classes.remove("selected")}),menu.submenu=!0),menu._parentMenu=parent,menu.classes.add("menu-sub");var rel=menu.testMoveRel(self.getEl(),self.isRtl()?["tl-tr","bl-br","tr-tl","br-bl"]:["tr-tl","br-bl","tl-tr","bl-br"]);menu.moveRel(self.getEl(),rel),menu.rel=rel,rel="menu-sub-"+rel,menu.classes.remove(menu._lastRel).add(rel),menu._lastRel=rel,self.classes.add("selected"),self.aria("expanded",!0)}},hideMenu:function(){var self=this;return self.menu&&(self.menu.items().each(function(item){item.hideMenu&&item.hideMenu()}),self.menu.hide(),self.aria("expanded",!1)),self},renderHtml:function(){function convertShortcut(shortcut){var i,value,replace={};for(replace=Env.mac?{alt:"&#x2325;",ctrl:"&#x2318;",shift:"&#x21E7;",meta:"&#x2318;"}:{meta:"Ctrl"},shortcut=shortcut.split("+"),i=0;i<shortcut.length;i++)value=replace[shortcut[i].toLowerCase()],value&&(shortcut[i]=value);return shortcut.join("+")}var self=this,id=self._id,settings=self.settings,prefix=self.classPrefix,text=self.encode(self.state.get("text")),icon=self.settings.icon,image="",shortcut=settings.shortcut;return icon&&self.parent().classes.add("menu-has-icons"),settings.image&&(image=" style=\"background-image: url('"+settings.image+"')\""),shortcut&&(shortcut=convertShortcut(shortcut)),icon=prefix+"ico "+prefix+"i-"+(self.settings.icon||"none"),'<div id="'+id+'" class="'+self.classes+'" tabindex="-1">'+("-"!==text?'<i class="'+icon+'"'+image+"></i> ":"")+("-"!==text?'<span id="'+id+'-text" class="'+prefix+'text">'+text+"</span>":"")+(shortcut?'<div id="'+id+'-shortcut" class="'+prefix+'menu-shortcut">'+shortcut+"</div>":"")+(settings.menu?'<div class="'+prefix+'caret"></div>':"")+"</div>"},postRender:function(){var self=this,settings=self.settings,textStyle=settings.textStyle;if("function"==typeof textStyle&&(textStyle=textStyle.call(this)),textStyle){var textElm=self.getEl("text");textElm&&textElm.setAttribute("style",textStyle)}return self.on("mouseenter click",function(e){e.control===self&&(settings.menu||"click"!==e.type?(self.showMenu(),e.aria&&self.menu.focus(!0)):(self.fire("select"),Delay.requestAnimationFrame(function(){self.parent().hideAll()})))}),self._super(),self},hover:function(){var self=this;return self.parent().items().each(function(ctrl){ctrl.classes.remove("selected")}),self.classes.toggle("selected",!0),self},active:function(state){return"undefined"!=typeof state&&this.aria("checked",state),this._super(state)},remove:function(){this._super(),this.menu&&this.menu.remove()}})}),define("tinymce/ui/Throbber",["tinymce/dom/DomQuery","tinymce/ui/Control","tinymce/util/Delay"],function($,Control,Delay){return function(elm,inline){var state,timer,self=this,classPrefix=Control.classPrefix;self.show=function(time,callback){function render(){state&&($(elm).append('<div class="'+classPrefix+"throbber"+(inline?" "+classPrefix+"throbber-inline":"")+'"></div>'),callback&&callback())}return self.hide(),state=!0,time?timer=Delay.setTimeout(render,time):render(),self},self.hide=function(){var child=elm.lastChild;return Delay.clearTimeout(timer),child&&-1!=child.className.indexOf("throbber")&&child.parentNode.removeChild(child),state=!1,self}}}),define("tinymce/ui/Menu",["tinymce/ui/FloatPanel","tinymce/ui/MenuItem","tinymce/ui/Throbber","tinymce/util/Tools"],function(FloatPanel,MenuItem,Throbber,Tools){return FloatPanel.extend({Defaults:{defaultType:"menuitem",border:1,layout:"stack",role:"application",bodyRole:"menu",ariaRoot:!0},init:function(settings){var self=this;if(settings.autohide=!0,settings.constrainToViewport=!0,"function"==typeof settings.items&&(settings.itemsFactory=settings.items,settings.items=[]),settings.itemDefaults)for(var items=settings.items,i=items.length;i--;)items[i]=Tools.extend({},settings.itemDefaults,items[i]);self._super(settings),self.classes.add("menu")},repaint:function(){return this.classes.toggle("menu-align",!0),this._super(),this.getEl().style.height="",this.getEl("body").style.height="",this},cancel:function(){var self=this;self.hideAll(),self.fire("select")},load:function(){function hideThrobber(){self.throbber&&(self.throbber.hide(),self.throbber=null)}var time,factory,self=this;factory=self.settings.itemsFactory,factory&&(self.throbber||(self.throbber=new Throbber(self.getEl("body"),!0),0===self.items().length?(self.throbber.show(),self.fire("loading")):self.throbber.show(100,function(){self.items().remove(),self.fire("loading")}),self.on("hide close",hideThrobber)),self.requestTime=time=(new Date).getTime(),self.settings.itemsFactory(function(items){return 0===items.length?void self.hide():void(self.requestTime===time&&(self.getEl().style.width="",self.getEl("body").style.width="",hideThrobber(),self.items().remove(),self.getEl("body").innerHTML="",self.add(items),self.renderNew(),self.fire("loaded")))}))},hideAll:function(){var self=this;return this.find("menuitem").exec("hideMenu"),self._super()},preRender:function(){var self=this;return self.items().each(function(ctrl){var settings=ctrl.settings;return settings.icon||settings.image||settings.selectable?(self._hasIcons=!0,!1):void 0}),self.settings.itemsFactory&&self.on("postrender",function(){self.settings.itemsFactory&&self.load()}),self._super()}})}),define("tinymce/ui/ListBox",["tinymce/ui/MenuButton","tinymce/ui/Menu"],function(MenuButton,Menu){return MenuButton.extend({init:function(settings){function setSelected(menuValues){for(var i=0;i<menuValues.length;i++){if(selected=menuValues[i].selected||settings.value===menuValues[i].value)return selectedText=selectedText||menuValues[i].text,self.state.set("value",menuValues[i].value),!0;if(menuValues[i].menu&&setSelected(menuValues[i].menu))return!0}}var values,selected,selectedText,lastItemCtrl,self=this;self._super(settings),settings=self.settings,self._values=values=settings.values,values&&("undefined"!=typeof settings.value&&setSelected(values),!selected&&values.length>0&&(selectedText=values[0].text,self.state.set("value",values[0].value)),self.state.set("menu",values)),self.state.set("text",settings.text||selectedText),self.classes.add("listbox"),self.on("select",function(e){var ctrl=e.control;lastItemCtrl&&(e.lastControl=lastItemCtrl),settings.multiple?ctrl.active(!ctrl.active()):self.value(e.control.value()),lastItemCtrl=ctrl})},bindStates:function(){function activateMenuItemsByValue(menu,value){menu instanceof Menu&&menu.items().each(function(ctrl){ctrl.hasMenus()||ctrl.active(ctrl.value()===value)})}function getSelectedItem(menuValues,value){var selectedItem;if(menuValues)for(var i=0;i<menuValues.length;i++){if(menuValues[i].value===value)return menuValues[i];if(menuValues[i].menu&&(selectedItem=getSelectedItem(menuValues[i].menu,value)))return selectedItem}}var self=this;return self.on("show",function(e){activateMenuItemsByValue(e.control,self.value())}),self.state.on("change:value",function(e){var selectedItem=getSelectedItem(self.state.get("menu"),e.value);selectedItem?self.text(selectedItem.text):self.text(self.settings.text)}),self._super()}})}),define("tinymce/ui/Radio",["tinymce/ui/Checkbox"],function(Checkbox){return Checkbox.extend({Defaults:{classes:"radio",role:"radio"}})}),define("tinymce/ui/ResizeHandle",["tinymce/ui/Widget","tinymce/ui/DragHelper"],function(Widget,DragHelper){return Widget.extend({renderHtml:function(){var self=this,prefix=self.classPrefix;return self.classes.add("resizehandle"),"both"==self.settings.direction&&self.classes.add("resizehandle-both"),self.canFocus=!1,'<div id="'+self._id+'" class="'+self.classes+'"><i class="'+prefix+"ico "+prefix+'i-resize"></i></div>'},postRender:function(){var self=this;self._super(),self.resizeDragHelper=new DragHelper(this._id,{start:function(){self.fire("ResizeStart")},drag:function(e){"both"!=self.settings.direction&&(e.deltaX=0),self.fire("Resize",e)},stop:function(){self.fire("ResizeEnd")}})},remove:function(){return this.resizeDragHelper&&this.resizeDragHelper.destroy(),this._super()}})}),define("tinymce/ui/SelectBox",["tinymce/ui/Widget"],function(Widget){function createOptions(options){var strOptions="";if(options)for(var i=0;i<options.length;i++)strOptions+='<option value="'+options[i]+'">'+options[i]+"</option>";return strOptions}return Widget.extend({Defaults:{classes:"selectbox",role:"selectbox",options:[]},init:function(settings){var self=this;self._super(settings),self.settings.size&&(self.size=self.settings.size),self.settings.options&&(self._options=self.settings.options)},options:function(state){return arguments.length?(this.state.set("options",state),this):this.state.get("options")},renderHtml:function(){var options,self=this,size="";return options=createOptions(self._options),self.size&&(size=' size = "'+self.size+'"'),'<select id="'+self._id+'" class="'+self.classes+'"'+size+">"+options+"</select>"},bindStates:function(){var self=this;return self.state.on("change:options",function(e){self.getEl().innerHTML=createOptions(e.value)}),self._super()}})}),define("tinymce/ui/Slider",["tinymce/ui/Widget","tinymce/ui/DragHelper","tinymce/ui/DomUtils"],function(Widget,DragHelper,DomUtils){function constrain(value,minVal,maxVal){return minVal>value&&(value=minVal),value>maxVal&&(value=maxVal),value}function updateSliderHandle(ctrl,value){var maxHandlePos,shortSizeName,sizeName,stylePosName,styleValue;"v"==ctrl.settings.orientation?(stylePosName="top",sizeName="height",shortSizeName="h"):(stylePosName="left",sizeName="width",shortSizeName="w"),maxHandlePos=(ctrl.layoutRect()[shortSizeName]||100)-DomUtils.getSize(ctrl.getEl("handle"))[sizeName],styleValue=maxHandlePos*((value-ctrl._minValue)/(ctrl._maxValue-ctrl._minValue))+"px",ctrl.getEl("handle").style[stylePosName]=styleValue,ctrl.getEl("handle").style.height=ctrl.layoutRect().h+"px"}return Widget.extend({init:function(settings){var self=this;settings.previewFilter||(settings.previewFilter=function(value){return Math.round(100*value)/100}),self._super(settings),self.classes.add("slider"),"v"==settings.orientation&&self.classes.add("vertical"),self._minValue=settings.minValue||0,self._maxValue=settings.maxValue||100,self._initValue=self.state.get("value")},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix;return'<div id="'+id+'" class="'+self.classes+'"><div id="'+id+'-handle" class="'+prefix+'slider-handle"></div></div>'},reset:function(){this.value(this._initValue).repaint()},postRender:function(){var startPos,startHandlePos,value,minValue,maxValue,maxHandlePos,screenCordName,stylePosName,sizeName,shortSizeName,self=this,handlePos=0;minValue=self._minValue,maxValue=self._maxValue,value=self.value(),"v"==self.settings.orientation?(screenCordName="screenY",stylePosName="top",sizeName="height",shortSizeName="h"):(screenCordName="screenX",stylePosName="left",sizeName="width",shortSizeName="w"),self._super(),self._dragHelper=new DragHelper(self._id,{handle:self._id+"-handle",start:function(e){startPos=e[screenCordName],startHandlePos=parseInt(self.getEl("handle").style[stylePosName],10),maxHandlePos=(self.layoutRect()[shortSizeName]||100)-DomUtils.getSize(self.getEl("handle"))[sizeName],self.fire("dragstart",{value:value})},drag:function(e){var delta=e[screenCordName]-startPos,handleEl=self.getEl("handle");handlePos=constrain(startHandlePos+delta,0,maxHandlePos),handleEl.style[stylePosName]=handlePos+"px",value=minValue+handlePos/maxHandlePos*(maxValue-minValue),self.value(value),self.tooltip().text(""+self.settings.previewFilter(value)).show().moveRel(handleEl,"bc tc"),self.fire("drag",{value:value})},stop:function(){self.tooltip().hide(),self.fire("dragend",{value:value})}})},repaint:function(){this._super(),updateSliderHandle(this,this.value())},bindStates:function(){var self=this;return self.state.on("change:value",function(e){updateSliderHandle(self,e.value)}),self._super()}})}),define("tinymce/ui/Spacer",["tinymce/ui/Widget"],function(Widget){return Widget.extend({renderHtml:function(){var self=this;return self.classes.add("spacer"),self.canFocus=!1,'<div id="'+self._id+'" class="'+self.classes+'"></div>'}})}),define("tinymce/ui/SplitButton",["tinymce/ui/MenuButton","tinymce/ui/DomUtils","tinymce/dom/DomQuery"],function(MenuButton,DomUtils,$){return MenuButton.extend({Defaults:{classes:"widget btn splitbtn",role:"button"},repaint:function(){var mainButtonElm,menuButtonElm,self=this,elm=self.getEl(),rect=self.layoutRect();return self._super(),mainButtonElm=elm.firstChild,menuButtonElm=elm.lastChild,$(mainButtonElm).css({width:rect.w-DomUtils.getSize(menuButtonElm).width,height:rect.h-2}),$(menuButtonElm).css({height:rect.h-2}),self},activeMenu:function(state){var self=this;$(self.getEl().lastChild).toggleClass(self.classPrefix+"active",state)},renderHtml:function(){var image,self=this,id=self._id,prefix=self.classPrefix,icon=self.state.get("icon"),text=self.state.get("text"),textHtml="";return image=self.settings.image,image?(icon="none","string"!=typeof image&&(image=window.getSelection?image[0]:image[1]),image=" style=\"background-image: url('"+image+"')\""):image="",icon=self.settings.icon?prefix+"ico "+prefix+"i-"+icon:"",text&&(self.classes.add("btn-has-text"),textHtml='<span class="'+prefix+'txt">'+self.encode(text)+"</span>"),'<div id="'+id+'" class="'+self.classes+'" role="button" tabindex="-1"><button type="button" hidefocus="1" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+textHtml+'</button><button type="button" class="'+prefix+'open" hidefocus="1" tabindex="-1">'+(self._menuBtnText?(icon?" ":"")+self._menuBtnText:"")+' <i class="'+prefix+'caret"></i></button></div>'},postRender:function(){var self=this,onClickHandler=self.settings.onclick;return self.on("click",function(e){var node=e.target;if(e.control==this)for(;node;){if(e.aria&&"down"!=e.aria.key||"BUTTON"==node.nodeName&&-1==node.className.indexOf("open"))return e.stopImmediatePropagation(),void(onClickHandler&&onClickHandler.call(this,e));node=node.parentNode}}),delete self.settings.onclick,self._super()}})}),define("tinymce/ui/StackLayout",["tinymce/ui/FlowLayout"],function(FlowLayout){return FlowLayout.extend({Defaults:{containerClass:"stack-layout",controlClass:"stack-layout-item",endClass:"break"},isNative:function(){return!0}})}),define("tinymce/ui/TabPanel",["tinymce/ui/Panel","tinymce/dom/DomQuery","tinymce/ui/DomUtils"],function(Panel,$,DomUtils){return Panel.extend({Defaults:{layout:"absolute",defaults:{type:"panel"}},activateTab:function(idx){var activeTabElm;this.activeTabId&&(activeTabElm=this.getEl(this.activeTabId),$(activeTabElm).removeClass(this.classPrefix+"active"),activeTabElm.setAttribute("aria-selected","false")),this.activeTabId="t"+idx,activeTabElm=this.getEl("t"+idx),activeTabElm.setAttribute("aria-selected","true"),$(activeTabElm).addClass(this.classPrefix+"active"),this.items()[idx].show().fire("showtab"),this.reflow(),this.items().each(function(item,i){idx!=i&&item.hide()})},renderHtml:function(){var self=this,layout=self._layout,tabsHtml="",prefix=self.classPrefix;return self.preRender(),layout.preRender(self),self.items().each(function(ctrl,i){var id=self._id+"-t"+i;ctrl.aria("role","tabpanel"),ctrl.aria("labelledby",id),tabsHtml+='<div id="'+id+'" class="'+prefix+'tab" unselectable="on" role="tab" aria-controls="'+ctrl._id+'" aria-selected="false" tabIndex="-1">'+self.encode(ctrl.settings.title)+"</div>"}),'<div id="'+self._id+'" class="'+self.classes+'" hidefocus="1" tabindex="-1"><div id="'+self._id+'-head" class="'+prefix+'tabs" role="tablist">'+tabsHtml+'</div><div id="'+self._id+'-body" class="'+self.bodyClasses+'">'+layout.renderHtml(self)+"</div></div>"},postRender:function(){var self=this;self._super(),self.settings.activeTab=self.settings.activeTab||0,self.activateTab(self.settings.activeTab),this.on("click",function(e){var targetParent=e.target.parentNode;if(e.target.parentNode.id==self._id+"-head")for(var i=targetParent.childNodes.length;i--;)targetParent.childNodes[i]==e.target&&self.activateTab(i)})},initLayoutRect:function(){var rect,minW,minH,self=this;minW=DomUtils.getSize(self.getEl("head")).width,minW=0>minW?0:minW,minH=0,self.items().each(function(item){minW=Math.max(minW,item.layoutRect().minW),minH=Math.max(minH,item.layoutRect().minH)}),self.items().each(function(ctrl){ctrl.settings.x=0,ctrl.settings.y=0,ctrl.settings.w=minW,ctrl.settings.h=minH,ctrl.layoutRect({x:0,y:0,w:minW,h:minH})});var headH=DomUtils.getSize(self.getEl("head")).height;return self.settings.minWidth=minW,self.settings.minHeight=minH+headH,rect=self._super(),rect.deltaH+=headH,rect.innerH=rect.h-rect.deltaH,rect}})}),define("tinymce/ui/TextBox",["tinymce/ui/Widget"],function(Widget){return Widget.extend({init:function(settings){var self=this;self._super(settings),self.classes.add("textbox"),settings.multiline?self.classes.add("multiline"):(self.on("keydown",function(e){var rootControl;13==e.keyCode&&(e.preventDefault(),self.parents().reverse().each(function(ctrl){return ctrl.toJSON?(rootControl=ctrl,!1):void 0}),self.fire("submit",{data:rootControl.toJSON()}))}),self.on("keyup",function(e){self.state.set("value",e.target.value)}))},repaint:function(){var style,rect,borderBox,borderW,lastRepaintRect,self=this,borderH=0;style=self.getEl().style,rect=self._layoutRect,lastRepaintRect=self._lastRepaintRect||{};var doc=document;return!self.settings.multiline&&doc.all&&(!doc.documentMode||doc.documentMode<=8)&&(style.lineHeight=rect.h-borderH+"px"),borderBox=self.borderBox,borderW=borderBox.left+borderBox.right+8,borderH=borderBox.top+borderBox.bottom+(self.settings.multiline?8:0),rect.x!==lastRepaintRect.x&&(style.left=rect.x+"px",lastRepaintRect.x=rect.x),rect.y!==lastRepaintRect.y&&(style.top=rect.y+"px",lastRepaintRect.y=rect.y),rect.w!==lastRepaintRect.w&&(style.width=rect.w-borderW+"px",lastRepaintRect.w=rect.w),rect.h!==lastRepaintRect.h&&(style.height=rect.h-borderH+"px",lastRepaintRect.h=rect.h),self._lastRepaintRect=lastRepaintRect,self.fire("repaint",{},!1),self},renderHtml:function(){var self=this,id=self._id,settings=self.settings,value=self.encode(self.state.get("value"),!1),extraAttrs="";return"spellcheck"in settings&&(extraAttrs+=' spellcheck="'+settings.spellcheck+'"'),settings.maxLength&&(extraAttrs+=' maxlength="'+settings.maxLength+'"'),settings.size&&(extraAttrs+=' size="'+settings.size+'"'),settings.subtype&&(extraAttrs+=' type="'+settings.subtype+'"'),self.disabled()&&(extraAttrs+=' disabled="disabled"'),settings.multiline?'<textarea id="'+id+'" class="'+self.classes+'" '+(settings.rows?' rows="'+settings.rows+'"':"")+' hidefocus="1"'+extraAttrs+">"+value+"</textarea>":'<input id="'+id+'" class="'+self.classes+'" value="'+value+'" hidefocus="1"'+extraAttrs+" />"},value:function(value){return arguments.length?(this.state.set("value",value),this):(this.state.get("rendered")&&this.state.set("value",this.getEl().value),this.state.get("value"))},postRender:function(){var self=this;self._super(),self.$el.on("change",function(e){self.state.set("value",e.target.value),self.fire("change",e)})},bindStates:function(){var self=this;return self.state.on("change:value",function(e){self.getEl().value!=e.value&&(self.getEl().value=e.value)}),self.state.on("change:disabled",function(e){self.getEl().disabled=e.value}),self._super()},remove:function(){this.$el.off(),this._super()}})}),expose(["tinymce/geom/Rect","tinymce/util/Promise","tinymce/util/Delay","tinymce/dom/EventUtils","tinymce/dom/Sizzle","tinymce/Env","tinymce/util/Tools","tinymce/dom/DomQuery","tinymce/html/Styles","tinymce/dom/TreeWalker","tinymce/html/Entities","tinymce/dom/DOMUtils","tinymce/dom/ScriptLoader","tinymce/AddOnManager","tinymce/dom/RangeUtils","tinymce/html/Node","tinymce/html/Schema","tinymce/html/SaxParser","tinymce/html/DomParser","tinymce/html/Writer","tinymce/html/Serializer","tinymce/dom/Serializer","tinymce/util/VK","tinymce/dom/ControlSelection","tinymce/dom/BookmarkManager","tinymce/dom/Selection","tinymce/Formatter","tinymce/UndoManager","tinymce/EditorCommands","tinymce/util/URI","tinymce/util/Class","tinymce/util/EventDispatcher","tinymce/util/Observable","tinymce/ui/Selector","tinymce/ui/Collection","tinymce/ui/ReflowQueue","tinymce/ui/Control","tinymce/ui/Factory","tinymce/ui/KeyboardNavigation","tinymce/ui/Container","tinymce/ui/DragHelper","tinymce/ui/Scrollable","tinymce/ui/Panel","tinymce/ui/Movable","tinymce/ui/Resizable","tinymce/ui/FloatPanel","tinymce/ui/Window","tinymce/ui/MessageBox","tinymce/WindowManager","tinymce/ui/Tooltip","tinymce/ui/Widget","tinymce/ui/Progress","tinymce/ui/Notification","tinymce/NotificationManager","tinymce/EditorObservable","tinymce/Shortcuts","tinymce/Editor","tinymce/util/I18n","tinymce/FocusManager","tinymce/EditorManager","tinymce/util/XHR","tinymce/util/JSON","tinymce/util/JSONRequest","tinymce/util/JSONP","tinymce/util/LocalStorage","tinymce/Compat","tinymce/ui/Layout","tinymce/ui/AbsoluteLayout","tinymce/ui/Button","tinymce/ui/ButtonGroup","tinymce/ui/Checkbox","tinymce/ui/ComboBox","tinymce/ui/ColorBox","tinymce/ui/PanelButton","tinymce/ui/ColorButton","tinymce/util/Color","tinymce/ui/ColorPicker","tinymce/ui/Path","tinymce/ui/ElementPath","tinymce/ui/FormItem","tinymce/ui/Form","tinymce/ui/FieldSet","tinymce/ui/FilePicker","tinymce/ui/FitLayout","tinymce/ui/FlexLayout","tinymce/ui/FlowLayout","tinymce/ui/FormatControls","tinymce/ui/GridLayout","tinymce/ui/Iframe","tinymce/ui/Label","tinymce/ui/Toolbar","tinymce/ui/MenuBar","tinymce/ui/MenuButton","tinymce/ui/MenuItem","tinymce/ui/Throbber","tinymce/ui/Menu","tinymce/ui/ListBox","tinymce/ui/Radio","tinymce/ui/ResizeHandle","tinymce/ui/SelectBox","tinymce/ui/Slider","tinymce/ui/Spacer","tinymce/ui/SplitButton","tinymce/ui/StackLayout","tinymce/ui/TabPanel","tinymce/ui/TextBox"]);
}(this)}).call(window)}).call(exports,__webpack_require__(51).setImmediate)},function(module,exports,__webpack_require__){(function(setImmediate,clearImmediate){function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}var nextTick=__webpack_require__(52).nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;msecs>=0&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))},exports.setImmediate="function"==typeof setImmediate?setImmediate:function(fn){var id=nextImmediateId++,args=arguments.length<2?!1:slice.call(arguments,1);return immediateIds[id]=!0,nextTick(function(){immediateIds[id]&&(args?fn.apply(null,args):fn.call(null),exports.clearImmediate(id))}),id},exports.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(id){delete immediateIds[id]}}).call(exports,__webpack_require__(51).setImmediate,__webpack_require__(51).clearImmediate)},function(module,exports){function cleanUpNextTick(){draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue()}function drainQueue(){if(!draining){var timeout=setTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,clearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var currentQueue,process=module.exports={},queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},function(module,exports){"use strict";(function(){tinymce.ThemeManager.add("modern",function(editor){function createToolbar(items,size){var buttonGroup,toolbarItems=[];return items?(each(items.split(/[ ,]/),function(item){function bindSelectorChanged(){function setActiveItem(name){return function(state,args){for(var nodeName,i=args.parents.length;i--&&(nodeName=args.parents[i].nodeName,"OL"!=nodeName&&"UL"!=nodeName););item.active(state&&nodeName==name)}}var selection=editor.selection;"bullist"==itemName&&selection.selectorChanged("ul > li",setActiveItem("UL")),"numlist"==itemName&&selection.selectorChanged("ol > li",setActiveItem("OL")),item.settings.stateSelector&&selection.selectorChanged(item.settings.stateSelector,function(state){item.active(state)},!0),item.settings.disabledStateSelector&&selection.selectorChanged(item.settings.disabledStateSelector,function(state){item.disabled(state)})}var itemName;"|"==item?buttonGroup=null:Factory.has(item)?(item={type:item,size:size},toolbarItems.push(item),buttonGroup=null):(buttonGroup||(buttonGroup={type:"buttongroup",items:[]},toolbarItems.push(buttonGroup)),editor.buttons[item]&&(itemName=item,item=editor.buttons[itemName],"function"==typeof item&&(item=item()),item.type=item.type||"button",item.size=size,item=Factory.create(item),buttonGroup.items.push(item),editor.initialized?bindSelectorChanged():editor.on("init",bindSelectorChanged)))}),{type:"toolbar",layout:"flow",items:toolbarItems}):void 0}function createToolbars(size){function addToolbar(items){return items?(toolbars.push(createToolbar(items,size)),!0):void 0}var toolbars=[];if(tinymce.isArray(settings.toolbar)){if(0===settings.toolbar.length)return;tinymce.each(settings.toolbar,function(toolbar,i){settings["toolbar"+(i+1)]=toolbar}),delete settings.toolbar}for(var i=1;10>i&&addToolbar(settings["toolbar"+i]);i++);return toolbars.length||settings.toolbar===!1||addToolbar(settings.toolbar||defaultToolbar),toolbars.length?{type:"panel",layout:"stack",classes:"toolbar-grp",ariaRoot:!0,ariaRemember:!0,items:toolbars}:void 0}function createMenuButtons(){function createMenuItem(name){var menuItem;return"|"==name?{text:"|"}:menuItem=editor.menuItems[name]}function createMenu(context){var menuButton,menu,menuItems,isUserDefined,removedMenuItems;if(removedMenuItems=tinymce.makeMap((settings.removed_menuitems||"").split(/[ ,]/)),settings.menu?(menu=settings.menu[context],isUserDefined=!0):menu=defaultMenus[context],menu){menuButton={text:menu.title},menuItems=[],each((menu.items||"").split(/[ ,]/),function(item){var menuItem=createMenuItem(item);menuItem&&!removedMenuItems[item]&&menuItems.push(createMenuItem(item))}),isUserDefined||each(editor.menuItems,function(menuItem){menuItem.context==context&&("before"==menuItem.separator&&menuItems.push({text:"|"}),menuItem.prependToContext?menuItems.unshift(menuItem):menuItems.push(menuItem),"after"==menuItem.separator&&menuItems.push({text:"|"}))});for(var i=0;i<menuItems.length;i++)"|"==menuItems[i].text&&(0!==i&&i!=menuItems.length-1||menuItems.splice(i,1));if(menuButton.menu=menuItems,!menuButton.menu.length)return null}return menuButton}var name,menuButtons=[],defaultMenuBar=[];if(settings.menu)for(name in settings.menu)defaultMenuBar.push(name);else for(name in defaultMenus)defaultMenuBar.push(name);for(var enabledMenuNames="string"==typeof settings.menubar?settings.menubar.split(/[ ,]/):defaultMenuBar,i=0;i<enabledMenuNames.length;i++){var menu=enabledMenuNames[i];menu=createMenu(menu),menu&&menuButtons.push(menu)}return menuButtons}function addAccessibilityKeys(panel){function focus(type){var item=panel.find(type)[0];item&&item.focus(!0)}editor.shortcuts.add("Alt+F9","",function(){focus("menubar")}),editor.shortcuts.add("Alt+F10","",function(){focus("toolbar")}),editor.shortcuts.add("Alt+F11","",function(){focus("elementpath")}),panel.on("cancel",function(){editor.focus()})}function resizeTo(width,height){function getSize(elm){return{width:elm.clientWidth,height:elm.clientHeight}}var containerElm,iframeElm,containerSize,iframeSize;containerElm=editor.getContainer(),iframeElm=editor.getContentAreaContainer().firstChild,containerSize=getSize(containerElm),iframeSize=getSize(iframeElm),null!==width&&(width=Math.max(settings.min_width||100,width),width=Math.min(settings.max_width||65535,width),DOM.setStyle(containerElm,"width",width+(containerSize.width-iframeSize.width)),DOM.setStyle(iframeElm,"width",width)),height=Math.max(settings.min_height||100,height),height=Math.min(settings.max_height||65535,height),DOM.setStyle(iframeElm,"height",height),editor.fire("ResizeEditor")}function resizeBy(dw,dh){var elm=editor.getContentAreaContainer();self.resizeTo(elm.clientWidth+dw,elm.clientHeight+dh)}function addContextualToolbars(){function getContextToolbars(){return editor.contextToolbars||[]}function getElementRect(elm){var pos,targetRect,root;return pos=tinymce.DOM.getPos(editor.getContentAreaContainer()),targetRect=editor.dom.getRect(elm),root=editor.dom.getRoot(),"BODY"==root.nodeName&&(targetRect.x-=root.ownerDocument.documentElement.scrollLeft||root.scrollLeft,targetRect.y-=root.ownerDocument.documentElement.scrollTop||root.scrollTop),targetRect.x+=pos.x,targetRect.y+=pos.y,targetRect}function hideAllFloatingPanels(){each(editor.contextToolbars,function(toolbar){toolbar.panel&&toolbar.panel.hide()})}function reposition(match){var relPos,panelRect,elementRect,contentAreaRect,panel,relRect,testPositions;if(!editor.removed){if(!match||!match.toolbar.panel)return void hideAllFloatingPanels();testPositions=["tc-bc","bc-tc","tl-bl","bl-tl","tr-br","br-tr"],panel=match.toolbar.panel,panel.show(),elementRect=getElementRect(match.element),panelRect=tinymce.DOM.getRect(panel.getEl()),contentAreaRect=tinymce.DOM.getRect(editor.getContentAreaContainer()||editor.getBody()),elementRect.w=match.element.clientWidth,elementRect.h=match.element.clientHeight,editor.inline||(contentAreaRect.w=editor.getDoc().documentElement.offsetWidth),editor.selection.controlSelection.isResizable(match.element)&&(elementRect=Rect.inflate(elementRect,0,8)),relPos=Rect.findBestRelativePosition(panelRect,elementRect,contentAreaRect,testPositions),relPos?(each(testPositions.concat("inside"),function(pos){panel.classes.toggle("tinymce-inline-"+pos,pos==relPos)}),relRect=Rect.relativePosition(panelRect,elementRect,relPos),panel.moveTo(relRect.x,relRect.y)):(each(testPositions,function(pos){panel.classes.toggle("tinymce-inline-"+pos,!1)}),panel.classes.toggle("tinymce-inline-inside",!0),elementRect=Rect.intersect(contentAreaRect,elementRect),elementRect?(relPos=Rect.findBestRelativePosition(panelRect,elementRect,contentAreaRect,["tc-tc","tl-tl","tr-tr"]),relPos?(relRect=Rect.relativePosition(panelRect,elementRect,relPos),panel.moveTo(relRect.x,relRect.y)):panel.moveTo(elementRect.x,elementRect.y)):panel.hide())}}function repositionHandler(){function execute(){editor.selection&&reposition(findFrontMostMatch(editor.selection.getNode()))}tinymce.util.Delay.requestAnimationFrame(execute)}function bindScrollEvent(){scrollContainer||(scrollContainer=editor.selection.getScrollContainer()||editor.getWin(),tinymce.$(scrollContainer).on("scroll",repositionHandler),editor.on("remove",function(){tinymce.$(scrollContainer).off("scroll")}))}function showContextToolbar(match){var panel;return match.toolbar.panel?(match.toolbar.panel.show(),void reposition(match)):(bindScrollEvent(),panel=Factory.create({type:"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!0,border:1,items:createToolbar(match.toolbar.items)}),match.toolbar.panel=panel,panel.renderTo(document.body).reflow(),void reposition(match))}function hideAllContextToolbars(){tinymce.each(getContextToolbars(),function(toolbar){toolbar.panel&&toolbar.panel.hide()})}function findFrontMostMatch(targetElm){var i,y,parentsAndSelf,toolbars=getContextToolbars();for(parentsAndSelf=editor.$(targetElm).parents().add(targetElm),i=parentsAndSelf.length-1;i>=0;i--)for(y=toolbars.length-1;y>=0;y--)if(toolbars[y].predicate(parentsAndSelf[i]))return{toolbar:toolbars[y],element:parentsAndSelf[i]};return null}var scrollContainer;editor.on("click keyup setContent",function(e){("setcontent"!=e.type||e.selection)&&tinymce.util.Delay.setEditorTimeout(editor,function(){var match;match=findFrontMostMatch(editor.selection.getNode()),match?(hideAllContextToolbars(),showContextToolbar(match)):hideAllContextToolbars()})}),editor.on("blur hide",hideAllContextToolbars),editor.on("ObjectResizeStart",function(){var match=findFrontMostMatch(editor.selection.getNode());match&&match.toolbar.panel&&match.toolbar.panel.hide()}),editor.on("nodeChange ResizeEditor ResizeWindow",repositionHandler),editor.on("remove",function(){tinymce.each(getContextToolbars(),function(toolbar){toolbar.panel&&toolbar.panel.remove()}),editor.contextToolbars={}})}function renderInlineUI(args){function reposition(){if(panel&&panel.moveRel&&panel.visible()&&!panel._fixed){var scrollContainer=editor.selection.getScrollContainer(),body=editor.getBody(),deltaX=0,deltaY=0;if(scrollContainer){var bodyPos=DOM.getPos(body),scrollContainerPos=DOM.getPos(scrollContainer);deltaX=Math.max(0,scrollContainerPos.x-bodyPos.x),deltaY=Math.max(0,scrollContainerPos.y-bodyPos.y)}panel.fixed(!1).moveRel(body,editor.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl","tr-br"]).moveBy(deltaX,deltaY)}}function show(){panel&&(panel.show(),reposition(),DOM.addClass(editor.getBody(),"mce-edit-focus"))}function hide(){panel&&(panel.hide(),FloatPanel.hideAll(),DOM.removeClass(editor.getBody(),"mce-edit-focus"))}function render(){return panel?void(panel.visible()||show()):(panel=self.panel=Factory.create({type:inlineToolbarContainer?"panel":"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!!inlineToolbarContainer,border:1,items:[settings.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:createMenuButtons()},createToolbars(settings.toolbar_items_size)]}),editor.fire("BeforeRenderUI"),panel.renderTo(inlineToolbarContainer||document.body).reflow(),addAccessibilityKeys(panel),show(),addContextualToolbars(),editor.on("nodeChange",reposition),editor.on("activate",show),editor.on("deactivate",hide),void editor.nodeChanged())}var panel,inlineToolbarContainer;return settings.fixed_toolbar_container&&(inlineToolbarContainer=DOM.select(settings.fixed_toolbar_container)[0]),settings.content_editable=!0,editor.on("focus",function(){args.skinUiCss?tinymce.DOM.styleSheetLoader.load(args.skinUiCss,render,render):render()}),editor.on("blur hide",hide),editor.on("remove",function(){panel&&(panel.remove(),panel=null)}),args.skinUiCss&&tinymce.DOM.styleSheetLoader.load(args.skinUiCss,function(){editor.fire("SkinLoaded")}),{}}function renderIframeUI(args){function switchMode(){return function(e){"readonly"==e.mode?panel.find("*").disabled(!0):panel.find("*").disabled(!1)}}var panel,resizeHandleCtrl,startSize;return args.skinUiCss&&tinymce.DOM.styleSheetLoader.load(args.skinUiCss,function(){editor.fire("SkinLoaded")}),panel=self.panel=Factory.create({type:"panel",role:"application",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[settings.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:createMenuButtons()},createToolbars(settings.toolbar_items_size),{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",html:"",border:"1 0 0 0"}]}),settings.resize!==!1&&(resizeHandleCtrl={type:"resizehandle",direction:settings.resize,onResizeStart:function(){var elm=editor.getContentAreaContainer().firstChild;startSize={width:elm.clientWidth,height:elm.clientHeight}},onResize:function(e){"both"==settings.resize?resizeTo(startSize.width+e.deltaX,startSize.height+e.deltaY):resizeTo(null,startSize.height+e.deltaY)}}),settings.statusbar!==!1&&panel.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",ariaRoot:!0,items:[{type:"elementpath"},resizeHandleCtrl]}),settings.readonly&&panel.find("*").disabled(!0),editor.fire("BeforeRenderUI"),editor.on("SwitchMode",switchMode()),panel.renderBefore(args.targetNode).reflow(),settings.width&&tinymce.DOM.setStyle(panel.getEl(),"width",settings.width),editor.on("remove",function(){panel.remove(),panel=null}),addAccessibilityKeys(panel),addContextualToolbars(),{iframeContainer:panel.find("#iframe")[0].getEl(),editorContainer:panel.getEl()}}var self=this,settings=editor.settings,Factory=tinymce.ui.Factory,each=tinymce.each,DOM=tinymce.DOM,Rect=tinymce.geom.Rect,FloatPanel=tinymce.ui.FloatPanel,defaultMenus={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}},defaultToolbar="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";self.renderUI=function(args){var skin=settings.skin!==!1?settings.skin||"lightgray":!1;if(skin){var skinUrl=settings.skin_url;skinUrl=skinUrl?editor.documentBaseURI.toAbsolute(skinUrl):tinymce.baseURL+"/skins/"+skin,args.skinUiCss=skinUrl,editor.contentCSS.push(skinUrl)}return editor.on("ProgressState",function(e){self.throbber=self.throbber||new tinymce.ui.Throbber(self.panel.getEl("body")),e.state?self.throbber.show(e.time):self.throbber.hide()}),settings.inline?renderInlineUI(args):renderIframeUI(args)},self.resizeTo=resizeTo,self.resizeBy=resizeBy})}).call(window)},function(module,exports){"use strict";(function(){tinymce.PluginManager.add("link",function(editor){function createLinkList(callback){return function(){var linkList=editor.settings.link_list;"string"==typeof linkList?tinymce.util.XHR.send({url:linkList,success:function(text){callback(tinymce.util.JSON.parse(text))}}):"function"==typeof linkList?linkList(callback):callback(linkList)}}function buildListItems(inputList,itemCallback,startItems){function appendItems(values,output){return output=output||[],tinymce.each(values,function(item){var menuItem={text:item.text||item.title};item.menu?menuItem.menu=appendItems(item.menu):(menuItem.value=item.value,itemCallback&&itemCallback(menuItem)),output.push(menuItem)}),output}return appendItems(inputList,startItems||[])}function showDialog(linkList){function linkListChangeHandler(e){var textCtrl=win.find("#text");(!textCtrl.value()||e.lastControl&&textCtrl.value()==e.lastControl.text())&&textCtrl.value(e.control.text()),win.find("#href").value(e.control.value())}function buildAnchorListControl(url){var anchorList=[];return tinymce.each(editor.dom.select("a:not([href])"),function(anchor){var id=anchor.name||anchor.id;id&&anchorList.push({text:id,value:"#"+id,selected:-1!=url.indexOf("#"+id)})}),anchorList.length?(anchorList.unshift({text:"None",value:""}),{name:"anchor",type:"listbox",label:"Anchors",values:anchorList,onselect:linkListChangeHandler}):void 0}function updateText(){!initialText&&0===data.text.length&&onlyText&&this.parent().parent().find("#text")[0].value(this.value())}function urlChange(e){var meta=e.meta||{};linkListCtrl&&linkListCtrl.value(editor.convertURL(this.value(),"href")),tinymce.each(e.meta,function(value,key){win.find("#"+key).value(value)}),meta.text||updateText.call(this)}function isOnlyTextSelected(anchorElm){var html=selection.getContent();if(/</.test(html)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(html)||-1==html.indexOf("href=")))return!1;if(anchorElm){var i,nodes=anchorElm.childNodes;if(0===nodes.length)return!1;for(i=nodes.length-1;i>=0;i--)if(3!=nodes[i].nodeType)return!1}return!0}var selectedElm,anchorElm,initialText,win,onlyText,textListCtrl,linkListCtrl,relListCtrl,targetListCtrl,classListCtrl,linkTitleCtrl,value,data={},selection=editor.selection,dom=editor.dom;selectedElm=selection.getNode(),anchorElm=dom.getParent(selectedElm,"a[href]"),onlyText=isOnlyTextSelected(),data.text=initialText=anchorElm?anchorElm.innerText||anchorElm.textContent:selection.getContent({format:"text"}),data.href=anchorElm?anchorElm.href:"",anchorElm?data.target=dom.getAttrib(anchorElm,"target"):editor.settings.default_link_target&&(data.target=editor.settings.default_link_target),(value=dom.getAttrib(anchorElm,"rel"))&&(data.rel=value),(value=dom.getAttrib(anchorElm,"class"))&&(data["class"]=value),(value=dom.getAttrib(anchorElm,"title"))&&(data.title=value),onlyText&&(textListCtrl={name:"text",type:"textbox",size:40,label:"Text to display",onchange:function(){data.text=this.value()}}),linkList&&(linkListCtrl={type:"listbox",label:"Link list",values:buildListItems(linkList,function(item){item.value=editor.convertURL(item.value||item.url,"href")},[{text:"None",value:""}]),onselect:linkListChangeHandler,value:editor.convertURL(data.href,"href"),onPostRender:function(){linkListCtrl=this}}),editor.settings.target_list!==!1&&(editor.settings.target_list||(editor.settings.target_list=[{text:"None",value:""},{text:"New window",value:"_blank"}]),targetListCtrl={name:"target",type:"listbox",label:"Target",values:buildListItems(editor.settings.target_list)}),editor.settings.rel_list&&(relListCtrl={name:"rel",type:"listbox",label:"Rel",values:buildListItems(editor.settings.rel_list)}),editor.settings.link_class_list&&(classListCtrl={name:"class",type:"listbox",label:"Class",values:buildListItems(editor.settings.link_class_list,function(item){item.value&&(item.textStyle=function(){return editor.formatter.getCssText({inline:"a",classes:[item.value]})})})}),editor.settings.link_title!==!1&&(linkTitleCtrl={name:"title",type:"textbox",label:"Title",value:data.title}),win=editor.windowManager.open({title:"Insert link",data:data,body:[{name:"href",type:"filepicker",filetype:"file",size:40,autofocus:!0,label:"Url",onchange:urlChange,onkeyup:updateText},textListCtrl,linkTitleCtrl,buildAnchorListControl(data.href),linkListCtrl,relListCtrl,targetListCtrl,classListCtrl],onSubmit:function(e){function delayedConfirm(message,callback){var rng=editor.selection.getRng();tinymce.util.Delay.setEditorTimeout(editor,function(){editor.windowManager.confirm(message,function(state){editor.selection.setRng(rng),callback(state)})})}function insertLink(){var linkAttrs={href:href,target:data.target?data.target:null,rel:data.rel?data.rel:null,"class":data["class"]?data["class"]:null,title:data.title?data.title:null};anchorElm?(editor.focus(),onlyText&&data.text!=initialText&&("innerText"in anchorElm?anchorElm.innerText=data.text:anchorElm.textContent=data.text),dom.setAttribs(anchorElm,linkAttrs),selection.select(anchorElm),editor.undoManager.add()):onlyText?editor.insertContent(dom.createHTML("a",linkAttrs,dom.encode(data.text))):editor.execCommand("mceInsertLink",!1,linkAttrs)}var href;return data=tinymce.extend(data,e.data),(href=data.href)?href.indexOf("@")>0&&-1==href.indexOf("//")&&-1==href.indexOf("mailto:")?void delayedConfirm("The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",function(state){state&&(href="mailto:"+href),insertLink()}):editor.settings.link_assume_external_targets&&!/^\w+:/i.test(href)||!editor.settings.link_assume_external_targets&&/^\s*www[\.|\d\.]/i.test(href)?void delayedConfirm("The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",function(state){state&&(href="http://"+href),insertLink()}):void insertLink():void editor.execCommand("unlink")}})}editor.addButton("link",{icon:"link",tooltip:"Insert/edit link",shortcut:"Meta+K",onclick:createLinkList(showDialog),stateSelector:"a[href]"}),editor.addButton("unlink",{icon:"unlink",tooltip:"Remove link",cmd:"unlink",stateSelector:"a[href]"}),editor.addShortcut("Meta+K","",createLinkList(showDialog)),editor.addCommand("mceLink",createLinkList(showDialog)),this.showDialog=showDialog,editor.addMenuItem("link",{icon:"link",text:"Insert/edit link",shortcut:"Meta+K",onclick:createLinkList(showDialog),stateSelector:"a[href]",context:"insert",prependToContext:!0})})}).call(window)},function(module,exports){"use strict";(function(){tinymce.PluginManager.add("textcolor",function(editor){function getCurrentColor(format){var color;return editor.dom.getParents(editor.selection.getStart(),function(elm){var value;(value=elm.style["forecolor"==format?"color":"background-color"])&&(color=value)}),color}function mapColors(){var i,colorMap,colors=[];for(colorMap=editor.settings.textcolor_map||["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"],i=0;i<colorMap.length;i+=2)colors.push({text:colorMap[i+1],color:"#"+colorMap[i]});return colors}function renderColorPicker(){function getColorCellHtml(color,title){var isNoColor="transparent"==color;return'<td class="mce-grid-cell'+(isNoColor?" mce-colorbtn-trans":"")+'"><div id="'+id+"-"+count++ +'" data-mce-color="'+(color?color:"")+'" role="option" tabIndex="-1" style="'+(color?"background-color: "+color:"")+'" title="'+tinymce.translate(title)+'">'+(isNoColor?"&#215;":"")+"</div></td>"}var colors,color,html,last,x,y,i,ctrl=this,id=ctrl._id,count=0;for(colors=mapColors(),html='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>',last=colors.length-1,y=0;rows>y;y++){for(html+="<tr>",x=0;cols>x;x++)i=y*cols+x,i>last?html+="<td></td>":(color=colors[i],html+=getColorCellHtml(color.color,color.text));html+="</tr>"}if(editor.settings.color_picker_callback){for(html+='<tr><td colspan="'+cols+'" class="mce-custom-color-btn"><div id="'+id+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+id+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+tinymce.translate("Custom...")+"</button></div></td></tr>",html+="<tr>",x=0;cols>x;x++)html+=getColorCellHtml("","Custom color");html+="</tr>"}return html+="</tbody></table>"}function applyFormat(format,value){editor.undoManager.transact(function(){editor.formatter.apply(format,{value:value}),editor.nodeChanged()})}function removeFormat(format){editor.undoManager.transact(function(){editor.formatter.remove(format,{value:null},null,!0),editor.nodeChanged()})}function onPanelClick(e){function selectColor(value){buttonCtrl.hidePanel(),buttonCtrl.color(value),applyFormat(buttonCtrl.settings.format,value)}function resetColor(){buttonCtrl.hidePanel(),buttonCtrl.resetColor(),removeFormat(buttonCtrl.settings.format)}function setDivColor(div,value){div.style.background=value,div.setAttribute("data-mce-color",value)}var value,buttonCtrl=this.parent();tinymce.DOM.getParent(e.target,".mce-custom-color-btn")&&(buttonCtrl.hidePanel(),editor.settings.color_picker_callback.call(editor,function(value){var customColorCells,div,i,tableElm=buttonCtrl.panel.getEl().getElementsByTagName("table")[0];for(customColorCells=tinymce.map(tableElm.rows[tableElm.rows.length-1].childNodes,function(elm){return elm.firstChild}),i=0;i<customColorCells.length&&(div=customColorCells[i],div.getAttribute("data-mce-color"));i++);if(i==cols)for(i=0;cols-1>i;i++)setDivColor(customColorCells[i],customColorCells[i+1].getAttribute("data-mce-color"));setDivColor(div,value),selectColor(value)},getCurrentColor(buttonCtrl.settings.format))),value=e.target.getAttribute("data-mce-color"),value?(this.lastId&&document.getElementById(this.lastId).setAttribute("aria-selected",!1),e.target.setAttribute("aria-selected",!0),this.lastId=e.target.id,"transparent"==value?resetColor():selectColor(value)):null!==value&&buttonCtrl.hidePanel()}function onButtonClick(){var self=this;self._color?applyFormat(self.settings.format,self._color):removeFormat(self.settings.format)}var cols,rows;rows=editor.settings.textcolor_rows||5,cols=editor.settings.textcolor_cols||8,editor.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:!0,html:renderColorPicker,onclick:onPanelClick},onclick:onButtonClick}),editor.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:!0,html:renderColorPicker,onclick:onPanelClick},onclick:onButtonClick})})}).call(window)},function(module,exports){"use strict";(function(){tinymce.PluginManager.add("autoresize",function(editor){function isFullscreen(){return editor.plugins.fullscreen&&editor.plugins.fullscreen.isFullscreen()}function resize(e){var deltaSize,doc,body,docElm,resizeHeight,myHeight,marginTop,marginBottom,paddingTop,paddingBottom,borderTop,borderBottom,DOM=tinymce.DOM;if(doc=editor.getDoc()){if(body=doc.body,docElm=doc.documentElement,resizeHeight=settings.autoresize_min_height,!body||e&&"setcontent"===e.type&&e.initial||isFullscreen())return void(body&&docElm&&(body.style.overflowY="auto",docElm.style.overflowY="auto"));marginTop=editor.dom.getStyle(body,"margin-top",!0),marginBottom=editor.dom.getStyle(body,"margin-bottom",!0),paddingTop=editor.dom.getStyle(body,"padding-top",!0),paddingBottom=editor.dom.getStyle(body,"padding-bottom",!0),borderTop=editor.dom.getStyle(body,"border-top-width",!0),borderBottom=editor.dom.getStyle(body,"border-bottom-width",!0),myHeight=body.offsetHeight+parseInt(marginTop,10)+parseInt(marginBottom,10)+parseInt(paddingTop,10)+parseInt(paddingBottom,10)+parseInt(borderTop,10)+parseInt(borderBottom,10),(isNaN(myHeight)||0>=myHeight)&&(myHeight=tinymce.Env.ie?body.scrollHeight:tinymce.Env.webkit&&0===body.clientHeight?0:body.offsetHeight),myHeight>settings.autoresize_min_height&&(resizeHeight=myHeight),settings.autoresize_max_height&&myHeight>settings.autoresize_max_height?(resizeHeight=settings.autoresize_max_height,body.style.overflowY="auto",docElm.style.overflowY="auto"):(body.style.overflowY="hidden",docElm.style.overflowY="hidden",body.scrollTop=0),resizeHeight!==oldSize&&(deltaSize=resizeHeight-oldSize,DOM.setStyle(editor.iframeElement,"height",resizeHeight+"px"),oldSize=resizeHeight,tinymce.isWebKit&&0>deltaSize&&resize(e))}}function wait(times,interval,callback){tinymce.util.Delay.setEditorTimeout(editor,function(){resize({}),times--?wait(times,interval,callback):callback&&callback()},interval)}var settings=editor.settings,oldSize=0;editor.settings.inline||(settings.autoresize_min_height=parseInt(editor.getParam("autoresize_min_height",editor.getElement().offsetHeight),10),settings.autoresize_max_height=parseInt(editor.getParam("autoresize_max_height",0),10),editor.on("init",function(){var overflowPadding,bottomMargin;overflowPadding=editor.getParam("autoresize_overflow_padding",1),bottomMargin=editor.getParam("autoresize_bottom_margin",50),overflowPadding!==!1&&editor.dom.setStyles(editor.getBody(),{paddingLeft:overflowPadding,paddingRight:overflowPadding}),bottomMargin!==!1&&editor.dom.setStyles(editor.getBody(),{paddingBottom:bottomMargin})}),editor.on("nodechange setcontent keyup FullscreenStateChanged",resize),editor.getParam("autoresize_on_init",!0)&&editor.on("init",function(){wait(20,100,function(){wait(5,1e3)})}),editor.addCommand("mceAutoResize",resize))})}).call(window)},function(module,exports){"use strict";(function(){tinymce.PluginManager.add("hr",function(editor){editor.addCommand("InsertHorizontalRule",function(){editor.execCommand("mceInsertContent",!1,"<hr />")}),editor.addButton("hr",{icon:"hr",tooltip:"Horizontal line",cmd:"InsertHorizontalRule"}),editor.addMenuItem("hr",{icon:"hr",text:"Horizontal line",cmd:"InsertHorizontalRule",context:"insert"})})}).call(window)},function(module,exports){"use strict";(function(){!function(exports,undefined){function require(ids,callback){for(var module,defs=[],i=0;i<ids.length;++i){if(module=modules[ids[i]]||resolve(ids[i]),!module)throw"module definition dependecy not found: "+ids[i];defs.push(module)}callback.apply(null,defs)}function define(id,dependencies,definition){if("string"!=typeof id)throw"invalid module definition, module id must be defined and be a string";if(dependencies===undefined)throw"invalid module definition, dependencies must be specified";if(definition===undefined)throw"invalid module definition, definition function must be specified";
require(dependencies,function(){modules[id]=definition.apply(null,arguments)})}function resolve(id){for(var target=exports,fragments=id.split(/[.\/]/),fi=0;fi<fragments.length;++fi){if(!target[fragments[fi]])return;target=target[fragments[fi]]}return target}function expose(ids){var i,target,id,fragments,privateModules;for(i=0;i<ids.length;i++){target=exports,id=ids[i],fragments=id.split(/[.\/]/);for(var fi=0;fi<fragments.length-1;++fi)target[fragments[fi]]===undefined&&(target[fragments[fi]]={}),target=target[fragments[fi]];target[fragments[fragments.length-1]]=modules[id]}if(exports.AMDLC_TESTS){privateModules=exports.privateModules||{};for(id in modules)privateModules[id]=modules[id];for(i=0;i<ids.length;i++)delete privateModules[ids[i]];exports.privateModules=privateModules}}var modules={};define("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(Tools,DomParser,Schema){function filter(content,items){return Tools.each(items,function(v){content=v.constructor==RegExp?content.replace(v,""):content.replace(v[0],v[1])}),content}function innerText(html){function walk(node){var name=node.name,currentNode=node;if("br"===name)return void(text+="\n");if(shortEndedElements[name]&&(text+=" "),ignoreElements[name])return void(text+=" ");if(3==node.type&&(text+=node.value),!node.shortEnded&&(node=node.firstChild))do walk(node);while(node=node.next);blockElements[name]&&currentNode.next&&(text+="\n","p"==name&&(text+="\n"))}var schema=new Schema,domParser=new DomParser({},schema),text="",shortEndedElements=schema.getShortEndedElements(),ignoreElements=Tools.makeMap("script noscript style textarea video audio iframe object"," "),blockElements=schema.getBlockElements();return html=filter(html,[/<!\[[^\]]+\]>/g]),walk(domParser.parse(html)),text}function trimHtml(html){function trimSpaces(all,s1,s2){return s1||s2?" ":" "}return html=filter(html,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,trimSpaces],/<br class="Apple-interchange-newline">/g,/<br>$/i])}return{filter:filter,innerText:innerText,trimHtml:trimHtml}}),define("tinymce/pasteplugin/Clipboard",["tinymce/Env","tinymce/dom/RangeUtils","tinymce/util/VK","tinymce/pasteplugin/Utils","tinymce/util/Delay"],function(Env,RangeUtils,VK,Utils,Delay){return function(editor){function pasteHtml(html){var args,dom=editor.dom;if(args=editor.fire("BeforePastePreProcess",{content:html}),args=editor.fire("PastePreProcess",args),html=args.content,!args.isDefaultPrevented()){if(editor.hasEventListeners("PastePostProcess")&&!args.isDefaultPrevented()){var tempBody=dom.add(editor.getBody(),"div",{style:"display:none"},html);args=editor.fire("PastePostProcess",{node:tempBody}),dom.remove(tempBody),html=args.node.innerHTML}args.isDefaultPrevented()||editor.insertContent(html,{merge:editor.settings.paste_merge_formats!==!1,data:{paste:!0}})}}function pasteText(text){text=editor.dom.encode(text).replace(/\r\n/g,"\n");var forcedRootBlockStartHtml,startBlock=editor.dom.getParent(editor.selection.getStart(),editor.dom.isBlock),forcedRootBlockName=editor.settings.forced_root_block;forcedRootBlockName&&(forcedRootBlockStartHtml=editor.dom.createHTML(forcedRootBlockName,editor.settings.forced_root_block_attrs),forcedRootBlockStartHtml=forcedRootBlockStartHtml.substr(0,forcedRootBlockStartHtml.length-3)+">"),startBlock&&/^(PRE|DIV)$/.test(startBlock.nodeName)||!forcedRootBlockName?text=Utils.filter(text,[[/\n/g,"<br>"]]):(text=Utils.filter(text,[[/\n\n/g,"</p>"+forcedRootBlockStartHtml],[/^(.*<\/p>)(<p>)$/,forcedRootBlockStartHtml+"$1"],[/\n/g,"<br />"]]),-1!=text.indexOf("<p>")&&(text=forcedRootBlockStartHtml+text)),pasteHtml(text)}function createPasteBin(){function getCaretRect(rng){var rects,textNode,node,container=rng.startContainer;if(rects=rng.getClientRects(),rects.length)return rects[0];if(rng.collapsed&&1==container.nodeType){for(node=container.childNodes[lastRng.startOffset];node&&3==node.nodeType&&!node.data.length;)node=node.nextSibling;if(node)return"BR"==node.tagName&&(textNode=dom.doc.createTextNode("\ufeff"),node.parentNode.insertBefore(textNode,node),rng=dom.createRng(),rng.setStartBefore(textNode),rng.setEndAfter(textNode),rects=rng.getClientRects(),dom.remove(textNode)),rects.length?rects[0]:void 0}}var scrollContainer,dom=editor.dom,body=editor.getBody(),viewport=editor.dom.getViewPort(editor.getWin()),scrollTop=viewport.y,top=20;if(lastRng=editor.selection.getRng(),editor.inline&&(scrollContainer=editor.selection.getScrollContainer(),scrollContainer&&scrollContainer.scrollTop>0&&(scrollTop=scrollContainer.scrollTop)),lastRng.getClientRects){var rect=getCaretRect(lastRng);if(rect)top=scrollTop+(rect.top-dom.getPos(body).y);else{top=scrollTop;var container=lastRng.startContainer;container&&(3==container.nodeType&&container.parentNode!=body&&(container=container.parentNode),1==container.nodeType&&(top=dom.getPos(container,scrollContainer||body).y))}}pasteBinElm=dom.add(editor.getBody(),"div",{id:"mcepastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: absolute; top: "+top+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},pasteBinDefaultContent),(Env.ie||Env.gecko)&&dom.setStyle(pasteBinElm,"left","rtl"==dom.getStyle(body,"direction",!0)?65535:-65535),dom.bind(pasteBinElm,"beforedeactivate focusin focusout",function(e){e.stopPropagation()}),pasteBinElm.focus(),editor.selection.select(pasteBinElm,!0)}function removePasteBin(){if(pasteBinElm){for(var pasteBinClone;pasteBinClone=editor.dom.get("mcepastebin");)editor.dom.remove(pasteBinClone),editor.dom.unbind(pasteBinClone);lastRng&&editor.selection.setRng(lastRng)}pasteBinElm=lastRng=null}function getPasteBinHtml(){var pasteBinClones,i,clone,cloneHtml,html="";for(pasteBinClones=editor.dom.select("div[id=mcepastebin]"),i=0;i<pasteBinClones.length;i++)clone=pasteBinClones[i],clone.firstChild&&"mcepastebin"==clone.firstChild.id&&(clone=clone.firstChild),cloneHtml=clone.innerHTML,html!=pasteBinDefaultContent&&(html+=cloneHtml);return html}function decodeEdgeData(data){var i,out,fingerprint,code;for(fingerprint=[25942,29554,28521,14958],i=0;i<fingerprint.length;i++)if(data.charCodeAt(i)!=fingerprint[i])return data;for(out="",i=0;i<data.length;i++)code=data.charCodeAt(i),out+=String.fromCharCode(255&code),out+=String.fromCharCode((65280&code)>>8);return decodeURIComponent(escape(out))}function extractFragment(data){var idx,startFragment,endFragment;return startFragment="<!--StartFragment-->",idx=data.indexOf(startFragment),-1!==idx&&(data=data.substr(idx+startFragment.length)),endFragment="<!--EndFragment-->",idx=data.indexOf(endFragment),-1!==idx&&(data=data.substr(0,idx)),data}function getDataTransferItems(dataTransfer){var items={};if(dataTransfer){if(dataTransfer.getData){var legacyText=dataTransfer.getData("Text");legacyText&&legacyText.length>0&&-1==legacyText.indexOf(mceInternalUrlPrefix)&&(items["text/plain"]=legacyText)}if(dataTransfer.types)for(var i=0;i<dataTransfer.types.length;i++){var contentType=dataTransfer.types[i],data=dataTransfer.getData(contentType);"text/html"==contentType&&(data=extractFragment(decodeEdgeData(data))),items[contentType]=data}}return items}function getClipboardContent(clipboardEvent){return getDataTransferItems(clipboardEvent.clipboardData||editor.getDoc().dataTransfer)}function pasteImageData(e,rng){function processItems(items){function pasteImage(reader){rng&&(editor.selection.setRng(rng),rng=null),pasteHtml('<img src="'+reader.result+'">')}var i,item,reader,hadImage=!1;if(items)for(i=0;i<items.length;i++)item=items[i],/^image\/(jpeg|png|gif|bmp)$/.test(item.type)&&(reader=new FileReader,reader.onload=pasteImage.bind(null,reader),reader.readAsDataURL(item.getAsFile?item.getAsFile():item),e.preventDefault(),hadImage=!0);return hadImage}var dataTransfer=e.clipboardData||e.dataTransfer;return editor.settings.paste_data_images&&dataTransfer?processItems(dataTransfer.items)||processItems(dataTransfer.files):void 0}function isBrokenAndroidClipboardEvent(e){var clipboardData=e.clipboardData;return-1!=navigator.userAgent.indexOf("Android")&&clipboardData&&clipboardData.items&&0===clipboardData.items.length}function getCaretRangeFromEvent(e){return RangeUtils.getCaretRangeFromPoint(e.clientX,e.clientY,editor.getDoc())}function hasContentType(clipboardContent,mimeType){return mimeType in clipboardContent&&clipboardContent[mimeType].length>0}function isKeyboardPasteEvent(e){return VK.metaKeyPressed(e)&&86==e.keyCode||e.shiftKey&&45==e.keyCode}function registerEventHandlers(){function insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode){var content;return hasContentType(clipboardContent,"text/html")?content=clipboardContent["text/html"]:(content=getPasteBinHtml(),content==pasteBinDefaultContent&&(plainTextMode=!0)),content=Utils.trimHtml(content),pasteBinElm&&pasteBinElm.firstChild&&"mcepastebin"===pasteBinElm.firstChild.id&&(plainTextMode=!0),removePasteBin(),content.length||(plainTextMode=!0),plainTextMode&&(content=hasContentType(clipboardContent,"text/plain")&&-1==content.indexOf("</p>")?clipboardContent["text/plain"]:Utils.innerText(content)),content==pasteBinDefaultContent?void(isKeyBoardPaste||editor.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")):void(plainTextMode?pasteText(content):pasteHtml(content))}editor.on("keydown",function(e){function removePasteBinOnKeyUp(e){isKeyboardPasteEvent(e)&&!e.isDefaultPrevented()&&removePasteBin()}if(isKeyboardPasteEvent(e)&&!e.isDefaultPrevented()){if(keyboardPastePlainTextState=e.shiftKey&&86==e.keyCode,keyboardPastePlainTextState&&Env.webkit&&-1!=navigator.userAgent.indexOf("Version/"))return;if(e.stopImmediatePropagation(),keyboardPasteTimeStamp=(new Date).getTime(),Env.ie&&keyboardPastePlainTextState)return e.preventDefault(),void editor.fire("paste",{ieFake:!0});removePasteBin(),createPasteBin(),editor.once("keyup",removePasteBinOnKeyUp),editor.once("paste",function(){editor.off("keyup",removePasteBinOnKeyUp)})}}),editor.on("paste",function(e){var clipboardTimer=(new Date).getTime(),clipboardContent=getClipboardContent(e),clipboardDelay=(new Date).getTime()-clipboardTimer,isKeyBoardPaste=(new Date).getTime()-keyboardPasteTimeStamp-clipboardDelay<1e3,plainTextMode="text"==self.pasteFormat||keyboardPastePlainTextState;return keyboardPastePlainTextState=!1,e.isDefaultPrevented()||isBrokenAndroidClipboardEvent(e)?void removePasteBin():pasteImageData(e)?void removePasteBin():(isKeyBoardPaste||e.preventDefault(),!Env.ie||isKeyBoardPaste&&!e.ieFake||(createPasteBin(),editor.dom.bind(pasteBinElm,"paste",function(e){e.stopPropagation()}),editor.getDoc().execCommand("Paste",!1,null),clipboardContent["text/html"]=getPasteBinHtml()),void(hasContentType(clipboardContent,"text/html")?(e.preventDefault(),insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode)):Delay.setEditorTimeout(editor,function(){insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode)},0)))}),editor.on("dragstart dragend",function(e){draggingInternally="dragstart"==e.type}),editor.on("drop",function(e){var rng=getCaretRangeFromEvent(e);if(!e.isDefaultPrevented()&&!draggingInternally&&!pasteImageData(e,rng)&&rng&&editor.settings.paste_filter_drop!==!1){var dropContent=getDataTransferItems(e.dataTransfer),content=dropContent["mce-internal"]||dropContent["text/html"]||dropContent["text/plain"];content&&(e.preventDefault(),editor.undoManager.transact(function(){dropContent["mce-internal"]&&editor.execCommand("Delete"),editor.selection.setRng(rng),content=Utils.trimHtml(content),dropContent["text/html"]?pasteHtml(content):pasteText(content)}))}}),editor.on("dragover dragend",function(e){editor.settings.paste_data_images&&e.preventDefault()})}var pasteBinElm,lastRng,keyboardPastePlainTextState,self=this,keyboardPasteTimeStamp=0,draggingInternally=!1,pasteBinDefaultContent="%MCEPASTEBIN%",mceInternalUrlPrefix="data:text/mce-internal,";self.pasteHtml=pasteHtml,self.pasteText=pasteText,editor.on("preInit",function(){registerEventHandlers(),editor.parser.addNodeFilter("img",function(nodes,name,args){function isPasteInsert(args){return args.data&&args.data.paste===!0}function remove(node){node.attr("data-mce-object")||src===Env.transparentSrc||node.remove()}function isWebKitFakeUrl(src){return 0===src.indexOf("webkit-fake-url")}function isDataUri(src){return 0===src.indexOf("data:")}if(!editor.settings.paste_data_images&&isPasteInsert(args))for(var i=nodes.length;i--;){var src=nodes[i].attributes.map.src;src&&(isWebKitFakeUrl(src)?remove(nodes[i]):!editor.settings.allow_html_data_urls&&isDataUri(src)&&remove(nodes[i]))}})})}}),define("tinymce/pasteplugin/WordFilter",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema","tinymce/html/Serializer","tinymce/html/Node","tinymce/pasteplugin/Utils"],function(Tools,DomParser,Schema,Serializer,Node,Utils){function isWordContent(content){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(content)||/class="OutlineElement/.test(content)||/id="?docs\-internal\-guid\-/.test(content)}function isNumericList(text){var found,patterns;return patterns=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],text=text.replace(/^[\u00a0 ]+/,""),Tools.each(patterns,function(pattern){return pattern.test(text)?(found=!0,!1):void 0}),found}function isBulletList(text){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(text)}function WordFilter(editor){var settings=editor.settings;editor.on("BeforePastePreProcess",function(e){function convertFakeListsToProperLists(node){function getText(node){var txt="";if(3===node.type)return node.value;if(node=node.firstChild)do txt+=getText(node);while(node=node.next);return txt}function trimListStart(node,regExp){if(3===node.type&&regExp.test(node.value))return node.value=node.value.replace(regExp,""),!1;if(node=node.firstChild)do if(!trimListStart(node,regExp))return!1;while(node=node.next);return!0}function removeIgnoredNodes(node){if(node._listIgnore)return void node.remove();if(node=node.firstChild)do removeIgnoredNodes(node);while(node=node.next)}function convertParagraphToLi(paragraphNode,listName,start){var level=paragraphNode._listLevel||lastLevel;level!=lastLevel&&(lastLevel>level?currentListNode&&(currentListNode=currentListNode.parent.parent):(prevListNode=currentListNode,currentListNode=null)),currentListNode&&currentListNode.name==listName?currentListNode.append(paragraphNode):(prevListNode=prevListNode||currentListNode,currentListNode=new Node(listName,1),start>1&&currentListNode.attr("start",""+start),paragraphNode.wrap(currentListNode)),paragraphNode.name="li",level>lastLevel&&prevListNode&&prevListNode.lastChild.append(currentListNode),lastLevel=level,removeIgnoredNodes(paragraphNode),trimListStart(paragraphNode,/^\u00a0+/),trimListStart(paragraphNode,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),trimListStart(paragraphNode,/^\u00a0+/)}for(var currentListNode,prevListNode,lastLevel=1,elements=[],child=node.firstChild;"undefined"!=typeof child&&null!==child;)if(elements.push(child),child=child.walk(),null!==child)for(;"undefined"!=typeof child&&child.parent!==node;)child=child.walk();for(var i=0;i<elements.length;i++)if(node=elements[i],"p"==node.name&&node.firstChild){var nodeText=getText(node);if(isBulletList(nodeText)){convertParagraphToLi(node,"ul");continue}if(isNumericList(nodeText)){var matches=/([0-9]+)\./.exec(nodeText),start=1;matches&&(start=parseInt(matches[1],10)),convertParagraphToLi(node,"ol",start);continue}if(node._listLevel){convertParagraphToLi(node,"ul",1);continue}currentListNode=null}else prevListNode=currentListNode,currentListNode=null}function filterStyles(node,styleValue){var matches,outputStyles={},styles=editor.dom.parseStyle(styleValue);return Tools.each(styles,function(value,name){switch(name){case"mso-list":matches=/\w+ \w+([0-9]+)/i.exec(styleValue),matches&&(node._listLevel=parseInt(matches[1],10)),/Ignore/i.test(value)&&node.firstChild&&(node._listIgnore=!0,node.firstChild._listIgnore=!0);break;case"horiz-align":name="text-align";break;case"vert-align":name="vertical-align";break;case"font-color":case"mso-foreground":name="color";break;case"mso-background":case"mso-highlight":name="background";break;case"font-weight":case"font-style":return void("normal"!=value&&(outputStyles[name]=value));case"mso-element":if(/^(comment|comment-list)$/i.test(value))return void node.remove()}return 0===name.indexOf("mso-comment")?void node.remove():void(0!==name.indexOf("mso-")&&("all"==retainStyleProperties||validStyles&&validStyles[name])&&(outputStyles[name]=value))}),/(bold)/i.test(outputStyles["font-weight"])&&(delete outputStyles["font-weight"],node.wrap(new Node("b",1))),/(italic)/i.test(outputStyles["font-style"])&&(delete outputStyles["font-style"],node.wrap(new Node("i",1))),outputStyles=editor.dom.serializeStyle(outputStyles,node.name),outputStyles?outputStyles:null}var retainStyleProperties,validStyles,content=e.content;if(content=content.replace(/<b[^>]+id="?docs-internal-[^>]*>/gi,""),content=content.replace(/<br class="?Apple-interchange-newline"?>/gi,""),retainStyleProperties=settings.paste_retain_style_properties,retainStyleProperties&&(validStyles=Tools.makeMap(retainStyleProperties.split(/[, ]/))),settings.paste_enable_default_filters!==!1&&isWordContent(e.content)){e.wordContent=!0,content=Utils.filter(content,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(str,spaces){return spaces.length>0?spaces.replace(/./," ").slice(Math.floor(spaces.length/2)).split("").join(" "):""}]]);var validElements=settings.paste_word_valid_elements;validElements||(validElements="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody");var schema=new Schema({valid_elements:validElements,valid_children:"-li[p]"});Tools.each(schema.elements,function(rule){rule.attributes["class"]||(rule.attributes["class"]={},rule.attributesOrder.push("class")),rule.attributes.style||(rule.attributes.style={},rule.attributesOrder.push("style"))});var domParser=new DomParser({},schema);domParser.addAttributeFilter("style",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],node.attr("style",filterStyles(node,node.attr("style"))),"span"==node.name&&node.parent&&!node.attributes.length&&node.unwrap()}),domParser.addAttributeFilter("class",function(nodes){for(var node,className,i=nodes.length;i--;)node=nodes[i],className=node.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(className)&&node.remove(),node.attr("class",null)}),domParser.addNodeFilter("del",function(nodes){for(var i=nodes.length;i--;)nodes[i].remove()}),domParser.addNodeFilter("a",function(nodes){for(var node,href,name,i=nodes.length;i--;)if(node=nodes[i],href=node.attr("href"),name=node.attr("name"),href&&-1!=href.indexOf("#_msocom_"))node.remove();else if(href&&0===href.indexOf("file://")&&(href=href.split("#")[1],href&&(href="#"+href)),href||name){if(name&&!/^_?(?:toc|edn|ftn)/i.test(name)){node.unwrap();continue}node.attr({href:href,name:name})}else node.unwrap()});var rootNode=domParser.parse(content);settings.paste_convert_word_fake_lists!==!1&&convertFakeListsToProperLists(rootNode),e.content=new Serializer({validate:settings.validate},schema).serialize(rootNode)}})}return WordFilter.isWordContent=isWordContent,WordFilter}),define("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(Env,Tools,WordFilter,Utils){return function(editor){function addPreProcessFilter(filterFunc){editor.on("BeforePastePreProcess",function(e){e.content=filterFunc(e.content)})}function removeExplorerBrElementsAfterBlocks(html){if(!WordFilter.isWordContent(html))return html;var blockElements=[];Tools.each(editor.schema.getBlockElements(),function(block,blockName){blockElements.push(blockName)});var explorerBlocksRegExp=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+blockElements.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return html=Utils.filter(html,[[explorerBlocksRegExp,"$1"]]),html=Utils.filter(html,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function removeWebKitStyles(content){if(WordFilter.isWordContent(content))return content;var webKitStyles=editor.settings.paste_webkit_styles;if(editor.settings.paste_remove_styles_if_webkit===!1||"all"==webKitStyles)return content;if(webKitStyles&&(webKitStyles=webKitStyles.split(/[, ]/)),webKitStyles){var dom=editor.dom,node=editor.selection.getNode();content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(all,before,value,after){var inputStyles=dom.parseStyle(value,"span"),outputStyles={};if("none"===webKitStyles)return before+after;for(var i=0;i<webKitStyles.length;i++){var inputValue=inputStyles[webKitStyles[i]],currentValue=dom.getStyle(node,webKitStyles[i],!0);/color/.test(webKitStyles[i])&&(inputValue=dom.toHex(inputValue),currentValue=dom.toHex(currentValue)),currentValue!=inputValue&&(outputStyles[webKitStyles[i]]=inputValue)}return outputStyles=dom.serializeStyle(outputStyles,"span"),outputStyles?before+' style="'+outputStyles+'"'+after:before+after})}else content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return content=content.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(all,before,value,after){return before+' style="'+value+'"'+after})}Env.webkit&&addPreProcessFilter(removeWebKitStyles),Env.ie&&addPreProcessFilter(removeExplorerBrElementsAfterBlocks)}}),define("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(PluginManager,Clipboard,WordFilter,Quirks){var userIsInformed;PluginManager.add("paste",function(editor){function togglePlainTextPaste(){if("text"==clipboard.pasteFormat)this.active(!1),clipboard.pasteFormat="html";else if(clipboard.pasteFormat="text",this.active(!0),!userIsInformed){var message=editor.translate("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.");editor.notificationManager.open({text:message,type:"info"}),userIsInformed=!0}}var clipboard,self=this,settings=editor.settings;self.clipboard=clipboard=new Clipboard(editor),self.quirks=new Quirks(editor),self.wordFilter=new WordFilter(editor),editor.settings.paste_as_text&&(self.clipboard.pasteFormat="text"),settings.paste_preprocess&&editor.on("PastePreProcess",function(e){settings.paste_preprocess.call(self,self,e)}),settings.paste_postprocess&&editor.on("PastePostProcess",function(e){settings.paste_postprocess.call(self,self,e)}),editor.addCommand("mceInsertClipboardContent",function(ui,value){value.content&&self.clipboard.pasteHtml(value.content),value.text&&self.clipboard.pasteText(value.text)}),editor.paste_block_drop&&editor.on("dragend dragover draggesture dragdrop drop drag",function(e){e.preventDefault(),e.stopPropagation()}),editor.settings.paste_data_images||editor.on("drop",function(e){var dataTransfer=e.dataTransfer;dataTransfer&&dataTransfer.files&&dataTransfer.files.length>0&&e.preventDefault()}),editor.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:togglePlainTextPaste,active:"text"==self.clipboard.pasteFormat}),editor.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:clipboard.pasteFormat,onclick:togglePlainTextPaste})})}),expose(["tinymce/pasteplugin/Utils"])}(this)}).call(window)},function(module,exports){"use strict";(function(){tinymce.PluginManager.add("noneditable",function(editor){function hasClass(checkClassName){return function(node){return-1!==(" "+node.attr("class")+" ").indexOf(checkClassName)}}function convertRegExpsToNonEditable(e){function replaceMatchWithSpan(match){var args=arguments,index=args[args.length-2];return index>0&&'"'==content.charAt(index-1)?match:'<span class="'+cls+'" data-mce-content="'+editor.dom.encode(args[0])+'">'+editor.dom.encode("string"==typeof args[1]?args[1]:args[0])+"</span>"}var i=nonEditableRegExps.length,content=e.content,cls=tinymce.trim(nonEditClass);if("raw"!=e.format){for(;i--;)content=content.replace(nonEditableRegExps[i],replaceMatchWithSpan);e.content=content}}var editClass,nonEditClass,nonEditableRegExps,contentEditableAttrName="contenteditable";editClass=" "+tinymce.trim(editor.getParam("noneditable_editable_class","mceEditable"))+" ",nonEditClass=" "+tinymce.trim(editor.getParam("noneditable_noneditable_class","mceNonEditable"))+" ";var hasEditClass=hasClass(editClass),hasNonEditClass=hasClass(nonEditClass);nonEditableRegExps=editor.getParam("noneditable_regexp"),nonEditableRegExps&&!nonEditableRegExps.length&&(nonEditableRegExps=[nonEditableRegExps]),editor.on("PreInit",function(){nonEditableRegExps&&editor.on("BeforeSetContent",convertRegExpsToNonEditable),editor.parser.addAttributeFilter("class",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],hasEditClass(node)?node.attr(contentEditableAttrName,"true"):hasNonEditClass(node)&&node.attr(contentEditableAttrName,"false")}),editor.serializer.addAttributeFilter(contentEditableAttrName,function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],(hasEditClass(node)||hasNonEditClass(node))&&(nonEditableRegExps&&node.attr("data-mce-content")?(node.name="#text",node.type=3,node.raw=!0,node.value=node.attr("data-mce-content")):node.attr(contentEditableAttrName,null))})})})}).call(window)},function(module,exports){"use strict";(function(){tinymce.addI18n("zh_CN",{Cut:"剪切","Heading 5":"标题5","Header 2":"标题2","Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.":"你的浏览器不支持对剪贴板的访问，请使用Ctrl+X/C/V键进行复制粘贴。","Heading 4":"标题4",Div:"Div区块","Heading 2":"标题2",Paste:"粘贴",Close:"关闭","Font Family":"字体",Pre:"预格式文本","Align right":"右对齐","New document":"新文档",Blockquote:"引用","Numbered list":"编号列表","Heading 1":"标题1",Headings:"标题","Increase indent":"增加缩进",Formats:"格式",Headers:"标题","Select all":"全选","Header 3":"标题3",Blocks:"区块",Undo:"撤消",Strikethrough:"删除线","Bullet list":"项目符号","Header 1":"标题1",Superscript:"上标","Clear formatting":"清除格式","Font Sizes":"字号",Subscript:"下标","Header 6":"标题6",Redo:"重复",Paragraph:"段落",Ok:"确定",Bold:"粗体",Code:"代码",Italic:"斜体","Align center":"居中","Header 5":"标题5","Heading 6":"标题6","Heading 3":"标题3","Decrease indent":"减少缩进","Header 4":"标题4","Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.":"当前为纯文本粘贴模式，再次点击可以回到普通粘贴模式。",Underline:"下划线",Cancel:"取消",Justify:"两端对齐",Inline:"文本",Copy:"复制","Align left":"左对齐","Visual aids":"网格线","Lower Greek":"小写希腊字母",Square:"方块",Default:"默认","Lower Alpha":"小写英文字母",Circle:"空心圆",Disc:"实心圆","Upper Alpha":"大写英文字母","Upper Roman":"大写罗马字母","Lower Roman":"小写罗马字母",Name:"名称",Anchor:"锚点","You have unsaved changes are you sure you want to navigate away?":"你还有文档尚未保存，确定要离开？","Restore last draft":"恢复上次的草稿","Special character":"特殊符号","Source code":"源代码",Color:"颜色","Right to left":"从右到左","Left to right":"从左到右",Emoticons:"表情",Robots:"机器人","Document properties":"文档属性",Title:"标题",Keywords:"关键词",Encoding:"编码",Description:"描述",Author:"作者",Fullscreen:"全屏","Horizontal line":"水平分割线","Horizontal space":"水平边距","Insert/edit image":"插入/编辑图片",General:"普通",Advanced:"高级",Source:"地址",Border:"边框","Constrain proportions":"保持纵横比","Vertical space":"垂直边距","Image description":"图片描述",Style:"样式",Dimensions:"大小","Insert image":"插入图片","Insert date/time":"插入日期/时间","Remove link":"删除链接",Url:"地址","Text to display":"显示文字",Anchors:"锚点","Insert link":"插入链接","New window":"在新窗口打开",None:"无","The URL you entered seems to be an external link. Do you want to add the required http:// prefix?":"你所填写的URL地址属于外部链接，需要加上http://:前缀吗？",Target:"打开方式","The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?":"你所填写的URL地址貌似是邮件地址，需要加上mailto:前缀吗？","Insert/edit link":"插入/编辑链接","Insert/edit video":"插入/编辑视频",Poster:"封面","Alternative source":"镜像","Paste your embed code below:":"将内嵌代码粘贴在下面:","Insert video":"插入视频",Embed:"内嵌","Nonbreaking space":"不间断空格","Page break":"分页符","Paste as text":"粘贴为文本",Preview:"预览",Print:"打印",Save:"保存","Could not find the specified string.":"未找到搜索内容.",Replace:"替换",Next:"下一个","Whole words":"全字匹配","Find and replace":"查找和替换","Replace with":"替换为",Find:"查找","Replace all":"全部替换","Match case":"区分大小写",Prev:"上一个",Spellcheck:"拼写检查",Finish:"完成","Ignore all":"全部忽略",Ignore:"忽略","Add to Dictionary":"添加到字典","Insert row before":"在上方插入",Rows:"行",Height:"高","Paste row after":"粘贴到下方",Alignment:"对齐方式","Border color":"边框颜色","Column group":"列组",Row:"行","Insert column before":"在左侧插入","Split cell":"拆分单元格","Cell padding":"单元格内边距","Cell spacing":"单元格外间距","Row type":"行类型","Insert table":"插入表格",Body:"表体",Caption:"标题",Footer:"表尾","Delete row":"删除行","Paste row before":"粘贴到上方",Scope:"范围","Delete table":"删除表格","H Align":"水平对齐",Top:"顶部对齐","Header cell":"表头单元格",Column:"列","Row group":"行组",Cell:"单元格",Middle:"垂直居中","Cell type":"单元格类型","Copy row":"复制行","Row properties":"行属性","Table properties":"表格属性",Bottom:"底部对齐","V Align":"垂直对齐",Header:"表头",Right:"右对齐","Insert column after":"在右侧插入",Cols:"列","Insert row after":"在下方插入",Width:"宽","Cell properties":"单元格属性",Left:"左对齐","Cut row":"剪切行","Delete column":"删除列",Center:"居中","Merge cells":"合并单元格","Insert template":"插入模板",Templates:"模板","Background color":"背景色","Custom...":"自定义...","Custom color":"自定义颜色","No color":"无","Text color":"文字颜色","Show blocks":"显示区块边框","Show invisible characters":"显示不可见字符","Words: {0}":"字数：{0}",Insert:"插入",File:"文件",Edit:"编辑","Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help":"在编辑区按ALT-F9打开菜单，按ALT-F10打开工具栏，按ALT-0查看帮助",Tools:"工具",View:"视图",Table:"表格",Format:"格式"})}).call(window)},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ArticleSuccessCtrl=function(){function ArticleSuccessCtrl($timeout,$location,$http){var _this=this;_classCallCheck(this,ArticleSuccessCtrl),this.$timeout=$timeout,this.$http=$http,this.$location=$location,this.timeLast=5;for(var i=5;i>=1;i--)!function(j){_this.$timeout(function(){_this.timeLast=5-j,5===j&&$location.url("/published/")},1e3*j)}(i)}return _createClass(ArticleSuccessCtrl,[{key:"cancel",value:function(){localStorage.removeItem("articleInfo"),this.$location.url("/published/")}},{key:"join",value:function(){var _this2=this;this.articleInfo&&(this.articleInfo=angular.fromJson(this.articleInfo),angular.extend(this.articleInfo,{flag:105,nickname:USER.username,email:"305179945@qq.com"}),this.$http({method:"POST",url:"/napi/leave/message/",dataType:"json",data:this.articleInfo}).then(function(jsn){1===jsn.data.status?(localStorage.removeItem("articleInfo"),_this2.$location.url("/published/")):SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>'+jsn.data.message+"</h3></div>");
},function(error){console.log(error)}))}}]),ArticleSuccessCtrl}();ArticleSuccessCtrl.$inject=["$timeout","$location","$http"],exports["default"]=ArticleSuccessCtrl},function(module,exports){angular.module("monospaced.qrcode",[]).directive("qrcode",["$window",function($window){var canvas2D=!!$window.CanvasRenderingContext2D,levels={L:"Low",M:"Medium",Q:"Quartile",H:"High"},draw=function(context,qr,modules,tile){for(var row=0;modules>row;row++)for(var col=0;modules>col;col++){var w=Math.ceil((col+1)*tile)-Math.floor(col*tile),h=Math.ceil((row+1)*tile)-Math.floor(row*tile);context.fillStyle=qr.isDark(row,col)?"#000":"#fff",context.fillRect(Math.round(col*tile),Math.round(row*tile),w,h)}};return{restrict:"E",template:'<canvas class="qrcode"></canvas>',link:function(scope,element,attrs){var error,version,errorCorrectionLevel,data,size,modules,tile,qr,$img,domElement=element[0],$canvas=element.find("canvas"),canvas=$canvas[0],context=canvas2D?canvas.getContext("2d"):null,download="download"in attrs,href=attrs.href,link=download||href?document.createElement("a"):"",trim=/^\s+|\s+$/g,setVersion=function(value){version=Math.max(1,Math.min(parseInt(value,10),40))||5},setErrorCorrectionLevel=function(value){errorCorrectionLevel=value in levels?value:"M"},setData=function(value){if(value){data=value.replace(trim,""),qr=qrcode(version,errorCorrectionLevel),qr.addData(data);try{qr.make()}catch(e){return void(error=e.message)}error=!1,modules=qr.getModuleCount()}},setSize=function(value){size=parseInt(value,10)||2*modules,tile=size/modules,canvas.width=canvas.height=size},render=function(){if(qr){if(error)return link&&(link.removeAttribute("download"),link.title="",link.href="#_"),canvas2D||(domElement.innerHTML='<img src width="'+size+'"height="'+size+'"class="qrcode">'),void scope.$emit("qrcode:error",error);if(download&&(domElement.download="qrcode.png",domElement.title="Download QR code"),canvas2D){if(draw(context,qr,modules,tile),download)return void(domElement.href=canvas.toDataURL("image/png"))}else if(domElement.innerHTML=qr.createImgTag(tile,0),$img=element.find("img"),$img.addClass("qrcode"),download)return void(domElement.href=$img[0].src);href&&(domElement.href=href)}};link&&(link.className="qrcode-link",$canvas.wrap(link),domElement=domElement.firstChild),setVersion(attrs.version),setErrorCorrectionLevel(attrs.errorCorrectionLevel),setSize(attrs.size),attrs.$observe("version",function(value){value&&(setVersion(value),setData(data),setSize(size),render())}),attrs.$observe("errorCorrectionLevel",function(value){value&&(setErrorCorrectionLevel(value),setData(data),setSize(size),render())}),attrs.$observe("data",function(value){value&&(setData(value),setSize(size),render())}),attrs.$observe("size",function(value){value&&(setSize(value),render())}),attrs.$observe("href",function(value){value&&(href=value,render())})}}}])},function(module,exports){angular.module("ui.tinymce",[]).value("uiTinymceConfig",{}).directive("uiTinymce",["$rootScope","$compile","$timeout","$window","$sce","uiTinymceConfig",function($rootScope,$compile,$timeout,$window,$sce,uiTinymceConfig){uiTinymceConfig=uiTinymceConfig||{};var generatedIds=0,ID_ATTR="ui-tinymce";return uiTinymceConfig.baseUrl&&(tinymce.baseURL=uiTinymceConfig.baseUrl),{require:["ngModel","^?form"],priority:599,link:function(scope,element,attrs,ctrls){function toggleDisable(disabled){disabled?(ensureInstance(),tinyInstance&&tinyInstance.getBody().setAttribute("contenteditable",!1)):(ensureInstance(),tinyInstance&&!tinyInstance.settings.readonly&&tinyInstance.getBody().setAttribute("contenteditable",!0))}function ensureInstance(){tinyInstance||(tinyInstance=tinymce.get(attrs.id))}if($window.tinymce){var expression,tinyInstance,ngModel=ctrls[0],form=ctrls[1]||null,options={},updateView=function(editor){var content=editor.getContent({format:options.format}).trim();content=$sce.trustAsHtml(content),ngModel.$setViewValue(content),$rootScope.$$phase||scope.$digest()};attrs.$set("id",ID_ATTR+"-"+generatedIds++),expression={},angular.extend(expression,scope.$eval(attrs.uiTinymce));var debouncedUpdate=function(debouncedUpdateDelay){var debouncedUpdateTimer;return function(ed){$timeout.cancel(debouncedUpdateTimer),debouncedUpdateTimer=$timeout(function(){return function(ed){ed.isDirty()&&(ed.save(),updateView(ed))}(ed)},debouncedUpdateDelay)}}(400),setupOptions={setup:function(ed){ed.on("init",function(){ngModel.$render(),ngModel.$setPristine(),ngModel.$setUntouched(),form&&form.$setPristine()}),ed.on("ExecCommand change NodeChange ObjectResized",function(){debouncedUpdate(ed)}),ed.on("blur",function(){element[0].blur(),ngModel.$setTouched(),scope.$digest()}),ed.on("remove",function(){element.remove()}),expression.setup&&expression.setup(ed,{updateView:updateView})},format:expression.format||"html",selector:"#"+attrs.id};angular.extend(options,uiTinymceConfig,expression,setupOptions),$timeout(function(){options.baseURL&&(tinymce.baseURL=options.baseURL),tinymce.init(options),toggleDisable(scope.$eval(attrs.ngDisabled))}),ngModel.$formatters.unshift(function(modelValue){return modelValue?$sce.trustAsHtml(modelValue):""}),ngModel.$parsers.unshift(function(viewValue){return viewValue?$sce.getTrustedHtml(viewValue):""}),ngModel.$render=function(){ensureInstance();var viewValue=ngModel.$viewValue?$sce.getTrustedHtml(ngModel.$viewValue):"";tinyInstance&&tinyInstance.getDoc()&&(tinyInstance.setContent(viewValue),tinyInstance.fire("change"))},attrs.$observe("disabled",toggleDisable),scope.$on("$tinymce:refresh",function(e,id){var eid=attrs.id;if(angular.isUndefined(id)||id===eid){var parentElement=element.parent(),clonedElement=element.clone();clonedElement.removeAttr("id"),clonedElement.removeAttr("style"),clonedElement.removeAttr("aria-hidden"),tinymce.execCommand("mceRemoveEditor",!1,eid),parentElement.append($compile(clonedElement)(scope))}}),scope.$on("$destroy",function(){ensureInstance(),tinyInstance&&(tinyInstance.remove(),tinyInstance=null)})}}}}])},function(module,exports){module.exports='<header></header>\n<div id="content">\n  <div class="warp">\n    <navbar></navbar>\n    <div class="warp-inner">\n      <div class="draft">\n        <div  ng-if="draft.dataList.object_list.length>0">\n          <h3 class="hd-title">\n          草稿 ({{draft.total}})\n          <a class="addnew-btn" href="#/create/" target="_blank">+ 添加新文章</a>\n          </h3>\n          <div class="article-list">\n            <ul>\n              <li style="padding-top:0;padding-right: 0;" ng-if="draft.showTips">\n                <a href="http://www.duitang.com/life_artist/article/?id=284560" target="_blank" style="display: block;height: 150px;background-image: url(http://img4q.duitang.com/uploads/people/201608/23/20160823161115_QXUEw.png);cursor: pointer;margin-left: -36px;padding-top: 44px;box-sizing: border-box;-webkit-box-sizing: border-box;position:relative; ">\n                  <i style="position: absolute;width: 14px;height: 14px;right: 24px;top: 22px;font-size: 22px;line-height: 14px;" ng-click="draft.closeTips($event)">&times;</i>\n                </a>\n              </li>\n               <!--临时 S-->\n              <!-- <li class="tips-temp" ng-if="!draft.isFirst">\n                <div class="ar-title">\n                  <a class="ar-link" href="/mobp/solicit/article/?from=platform" style="color:#fd8284;" target="_blank">征文大赛 <span style="display: inline-block;width: 2px;background-color: #fd8284;height: 18px;vertical-align: middle;margin: -3px 5px 0 1px;"></span>用心之处便是家</a>\n                </div>\n                <p style="width: 100%;">第二期主题征文大赛正式开启，优秀文章即有机会赢得礼品，点击了解更多。</p>\n                <div class="opt-btns">\n                  <span class="open"><i class="icon arr"></i></span>\n                </div>\n                <span style="width: 50px;height: 20px;background-color: #fd8284;position:absolute;right: 0;top:10px;font-size: 12px;letter-spacing: 2px;color: #ffffff;text-align: center;line-height: 20px;">活动</span>\n              </li> -->\n              <!--临时 E-->\n              <li ng-repeat="article in draft.dataList.object_list" ng-if="!article.removed">\n                <div class="ar-title">\n                  <a class="ar-link" href="#/create/?id={{article.id}}&type=1"  target="_blank">{{article.title}}</a>\n                  <span class="ar-time">\n                    编辑于{{article.update_at_str}}\n                  </span>\n                </div>\n                <p>{{article.content}}</p>\n                <div class="opt-btns"  ng-mouseenter="article.toolsBar=true" ng-mouseleave="article.toolsBar=false">\n                  <span ng-class="article.toolsBar?\'open\':\'\'"><i class="icon arr"></i></span>\n                  <div class="opt-box" ng-show="article.toolsBar">\n                    <a href="#/create/?id={{article.id}}&type=1" target="_blank">编辑</a>\n                    <a ng-click="draft.deleteDraft(article)">删除</a>\n                  </div>\n                </div>\n              </li>\n            </ul>\n            <dt-page pagepar="draft.page"></dt-page>\n          </div>\n        </div>\n        <p class="has-none" ng-if="draft.dataList.object_list.length<1">\n          <a href="http://www.duitang.com/life_artist/article/?id=284560" target="_blank" style="display: block;height: 150px;background-image: url(http://img4q.duitang.com/uploads/people/201608/23/20160823161115_QXUEw.png);cursor: pointer;margin:0;padding-top: 44px;box-sizing: border-box;-webkit-box-sizing: border-box;position:relative" ng-if="draft.showTips">\n            <i style="position: absolute;width: 14px;height: 14px;right: 24px;top: 22px;font-size: 22px;line-height: 14px;" ng-click="draft.closeTips($event)">&times;</i>\n          </a>\n          <a class="addnew-btn" href="#/create/" target="_blank">+ 添加新文章</a>\n\n          <!--临时-->\n          <!-- <span style="font-size: 14px;color: #999999;display: block;margin-top: 20px;">撰写文章，参与 <a href="/mobp/solicit/article/?from=platform" target="_blank" style="color:#fd8284;text-decoration: underline;margin-top: 0;">征文大赛“用心之处便是家”</a></span> -->\n        </p>\n      </div>\n    </div>\n  </div>\n  <!--删除模板-->\n  <script type="text/ng-template" id="DraftTmpl">\n  <div class="modal">\n    <a class="close" ng-click="close()">&times;</a>\n    <p>确认要删除吗？</p>\n    <div class="modal-tools">\n      <a ng-click="close()">取消</a>\n      <a class="confirm" ng-click="confirm()">确认</a>\n    </div>\n  </div>\n  </script>\n</div>'},function(module,exports){module.exports='<header></header>\n<div id="content">\n  <div class="warp">\n    <navbar></navbar>\n    <div class="warp-inner">\n      <div class="published">\n        <h3 class="hd-title">\n        已发布文章 <span ng-if="published.dataList.total">({{published.dataList.total}})</span>\n        </h3>\n        <div class="article-list" ng-if="published.dataList.object_list.length>0">\n          <ul>\n            <li class="article-item" ng-repeat="article in published.dataList.object_list" ng-if="!article.removed">\n              <div class="cover-img">\n                <img ng-src="{{article.cover.photo_path}}" alt="暂无封面图">\n              </div>\n              <div class="ar-title">\n                <a class="ar-link" href="http://{{published.hostName}}/article/?id={{article.id}}" target="_blank">{{article.title}}</a>\n                <span class="ar-time">\n                  编辑于{{article.update_at_str}}\n                </span>\n              </div>\n              <p>{{article.content}}</p>\n              <div class="opt-btns" ng-mouseenter="article.toolsBar=true" ng-mouseleave="article.toolsBar=false">\n                <span ng-class="article.toolsBar?\'open\':\'\'"><i class="icon arr"></i></span>\n                <div class="opt-box" ng-show="article.toolsBar">\n                  <a href="#/create/?id={{article.id}}&type=0"  target="_blank">编辑</a>\n                  <a href="http://{{published.hostName}}/article/?id={{article.id}}" target="_blank">查看</a>\n                </div>\n              </div>\n            </li>\n          </ul>\n          <dt-page pagepar="published.page"></dt-page>\n        </div>\n        <p class="has-none" ng-if="published.dataList.object_list.length<1">\n          您还没有发布任何文章，您可以立即<a href="#/create/" target="_blank">添加新文章</a>\n        </p>\n      </div>\n    </div>\n  </div>\n</div>'},function(module,exports){module.exports='<div class="article">\n  <div class="article-nav">\n    <a class="logo" href="#/"></a>\n    <div class="nav-btns">\n      <div class="opt-btns">\n        <button class="a-btn" ng-click="article.saveDarft()" ng-if="!article.topicId" ng-disabled="article.draftSaving"><i class="icon" ng-class="article.draftSaving==undefined?\'icon_save\':(article.drafSaving?\'icon_saving\':\'icon_saved\')"></i>{{article.draftSaving==undefined?\'保存\':(article.drafSaving?\'保存中...\':\'已保存\')}}</button>\n        <a class="a-btn qcode-p" ng-click="article.preview()"><i class="icon icon_preview"></i>预览\n          <div class="qrcode-box" ng-if="article.previewEnabled == true">\n            <qrcode size="147" data="{{article.previewUrl}}" error-correction-level="L" version="5"></qrcode>\n            <p>扫描二维码可在手机上预览</p>\n          </div>\n        </a>\n        <div class="a-btn save" ng-click="article.checkInfo()">\n          {{article.topicId?\'保存\':\'发布\'}}\n          <div class="publist-box" ng-if="article.publishPreparation">\n            <form name="article.submitForm" ng-submit="article.publish()">\n              <div class="form-control">\n                <label>选择文章类型：</label>\n                <div class="control">\n                  <div class="select-box" ng-class="article.showType?\'open\':\'\'" ng-click="article.selectShow(\'type\')">\n                    <span>{{article.typeList[article.selectType]?article.typeList[article.selectType]:\'选择\'}}<i class="icon up"></i></span>\n                    <div class="select-inner">\n                      <a ng-repeat="(key,_tagValue) in article.typeList" ng-click="article.typeSelect(key)">{{_tagValue}}</a>\n                    </div>\n                  </div>\n                  <input type="hidden" name="type" ng-model="article.selectType" required>\n                </div>\n              </div>\n              <div class="form-control" ng-if="article.hasClub">\n                <label>选择Club：</label>\n                <div class="control">\n                  <div class="select-box" ng-class="article.showClub?\'open\':\'\'" ng-click="article.selectShow(\'club\')">\n                    <span>{{article.clubList[article.selectClub]?article.clubList[article.selectClub]:\'选择\'}}<i class="icon up"></i></span>\n                    <div class="select-inner">\n                      <a ng-repeat="(key,_clubValue) in article.clubList" ng-click="article.clubSelect(key)">{{_clubValue}}</a>\n                    </div>\n                  </div>\n                  <input type="hidden" name="club" ng-model="article.selectClub" required>\n                </div>\n              </div>\n              <div class="form-control" style="line-height: 1;margin-bottom: 0;margin-top: 24px;">\n                <div class="control">\n                  <label class="check-inlne" ng-class="article.isOriginal?\'selected\':\'\'"><span class="icon checkbox"></span><input type="checkbox" ng-model="article.isOriginal" ng-checked="article.isOriginal">开启原创声明<a href="http://www.duitang.com/guide/duitang/original_statement/" target="_blank">了解更多</a></label>\n                </div>\n              </div>\n              <input type="submit" ng-if="!article.topicId" class="submit-btn" value="{{article.submiting?\'发布中\':\'确认发布\'}}" ng-disabled="article.submitForm.$invalid||article.submiting"/>\n              <input type="submit" class="submit-btn" ng-if="article.topicId" value="{{article.submiting?\'保存中\':\'确认保存\'}}" ng-disabled="article.submitForm.$invalid||article.submiting"/>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="article-content">\n    <!-- //图片上传 -->\n    <dt-image-insert style="display:none"/>\n    <!-- //图片上传 -->\n    <div class="article-cover" ng-class="article.cover.photo_path?\'cont-bt\':\'\'" style="background-image: url({{article.cover.photo_path}});">\n      <div ng-show="article.cover.uploading">\n        <div class="upload-process">\n          <div class="process-line" style="width: {{article.cover.process}}"></div>\n        </div>\n        <p>图片上传中</p>\n      </div>\n      <div ng-show="!article.cover.uploading">\n        <dt-image-upload ng-model="article.cover.photo_path" uploading="article.cover.uploading"  process="article.cover.process" photo-id="article.cover.id" size="700,389"></dt-image-upload>\n        <p ng-if="!article.cover.photo_path">建议尺寸：不小于900x500像素</p>\n      </div>\n    </div>\n    <textarea class="art-tit" dt-elastic max="30" placeholder="在此输入标题" ng-model="article.htmlData.title" style="height:42px;"></textarea>\n    <div class="art-inner">\n      <div class="tool-bar" id="mce-tools">\n      </div>\n      <div class="art-editor"  ui-tinymce="article.tinymceOptions" ng-model="article.htmlData.articleModel" contenteditable="true">\n      </div>\n      <div class="card-user" ng-if="article.cardEnable">\n        <div class="user-info">\n          <i class="close icon icon_close_usercard" ng-click="article.cardEnable = false"></i>\n          <dl>\n            <dt>\n              <a href="/people/?user_id={{article.userInfo.id}}">\n                <img ng-src="{{article.userInfo.avatar}}">\n               </a>\n            </dt>\n            <dd>\n              <textarea placeholder="编辑个人简介（必填）" style="height:20px;" dt-elastic max="200" ng-blur="article.saveCareInfo()" ng-model="article.cardDesc"></textarea>\n            </dd>\n          </dl>\n        </div>\n      </div>\n    </div>\n    <div ng-include src="article.tmpl" id="articleContent" style="display: none"></div>\n    <div class="tips-opt {{article.showMes?\'show\':\'\'}}" ng-class="article.hasError?\'error\':\'success\'">\n      {{article.Message}}\n    </div>\n  </div>\n</div>\n<!--生成Html模板-->\n<script type="text/ng-template" id="article.html">\n  <div class="article-header" ng-if="article.isPreview">\n    <h3>{{article.htmlData.escapeTitle}}</h3>\n    <a class="blog-link" href="http://www.duitang.com/people/?user_id={{article.userInfo.id}}">\n      <img ng-src="{{article.userInfo.avatar}}">\n      <span data-name="{{article.sender.username}}" id="username" data-uid="{{article.userInfo.id}}">\n        {{article.userInfo.username}}\n        <b><i>{{article.htmlData.updateTime}}</i>·<em>0</em>次浏览</b>\n      </span>\n    </a>\n  </div>\n  <div id="container" data-carte="{{article.cardEnable? true:false}}" data-original="article.isOriginal?\'1\':\'0\'">\n    <input type="hidden" id="domain" value="{{article.htmlData.domain}}" />\n    <div class="blog-content" ng-bind-html="article.htmlData.articleContent">\n    </div>\n    <p ng-if="article.isOriginal" class="original-tip grey">本文版权归 {{article.userInfo.username}} 所有，<a href="http://www.duitang.com/guide/duitang/original_statement/?__urlopentype=pageweb">任何形式转载请联系作者。</a></p>\n  </div>\n</script>\n<!--视频模块-->\n<script type="text/ng-template" id="videoTmpl">\n<div class="videobox">\n  <a class="close" ng-click="close()">&times;</a>\n  <h3><a class="reload {{isloading?\'isloading\':\'\'}}" ng-click="reload()"> 同步媒体库</a> 添加视频 <a class="addnew-btn" href="#/videolib/create/" target="_blank">+ 新建视频</a></h3>\n  <div class="video-inner">\n    <ul class="video-list clr">\n      <li ng-repeat="video in videoList" ng-click="videoSelect(video)" class="{{video.video_status ==\'audit\'?\'disabled\':\'\'}}" ng-class="video.selected?\'active\':\'\'">\n        <div class="video">\n          <div class="video-info">\n            <div class="video-cover" style="background: url({{video.cover.bgSrc}});">\n              <div class="video-intro">\n                <span class="name">{{video.alias}}</span>\n                <span class="time-length">{{video.duration}}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </li>\n    </ul>\n    <p class="none" ng-if="videoList.length<1">还没有视频<a href="#/videolib/create/" target="_blank">添加视频</a></p>\n  </div>\n  <div class="tools">\n    <a ng-click="close()">取消</a>\n    <a class="confirm" ng-click="confirm()">确认</a>\n  </div>\n</div>\n</script>\n<!--audio tmpl-->\n<script type="text/ng-template" id="audioTmpl">\n<div class="pop-box">\n  <h3>添加音乐</h3>\n  <div class="pop-inner">\n    <p>请将音乐链接粘贴至下方（目前仅支持虾米音乐）：</p>\n    <textarea placeholder="请输入虾米链接,每篇文章最多上传插入10首音乐" ng-model="link"></textarea>\n  </div>\n  <div class="tools">\n    <a ng-click="close()">取消</a>\n    <a class="confirm" ng-click="confirm()">确认</a>\n  </div>\n</div>\n</script>\n<!-- tip tmpl-->\n<script type="text/ng-template" id="stopTempl">\n<div class="modal">\n  <a class="close" ng-click="close()">&times;</a>\n  <p>离开后修改的内容将不再保存！</p>\n  <div class="modal-tools">\n    <a ng-click="close()">留在此页</a>\n    <a class="confirm" ng-click="confirm()">离开</a>\n  </div>\n</div>\n</script>\n<script type="text/ng-template" id="ImportTmpl">\n<div class="pop-box">\n  <h3>导入文章<i class="close" ng-if="loading" ng-click="close()">×</i></h3>\n  <div class="resolve" ng-if="loading">\n    <img ng-src="{{tipSrc}}">\n    <p>{{tipTxt}}</p>\n  </div>\n  <div class="pop-inner" ng-show="!loading">\n    <p>填入文章链接（目前仅支持微信、豆瓣日志）：</p>\n    <textarea placeholder="请输入文章链接" ng-model="url"></textarea>\n  </div>\n  <div class="tools"  ng-show="!loading">\n    <a ng-click="close()">取消</a>\n    <a class="confirm" ng-click="confirm()">确认</a>\n  </div>\n</div>\n</script>\n<script type="text/ng-template" id="voteTmpl">\n<div class="pop-box vote">\n  <h3>{{editing?\'投票编辑\':\'添加投票\'}}</h3>\n  <div class="pop-inner">\n    <div class="vote-tmpl-box">\n      <div class="form-control">\n        <label class="l control-name">投票主题:</label>\n        <div class="control-input">\n          <input type="text" placeholder="不超过30个字" ng-model="name" maxlength="30">\n        </div>\n      </div>\n      <div class="form-control">\n        <div class="control-input">\n          <label class="inline-radio {{type ===\'single\' ? \'checked\':\'\'}}">\n            <input type="radio" name="votecate" ng-model="type" value="single">单选\n          </label>\n          <label class="inline-radio {{type ===\'multi\' ? \'checked\':\'\'}}">\n            <input type="radio" name="votecate" ng-model="type" value="multi">多选\n          </label>\n        </div>\n      </div>\n      <div class="form-control" ng-repeat="(key, opt) in options">\n        <label class="l control-name">选项{{key+1}}:</label>\n        <div class="control-input">\n          <input type="text" placeholder="不超过30个字" ng-model="opt.content" maxlength="30">\n        </div>\n        <i class="line-remove" ng-click="remove(key)" ng-if="opt.new">&times;</i>\n      </div>\n      <a class="add-choice" ng-click="addNewChoice()" ng-if="addEnabled"><i>+</i>添加选项</a>\n    </div>\n  </div>\n  <div class="tools">\n    <a ng-click="close()">取消</a>\n    <button class="a-btn confirm" ng-click="confirm()" ng-disabled="name==\'\'||options[0].content==\'\'||options[1].content==\'\'">确认</button>\n  </div>\n</div>\n</script>\n\n<script type="text/ng-template" id="darenTmpl">\n<div class="pop-box daren">\n  <h3>添加达人名片</h3>\n  <div class="pop-inner">\n    <dl>\n      <dt>达人ID：</dt>\n      <dd><input type="text" ng-model="darenId"></dd>\n    </dl>\n  </div>\n  <div class="tools">\n    <a ng-click="close()">取消</a>\n    <button class="a-btn confirm" ng-click="confirm()" ng-disabled="!darenId">确认</button>\n  </div>\n</div>\n</script>\n\n'},function(module,exports){module.exports='<header></header>\n<div class="success-tips" style="position: absolute;top: 50%;padding-top: 0;left: 50%;right: 0;margin-left: -480px;margin-top: -170px;">\n  <div class="succes-icon">\n    <img src="http://img4.duitang.com/uploads/people/201605/12/20160512120846_8zjNy.png">\n  </div>\n  <h3>文章发布成功</h3>\n  <p>{{vm.timeLast}}s后将自动跳转至<a href="#/published/">已发布文章</a></p>\n  <!-- <div style="width: 720px;height: 2px;margin: 40px auto 48px;background-color: #e3e3e3;"></div>\n  <h3 style="margin-bottom: 59px;font-size: 24px;">此文章是否参加 <a style="color:#fc8383;text-decoration: underline" href="/mobp/solicit/article/?from=platform" target="_blank">征文大赛“用心之处便是家”</a>?</h3>\n  <div style="text-align: center;">\n    <a href="#/published/" style="display:inline-block;width: 180px;height: 46px;border-radius: 4px;background-color: #f1f1f1;color: #999999;text-align: center;font-size: 18px;letter-spacing: 1.1px;line-height: 46px;">不参加</a>\n    <a style="display:inline-block;margin-left:70px;width: 180px;height: 46px;border-radius: 4px;background-color: #fc8383;text-align: center;color: #fff;font-size: 18px;letter-spacing: 1.1px;line-height: 46px;" ng-click="vm.join()">参加</a>\n  </div> -->\n</div>'},function(module,exports){module.exports='<header></header>\n<div id="content">\n  <div class="warp">\n    <navbar></navbar>\n    <div class="warp-inner">\n      <div class="video">\n        <h3 class="hd-title">\n        视频 <span ng-if="videolib.videoTotal">({{videolib.videoTotal}})</span>\n        <a class="addnew-btn" href="#/videolib/create/">+ 添加新视频</a>\n        </h3>\n        <div class="video-list" ng-if="videolib.videoList.length>0">\n          <ul>\n            <li ng-repeat="video in videolib.videoList" ng-if="!video.removed">\n              <div class="video">\n                <div class="video-info">\n                  <div class="video-cover" style="background: url({{video.cover.photo_path}})">\n                    <div class="video-intro">\n                      <span class="name">{{video.alias}}</span>\n                      <span class="time-length" ng-show="videolib.status===\'usable\'">{{video.duration}}</span>\n                    </div>\n                  </div>\n                </div>\n                <div class="btn-tools">\n                  <a class="btn-del" ng-if="video.video_status===\'usable\'" ng-href="#/videolib/update/?id={{video.id}}" style="border-right: 1px solid rgba(0, 0, 0, 0.08);">编辑</a>\n                  <a class="btn-del" ng-if="video.video_status===\'usable\'" ng-click="videolib.videoDelete(video)">删除</a>\n                  <a class="btn-del" ng-if="video.video_status===\'audit\'" >转码中，约需20分钟...</a>\n                </div>\n              </div>\n            </li>\n          </ul>\n          <dt-page pagepar="videolib.page"></dt-page>\n        </div>\n        <p class="has-none" ng-if="videolib.videoList.length<1">\n          您还没有添加任何视频，您可以立即<a href="#/videolib/create/">新建视频</a>\n        </p>\n      </div>\n    </div>\n  </div>\n</div>\n\n <!--删除模板-->\n  <script type="text/ng-template" id="videoTmpl">\n  <div class="modal">\n    <a class="close" ng-click="close()">&times;</a>\n    <p>确认要删除吗？</p>\n    <div class="modal-tools">\n      <a ng-click="close()">取消</a>\n      <a class="confirm" ng-click="confirm()">确认</a>\n    </div>\n  </div>\n  </script>'},function(module,exports){module.exports='<header></header>\n<div id="content">\n  <div class="warp">\n    <div class="video-form">\n      <h3 class="v-title">新建视频</h3>\n      <form name="videoCrt.videoInfo" ng-submit="videoCrt.finish()">\n        <div class="video-mes">\n          <div class="form-control clr">\n            <label>上传视频:</label>\n            <div class="control-inner">\n              <p class="tips">视频大小不超过300MB，目前支持mov / mp4 / avi格式</p>\n              <div ng-show="!videoCrt.uploading" class="inline">\n                <div class="upload-video" id="videoFile">\n                  <span class="kword">选择文件</span>\n                </div>\n                <span class="inline">{{videoCrt.videofile}}</span>\n              </div>\n              <input type="hidden" name="video" ng-model="videoCrt.videofile" required ng-pattern="videoCrt.pattern"/>\n              <input type="hidden" name="videoproc" ng-model="videoCrt.finishParams" required>\n              <div ng-messages="videoCrt.videoInfo.video.$error" class="error inline">\n                <div ng-message="pattern">文件格式不正确</div>\n              </div>\n              <div class="proc-box" ng-show="videoCrt.uploading">\n                <div class="name">{{videoCrt.videofile}}<a class="close" ng-click="videoCrt.stop()">&times;</a></div>\n                <div class="proc">\n                  <i style="width: {{videoCrt.percent}}%"></i>\n                  <span class="rate">{{videoCrt.percent}}%</span>\n                </div>\n                <div class="error-p" ng-if="videoCrt.errorMes">\n                  {{videoCrt.errorMes?videoCrt.errorMes:\'上传失败\'}}<a  ng-click="videoCrt.reStart()">重新上传</a>\n                </div>\n                <div class="success-p" ng-if="videoCrt.successMes">\n                  上传成功！\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class="form-control clr">\n            <label>视频标题:</label>\n            <div class="control-inner">\n              <input type="text" class="text" name="videoName" placeholder="不超过12字(必填)" ng-maxlength="12" ng-model="videoCrt.name" required>\n              <div ng-messages="videoCrt.videoInfo.videoName.$error" class="error inline">\n                <p ng-message="maxlength">不超过12字</p>\n              </div>\n            </div>\n          </div>\n          <div class="form-control clr">\n            <label>视频封面:</label>\n            <div class="control-inner">\n              <div class="video-cover" style="background-image: url({{videoCrt.cover.path}});">\n                <div ng-show="videoCrt.cover.uploading">\n                  <div class="upload-process">\n                    <div class="process-line" style="width: {{videoCrt.process}}"></div>\n                  </div>\n                  <p>图片上传中</p>\n                </div>\n                <div ng-show="!videoCrt.cover.uploading">\n                  <dt-image-upload ng-model="videoCrt.cover.path" uploading="videoCrt.cover.uploading" photo-id="videoCrt.photoId" process="videoCrt.process" size="200,150" ></dt-image-upload>\n                  <p class="tips" ng-if="!videoCrt.cover.path">建议尺寸：800x600像素</p>\n                </div>\n              </div>\n              <input type="hidden" name="cover" required ng-model="videoCrt.cover.path">\n            </div>\n          </div>\n          <div class="from-btn">\n            <input type="submit" class="sub-btn" value="确认" ng-disabled="videoCrt.videoInfo.$invalid">\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n<!--删除模板-->\n<script type="text/ng-template" id="videoTempl">\n<div class="modal">\n  <a class="close" ng-click="close()">&times;</a>\n  <p>若现在离开，视频将终止上传</p>\n  <div class="modal-tools">\n    <a ng-click="close()">留在此页</a>\n    <a class="confirm" ng-click="confirm()">离开此页</a>\n  </div>\n</div>\n</script>\n<!--删除模板-->\n<script type="text/ng-template" id="videoStopTempl">\n<div class="modal">\n  <a class="close" ng-click="close()">&times;</a>\n  <p>视频将终止上传</p>\n  <div class="modal-tools">\n    <a ng-click="close()">取消</a>\n    <a class="confirm" ng-click="confirm()">确认</a>\n  </div>\n</div>\n</script>'},function(module,exports){module.exports='<header></header>\n<div id="content">\n  <div class="warp">\n    <div class="video-form">\n      <h3 class="v-title">编辑视频</h3>\n      <form name="videoU.videoInfo" ng-submit="videoU.saveChange()">\n        <div class="video-mes">\n          <div class="form-control clr">\n            <label>视频名称:</label>\n            <div class="control-inner">\n              <span class="inline">{{videoU.videofile}}</span>\n            </div>\n          </div>\n          <div class="form-control clr">\n            <label>视频标题:</label>\n            <div class="control-inner">\n              <input type="text" class="text" name="videoName" placeholder="不超过12字(必填)" ng-maxlength="12" ng-model="videoU.name" required>\n              <div ng-messages="videoU.videoInfo.videoName.$error" class="error inline">\n                <p ng-message="maxlength">不超过12字</p>\n              </div>\n            </div>\n          </div>\n          <div class="form-control clr">\n            <label>视频封面:</label>\n            <div class="control-inner">\n              <div class="video-cover" style="background-image: url({{videoU.videoCover}});">\n                <div ng-show="videoU.uploading">\n                  <div class="upload-process">\n                    <div class="process-line" style="width: {{videoU.process}}"></div>\n                  </div>\n                  <p>图片上传中</p>\n                </div>\n                <div ng-show="!videoU.uploading">\n                  <dt-image-upload ng-model="videoU.videoCover" uploading="videoU.uploading" photo-id="videoU.photoId" process="videoU.process" size="200,150" ></dt-image-upload>\n                  <p class="tips" ng-if="!videoU.videoCover">建议尺寸：800x600像素</p>\n                </div>\n              </div>\n              <input type="hidden" name="cover" required ng-model="videoU.videoCover">\n            </div>\n          </div>\n          <div class="from-btn">\n            <input type="submit" class="sub-btn" value="确认" ng-disabled="videoU.videoInfo.$invalid">\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>';
}]);